       IDENTIFICATION DIVISION.                                                  000000
       PROGRAM-ID. ZSCLAWBACK.                                                   151030
      *                                                                          950209
      * Copyright 1986-2019, Computer Sciences Corporation.                      190628
      *           COMMISSION CLAWBACK SUBROUTINE                                 181017
      *                                                                          950209
      *REMARKS.                                                                  140603
      *                                                                          000801
      ***********************************************************************    950428
      *           AMENDMENT  HISTORY                                        *    181010
      ***********************************************************************    950428
      * DATE.... VSN/MOD  WORK UNIT    BY....                               *    950428
      *                                                                     *    950428
      * 30/10/15  01/01   ATHA39       Androni Katerina                     *    151223
      *           INITIAL VERSION                                           *    151030
      *                                                                     *    151030
      * 05/02/16  01/01   ATHA43       Androni Katerina                     *    160324
      *           PHASE II- MCPPI  PARTIAL SURRENDER                        *    160205
      *                                                                     *    160205
      * 04/04/16  01/01   ATHA67       Androni Katerina                     *    160607
      *           CLAWBACK CHANGES/ PARTIAL SURRENDER                       *    160404
      *                                                                     *    160404
      * 08/02/17  01/01   ATHB37       Androni Katerina                     *    170208
      *           PREMIUM DECREASE CLAWBACK                                 *    170208
      *                                                                     *    170208
      * 10/03/17  01/01   ATHB45       Androni Katerina                     *    170310
      *           CHANGES FOR THE NEW LOYALTY BONUS                         *    170823
      *                                                                     *    170310
      * 23/08/17  01/01   ATHB87       Androni Katerina                     *    170823
      *           CHANGES FOR NEW UL REGULAR. DO NOT WRITE ACCOUNT 52       *    170823
      *           FOR TOPUP COVERAGES.                                           170823
      *                                                                     *    170823
      * 08/03/18  01/01   ATHC41       Androni Katerina                     *    180308
      *           MG1 PARTIAL SURRENDER CHANGES                             *    180308
      *                                                                     *    180308
      * 28/09/18  01/01   TSTDBG       Mitraina Eyaggelia                   *    180928
      *           DEBUG                                                     *    180928
      *                                                                     *    180928
      * 12/10/18  01/01   ATHD11       Mitraina Eyaggelia                   *    181012
      *           US515- Add Clawback Functionality for UL                  *    181012
      *                  Method SURRF must write in ZTUD also.              *    181012
      *                                                                     *    181012
      * 27/06/19  01/01   ATHD94       Xatzirvasanis Nikolas                *    190627
      *           Clawback calculation for "NN Orange LIFE" term TT05, TT06.*    190628
      *                                                                     *    190628
      *           It is calculated on two occasions:                        *    190627
      *              - Lapse            (function SURRT)                    *    190628
      *              - Premium decrease (function DECRP)                    *    190628
      *                                                                     *    190627
      **DD/MM/YY*************************************************************    190627
      *                                                                          000000
       ENVIRONMENT DIVISION.                                                     151030
       CONFIGURATION SECTION.                                                    151030
       SOURCE-COMPUTER.                                IBM-AS400.                151030
       OBJECT-COMPUTER.                                IBM-AS400.                151030
                                                                                 151030
       INPUT-OUTPUT SECTION.                                                     151030
       FILE-CONTROL.                                                             151030
      /                                                                          151030
       DATA DIVISION.                                                            151030
       FILE SECTION.                                                             151030
      /                                                                          151030
       WORKING-STORAGE SECTION.                                                  151030
       01  WSAA-SUBR                      PIC  X(10) VALUE 'ZSCLAWBACK'.         151030
       01  WSAA-VERSION                   PIC  X(02) VALUE '01'.                 151030
                                                                                 151030
       01  FORMATS.                                                              151030
           03  ITEMREC                    PIC  X(10) VALUE 'ITEMREC'.            151030
           03  ITDMREC                    PIC  X(10) VALUE 'ITEMREC'.            151030
           03  CHDRMJAREC                 PIC  X(10) VALUE 'CHDRMJAREC'.         151103
           03  ACMVBK3REC                 PIC  X(10) VALUE 'ACMVBK3REC'.         151103
           03  ACMVREVREC                 PIC  X(10) VALUE 'ACMVREVREC'.         151109
           03  ZTUDREC                    PIC  X(10) VALUE 'ZTUDREC'.            151030
           03  ZTUHREC                    PIC  X(10) VALUE 'ZTUHREC'.            151110
           03  ZTUHTRNREC                 PIC  X(10) VALUE 'ZTUHTRNREC'.         151110
           03  ZCHDREC                    PIC  X(10) VALUE 'ZCHDREC'.            151104
           03  AGCMBCRREC                 PIC  X(10) VALUE 'AGCMBCRREC'.         151104
           03  AGNTREC                    PIC  X(10) VALUE 'AGNTREC'.            151109
           03  ZCHAREC                    PIC  X(10) VALUE 'ZCHAREC'.            151110
           03  ZCLBREC                    PIC  X(10) VALUE 'ZCLBREC'.            151112
           03  ZCLBCOVREC                 PIC  X(10) VALUE 'ZCLBCOVREC'.<ATHA67> 160404
           03  AGLFREC                    PIC  X(10) VALUE 'AGLFREC'.            151113
           03  PTRNREVREC                 PIC  X(10) VALUE 'PTRNREVREC'.         151114
           03  COVRAFIREC                 PIC  X(10) VALUE 'COVRAFIREC'.<ATHB37> 170210
           03  CHDRAFIREC                 PIC  X(10) VALUE 'CHDRAFIREC'.<ATHB37> 170210
           03  ZCOVCRTREC                 PIC  X(10) VALUE 'ZCOVCRTREC'.<ATHB45> 170310
                                                                                 151030
       01  WSAA-ITDMKEY.                                                         151030
           COPY ITDMKEY.                                                         151030
                                                                                 151030
       01  TABLES.                                                               151030
           03  T8Z82                      PIC  X(06) VALUE 'T8Z82'.              151030
           03  T5645                      PIC  X(06) VALUE 'T5645'.              151030
           03  T7Z11                      PIC  X(06) VALUE 'T7Z11'.     <ATHB37> 170214
           03  T5Z01                      PIC  X(06) VALUE 'T5Z01'.     <ATHB37> 170214
           03  T5694                      PIC  X(06) VALUE 'T5694'.     <ATHB37> 170302
           03  T5673                      PIC  X(06) VALUE 'T5673'.     <ATHB45> 170313
           03  T5687                      PIC  X(06) VALUE 'T5687'.     <ATHB45> 170313
           03  T8Z05                      PIC  X(06) VALUE 'T8Z05'.     <ATHD11> 181019
                                                                                 151109
       01  ERRORS.                                                               151109
           03  H028                    PIC X(4)  VALUE 'H028'.                   151109
           03  H791                    PIC X(4)  VALUE 'H791'.                   151113
                                                                                 151030
       01  WSAA-VARIABLES.                                                       151030
           03  WSAA-NEXT-ANNI-DATE     PIC 9(08) COMP-3 VALUE ZERO.              151109
           03  WSVA-OCCDATE            PIC 9(08) COMP-3 VALUE ZERO.              151030
           03  WSVA-HOLE-DATE.                                                   151030
               05  WSVA-YEARS          PIC S9(06)  VALUE ZERO.                   151030
               05  WSVA-REST           PIC  9(05)  VALUE ZERO.                   151030
           03  WSAA-INSTPREM           PIC S9(11)V9(02) COMP-3.                  151030
           03  WSAA-TOT-INSTPREM       PIC S9(11)V9(02) COMP-3.                  151030
           03  WSAA-VAR-IDX            PIC S9(05)V9(02).                         151030
           03  WSAA-TEMP-VAR-IDX       PIC S9(12)V9(06).                         151030
           03  WSAA-IND1               PIC  9(03).                               151109
           03  WSAA-IND2               PIC  9(03).                      <ATHB37> 170208
           03  WSAA-INDEX              PIC  9(03).                               151103
           03  WSAA-ARRAY-INDEX        PIC  9(03).                      <ATHB37> 170214
           03  WSAA-ARRAY-INDEX2       PIC  9(03).                      <ATHB37> 170214
           03  IX-SA                   PIC  9(02).                               151111
           03  WSAA-TERM               PIC  9(02).                               151103
           03  WSAA-TERMW              PIC  9(02).                      <ATHB37> 170214
           03  WSAA-CESS-TERM          PIC  9(02).                      <ATHB37> 170214
           03  WSAA-FROM-DATE          PIC  9(08).                               151109
           03  WSAA-T8Z82              PIC S9(03)V99  VALUE ZERO.                151103
           03  WSAA-T7Z11              PIC S9(03)V9(04) VALUE ZERO.     <ATHB37> 170214
           03  WSAA-T5694              PIC S9(03)V9(04) VALUE ZERO.     <ATHB37> 170302
           03  WSAA-LAST-RLDGACCT          PIC X(16).                            151216
           03  WSAA-USED-RLDGACCT          PIC X(16).                            151216
           03  WSAA-ACMV-RLDGACCT.                                               151216
               05  WSAA-ACMV-CHDRNUM       PIC X(08).                            151030
               05  WSAA-ACMV-LIFE          PIC X(02).                            151030
               05  WSAA-ACMV-COVERAGE      PIC X(02).                            151030
               05  WSAA-ACMV-RIDER         PIC X(02).                            151030
               05  WSAA-ACMV-PLAN-SUFF     PIC X(02).                            151030
           03  WSAA-PAID-PREM          PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-PAID-PREM-CLAWB    PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-PAID-COMM          PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-PAID-COMM-CLAWB    PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-PAID-OVRCOM        PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-PAID-OVRCOM-CLAWB  PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-TOT-CLAWB-TOPUP    PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-TOT-CLAWB-NET      PIC S9(11)V9(02) COMP-3.                  151116
           03  WSAA-TOT-CLAWB-OVRAMT   PIC S9(11)V9(02) COMP-3.                  151116
           03  WSAA-CLAWBACK-TOPUP     PIC S9(11)V9(02) COMP-3.                  151109
           03  WSAA-CLAWBACK-NET       PIC S9(11)V9(02) COMP-3.                  151110
           03  WSAA-CLAWBACK-OVRAMT    PIC S9(11)V9(02) COMP-3.                  151118
           03  WSAA-OVRAMT-TOPUP       PIC S9(11)V9(02) COMP-3.                  151118
           03  WSAA-PRV-CLAW-PREM      PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-PRV-CLAW-COMM      PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-PRV-CLAW-OVRC      PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-CLAW-PREM-REMN     PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-CLAW-COMM-REMN     PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-CLAW-OVRC-REMN     PIC S9(11)V9(02) COMP-3.         <ATHA67> 160404
           03  WSAA-CRCODE                PIC  X(01).                            151103
           03  WSAA-AGNTNUM               PIC  X(08).                            151109
           03  WSAA-AGNTNUM-INIT          PIC  X(08).                            151123
           03  WSAA-ZCHA-CLNTNUM          PIC  X(08).                            151110
           03  WSAA-ZCHD-CLNTNUM          PIC  X(08).                            151110
           03  WSAA-AGCM-CLNTNUM          PIC  X(08).                            151109
           03  WSAA-ZTUD-ARRAY-CNT        PIC  9(03).                            151109
           03  WSAA-ZTUD-ARRAY.                                                  151109
               05  WSAA-ZTUD-RECODE       PIC  X(02) OCCURS 999.                 151109
               05  WSAA-ZTUD-EFFDATE      PIC  9(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-ZPREMAMT     PIC  9(13)V9(02) OCCURS 999.           151109
               05  WSAA-ZTUD-ZCOMMAMT     PIC  9(13)V9(02) OCCURS 999.           151109
               05  WSAA-ZTUD-NET          PIC  9(13)V9(02) OCCURS 999.           151109
               05  WSAA-ZTUD-OVRAMT       PIC  9(13)V9(02) OCCURS 999.           151118
               05  WSAA-ZTUD-JCOVCODE     PIC  X(05) OCCURS 999.                 151109
               05  WSAA-ZTUD-LIFENUM      PIC  X(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-AGNTNUM      PIC  X(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-ZCLNTAGN     PIC  X(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-ZCLNTUNI     PIC  X(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-ZCLNTASS     PIC  X(08) OCCURS 999.                 151109
               05  WSAA-ZTUD-ZCLNTAGY     PIC  X(08) OCCURS 999.                 151109
           03  WSAA-ACMV-ARRAY-CNT        PIC  9(03).                   <ATHA67> 160513
           03  WSAA-ACMV-ARRAY.                                         <ATHA67> 160513
      **       05  WSAA-ACMV-RLDGACCT-W   PIC  X(16) OCCURS 999.                 151216
               05  WSAA-ACMV-AGNTNUM      PIC  X(08) OCCURS 999.        <ATHA67> 160513
               05  WSAA-ACMV-ZPREMAMT     PIC  9(13)V9(02) OCCURS 999.  <ATHA67> 160513
               05  WSAA-ACMV-ZCOMMAMT     PIC  9(13)V9(02) OCCURS 999.  <ATHA67> 160513
               05  WSAA-ACMV-OVRAMT       PIC  9(13)V9(02) OCCURS 999.  <ATHA67> 160513
               05  WSAA-ACMV-CRTABLE      PIC  X(04) OCCURS 999.        <ATHA67> 160513
           03  WSAA-YEARS-ARRAY.                                        <ATHB37> 170210
               05  WSAA-FROM-DATE-W    PIC  9(08) OCCURS 25.            <ATHB37> 170208
               05  WSAA-TO-DATE-W      PIC  9(08) OCCURS 25.            <ATHB37> 170208
               05  WSAA-PAID-PREM-RP   PIC S9(13)V9(02) OCCURS 25.      <ATHB37> 170210
               05  WSAA-PAID-OVRC-RP   PIC S9(13)V9(02) OCCURS 25.      <ATHB37> 170210
               05  WSAA-PAID-COMM-RP   PIC S9(13)V9(02) OCCURS 25.      <ATHB37> 170210
           03  WSAA-NEXT-ANNI-WRK      PIC 9(08) COMP-3 VALUE ZERO.     <ATHB37> 170208
           03  WSAA-COUNT-YEAR         PIC 9(02).                       <ATHB37> 170208
           03  WSAA-SYSR-PARAMS.                                                 151112
               05  WSAA-SYSR-FORMAT    PIC  X(10).                               151110
               05  WSAA-SYSR-CHDRNUM   PIC  X(08).                               151110
           03  WSAA-CRTABLE            PIC  X(04).                               151111
           03  WSAA-JRNSEQ             PIC S9(03) COMP-3.                        151112
           03  WSAA-JPREMREG           PIC  X(09).                               151112
           03  WSAA-BATCTRCDE          PIC  X(04).                               151114
           03  WSAA-LAST-TRANNO        PIC  9(05).                               151216
           03  WSAA-LAST-TRANNO-W      PIC  9(05).                               151216
           03  WSAA-PARTS-PERC         PIC S9(03)V9(02) VALUE ZEROS.    <ATHA43> 160225
           03  WSAA-PARTS-PERC-WRK     PIC S9(06)V9(04) VALUE ZEROS.    <ATHA43> 160324
           03  WSAA-ZCLB-LIFE          PIC  X(02).                      <ATHA67> 160404
           03  WSAA-ZCLB-COVERAGE      PIC  X(02).                      <ATHA67> 160404
           03  WSAA-ZCLB-RIDER         PIC  X(02).                      <ATHA67> 160404
           03  WSAA-ZCLB-RECODE        PIC  X(02).                      <ATHA67> 160406
           03  WSAA-INIT-ANNPREM       PIC S9(11)V9(02) COMP-3.         <ATHB37> 170210
           03  WSAA-DIFF-PREM          PIC S9(11)V9(02) COMP-3.         <ATHB37> 170213
           03  WSAA-MIN-ANNPREM        PIC S9(11)V9(02) COMP-3.         <ATHB37> 170214
           03  WSAA-COMM-WRK           PIC S9(11)V9(02) COMP-3.         <ATHB37> 170214
           03  WSAA-OVRCOM-WRK         PIC S9(11)V9(02) COMP-3.         <ATHB37> 170214
           03  WSAA-PREM-CLAWB         PIC S9(11)V9(02) COMP-3.         <ATHB37> 170215
           03  WSAA-TU-LIFE            PIC X(02).                       <ATHB45> 170310
           03  WSAA-TU-COVERAGE        PIC X(02).                       <ATHB45> 170310
           03  WSAA-TU-RIDER           PIC X(02).                       <ATHB45> 170310
           03  WSAA-TU-CRTABLE         PIC X(04).                       <ATHB45> 170310
           03  WSAA-T5673-ITEM         PIC  X(08).                      <ATHB45> 181019
           03  WSAA-READ-CRTABLE       PIC  X(04).                      <ATHB45> 181019
           03  WSAA-COMM-RATE          PIC S9(03)V9(04) VALUE ZEROS.    <ATHD11> 181019
                                                                                 151111
       01  WSAA-RLDGACCT.                                                        151111
           03  WSAA-RLDG-CHDRNUM       PIC X(08).                                151111
           03  WSAA-RLDG-LIFE          PIC X(02).                                151111
           03  WSAA-RLDG-COVERAGE      PIC X(02).                                151111
           03  WSAA-RLDG-RIDER         PIC X(02).                                151111
           03  WSAA-RLDG-PLAN-SUFFIX   PIC X(02).                                151111
                                                                                 151111
       01  WSAA-TRANREF.                                                         151111
           03 WSAA-TRANCHDR            PIC X(26).                                151114
           03 WSAA-EXT-IGNORE          PIC X(01).                                151111
           03 WSAA-TRANAGNT            PIC X(03).                                151111
                                                                                 151214
       01  WSAA-TRANREF-TOP.                                                     151214
           03 WSAA-TRANCHDR-TOP        PIC X(25).                                151214
           03 WSAA-EXT-RECODE          PIC X(02).                                151214
           03 WSAA-TRANAGNT-TOP        PIC X(03).                                151214
                                                                                 151030
       01  WSAA-OCCDATE                PIC 9(08).                                151030
       01  WSAA-OCCDATE-A   REDEFINES WSAA-OCCDATE.                              151030
      **   03  WSAA-OCC-YEAR           PIC 9(04).                                151103
           03  WSAA-OCC-YEARMN         PIC 9(06).                                151103
               05  WSAA-OCC-YEAR       PIC 9(04).                                151103
               05  WSAA-OCC-MONTH      PIC 9(02).                                151103
      **   03  WSAA-OCC-MONTH          PIC 9(02).                                151103
           03  WSAA-OCC-DAY            PIC 9(02).                                151030
                                                                                 151030
       01  WSAA-BILLFREQ-VAR.                                                    151030
           05  WSAA-BILLFREQ           PIC X(02).                                151030
           05  FILLER REDEFINES WSAA-BILLFREQ.                                   151030
               10  WSAA-BILLFREQ-NUM   PIC 9(02).                                151030
       01  WSAA-FULL-DATE              PIC 9(08).                                151030
       01  WSAA-FULL-DATE-B            PIC 9(08).                                151030
       01  WSAA-FULL-DATE-C REDEFINES WSAA-FULL-DATE-B.                          151030
      **   03  WSAA-YEAR               PIC 9(04).                       <ATHA37> 151030
           03  WSAA-YEARMN             PIC 9(06).                       <ATHA37> 151030
               05  WSAA-YEAR           PIC 9(04).                       <ATHA37> 151030
               05  WSAA-MON            PIC 9(02).                       <ATHA37> 151030
      **   03  WSAA-MON                PIC 9(02).                       <ATHA37> 151030
           03  WSAA-DAY                PIC 9(02).                                151030
                                                                        <ATHA37> 151030
       01  WSAA-ACMV-DATE              PIC 9(06).                       <ATHA37> 151030
       01  WSAA-ACMV-DATE-A REDEFINES WSAA-ACMV-DATE.                   <ATHA37> 151030
           03  WSAA-ACMV-YEAR          PIC 9(04).                       <ATHA37> 151030
           03  WSAA-ACMV-MONTH         PIC 9(02).                       <ATHA37> 151030
                                                                                 151109
       01  WSAA-ITEMITEM.                                                        151109
      **   03  WSAA-ITEM-SRCEBUS       PIC X(02).                                151222
           03  WSAA-ITEM-CNTTYPE       PIC X(03).                                151222
           03  WSAA-ITEM-CRTABLE       PIC X(04).                                151109
                                                                        <ATHB37> 170214
       01  WSAA-ITEMITEM-IT.                                            <ATHB37> 170214
           03  WSAA-METHOD-IT          PIC X(04).                       <ATHB37> 170214
           03  WSAA-CRTABLE-IT         PIC X(03).                       <ATHB37> 170214
                                                                                 151113
       01  WSAA-T5645-SIZE             PIC 9(2) VALUE 30.                        151113
       01  WSAA-T5645-OFFSET           PIC 9(2) VALUE 1.                         151113
                                                                                 151113
       01  WSAA-T5645-ARRAY.                                                     151113
           03  WSAA-T5645-DATA OCCURS 30.                                        151113
               05  WSAA-T5645-CNTTOT        PIC S9(02).                          151113
               05  WSAA-T5645-GLMAP         PIC X(00014).                        151113
               05  WSAA-T5645-SACSCODE      PIC X(00002).                        151113
               05  WSAA-T5645-SACSTYPE      PIC X(00002).                        151113
               05  WSAA-T5645-SIGN          PIC X(00001).                        151113
                                                                                 151113
       01  WSAA-T5645-SUB              PIC S9(5)    COMP-3.                      151113
                                                                                 151030
       01  WSCC-CONSTANTS.                                                       151030
           03  WSCC-TXT-0                 PIC  X(01) VALUE '0'.                  151030
           03  WSCC-TXT-1                 PIC  X(01) VALUE '1'.                  151030
           03  WSCC-TXT-2                 PIC  X(01) VALUE '2'.                  151030
           03  WSCC-NUM-1                 PIC  9(01) VALUE 1.                    151109
           03  WSCC-01                    PIC  X(02) VALUE '01'.                 151030
           03  WSCC-00                    PIC  X(02) VALUE '00'.                 151109
           03  WSCC-LE                    PIC  X(02) VALUE 'LE'.                 151030
           03  WSCC-BK                    PIC  X(02) VALUE 'BK'.                 151030
           03  WSCC-PS                    PIC  X(02) VALUE 'PS'.                 151030
           03  WSCC-LP                    PIC  X(02) VALUE 'LP'.                 151030
           03  WSCC-YC                    PIC  X(02) VALUE 'YC'.                 151109
           03  WSCC-LA                    PIC  X(02) VALUE 'LA'.                 151109
           03  WSCC-CP                    PIC  X(02) VALUE 'CP'.                 151109
           03  WSCC-AG                    PIC  X(02) VALUE 'AG'.                 151109
           03  WSCC-OC                    PIC  X(02) VALUE 'OC'.                 151110
           03  WSCC-CB                    PIC  X(02) VALUE 'CB'.                 151116
           03  WSCC-SU                    PIC  X(02) VALUE 'SU'.                 151208
           03  WSCC-CF                    PIC  X(02) VALUE 'CF'.                 151208
           03  WSCC-T                     PIC  X(02) VALUE 'T '.                 151030
           03  WSCC-P                     PIC  X(01) VALUE 'P'.                  151030
           03  WSCC-NUM--1                PIC S9(01) VALUE -1.                   151030
           03  WSCC-SURFS                 PIC  X(05) VALUE 'SURFS'.              151111
           03  WSCC-SURCF                 PIC  X(05) VALUE 'SURCF'.              151116
           03  WSCC-SURRF                 PIC  X(05) VALUE 'SURRF'.              151111
      *                                                                 <ATHD94> 190627
      *        Lapse for term TT05, TT06.                               <ATHD94> 190628
      *                                                                 <ATHD94> 190627
           03  WSCC-SURRT                 PIC  X(05) VALUE 'SURRT'.     <ATHD94> 190627
           03  WSCC-SURTF                 PIC  X(05) VALUE 'SURTF'.              151111
           03  WSCC-SURPS                 PIC  X(05) VALUE 'SURPS'.     <ATHA43> 160205
           03  WSCC-SURPC                 PIC  X(05) VALUE 'SURPC'.     <ATHD11> 181016
           03  WSCC-SURSP                 PIC  X(05) VALUE 'SURSP'.              151122
           03  WSCC-SURGG                 PIC  X(05) VALUE 'SURGG'.     <ATHA67> 160407
           03  WSCC-SURGP                 PIC  X(05) VALUE 'SURGP'.     <ATHC41> 180308
           03  WSCC-CFIGG                 PIC  X(05) VALUE 'CFIGG'.     <ATHA67> 160413
           03  WSCC-DECRP                 PIC  X(05) VALUE 'DECRP'.     <ATHB37> 170208
           03  WSCC-EUR                   PIC  X(03) VALUE 'EUR'.                151030
           03  WSCC-MINUS              PIC  X(01) VALUE '-'.            <ATHA37> 151030
           03  WSCC-T679               PIC  X(04) VALUE 'T679'.         <ATHA37> 151030
           03  WSCC-T607               PIC  X(04) VALUE 'T607'.         <ATHA37> 151030
           03  WSCC-T656               PIC  X(04) VALUE 'T656'.         <ATHA37> 151030
           03  WSCC-T646               PIC  X(04) VALUE 'T646'.         <ATHA37> 151030
           03  WSCC-MAX-TRANNO         PIC  9(05) VALUE 99999.                   151109
           03  WSCC-MAX-ARRAY          PIC  9(03) VALUE 999.                     151109
           03 WSCC-NEXT                PIC X(04) VALUE 'NEXT'.                   151112
           03 WSCC-REE1                PIC X(04) VALUE 'REE1'.          <ATHA43> 160323
      /                                                                          151030
       01  WS88-CONTROL-FLAGS.                                                   151030
           03  WS88-MUST-EXIT-PGM         PIC  X(01).                            151030
               88  MUST-EXIT-PGM          VALUE 'Y'.                             151030
           03  WS88-CLAWBACK-REGP      PIC  X(01).                               151104
               88  CLAWBACK-REGP                  VALUE 'Y'.                     151104
               88  NOT-CLAWBACK-REGP              VALUE 'N'.                     151104
           03  WS88-ARRAY-CRTABLE-FOUND      PIC  X(01).                         151109
               88  ARRAY-CRTABLE-FOUND            VALUE 'Y'.                     151109
               88  NOT-ARRAY-CRTABLE-FOUND        VALUE 'N'.                     151109
           03  WS88-FIND-COMM                PIC  X(01).                         151109
               88  FIND-COMM                      VALUE 'Y'.                     151109
               88  NOT-FIND-COMM                  VALUE 'N'.                     151109
           03  WS88-VALID-RECORD             PIC  X(01).                         151114
               88  VALID-RECORD                   VALUE 'Y'.                     151114
               88  NOT-VALID-RECORD               VALUE 'N'.                     151114
           03  WS88-CHECK-AGENT              PIC  X(01).                <ATHA67> 160414
               88  CHECK-AGENT                    VALUE 'Y'.            <ATHA67> 160414
               88  NOT-CHECK-AGENT                VALUE 'N'.            <ATHA67> 160414
           03  WS88-ARRAY-ACMV-FOUND         PIC  X(01).                <ATHA67> 160513
               88  ARRAY-ACMV-FOUND               VALUE 'Y'.            <ATHA67> 160513
               88  NOT-ARRAY-ACMV-FOUND           VALUE 'N'.            <ATHA67> 160513
           03  WS88-MUST-EXIT-LOOP           PIC  X(01).                <ATHB45> 170313
               88  MUST-EXIT-LOOP            VALUE 'Y'.                 <ATHB45> 170313
               88  NOT-MUST-EXIT-LOOP        VALUE 'N'.                 <ATHB45> 170313
           03  WS88-CRTABLE-TYPE             PIC  X(01).                <ATHB45> 170313
               88  CRTABLE-TYPE-TOP-UP       VALUE 'P'.                 <ATHB45> 170313
               88  CRTABLE-TYPE-UL           VALUE 'L'.                 <ATHD11> 181016
           03  WS88-CLAWBACK-COVER           PIC  X(01).                <ATHD11> 181018
              88  CLAWBACK-COVER             VALUE 'Y'.                 <ATHD11> 181018
              88  NOT-CLAWBACK-COVER         VALUE 'N'.                 <ATHD11> 181018
           03  WS88-MCPPI-PRODUCT         PIC  X(01).                   <ATHD11> 181019
              88  MCPPI-PRODUCT           VALUE 'Y'.                    <ATHD11> 181019
              88  NOT-MCPPI-PRODUCT       VALUE 'N'.                    <ATHD11> 181019
      /                                                                          151030
           COPY SYSERRREC.                                                       151030
           COPY VFLAGCPY.                                                        151030
           COPY FREQCPY.                                                         151030
           COPY VARCOM.                                                          151030
           COPY SMTPFXCPY.                                                       151030
           COPY FSUPFXCPY.                                                       151030
      /                                                                          151030
           COPY ITEMSKM.                                                         151030
           COPY ITDMSKM.                                                         151030
      /                                                                          151030
           COPY T5645REC.                                                        151030
           COPY T8Z82REC.                                                        151030
           COPY T7Z11REC.                                               <ATHB37> 170214
           COPY T5Z01REC.                                               <ATHB37> 170214
           COPY T5694REC.                                               <ATHB37> 170302
           COPY T5687REC.                                               <ATHB45> 170313
           COPY T5673REC.                                               <ATHB45> 170313
           COPY T8Z05REC.                                               <ATHD11> 181019
      /                                                                          151030
           COPY DATCON2REC.                                                      151030
           COPY DATCON3REC.                                                      151030
           COPY DATCON4REC.                                                      151030
      /                                                                          151030
           COPY ACMVBK3SKM.                                                      151030
           COPY ACMVREVSKM.                                                      151109
           COPY ZTUDSKM.                                                         151030
           COPY ZCHDSKM.                                                         151104
           COPY ZCHASKM.                                                         151110
           COPY AGNTSKM.                                                         151109
           COPY AGLFSKM.                                                         151113
           COPY CHDRMJASKM.                                                      151103
           COPY AGCMBCRSKM.                                                      151104
           COPY ZTUHSKM.                                                         151110
           COPY ZCLBSKM.                                                         151112
           COPY ZCLBCOVSKM.                                             <ATHA67> 160404
           COPY ZTUHTRNSKM.                                                      151110
           COPY ZCOVCRTSKM.                                             <ATHB45> 170310
           COPY PTRNREVSKM.                                                      151114
           COPY COVRAFISKM.                                             <ATHB37> 170210
           COPY CHDRAFISKM.                                             <ATHB37> 170210
           COPY DESCSKM.                                                         151116
      /                                                                          151111
           COPY LIFACMVREC.                                                      151111
           COPY ALOCNOREC.                                                       151112
                                                                                 151030
       LINKAGE SECTION.                                                          151030
      *****************                                                          151030
           COPY ZSCLABCKC.                                                       151030
      /                                                                          151030
       PROCEDURE DIVISION           USING ZSCLABCK-REC.                          151030
                                                                                 151030
      *****************************************************************          151030
      *      CALL ALL THE SECTIONS                                               151030
      *****************************************************************          151030
       0000-SUBROUTINE-MAIN SECTION.                                             151030
      ******************************                                             151030
       0000-START.                                                               151030
                                                                                 151030
           PERFORM 1000-INITIALISE                                               151030
           IF  MUST-EXIT-PGM                                                     151111
               GO TO 0000-EXIT                                                   151111
           END-IF                                                                151111
           PERFORM 2000-PROCESS                                                  151030
           IF  ZSCLABCK-STATUZ        NOT = O-K                                  151030
               GO TO 0000-EXIT                                                   151030
           END-IF                                                                151030
           PERFORM 3000-TERMINATION                                              151030
           .                                                                     151030
       0000-EXIT.                                                                151030
            EXIT PROGRAM.                                                        151030
      /                                                                          151030
       1000-INITIALISE SECTION.                                                  151110
      *************************                                                  151030
       1000-START.                                                               151030
                                                                                 151030
      * Initialize Variables                                                     151030
           INITIALIZE WSAA-VARIABLES                                             151030
           INITIALIZE WS88-CONTROL-FLAGS                                         151030
           INITIALIZE LIFA-LIFACMV-REC                                           151111
           MOVE O-K                    TO ZSCLABCK-STATUZ                        151030
           SET NOT-CLAWBACK-REGP       TO TRUE                                   151104
           SET CHECK-AGENT             TO TRUE                          <ATHA67> 160414
                                                                                 151103
           PERFORM 1300-READ-CHDRMJA                                             151104
           PERFORM 1400-READ-ZCHD                                                151104
           PERFORM 1500-READ-AGCMBCR                                             151104
                                                                                 151104
      ***  PERFORM 1600-VALIDATE-AGENT                                  <ATHA43> 160317
                                                                                 151110
           PERFORM X1800-RETRIEVE-ZCHA-AGNTNUM                                   151110
                                                                        <ATHA43> 160317
           PERFORM 1600-VALIDATE-AGENT                                  <ATHA43> 160317
                                                                                 151105
           PERFORM 1700-FIND-NEXT-ANNI                                           151105
           IF  MUST-EXIT-PGM                                            <ATHB37> 170208
               GO TO 1000-EXIT                                          <ATHB37> 170208
           END-IF                                                       <ATHB37> 170208
                                                                                 151104
           PERFORM 1100-OBTAIN-CLAWBACK-RULES                                    151103
           IF  MUST-EXIT-PGM                                                     151111
               GO TO 1000-EXIT                                                   151111
           END-IF                                                                151111
                                                                        <ATHB37> 170208
           MOVE CHDRMJA-OCCDATE        TO WSAA-FROM-DATE                         151109
           PERFORM X900-CLAWBACK-RULES-PERC                                      151108
           IF  WSAA-T8Z82               = ZEROS                                  151124
               SET NOT-CLAWBACK-REGP   TO TRUE                                   151124
           END-IF                                                                151124
           PERFORM 1200-READ-T5645                                               151112
                                                                        <ATHA43> 160225
           MOVE ZSCLABCK-PARTS-PERC   TO WSAA-PARTS-PERC                <ATHA43> 160225
           IF  WSAA-PARTS-PERC         = ZEROS                          <ATHA43> 160225
               MOVE 100               TO WSAA-PARTS-PERC                <ATHA43> 160225
           END-IF                                                       <ATHA43> 160225
           COMPUTE WSAA-PARTS-PERC-WRK ROUNDED                          <ATHA43> 160324
                                        = WSAA-PARTS-PERC               <ATHA43> 160324
                                        / 100                           <ATHA43> 160324
           .                                                                     151030
       1000-EXIT.                                                                151030
           EXIT.                                                                 151030
                                                                                 151103
       1100-OBTAIN-CLAWBACK-RULES  SECTION.                                      151103
      ***********************************                                        151103
       1100-START.                                                               151103
                                                                                 151103
                                                                                 151103
           MOVE SPACES                 TO ITDM-DATA-KEY                          151103
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                           151103
           MOVE T8Z82                  TO ITDM-ITEMTABL                          151103
      **   MOVE CHDRMJA-SRCEBUS        TO WSAA-ITEM-SRCEBUS                      151222
           MOVE CHDRMJA-CNTTYPE        TO WSAA-ITEM-CNTTYPE                      151222
                                                                                 151103
      **   IF  ZSCLABCK-CRTABLE     NOT = SPACES                        <ATHB37> 170214
      **       MOVE ZSCLABCK-CRTABLE   TO WSAA-ITEM-CRTABLE             <ATHB37> 170214
      **   ELSE                                                         <ATHB37> 170214
               MOVE '****'             TO WSAA-ITEM-CRTABLE                      151103
      **   END-IF                                                       <ATHB37> 170214
           MOVE WSAA-ITEMITEM          TO ITDM-ITEMITEM                          151103
           MOVE ZSCLABCK-EFFDATE       TO ITDM-ITMFRM                            151103
           MOVE ITDMREC                TO ITDM-FORMAT                            151103
           MOVE BEGN                   TO ITDM-FUNCTION                          151103
                                                                                 151103
           CALL 'ITDMIO'            USING ITDM-PARAMS                            151103
                                                                                 151103
           IF  ITDM-STATUZ           NOT = O-K                                   151103
           AND ITDM-STATUZ           NOT = ENDP                                  151103
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                            151103
               MOVE ITDM-STATUZ        TO SYSR-STATUZ                            151103
               PERFORM 9000-FATAL-ERROR                                          151103
           END-IF                                                                151103
                                                                                 151103
           IF  ITDM-ITEMCOY         NOT = ZSCLABCK-CHDRCOY                       151103
           OR  ITDM-ITEMTABL        NOT = T8Z82                                  151103
           OR  ITDM-ITEMITEM        NOT = WSAA-ITEMITEM                          151103
           OR  ITDM-STATUZ              = ENDP                                   151103
               MOVE 'Y'                TO WS88-MUST-EXIT-PGM                     151111
               GO TO 1100-EXIT                                                   151111
           ELSE                                                                  151103
               MOVE ITDM-GENAREA       TO T8Z82-T8Z82-REC                        151103
           END-IF                                                                151103
                                                                                 151103
           .                                                                     151103
       1100-EXIT.                                                                151103
           EXIT.                                                                 151103
      /                                                                          151112
       1200-READ-T5645  SECTION.                                                 151112
      **************************                                                 151112
       1200-START.                                                               151112
      *                                                                          151112
      *  Read Additional Commission Accounting Rules                             151112
      *                                                                          151112
           INITIALIZE ITEMREC-KEY-DATA     OF ITEM-PARAMS                        151112
           INITIALIZE ITEMREC-NON-KEY-DATA OF ITEM-PARAMS                        151112
           MOVE 'IT'                   TO ITEM-ITEMPFX                           151112
           MOVE ZSCLABCK-CHDRCOY       TO ITEM-ITEMCOY                           151112
           MOVE T5645                  TO ITEM-ITEMTABL                          151112
           MOVE 'ZSCLAWBA'             TO ITEM-ITEMITEM                          151113
           MOVE BEGN                   TO ITEM-FUNCTION                          151113
                                                                                 151112
           MOVE 1                      TO WSAA-T5645-SUB                         151113
           MOVE 1                      TO WSAA-T5645-OFFSET             <ATHB37> 170302
      ***  PERFORM X100-ITEM-IO                                                  151113
                                                                                 151112
           MOVE ITEM-GENAREA           TO T5645-T5645-REC                        151112
           PERFORM 1250-LOAD-T5645  UNTIL ITEM-STATUZ                            151113
                                       = ENDP                                    151113
           .                                                                     151112
       1200-EXIT.                                                                151112
            EXIT.                                                                151112
      /                                                                          151113
       1250-LOAD-T5645 SECTION.                                                  151113
      ************************                                                   151113
       1250-START.                                                               151113
                                                                                 151113
           CALL 'ITEMIO'            USING ITEM-PARAMS                            151113
                                                                                 151113
           IF  ZSCLABCK-CHDRCOY     NOT = ITEM-ITEMCOY                           151113
           OR  ITEM-ITEMTABL        NOT = T5645                                  151113
           OR  ITEM-ITEMITEM        NOT = 'ZSCLAWBA'                             151113
           OR  ITEM-STATUZ          NOT = O-K                                    151113
               IF  ITEM-FUNCTION        = BEGN                                   151113
                   MOVE ITEM-PARAMS    TO SYSR-PARAMS                            151113
                   PERFORM 9000-FATAL-ERROR                                      151113
              ELSE                                                               151113
                   MOVE ENDP              TO ITEM-STATUZ                         151113
                   GO TO 1250-EXIT                                               151113
               END-IF                                                            151113
           END-IF                                                                151113
                                                                                 151113
           MOVE ITEM-GENAREA            TO T5645-T5645-REC                       151113
                                                                                 151113
           MOVE 1                       TO WSAA-T5645-SUB                        151113
                                                                                 151113
           IF  WSAA-T5645-SUB           > WSAA-T5645-SIZE                        151113
               MOVE H791               TO SYSR-STATUZ                            151113
               MOVE T5645              TO SYSR-PARAMS                            151113
               PERFORM 9000-FATAL-ERROR                                          151113
           END-IF                                                                151113
                                                                                 151113
           PERFORM UNTIL WSAA-T5645-SUB > 15                                     151113
                                                                                 151113
              MOVE T5645-CNTTOT(WSAA-T5645-SUB)                                  151113
                                       TO WSAA-T5645-CNTTOT                      151113
                                          (WSAA-T5645-OFFSET)                    151113
              MOVE T5645-GLMAP(WSAA-T5645-SUB)                                   151113
                                       TO WSAA-T5645-GLMAP                       151113
                                          (WSAA-T5645-OFFSET)                    151113
              MOVE T5645-SACSCODE(WSAA-T5645-SUB)                                151113
                                       TO WSAA-T5645-SACSCODE                    151113
                                          (WSAA-T5645-OFFSET)                    151113
              MOVE T5645-SACSTYPE(WSAA-T5645-SUB)                                151113
                                       TO WSAA-T5645-SACSTYPE                    151113
                                          (WSAA-T5645-OFFSET)                    151113
              MOVE T5645-SIGN(WSAA-T5645-SUB)                                    151113
                                       TO WSAA-T5645-SIGN                        151113
                                          (WSAA-T5645-OFFSET)                    151113
                                                                                 151113
              ADD 1                    TO WSAA-T5645-SUB                         151113
              ADD 1                    TO WSAA-T5645-OFFSET                      151113
                                                                                 151113
           END-PERFORM                                                           151113
                                                                                 151113
           MOVE NEXTR                  TO ITEM-FUNCTION                          151113
           .                                                                     151113
       1250-EXIT.                                                                151113
           EXIT.                                                                 151113
      /                                                                          151103
       1300-READ-CHDRMJA  SECTION.                                               151103
      ***********************************                                        151103
       1300-START.                                                               151103
                                                                                 151103
           INITIALIZE CHDRMJAREC-KEY-DATA     OF CHDRMJA-PARAMS                  151103
           INITIALIZE CHDRMJAREC-NON-KEY-DATA OF CHDRMJA-PARAMS                  151103
                                                                                 151103
           MOVE ZSCLABCK-CHDRCOY       TO CHDRMJA-CHDRCOY                        151103
           MOVE ZSCLABCK-CHDRNUM       TO CHDRMJA-CHDRNUM                        151103
           MOVE READR                  TO CHDRMJA-FUNCTION                       151103
                                                                                 151103
           PERFORM X500-CHDRMJA-IO                                               151104
           MOVE CHDRMJA-OCCDATE        TO WSAA-OCCDATE                           151123
                                                                                 151104
           .                                                                     151103
       1300-EXIT.                                                                151103
           EXIT.                                                                 151103
      /                                                                          151104
       1400-READ-ZCHD  SECTION.                                                  151104
      ***********************************                                        151104
       1400-START.                                                               151104
                                                                                 151104
           INITIALIZE ZCHDREC-KEY-DATA     OF ZCHD-PARAMS                        151104
           INITIALIZE ZCHDREC-NON-KEY-DATA OF ZCHD-PARAMS                        151104
                                                                                 151104
           MOVE ZSCLABCK-CHDRCOY       TO ZCHD-CHDRCOY                           151104
           MOVE ZSCLABCK-CHDRNUM       TO ZCHD-CHDRNUM                           151104
           MOVE READR                  TO ZCHD-FUNCTION                          151104
                                                                                 151104
           PERFORM X400-ZCHD-IO                                                  151104
                                                                                 151104
           .                                                                     151104
       1400-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151104
       1500-READ-AGCMBCR SECTION.                                                151104
      ****************************                                               151104
       1500-START.                                                               151104
                                                                                 151104
           INITIALIZE AGCMBCRREC-KEY-DATA     OF AGCMBCR-PARAMS                  151104
           INITIALIZE AGCMBCRREC-NON-KEY-DATA OF AGCMBCR-PARAMS                  151104
                                                                                 151104
           MOVE ZSCLABCK-CHDRCOY       TO AGCMBCR-CHDRCOY                        151104
           MOVE ZSCLABCK-CHDRNUM       TO AGCMBCR-CHDRNUM                        151104
           MOVE WSCC-01                TO AGCMBCR-LIFE                           151104
           MOVE WSCC-01                TO AGCMBCR-COVERAGE                       151104
           MOVE WSCC-00                TO AGCMBCR-RIDER                          151104
           MOVE WSCC-MAX-TRANNO        TO AGCMBCR-TRANNO                         151104
           MOVE BEGN                   TO AGCMBCR-FUNCTION                       151104
                                                                                 151104
           PERFORM X300-AGCMBCR-IO                                               151104
           .                                                                     151104
       1500-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151104
       1600-VALIDATE-AGENT SECTION.                                              151104
      ****************************                                               151104
       1600-START.                                                               151104
                                                                                 151104
           MOVE ZCHD-AGNTNUM       TO WSAA-AGNTNUM-INIT                          151123
           MOVE ZCHD-AGNTNUM       TO WSAA-AGNTNUM                               151123
           PERFORM X600-READ-AGNT                                       <ATHA43> 160317
           MOVE AGNT-CLNTNUM       TO WSAA-ZCHD-CLNTNUM                 <ATHA43> 160317
           IF  ZCHD-AGNTNUM         NOT = AGCMBCR-AGNTNUM                        151104
      ***      PERFORM X600-READ-AGNT                                   <ATHA43> 160317
      ***      MOVE AGNT-CLNTNUM       TO WSAA-ZCHD-CLNTNUM             <ATHA43> 160317
               MOVE AGCMBCR-AGNTNUM    TO WSAA-AGNTNUM                           151123
               PERFORM X600-READ-AGNT                                            151104
               MOVE AGNT-CLNTNUM       TO WSAA-AGCM-CLNTNUM                      151104
               IF  WSAA-ZCHD-CLNTNUM    = WSAA-AGCM-CLNTNUM                      151104
                   SET CLAWBACK-REGP   TO TRUE                                   151104
               END-IF                                                            151104
           ELSE                                                                  151104
               SET CLAWBACK-REGP       TO TRUE                                   151104
           END-IF                                                                151104
                                                                        <ATHA43> 160317
           IF  CLAWBACK-REGP                                            <ATHA43> 160317
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHA43> 160317
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHA43> 160317
               END-IF                                                   <ATHA43> 160317
           END-IF                                                       <ATHA43> 160317
           .                                                                     151104
       1600-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151105
       1700-FIND-NEXT-ANNI SECTION.                                              151105
      ****************************                                               151105
       1700-START.                                                               151105
                                                                        <ATHB37> 170208
            IF ZSCLABCK-FUNCTION        = WSCC-DECRP                    <ATHB37> 170208
               PERFORM X3500-FIND-ANNIVERSARY                           <ATHB37> 170208
            ELSE                                                        <ATHB37> 170208
                                                                        <ATHB37> 170208
            INITIALIZE DTC4-DATCON4-REC                                          151105
            MOVE CHDRMJA-OCCDATE       TO DTC4-INT-DATE-1                        151105
            MOVE WSCC-01               TO DTC4-FREQUENCY                         151105
            MOVE 1                     TO DTC4-FREQ-FACTOR                       151105
                                                                                 151105
            CALL 'DATCON4'          USING DTC4-DATCON4-REC                       151105
                                                                                 151105
            IF  DTC4-STATUZ         NOT = O-K                                    151105
                MOVE DTC4-DATCON4-REC                                            151105
                                       TO SYSR-PARAMS                            151105
                MOVE DTC4-STATUZ       TO SYSR-STATUZ                            151105
                PERFORM 9000-FATAL-ERROR                                         151105
            END-IF                                                               151105
            MOVE DTC4-INT-DATE-2       TO WSAA-NEXT-ANNI-DATE                    151105
            END-IF                                                      <ATHB37> 170208
           .                                                                     151105
       1700-EXIT.                                                                151105
           EXIT.                                                                 151105
      /                                                                          151030
       2000-PROCESS SECTION.                                                     151030
      **********************                                                     151030
       2000-START.                                                               151030
           SET NOT-CLAWBACK-COVER      TO TRUE                          <ATHD11> 181018
                                                                                 151030
           EVALUATE ZSCLABCK-FUNCTION                                            151030
      * FULL SURRENDER REGULAR AND TOP UP                                        151111
           WHEN WSCC-SURFS                                                       151111
                PERFORM 2200-SURFS-CLAWBACK                                      151111
      * FULL SURRENDER REGULAR ONLY                                              151111
           WHEN WSCC-SURRF                                                       151111
      ****     IF  CLAWBACK-REGP                                        <ATHD11> 181012
      ****         PERFORM 2250-READ-ACMV                               <ATHD11> 181012
      ****     END-IF                                                   <ATHD11> 181012
                                                                        <ATHD11> 181012
               PERFORM 2900-SURRF-CLAWBACK                              <ATHD11> 181012
      *                                                                 <ATHD94> 190627
      *        Lapse for term TT05, TT06.                               <ATHD94> 190628
      *                                                                 <ATHD94> 190627
           WHEN WSCC-SURRT                                              <ATHD94> 190627
               PERFORM 3100-SURRT-CLAWBACK                              <ATHD94> 190627
                                                                        <ATHD94> 190627
      * FULL SURRENDER TOP UP ONLY                                               151111
           WHEN WSCC-SURTF                                                       151111
                PERFORM X4400-GET-TU-COVR                               <ATHB45> 170313
                IF  WSAA-TU-CRTABLE NOT = SPACES                        <ATHB45> 170313
                    PERFORM X4800-READ-ZCOVCRT                          <ATHB45> 170313
                END-IF                                                  <ATHB45> 170313
                PERFORM 2270-READ-ZTUD-TOPUP                            <ATHB45> 170313
                PERFORM 2280-READ-ZTUD-ARRAY                                     151111
      ***       PERFORM 2290-WRITE-LIFA-TOPUP                           <ATHA67> 160407
      * CFI MCPPI                                                       <ATHA67> 160408
           WHEN WSCC-SURCF                                                       151116
                PERFORM 2400-SURCF-CLAWBACK                                      151116
      * PART SURRENDER MCPPI                                            <ATHA67> 160407
           WHEN WSCC-SURPS                                              <ATHA43> 160205
                PERFORM 2300-SURP-CLAWBACK                                       151111
      * PART SURRENDER PER COVER (ULTIMA)                               <ATHD11> 181016
           WHEN WSCC-SURPC                                              <ATHD11> 181016
                PERFORM 2950-SURPC-CLAWBACK                             <ATHD11> 181016
      * SINGLE PREMIUM                                                  <ATHA67> 160408
           WHEN WSCC-SURSP                                                       151122
                PERFORM 2500-SURSP-CLAWBACK                                      151122
      * SINGLE PREMIUM MCPPI (SURRENDER)                                <ATHA67> 160413
           WHEN WSCC-SURGG                                              <ATHA67> 160407
           WHEN WSCC-SURGP                                              <ATHC41> 180308
                PERFORM 2600-SURGG-CLAWBACK                             <ATHA67> 160407
      * SINGLE PREMIUM MCPPI (CFI)                                      <ATHA67> 160413
           WHEN WSCC-CFIGG                                              <ATHA67> 160413
                PERFORM 2700-CFIGG-CLAWBACK                             <ATHA67> 160413
      * DECREASE PREMIUM CLAWBACK FOR REGULAR PREM ONLY                 <ATHB37> 170208
           WHEN WSCC-DECRP                                              <ATHB37> 170208
                PERFORM 2800-DECRESE-PREM-CLAWBACK                      <ATHB37> 170208
           WHEN OTHER                                                            151030
                MOVE BOMB              TO ZSCLABCK-STATUZ                        151030
           END-EVALUATE                                                          151030
                                                                                 151111
           IF  ZSCLABCK-STATUZ        NOT = O-K                                  151030
               GO TO 2000-EXIT                                                   151030
           END-IF                                                                151030
           .                                                                     151030
       2000-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                          151030
       2200-SURFS-CLAWBACK SECTION.                                              151111
      ****************************                                               151030
       2200-START.                                                               151030
           IF  CLAWBACK-REGP                                            <ATHA67> 160408
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHA67> 160408
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHA67> 160408
               END-IF                                                   <ATHA67> 160408
           END-IF                                                       <ATHA67> 160408
                                                                                 151104
      * FOR REGULAR PREMIUM                                                      151109
           IF  CLAWBACK-REGP                                                     151104
               PERFORM 2250-READ-ACMV                                            151104
           END-IF                                                                151104
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHA43> 160323
                                                                                 151103
      * FOR TOP UP                                                               151030
           PERFORM X4400-GET-TU-COVR                                    <ATHB45> 170313
           IF  WSAA-TU-CRTABLE NOT = SPACES                             <ATHB45> 170313
               PERFORM X4800-READ-ZCOVCRT                               <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           PERFORM 2270-READ-ZTUD-TOPUP                                          151030
           PERFORM 2280-READ-ZTUD-ARRAY                                          151110
           PERFORM 2290-WRITE-LIFA-TOPUP                                         151214
           .                                                                     151030
       2200-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                          151030
       2250-READ-ACMV  SECTION.                                                  151030
      *********************************                                          151030
       2250-START.                                                               151030
                                                                                 151030
           INITIALIZE WSAA-ACMV-ARRAY                                   <ATHA67> 160513
           MOVE ZEROS                  TO WSAA-LAST-TRANNO                       151216
           MOVE ZEROS                  TO WSAA-ACMV-ARRAY-CNT           <ATHA67> 160513
           MOVE ZEROS                  TO WSAA-LAST-TRANNO-W                     151216
           MOVE ZSCLABCK-CHDRNUM        TO WSAA-ACMV-CHDRNUM                     151109
           MOVE '01'                   TO WSAA-ACMV-LIFE                         151030
           MOVE '01'                   TO WSAA-ACMV-COVERAGE                     151030
           MOVE '00'                   TO WSAA-ACMV-RIDER                        151030
           MOVE '00'                   TO WSAA-ACMV-PLAN-SUFF                    151030
                                                                        <ATHA67> 160513
           INITIALIZE ACMVBK3-PARAMS                                             151030
           INITIALIZE ACMVBK3REC-KEY-DATA     OF ACMVBK3-PARAMS                  151030
           INITIALIZE ACMVBK3REC-NON-KEY-DATA OF ACMVBK3-PARAMS                  151030
           MOVE ZSCLABCK-CHDRCOY       TO ACMVBK3-RLDGCOY                        151109
           MOVE WSAA-ACMV-RLDGACCT     TO ACMVBK3-RLDGACCT                       151030
           MOVE WSCC-LE                TO ACMVBK3-SACSCODE                       151030
           MOVE WSCC-YC                TO ACMVBK3-SACSTYP                        151106
           MOVE BEGN                   TO ACMVBK3-FUNCTION                       151030
           PERFORM X1100-ACMVBK3-IO                                              151030
           PERFORM                                                               151030
             UNTIL ACMVBK3-STATUZ       = ENDP                                   151030
                                                                                 151030
                MOVE 'B522'            TO WSAA-BATCTRCDE                         151114
                PERFORM X2200-READ-PTRNREV                                       151114
                                                                                 151114
                IF  VALID-RECORD                                                 151114
                IF  ACMVBK3-EFFDATE    >= WSAA-OCCDATE                           151104
                AND ACMVBK3-EFFDATE    <  WSAA-NEXT-ANNI-DATE                    151104
                                                                        <ATHA67> 160513
                    PERFORM 2250A-LOAD-ARRAY-ACMV                       <ATHA67> 160513
                                                                        <ATHA67> 160513
                    MOVE ACMVBK3-TRANREF(1:8)                           <ATHA67> 160513
                                        TO WSAA-ACMV-AGNTNUM            <ATHA67> 160513
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHA67> 160513
                    ADD ACMVBK3-ORIGAMT TO WSAA-ACMV-ZPREMAMT           <ATHA67> 160513
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHA67> 160513
                                                                        <ATHA67> 160513
                    COMPUTE WSAA-PAID-PREM                                       151104
                                        = WSAA-PAID-PREM                         151104
                                        + ACMVBK3-ORIGAMT                        151030
                    IF  ACMVBK3-TRANNO NOT = WSAA-LAST-TRANNO                    151216
                    PERFORM  2255-FIND-COMMISSIONS                               151106
                    END-IF                                                       151216
                    MOVE ACMVBK3-TRANNO TO WSAA-LAST-TRANNO                      151216
                END-IF                                                           151030
                END-IF                                                           151114
                                                                                 151114
      **        MOVE 'T512'            TO WSAA-BATCTRCDE                <ATHA67> 160404
      **        PERFORM X2200-READ-PTRNREV                              <ATHA67> 160404
      **        IF  VALID-RECORD                                        <ATHA67> 160404
      **                                                                <ATHA67> 160404
      **            COMPUTE WSAA-PAID-PREM                              <ATHA67> 160404
      **                                = WSAA-PAID-PREM                <ATHA67> 160404
      **                                + ACMVBK3-ORIGAMT               <ATHA67> 160404
      **            IF  ACMVBK3-TRANNO NOT = WSAA-LAST-TRANNO-W         <ATHA67> 160404
      **            PERFORM  2255-FIND-COMMISSIONS                      <ATHA67> 160404
      **            END-IF                                              <ATHA67> 160404
      **            MOVE ACMVBK3-TRANNO TO WSAA-LAST-TRANNO-W           <ATHA67> 160404
      **        END-IF                                                  <ATHA67> 160404
                                                                                 151114
                MOVE NEXTR             TO ACMVBK3-FUNCTION                       151030
                PERFORM X1100-ACMVBK3-IO                                         151030
           END-PERFORM                                                           151030
                                                                                 151105
           IF ZSCLABCK-FUNCTION         = WSCC-SURCF                    <ATHA67> 160513
              PERFORM 2250C-CFI-CLAWBACK                                <ATHA67> 160513
           ELSE                                                         <ATHA67> 160513
              PERFORM 2250B-REGP-CLAWBACK                               <ATHA67> 160513
           END-IF                                                       <ATHA67> 160513
           .                                                                     151030
       2250-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                 <ATHA67> 160513
       2250A-LOAD-ARRAY-ACMV SECTION.                                   <ATHA67> 160513
      *********************************                                 <ATHA67> 160513
       2250A-START.                                                     <ATHA67> 160513
                                                                        <ATHA67> 160513
           SET  NOT-ARRAY-ACMV-FOUND   TO TRUE                          <ATHA67> 160513
                                                                        <ATHA67> 160513
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                        <ATHA67> 160513
             UNTIL WSAA-IND1            > WSCC-MAX-ARRAY                <ATHA67> 160513
             OR    WSAA-ACMV-AGNTNUM (WSAA-IND1)                        <ATHA67> 160513
                                        = SPACES                        <ATHA67> 160513
             OR    ARRAY-ACMV-FOUND                                     <ATHA67> 160513
               IF  ACMVBK3-TRANREF(1:8)                                 <ATHA67> 160513
                                        = WSAA-ACMV-AGNTNUM(WSAA-IND1)  <ATHA67> 160513
                   SET ARRAY-ACMV-FOUND                                 <ATHA67> 160513
                                       TO TRUE                          <ATHA67> 160513
                   MOVE WSAA-IND1      TO WSAA-ACMV-ARRAY-CNT           <ATHA67> 160513
               END-IF                                                   <ATHA67> 160513
               MOVE WSAA-IND1          TO WSAA-ACMV-ARRAY-CNT           <ATHA67> 160513
           END-PERFORM                                                  <ATHA67> 160513
                                                                        <ATHA67> 160513
           IF  ARRAY-ACMV-FOUND                                         <ATHA67> 160513
               GO TO 2250A-EXIT                                         <ATHA67> 160513
           END-IF                                                       <ATHA67> 160513
                                                                        <ATHA67> 160513
           ADD WSCC-NUM-1              TO WSAA-ACMV-ARRAY-CNT           <ATHA67> 160513
           .                                                            <ATHA67> 160513
       2250A-EXIT.                                                      <ATHA67> 160513
           EXIT.                                                        <ATHA67> 160513
      /                                                                 <ATHA67> 160513
       2250B-REGP-CLAWBACK SECTION.                                     <ATHA67> 160513
      *********************************                                 <ATHA67> 160513
       2250B-START.                                                     <ATHA67> 160513
           COMPUTE WSAA-PAID-PREM-CLAWB ROUNDED                         <ATHA67> 160513
                                        = (WSAA-PAID-PREM               <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        *  WSAA-PARTS-PERC-WRK          <ATHA67> 160513
           COMPUTE WSAA-PAID-COMM-CLAWB ROUNDED                         <ATHA67> 160513
                                        = (WSAA-PAID-COMM               <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160513
                                                                        <ATHA67> 160513
           COMPUTE WSAA-PAID-OVRCOM-CLAWB ROUNDED                       <ATHA67> 160513
                                        = (WSAA-PAID-OVRCOM             <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160513
                                                                        <ATHA67> 160513
     ***   MOVE 'MCP2'                 TO WSAA-CRTABLE          <ATHB87><ATHA67> 170824
                                                                        <ATHA67> 160513
           MOVE '01'                   TO WSAA-ZCLB-LIFE                <ATHA67> 160513
           MOVE '01'                   TO WSAA-ZCLB-COVERAGE            <ATHA67> 160513
           MOVE '00'                   TO WSAA-ZCLB-RIDER               <ATHA67> 160513
           MOVE '00'                   TO WSAA-ZCLB-RECODE              <ATHA67> 160513
           PERFORM X5000-FIND-MAIN-COVR                                 <ATHB87> 170824
                                                                        <ATHB87> 170824
           PERFORM X3000-READ-ZCLBCOV                                   <ATHA67> 160513
           PERFORM X3100-FIND-CLAWB-REMN-REGP                           <ATHA67> 160513
                                                                        <ATHA67> 160513
           PERFORM X1900-WRITE-ZCLB                                     <ATHA67> 160513
                                                                        <ATHA67> 160513
           PERFORM X1400-WRITE-LIFA-REGP                                <ATHA67> 160513
           PERFORM X2000-DUE-ACCOUNTINGS                                <ATHA67> 160513
           PERFORM X2100-COLL-ACCOUNTINGS                               <ATHA67> 160513
           .                                                            <ATHA67> 160513
       2250B-EXIT.                                                      <ATHA67> 160513
           EXIT.                                                        <ATHA67> 160513
      /                                                                 <ATHA67> 160513
       2250C-CFI-CLAWBACK SECTION.                                      <ATHA67> 160513
      *********************************                                 <ATHA67> 160513
       2250C-START.                                                     <ATHA67> 160513
             PERFORM VARYING WSAA-IND1 FROM 1 BY 1                      <ATHA67> 160513
               UNTIL WSAA-IND1          > WSAA-ACMV-ARRAY-CNT           <ATHA67> 160513
                                                                        <ATHA67> 160513
               MOVE WSAA-ACMV-ZPREMAMT(WSAA-IND1)                       <ATHA67> 160513
                                       TO WSAA-PAID-PREM                <ATHA67> 160513
               MOVE WSAA-ACMV-ZCOMMAMT(WSAA-IND1)                       <ATHA67> 160513
                                       TO WSAA-PAID-COMM                <ATHA67> 160513
               MOVE WSAA-ACMV-OVRAMT  (WSAA-IND1)                       <ATHA67> 160513
                                       TO WSAA-PAID-OVRCOM              <ATHA67> 160513
               MOVE WSAA-ACMV-AGNTNUM (WSAA-IND1)                       <ATHA67> 160513
                                       TO WSAA-AGNTNUM                  <ATHA67> 160513
               COMPUTE WSAA-PAID-PREM-CLAWB ROUNDED                     <ATHA67> 160513
                                        = (WSAA-PAID-PREM               <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        *  WSAA-PARTS-PERC-WRK          <ATHA67> 160513
               COMPUTE WSAA-PAID-COMM-CLAWB ROUNDED                     <ATHA67> 160513
                                        = (WSAA-PAID-COMM               <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160513
                                                                        <ATHA67> 160513
               COMPUTE WSAA-PAID-OVRCOM-CLAWB ROUNDED                   <ATHA67> 160513
                                        = (WSAA-PAID-OVRCOM             <ATHA67> 160513
                                        * WSAA-T8Z82)                   <ATHA67> 160513
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160513
                                                                        <ATHA67> 160513
     ****      MOVE 'MCP2'             TO WSAA-CRTABLE          <ATHB87><ATHA67> 170824
                                                                        <ATHA67> 160513
               MOVE '01'                   TO WSAA-ZCLB-LIFE            <ATHA67> 160513
               MOVE '01'                   TO WSAA-ZCLB-COVERAGE        <ATHA67> 160513
               MOVE '00'                   TO WSAA-ZCLB-RIDER           <ATHA67> 160513
               MOVE '00'                   TO WSAA-ZCLB-RECODE          <ATHA67> 160513
               PERFORM X5000-FIND-MAIN-COVR                             <ATHB87> 170824
                                                                        <ATHB87> 170824
               PERFORM X3000-READ-ZCLBCOV                               <ATHA67> 160513
               PERFORM X3100-FIND-CLAWB-REMN-REGP                       <ATHA67> 160513
                                                                        <ATHA67> 160513
               PERFORM X1900-WRITE-ZCLB                                 <ATHA67> 160513
                                                                        <ATHA67> 160513
               PERFORM X1400-WRITE-LIFA-REGP                            <ATHA67> 160513
               PERFORM X2000-DUE-ACCOUNTINGS                            <ATHA67> 160513
               PERFORM X2100-COLL-ACCOUNTINGS                           <ATHA67> 160513
           END-PERFORM                                                  <ATHA67> 160513
           .                                                            <ATHA67> 160513
       2250C-EXIT.                                                      <ATHA67> 160513
           EXIT.                                                        <ATHA67> 160513
      /                                                                          151106
       2255-FIND-COMMISSIONS SECTION.                                            151106
      *********************************                                          151106
       2255-START.                                                               151106
           SET NOT-FIND-COMM           TO TRUE                                   151109
           MOVE SPACES                 TO WSAA-LAST-RLDGACCT                     151216
           MOVE SPACES                 TO WSAA-USED-RLDGACCT                     151216
           INITIALIZE ACMVREV-PARAMS                                             151106
           INITIALIZE ACMVREVREC-KEY-DATA     OF ACMVREV-PARAMS                  151106
           INITIALIZE ACMVREVREC-NON-KEY-DATA OF ACMVREV-PARAMS                  151106
                                                                                 151106
           MOVE ACMVBK3-RLDGCOY        TO ACMVREV-RLDGCOY                        151109
           MOVE ACMVBK3-RDOCNUM        TO ACMVREV-RDOCNUM                        151109
           MOVE ACMVBK3-TRANNO         TO ACMVREV-TRANNO                         151106
                                                                                 151106
           MOVE BEGN                   TO ACMVREV-FUNCTION                       151106
           PERFORM X800-ACMVREV-IO                                               151106
                                                                                 151106
           IF  ACMVREV-STATUZ           = ENDP                                   151106
               GO TO 2255-EXIT                                                   151118
           END-IF                                                                151106
                                                                                 151106
           PERFORM                                                               151106
             UNTIL ACMVREV-STATUZ       = ENDP                                   151106
      **     OR FIND-COMM                                               <ATHA67> 160513
                                                                                 151106
                IF  ACMVREV-SACSCODE    = WSCC-LE                                151216
                AND ACMVREV-SACSTYP     = WSCC-OC                                151216
                    MOVE ACMVREV-RLDGACCT                                        151216
                                       TO WSAA-LAST-RLDGACCT                     151216
                END-IF                                                           151216
                                                                                 151216
                IF  ACMVREV-SACSCODE    = WSCC-LE                                151215
                AND ACMVREV-SACSTYP     = WSCC-OC                                151215
                AND ACMVREV-RLDGACCT    = ACMVBK3-RLDGACCT                       151215
                    COMPUTE WSAA-PAID-OVRCOM = ACMVREV-ORIGAMT                   151215
                                           + WSAA-PAID-OVRCOM                    151215
                                                                        <ATHA67> 160513
                    ADD ACMVREV-ORIGAMT TO WSAA-ACMV-OVRAMT             <ATHA67> 160513
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHA67> 160513
                    MOVE ACMVREV-RLDGACCT TO WSAA-USED-RLDGACCT                  151216
                END-IF                                                           151215
                                                                                 151216
                IF  ACMVREV-SACSCODE    = WSCC-LA                                151106
                AND ACMVREV-SACSTYP     = WSCC-CP                                151106
                AND WSAA-USED-RLDGACCT  = WSAA-LAST-RLDGACCT                     151216
                    MOVE ACMVREV-RLDGACCT TO WSAA-AGNTNUM                        151123
                    COMPUTE WSAA-PAID-COMM = ACMVREV-ORIGAMT                     151106
                                           + WSAA-PAID-COMM                      151106
                                                                        <ATHA67> 160513
                    ADD ACMVREV-ORIGAMT TO WSAA-ACMV-ZCOMMAMT           <ATHA67> 160513
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHA67> 160513
                END-IF                                                           151106
                                                                                 151106
      *         IF  ACMVREV-RLDGACCT    = ACMVBK3-RLDGACCT                       151216
      *         AND ACMVREV-SACSTYP     = ACMVBK3-SACSTYP                        151216
      *         AND ACMVREV-SACSCODE    = ACMVBK3-SACSCODE                       151216
      *         AND ACMVREV-ORIGAMT     = ACMVBK3-ORIGAMT                        151216
      *             SET FIND-COMM       TO TRUE                                  151216
      *        END-IF                                                            151216
                                                                                 151106
                                                                                 151106
             MOVE NEXTR                  TO ACMVREV-FUNCTION                     151106
             PERFORM X800-ACMVREV-IO                                             151106
           END-PERFORM                                                           151106
           .                                                                     151106
       2255-EXIT.                                                                151106
           EXIT.                                                                 151106
      /                                                                 <ATHA43> 160322
       2257-READ-ZTUD-REGP   SECTION.                                   <ATHA43> 160322
      *********************************                                 <ATHA43> 160322
       2257-START.                                                      <ATHA43> 160322
                                                                        <ATHA43> 160322
           INITIALIZE ZTUD-PARAMS                                       <ATHA43> 160322
           INITIALIZE ZTUDREC-KEY-DATA     OF ZTUD-PARAMS               <ATHA43> 160322
           INITIALIZE ZTUDREC-NON-KEY-DATA OF ZTUD-PARAMS               <ATHA43> 160322
           MOVE O-K                    TO ZTUD-STATUZ                   <ATHA43> 160322
           MOVE ZSCLABCK-CHDRCOY       TO ZTUD-CHDRCOY                  <ATHA43> 160322
           MOVE ZSCLABCK-CHDRNUM       TO ZTUD-CHDRNUM                  <ATHA43> 160322
           MOVE BEGN                   TO ZTUD-FUNCTION                 <ATHA43> 160322
           MOVE ZTUDREC                TO ZTUD-FORMAT                   <ATHA43> 160322
                                                                        <ATHA43> 160322
           MOVE ZEROS                  TO WSAA-ZTUD-ARRAY-CNT           <ATHA43> 160322
           INITIALIZE WSAA-ZTUD-ARRAY                                   <ATHA43> 160322
           PERFORM X200-ZTUD-IO                                         <ATHA43> 160322
           PERFORM                                                      <ATHA43> 160322
              UNTIL ZTUD-STATUZ         = ENDP                          <ATHA43> 160322
                                                                        <ATHA43> 160322
                 IF  ZTUD-RECODE     = '00'                             <ATHA43> 160322
                 AND ZTUD-TRANS-CODE                                    <ATHA43> 160322
                                    NOT = 'REE1'                        <ATHA43> 160322
                     PERFORM 2257A-LOAD-ARRAY-REGP                      <ATHA43> 160323
                 END-IF                                                 <ATHA43> 160322
                                                                        <ATHA43> 160322
              MOVE NEXTR               TO ZTUD-FUNCTION                 <ATHA43> 160322
              PERFORM X200-ZTUD-IO                                      <ATHA43> 160322
           END-PERFORM                                                  <ATHA43> 160322
                                                                        <ATHA43> 160323
           PERFORM 2257B-READ-ZTUD-ARRAY                                <ATHA43> 160323
                                                                        <ATHA43> 160322
           .                                                            <ATHA43> 160322
       2257-EXIT.                                                       <ATHA43> 160322
           EXIT.                                                        <ATHA43> 160322
      /                                                                 <ATHA43> 160322
       2257A-LOAD-ARRAY-REGP SECTION.                                   <ATHA43> 160322
      *********************************                                 <ATHA43> 160322
       2257A-START.                                                     <ATHA43> 160322
                                                                        <ATHA43> 160322
           SET  NOT-ARRAY-CRTABLE-FOUND                                 <ATHA43> 160322
                                       TO TRUE                          <ATHA43> 160322
                                                                        <ATHA43> 160322
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                        <ATHA43> 160322
             UNTIL WSAA-IND1            > WSCC-MAX-ARRAY                <ATHA43> 160322
             OR    WSAA-ZTUD-RECODE  (WSAA-IND1)                        <ATHA43> 160322
                                        = SPACES                        <ATHA43> 160322
             OR    ARRAY-CRTABLE-FOUND                                  <ATHA43> 160322
               IF  ZTUD-RECODE                                          <ATHA43> 160322
                                        = WSAA-ZTUD-RECODE (WSAA-IND1)  <ATHA43> 160322
                   SET ARRAY-CRTABLE-FOUND                              <ATHA43> 160322
                                       TO TRUE                          <ATHA43> 160322
                   ADD ZTUD-ZPREMAMT   TO WSAA-ZTUD-ZPREMAMT            <ATHA43> 160322
                                          (WSAA-IND1)                   <ATHA43> 160322
                   ADD ZTUD-ZCOMMAMT   TO WSAA-ZTUD-ZCOMMAMT            <ATHA43> 160322
                                          (WSAA-IND1)                   <ATHA43> 160322
                   ADD ZTUD-NET        TO WSAA-ZTUD-NET                 <ATHA43> 160322
                                          (WSAA-IND1)                   <ATHA43> 160322
               END-IF                                                   <ATHA43> 160322
               MOVE WSAA-IND1          TO WSAA-ZTUD-ARRAY-CNT           <ATHA43> 160322
           END-PERFORM                                                  <ATHA43> 160322
                                                                        <ATHA43> 160322
           IF  ARRAY-CRTABLE-FOUND                                      <ATHA43> 160322
               GO TO 2257A-EXIT                                         <ATHA43> 160322
           END-IF                                                       <ATHA43> 160322
                                                                        <ATHA43> 160322
           ADD WSCC-NUM-1              TO WSAA-ZTUD-ARRAY-CNT           <ATHA43> 160322
           MOVE ZTUD-RECODE            TO WSAA-ZTUD-RECODE              <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-EFFDATE           TO WSAA-ZTUD-EFFDATE             <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZPREMAMT          TO WSAA-ZTUD-ZPREMAMT            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZCOMMAMT          TO WSAA-ZTUD-ZCOMMAMT            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-NET               TO WSAA-ZTUD-NET                 <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-JCOVCODE          TO WSAA-ZTUD-JCOVCODE            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-LIFENUM           TO WSAA-ZTUD-LIFENUM             <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-AGNTNUM           TO WSAA-ZTUD-AGNTNUM             <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZCLNTAGN          TO WSAA-ZTUD-ZCLNTAGN            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZCLNTUNI          TO WSAA-ZTUD-ZCLNTUNI            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZCLNTASS          TO WSAA-ZTUD-ZCLNTASS            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           MOVE ZTUD-ZCLNTAGY          TO WSAA-ZTUD-ZCLNTAGY            <ATHA43> 160322
                                          (WSAA-ZTUD-ARRAY-CNT)         <ATHA43> 160322
           .                                                            <ATHA43> 160322
       2257A-EXIT.                                                      <ATHA43> 160322
           EXIT.                                                        <ATHA43> 160322
      /                                                                 <ATHA43> 160322
       2257B-READ-ZTUD-ARRAY SECTION.                                   <ATHA43> 160322
      ****************************                                      <ATHA43> 160322
       2257B-START.                                                     <ATHA43> 160322
                                                                        <ATHA43> 160322
           MOVE ZEROS                  TO WSAA-PAID-PREM                <ATHA43> 160322
           MOVE ZEROS                  TO WSAA-PAID-COMM                <ATHA43> 160322
           MOVE ZEROS                  TO WSAA-PAID-OVRCOM              <ATHA43> 160322
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                        <ATHA43> 160322
              UNTIL WSAA-ZTUD-RECODE(WSAA-IND1)                         <ATHA43> 160322
                                        = SPACES                        <ATHA43> 160322
                OR  WSAA-IND1           > WSAA-ZTUD-ARRAY-CNT           <ATHA43> 160322
                                                                        <ATHA43> 160322
                                                                        <ATHA43> 160322
                 IF WSAA-ZTUD-ZPREMAMT(WSAA-IND1)                       <ATHA43> 160322
                                    NOT = ZEROS                         <ATHA43> 160322
                    MOVE WSAA-ZTUD-EFFDATE(WSAA-IND1)                   <ATHA43> 160322
                                       TO WSAA-FROM-DATE                <ATHB37> 170208
                    MOVE WSAA-ZTUD-JCOVCODE(WSAA-IND1)                  <ATHA43> 160322
                                        TO WSAA-CRTABLE                 <ATHB37> 170208
                                                                        <ATHA43> 160322
                    PERFORM 2287-UPDATE-ZTUH-SURF                       <ATHA43> 160322
                    PERFORM 2285-WRITE-ZTUD-SURF                        <ATHA43> 160322
                 END-IF                                                 <ATHA43> 160322
                                                                        <ATHA43> 160322
           END-PERFORM                                                  <ATHA43> 160322
           .                                                            <ATHA43> 160322
       2257B-EXIT.                                                      <ATHA43> 160322
           EXIT.                                                        <ATHA43> 160322
      /                                                                          151030
       2270-READ-ZTUD-TOPUP  SECTION.                                            151030
      *********************************                                          151030
       2270-START.                                                               151030
           MOVE ZSCLABCK-CHDRNUM       TO WSAA-ACMV-CHDRNUM                      151118
      ***  MOVE '01'                   TO WSAA-ACMV-LIFE                <ATHB45> 170313
      ***  MOVE '02'                   TO WSAA-ACMV-COVERAGE            <ATHB45> 170313
      ***  MOVE '00'                   TO WSAA-ACMV-RIDER               <ATHB45> 170313
           MOVE WSAA-TU-LIFE           TO WSAA-ACMV-LIFE                <ATHB45> 170313
           MOVE WSAA-TU-COVERAGE       TO WSAA-ACMV-COVERAGE            <ATHB45> 170313
           MOVE WSAA-TU-RIDER          TO WSAA-ACMV-RIDER               <ATHB45> 170313
           MOVE '00'                   TO WSAA-ACMV-PLAN-SUFF                    151118
                                                                                 151030
           INITIALIZE ZTUD-PARAMS                                                151030
           INITIALIZE ZTUDREC-KEY-DATA     OF ZTUD-PARAMS                        151030
           INITIALIZE ZTUDREC-NON-KEY-DATA OF ZTUD-PARAMS                        151030
           MOVE O-K                    TO ZTUD-STATUZ                            151030
           MOVE ZSCLABCK-CHDRCOY       TO ZTUD-CHDRCOY                           151030
           MOVE ZSCLABCK-CHDRNUM       TO ZTUD-CHDRNUM                           151030
           MOVE BEGN                   TO ZTUD-FUNCTION                          151030
           MOVE ZTUDREC                TO ZTUD-FORMAT                            151030
                                                                                 151030
           MOVE ZEROS                  TO WSAA-ZTUD-ARRAY-CNT                    151103
           MOVE ZEROS                  TO WSAA-OVRAMT-TOPUP                      151118
           INITIALIZE WSAA-ZTUD-ARRAY                                   <ATHA43> 160323
           PERFORM X200-ZTUD-IO                                                  151030
           PERFORM                                                               151030
              UNTIL ZTUD-STATUZ         = ENDP                                   151030
                                                                        <ATHD11> 181018
                 IF   CLAWBACK-COVER                                    <ATHD11> 181018
                 AND  ZSCLABCK-CRTABLE NOT = ZTUD-JCOVCODE              <ATHD11> 181022
                      CONTINUE                                          <ATHD11> 181022
                 ELSE                                                   <ATHD11> 181018
                     PERFORM 2275A-FIND-OVRCOM-TOPUP                             181018
                                                                        <ATHD11> 181018
                     IF  ZTUD-TRANS-CODE           = 'T679'             <ATHA67> 181018
                     AND ZTUD-TRANNOR              = ZEROS              <ATHA67> 181018
      ***            IF  ZTUD-TRANS-CODE NOT = WSCC-REE1        <ATHA67><ATHA43> 181018
      ***            AND ZTUD-RECODE     NOT = '00'             <ATHA67><ATHA43> 181018
                         PERFORM 2275-LOAD-ARRAY                                 181018
      ***            END-IF                                     <ATHA67><ATHA43> 181018
                     END-IF                                             <ATHA67> 181018
                 END-IF                                                 <ATHD11> 181018
                                                                                 151030
              MOVE NEXTR               TO ZTUD-FUNCTION                          151030
              PERFORM X200-ZTUD-IO                                               151030
           END-PERFORM                                                           151030
                                                                                 151108
           .                                                                     151030
       2270-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                          151030
       2275-LOAD-ARRAY SECTION.                                                  151030
      *********************************                                          151030
       2275-START.                                                               151030
                                                                                 151030
           SET  NOT-ARRAY-CRTABLE-FOUND                                          151108
                                       TO TRUE                                   151108
                                                                                 151108
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                                 151030
             UNTIL WSAA-IND1            > WSCC-MAX-ARRAY                         151030
             OR    WSAA-ZTUD-RECODE  (WSAA-IND1)                                 151108
                                        = SPACES                                 151030
             OR    ARRAY-CRTABLE-FOUND                                           151030
               IF  ZTUD-RECODE                                                   151030
                                        = WSAA-ZTUD-RECODE (WSAA-IND1)           151030
                   SET ARRAY-CRTABLE-FOUND                                       151030
                                       TO TRUE                                   151030
                   ADD ZTUD-ZPREMAMT   TO WSAA-ZTUD-ZPREMAMT                     151108
                                          (WSAA-IND1)                            151109
                   ADD ZTUD-ZCOMMAMT   TO WSAA-ZTUD-ZCOMMAMT                     151108
                                          (WSAA-IND1)                            151030
                   ADD ZTUD-NET        TO WSAA-ZTUD-NET                          151108
                                          (WSAA-IND1)                            151108
                   ADD WSAA-OVRAMT-TOPUP  TO WSAA-ZTUD-OVRAMT                    151118
                                          (WSAA-IND1)                            151118
               END-IF                                                            151030
               MOVE WSAA-IND1          TO WSAA-ZTUD-ARRAY-CNT                    151030
           END-PERFORM                                                           151030
                                                                                 151030
           IF  ARRAY-CRTABLE-FOUND                                               151030
               GO TO 2275-EXIT                                                   151030
           END-IF                                                                151030
                                                                                 151030
           ADD WSCC-NUM-1              TO WSAA-ZTUD-ARRAY-CNT                    151030
           MOVE ZTUD-RECODE            TO WSAA-ZTUD-RECODE                       151030
                                          (WSAA-ZTUD-ARRAY-CNT)                  151030
           MOVE ZTUD-EFFDATE           TO WSAA-ZTUD-EFFDATE                      151109
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZPREMAMT          TO WSAA-ZTUD-ZPREMAMT                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZCOMMAMT          TO WSAA-ZTUD-ZCOMMAMT                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-NET               TO WSAA-ZTUD-NET                          151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE WSAA-OVRAMT-TOPUP      TO WSAA-ZTUD-OVRAMT                       151118
                                          (WSAA-ZTUD-ARRAY-CNT)                  151118
           MOVE ZTUD-JCOVCODE          TO WSAA-ZTUD-JCOVCODE                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-LIFENUM           TO WSAA-ZTUD-LIFENUM                      151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-AGNTNUM           TO WSAA-ZTUD-AGNTNUM                      151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZCLNTAGN          TO WSAA-ZTUD-ZCLNTAGN                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZCLNTUNI          TO WSAA-ZTUD-ZCLNTUNI                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZCLNTASS          TO WSAA-ZTUD-ZCLNTASS                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           MOVE ZTUD-ZCLNTAGY          TO WSAA-ZTUD-ZCLNTAGY                     151108
                                          (WSAA-ZTUD-ARRAY-CNT)                  151108
           .                                                                     151030
       2275-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                          151110
       2280-READ-ZTUD-ARRAY SECTION.                                             151110
      ****************************                                               151110
       2280-START.                                                               151110
                                                                                 151110
      **   MOVE ZEROS                  TO WSAA-PAID-PREM                <ATHA67> 160404
      **   MOVE ZEROS                  TO WSAA-PAID-COMM                <ATHA67> 160404
      **   MOVE ZEROS                  TO WSAA-PAID-OVRCOM              <ATHA67> 160404
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                                 151110
              UNTIL WSAA-ZTUD-RECODE(WSAA-IND1)                                  151110
                                        = SPACES                                 151110
                OR  WSAA-IND1           > WSAA-ZTUD-ARRAY-CNT                    151110
                                                                                 151110
                 MOVE ZEROS            TO WSAA-CLAWBACK-TOPUP                    151110
                 MOVE ZEROS            TO WSAA-CLAWBACK-NET                      151114
                 MOVE ZEROS            TO WSAA-CLAWBACK-OVRAMT                   151118
                 MOVE ZEROS            TO WSAA-PAID-PREM                <ATHA67> 160404
                 MOVE ZEROS            TO WSAA-PAID-COMM                <ATHA67> 160404
                 MOVE ZEROS            TO WSAA-PAID-OVRCOM              <ATHA67> 160404
                                                                                 151110
                 IF WSAA-ZTUD-ZPREMAMT(WSAA-IND1)                                151110
                                    NOT = ZEROS                                  151110
                    MOVE WSAA-ZTUD-EFFDATE(WSAA-IND1)                            151110
                                       TO WSAA-FROM-DATE                         151110
                                                                        <ATHA67> 160414
      * DO NOT CHECK AGENT WHEN CFI GENIUS PLUS                         <ATHA67> 160414
                    IF NOT-CHECK-AGENT                                  <ATHA67> 160414
                       PERFORM 2280A-FIND-CLAWB-TOPUP                   <ATHA67> 160414
                    ELSE                                                <ATHA67> 160414
      *** ELSE CHECK AGENT                                              <ATHA67> 160414
                    IF WSAA-ZTUD-ZCLNTAGN(WSAA-IND1)                             151110
                                        = WSAA-ZCHA-CLNTNUM                      151110
                       PERFORM 2280A-FIND-CLAWB-TOPUP                   <ATHA67> 160414
                    END-IF                                                       151110
                    END-IF                                              <ATHA67> 160414
      *********                                                                  151214
      ***           MOVE '01'          TO WSAA-ZCLB-LIFE        <ATHB45><ATHA67> 170313
      ***           MOVE '02'          TO WSAA-ZCLB-COVERAGE    <ATHB45><ATHA67> 170313
      ***           MOVE '00'          TO WSAA-ZCLB-RIDER       <ATHB45><ATHA67> 170313
                                                                        <ATHB87> 170824
      * FIND THE COVERAGE CODE BY READING ZCOVCRT               <ATHB87><ATHB45> 170824
                    MOVE WSAA-ZTUD-JCOVCODE(WSAA-IND1)                  <ATHB87> 170824
                                       TO WSAA-TU-CRTABLE               <ATHB87> 170824
                    PERFORM X4800-READ-ZCOVCRT                          <ATHB87> 170824
      ****                                                              <ATHB87> 170824
                    MOVE WSAA-TU-LIFE  TO WSAA-ZCLB-LIFE                <ATHB45> 170313
                    MOVE WSAA-TU-COVERAGE                               <ATHB45> 170313
                                       TO WSAA-ZCLB-COVERAGE            <ATHB45> 170313
                    MOVE WSAA-TU-RIDER TO WSAA-ZCLB-RIDER               <ATHB45> 170313
                                                                        <ATHB45> 170313
                    MOVE WSAA-ZTUD-RECODE(WSAA-IND1)                    <ATHA67> 160406
                                        TO WSAA-ZCLB-RECODE             <ATHA67> 160406
                    PERFORM X3000-READ-ZCLBCOV                          <ATHA67> 160404
                    PERFORM X3200-FIND-CLAWB-REMN-TOPUP                 <ATHA67> 160404
                    PERFORM 2295-WRITE-LIFA-TOPUP                       <ATHA67> 160404
      *********                                                                  151214
      ***           COMPUTE WSAA-TOT-CLAWB-TOPUP                        <ATHA67> 160404
      ***                               = WSAA-CLAWBACK-TOPUP           <ATHA67> 160404
      ***                               + WSAA-TOT-CLAWB-TOPUP          <ATHA67> 160404
      ***           COMPUTE WSAA-TOT-CLAWB-NET                          <ATHA67> 160404
      ***                               = WSAA-CLAWBACK-NET             <ATHA67> 160404
      ***                               + WSAA-TOT-CLAWB-NET            <ATHA67> 160404
      ***           COMPUTE WSAA-TOT-CLAWB-OVRAMT                       <ATHA67> 160404
      ***                               = WSAA-CLAWBACK-OVRAMT          <ATHA67> 160404
      ***                               + WSAA-TOT-CLAWB-OVRAMT         <ATHA67> 160404
      ***           MOVE WSAA-ZTUD-JCOVCODE(WSAA-IND1)                  <ATHA67> 160404
      ***                               TO WSAA-CRTABLE                 <ATHA67> 160404
                                                                                 151110
                    PERFORM 2287-UPDATE-ZTUH-SURF                                151110
                    PERFORM 2285-WRITE-ZTUD-SURF                                 151110
                 END-IF                                                          151110
                                                                                 151110
           END-PERFORM                                                           151110
           .                                                                     151110
       2280-EXIT.                                                                151110
           EXIT.                                                                 151110
      /                                                                          151118
       2275A-FIND-OVRCOM-TOPUP SECTION.                                          151118
      *********************************                                          151118
       2275A-START.                                                              151118
           MOVE ZEROS                        TO WSAA-OVRAMT-TOPUP                151118
           IF  ZTUD-TRANS-CODE       NOT = 'T679'                                151118
           OR  (ZTUD-TRANS-CODE           = 'T679'                               151124
           AND ZTUD-TRANNOR          NOT = ZEROS)                                151124
               GO TO 2275A-EXIT                                                  151118
           END-IF                                                                151118
           MOVE ZTUD-JCOVCODE          TO WSAA-TU-CRTABLE               <ATHB87> 170824
           PERFORM X4800-READ-ZCOVCRT                                   <ATHB87> 170824
           MOVE WSAA-TU-LIFE           TO WSAA-ACMV-LIFE                <ATHB87> 170824
           MOVE WSAA-TU-COVERAGE       TO WSAA-ACMV-COVERAGE            <ATHB87> 170824
           MOVE WSAA-TU-RIDER          TO WSAA-ACMV-RIDER               <ATHB87> 170824
           MOVE '00'                   TO WSAA-ACMV-PLAN-SUFF           <ATHB87> 170824
                                                                        <ATHB87> 170824
           INITIALIZE ACMVREV-PARAMS                                             151118
           INITIALIZE ACMVREVREC-KEY-DATA     OF ACMVREV-PARAMS                  151118
           INITIALIZE ACMVREVREC-NON-KEY-DATA OF ACMVREV-PARAMS                  151118
                                                                                 151118
           MOVE ZTUD-CHDRCOY           TO ACMVREV-RLDGCOY                        151118
           MOVE ZTUD-CHDRNUM           TO ACMVREV-RDOCNUM                        151118
           MOVE ZTUD-TRANNO            TO ACMVREV-TRANNO                         151118
                                                                                 151118
           MOVE BEGN                   TO ACMVREV-FUNCTION                       151118
           PERFORM X800A-ACMVREV-IO                                              151118
                                                                                 151118
           IF  ACMVREV-STATUZ           = ENDP                                   151118
               GO TO 2275A-EXIT                                                  151118
           END-IF                                                                151118
                                                                                 151118
           PERFORM                                                               151118
             UNTIL ACMVREV-STATUZ       = ENDP                                   151118
                                                                                 151118
                IF  ACMVREV-SACSCODE    = WSAA-T5645-SACSCODE(1)                 151118
                AND ACMVREV-SACSTYP     = WSAA-T5645-SACSTYPE(1)                 151118
                AND ACMVREV-RLDGACCT    = WSAA-ACMV-RLDGACCT                     151118
                    COMPUTE WSAA-OVRAMT-TOPUP = ACMVREV-ORIGAMT                  151118
                                            + WSAA-OVRAMT-TOPUP                  151118
                END-IF                                                           151118
                                                                                 151118
             MOVE NEXTR                  TO ACMVREV-FUNCTION                     151118
             PERFORM X800A-ACMVREV-IO                                            151118
           END-PERFORM                                                           151118
           .                                                                     151118
       2275A-EXIT.                                                               151118
           EXIT.                                                                 151118
      /                                                                 <ATHA67> 160414
       2280A-FIND-CLAWB-TOPUP SECTION.                                  <ATHA67> 160414
      *********************************                                 <ATHA67> 160414
       2280A-START.                                                     <ATHA67> 160414
                       MOVE WSAA-ZTUD-AGNTNUM(WSAA-IND1)                <ATHA67> 160414
                                       TO WSAA-AGNTNUM                  <ATHA67> 160414
                       PERFORM X900A-CLAWBACK-RULES-PERC-TOP            <ATHA67> 160414
                                                                        <ATHA67> 160414
                       COMPUTE WSAA-CLAWBACK-TOPUP ROUNDED              <ATHA67> 160414
                                        = WSAA-T8Z82                    <ATHA67> 160414
                                        * WSAA-ZTUD-ZCOMMAMT(WSAA-IND1) <ATHA67> 160414
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160414
                       END-COMPUTE                                      <ATHA67> 160414
                                                                        <ATHA67> 160414
                       COMPUTE WSAA-CLAWBACK-NET   ROUNDED              <ATHA67> 160414
                                        = WSAA-T8Z82                    <ATHA67> 160414
                                        * WSAA-ZTUD-NET(WSAA-IND1)      <ATHA67> 160414
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160414
                       END-COMPUTE                                      <ATHA67> 160414
                                                                        <ATHA67> 160414
                       COMPUTE WSAA-CLAWBACK-OVRAMT   ROUNDED           <ATHA67> 160414
                                        = WSAA-T8Z82                    <ATHA67> 160414
                                        * WSAA-ZTUD-OVRAMT(WSAA-IND1)   <ATHA67> 160414
                                        * WSAA-PARTS-PERC-WRK           <ATHA67> 160414
                       END-COMPUTE                                      <ATHA67> 160414
                                                                        <ATHA67> 160414
                       COMPUTE WSAA-PAID-PREM                           <ATHA67> 160414
                                        = WSAA-ZTUD-NET(WSAA-IND1)      <ATHA67> 160414
                                        + WSAA-PAID-PREM                <ATHA67> 160414
                       COMPUTE WSAA-PAID-COMM                           <ATHA67> 160414
                                        = WSAA-ZTUD-ZCOMMAMT(WSAA-IND1) <ATHA67> 160414
                                        + WSAA-PAID-COMM                <ATHA67> 160414
                       COMPUTE WSAA-PAID-OVRCOM                         <ATHA67> 160414
                                        = WSAA-ZTUD-OVRAMT(WSAA-IND1)   <ATHA67> 160414
                                        + WSAA-PAID-OVRCOM              <ATHA67> 160414
           .                                                            <ATHA67> 160414
       2280A-EXIT.                                                      <ATHA67> 160414
           EXIT.                                                        <ATHA67> 160414
      /                                                                          151110
       2285-WRITE-ZTUD-SURF SECTION.                                             151110
      *********************************                                          151110
       2285-START.                                                               151110
                                                                                 151110
           INITIALIZE ZTUD-PARAMS                                                151110
           INITIALIZE ZTUDREC-KEY-DATA     OF ZTUD-PARAMS                        151110
           INITIALIZE ZTUDREC-NON-KEY-DATA OF ZTUD-PARAMS                        151110
                                                                                 151110
           MOVE CHDRMJA-CHDRCOY        TO ZTUD-CHDRCOY                           151110
           MOVE CHDRMJA-CHDRNUM        TO ZTUD-CHDRNUM                           151110
           MOVE WSAA-ZTUD-RECODE(WSAA-IND1)                                      151110
                                       TO ZTUD-RECODE                            151110
           MOVE ZSCLABCK-TRANNO        TO ZTUD-TRANNO                            151110
           MOVE ZSCLABCK-EFFDATE       TO ZTUD-PRCDATE                           151110
           MOVE WSAA-ZTUD-EFFDATE(WSAA-IND1)                                     151110
                                       TO ZTUD-EFFDATE                           151110
           MOVE ZSCLABCK-BATCTRCDE     TO ZTUD-TRANS-CODE                        151110
                                                                        <ATHA43> 160323
           IF  ZSCLABCK-FUNCTION    NOT = WSCC-SURPS                    <ATHA43> 160323
           AND ZSCLABCK-FUNCTION    NOT = WSCC-SURGP                    <ATHC41> 180308
           COMPUTE ZTUD-ZPREMAMT        = WSAA-ZTUD-ZPREMAMT                     151110
                                          (WSAA-IND1)                            151110
                                        * WSCC-NUM--1                            151110
           END-COMPUTE                                                           151110
           END-IF                                                       <ATHA43> 160323
           IF  WSAA-ZTUD-RECODE(WSAA-IND1)   = '00'                     <ATHA43> 160323
           COMPUTE ZTUD-ZCOMMAMT        = WSAA-PAID-COMM-CLAWB          <ATHA43> 160323
                                        * WSCC-NUM--1                   <ATHA43> 160323
           END-COMPUTE                                                  <ATHA43> 160323
           COMPUTE ZTUD-NET             = WSAA-PAID-PREM-CLAWB          <ATHA43> 160323
                                        * WSCC-NUM--1                   <ATHA43> 160323
           END-COMPUTE                                                  <ATHA43> 160323
           ELSE                                                         <ATHA43> 160323
           COMPUTE ZTUD-ZCOMMAMT        = WSAA-CLAWBACK-TOPUP                    151110
                                        * WSCC-NUM--1                            151110
           END-COMPUTE                                                           151110
           COMPUTE ZTUD-NET             = WSAA-CLAWBACK-NET                      151110
                                        * WSCC-NUM--1                            151110
           END-COMPUTE                                                           151110
           END-IF                                                       <ATHA43> 160323
           MOVE WSAA-ZTUD-LIFENUM(WSAA-IND1)                                     151110
                                       TO ZTUD-LIFENUM                           151110
           MOVE WSAA-ZTUD-JCOVCODE(WSAA-IND1)                                    151110
                                       TO ZTUD-JCOVCODE                          151110
           MOVE WSAA-ZTUD-AGNTNUM(WSAA-IND1)                                     151110
                                       TO ZTUD-AGNTNUM                           151110
           MOVE WSAA-ZTUD-ZCLNTAGN(WSAA-IND1)                                    151110
                                       TO ZTUD-ZCLNTAGN                          151110
           MOVE WSAA-ZTUD-ZCLNTUNI(WSAA-IND1)                                    151110
                                       TO ZTUD-ZCLNTUNI                          151110
           MOVE WSAA-ZTUD-ZCLNTASS(WSAA-IND1)                                    151110
                                       TO ZTUD-ZCLNTASS                          151110
           MOVE WSAA-ZTUD-ZCLNTAGY(WSAA-IND1)                                    151110
                                       TO ZTUD-ZCLNTAGY                          151110
                                                                                 151110
           MOVE WSCC-TXT-1             TO ZTUD-VALIDFLAG                         151110
                                                                                 151110
           MOVE WRITR                  TO ZTUD-FUNCTION                          151110
           PERFORM X200-ZTUD-IO                                                  151110
           .                                                                     151110
       2285-EXIT.                                                                151110
           EXIT.                                                                 151110
      /                                                                          151110
       2287-UPDATE-ZTUH-SURF SECTION.                                            151110
      ******************************                                             151110
       2287-START.                                                               151110
                                                                                 151110
           INITIALIZE ZTUH-PARAMS                                                151110
           INITIALIZE ZTUHREC-KEY-DATA     OF ZTUH-PARAMS                        151110
           INITIALIZE ZTUHREC-NON-KEY-DATA OF ZTUH-PARAMS                        151110
                                                                                 151110
           MOVE ZSCLABCK-CHDRCOY      TO ZTUH-CHDRCOY                            151110
           MOVE ZSCLABCK-CHDRNUM      TO ZTUH-CHDRNUM                            151110
           MOVE WSAA-ZTUD-RECODE(WSAA-IND1)                                      151110
                                       TO ZTUH-RECODE                            151114
                                                                                 151110
           MOVE READR                  TO ZTUH-FUNCTION                          151114
           PERFORM X1250-ZTUH-IO                                                 151110
           IF  ZTUH-STATUZ       NOT = O-K                                       151110
               GO TO 2287-EXIT                                                   151110
           END-IF                                                                151110
                                                                                 151110
           MOVE READD                  TO ZTUH-FUNCTION                          151114
           PERFORM X1250-ZTUH-IO                                                 151114
                                                                                 151110
           MOVE WSCC-TXT-2             TO ZTUH-VALIDFLAG                         151110
           MOVE WRITD                  TO ZTUH-FUNCTION                          151114
           PERFORM X1250-ZTUH-IO                                                 151110
                                                                                 151110
           PERFORM X1270-WRITE-ZTUHTRN                                           151110
                                                                                 151110
           .                                                                     151110
       2287-EXIT.                                                                151110
           EXIT.                                                                 151110
      /                                                                          151112
       2290-WRITE-LIFA-TOPUP SECTION.                                            151112
      ****************************                                               151112
       2290-START.                                                               151112
                                                                                 151112
            IF WSAA-TOT-CLAWB-TOPUP    = ZEROS                                   151112
               GO TO 2290-EXIT                                                   151112
            END-IF                                                               151112
      *     COMPUTE WSAA-TOT-CLAWB-OVRAMT ROUNDED                                151118
      *                                     = WSAA-TOT-CLAWB-NET                 151118
      *                                     * (0.5 / 100)                        151118
                                                                                 151116
           PERFORM X2050-READ-AGLF                                               151123
           PERFORM X1400-WRITE-LIFA-REGP                                         151112
                                                                                 151112
           IF  WSAA-TOT-CLAWB-OVRAMT                                             151118
                                    NOT  = ZEROS                                 151118
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151112
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151112
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151112
                                                                                 151113
      *        COMPUTE LIFA-ORIGAMT ROUNDED = WSAA-TOT-CLAWB-NET                 151118
      *                                     * (0.5 / 100)                        151118
      *                                     * WSCC-NUM--1                        151118
                                                                                 151116
               COMPUTE LIFA-ORIGAMT ROUNDED = WSAA-TOT-CLAWB-OVRAMT              151118
                                            * WSCC-NUM--1                        151118
                                                                                 151118
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151112
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151112
               MOVE 1                  TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151112
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151112
               MOVE 11                 TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151112
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151112
               MOVE 2                  TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151112
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151112
               MOVE 12                 TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
           END-IF                                                                151112
           IF  WSAA-TOT-CLAWB-TOPUP                                              151112
                                    NOT = ZEROS                                  151112
      **       MOVE WSAA-TOT-CLAWB-TOPUP                                         151113
      **                               TO LIFA-ORIGAMT                           151113
               COMPUTE LIFA-ORIGAMT         = WSAA-TOT-CLAWB-TOPUP               151113
                                            * WSCC-NUM--1                        151113
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
               MOVE 4                  TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
               MOVE 8                  TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
                                                                                 151113
               MOVE SPACES             TO LIFA-RLDGACCT                          151113
               MOVE WSAA-AGNTNUM       TO LIFA-RLDGACCT                          151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 9                  TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
                                                                                 151113
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 10                 TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
           END-IF                                                                151112
                                                                                 151113
           IF  WSAA-TOT-CLAWB-NET                                                151112
                                    NOT = ZEROS                                  151112
           AND WSAA-TOT-CLAWB-TOPUP                                              151113
                                    NOT = ZEROS                                  151113
               MOVE WSAA-TOT-CLAWB-NET                                           151112
                                       TO LIFA-ORIGAMT                           151112
               COMPUTE LIFA-ORIGAMT         = WSAA-TOT-CLAWB-NET                 151113
                                            * WSCC-NUM--1                        151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151112
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151112
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151112
               MOVE WSAA-AGNTNUM           TO WSAA-TRANCHDR                      151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151112
               MOVE 13                 TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
               MOVE 14                 TO IX-SA                                  151112
               PERFORM X1450-POST-COMM                                           151112
           END-IF                                                                151112
                                                                                 151117
           PERFORM X1900A-WRITE-ZCLB-TOPUP                                       151116
           .                                                                     151112
       2290-EXIT.                                                                151112
           EXIT.                                                                 151112
      /                                                                          151214
       2295-WRITE-LIFA-TOPUP SECTION.                                            151214
      ****************************                                               151214
       2295-START.                                                               151214
                                                                                 151214
            IF WSAA-CLAWBACK-TOPUP     = ZEROS                                   151214
               GO TO 2295-EXIT                                                   151214
            END-IF                                                               151214
           MOVE WSAA-ZTUD-JCOVCODE(WSAA-IND1)                                    151214
                                        TO WSAA-CRTABLE                          151214
           MOVE WSAA-ZTUD-RECODE(WSAA-IND1)                                      151214
                                        TO WSAA-EXT-RECODE                       151214
                                                                                 151214
           PERFORM X2050-READ-AGLF                                               151214
           PERFORM X1400-WRITE-LIFA-REGP                                         151214
                                                                                 151214
           IF  WSAA-CLAWBACK-OVRAMT                                              151214
                                    NOT  = ZEROS                                 151214
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151214
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151214
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151214
                                                                                 151214
               COMPUTE LIFA-ORIGAMT ROUNDED = WSAA-CLAWBACK-OVRAMT               151214
                                            * WSCC-NUM--1                        151214
                                                                                 151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 1                  TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 11                 TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 2                  TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 12                 TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
           END-IF                                                                151214
           IF  WSAA-CLAWBACK-TOPUP                                               151214
                                    NOT = ZEROS                                  151214
               COMPUTE LIFA-ORIGAMT         = WSAA-CLAWBACK-TOPUP                151214
                                            * WSCC-NUM--1                        151214
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151214
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151214
      *                                                                 <ATHB87> 170824
      * FOR TU05/TU06 WE DO NOT NEED TO WRITE ACCOUNT  52/0/@@@         <ATHB87> 170824
               IF  WSAA-CRTABLE         NOT = 'TU05'                    <ATHB87> 170824
               AND WSAA-CRTABLE         NOT = 'TU06'                    <ATHB87> 170824
               MOVE 4                  TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               MOVE 8                  TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               END-IF                                                   <ATHB87> 170824
                                                                                 151214
               MOVE SPACES             TO LIFA-RLDGACCT                          151214
               MOVE WSAA-AGNTNUM       TO LIFA-RLDGACCT                          151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 9                  TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
                                                                                 151214
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151214
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151214
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR-TOP                      151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 10                 TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
           END-IF                                                                151214
                                                                                 151214
           IF  WSAA-CLAWBACK-NET                                                 151214
                                    NOT = ZEROS                                  151214
           AND WSAA-CLAWBACK-TOPUP                                               151214
                                    NOT = ZEROS                                  151214
               COMPUTE LIFA-ORIGAMT         = WSAA-CLAWBACK-NET                  151214
                                            * WSCC-NUM--1                        151214
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151214
      ***      MOVE '01'                   TO WSAA-RLDG-LIFE            <ATHB45> 170313
      ***      MOVE '02'                   TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
      ***      MOVE '00'                   TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE WSAA-TU-LIFE           TO WSAA-RLDG-LIFE            <ATHB45> 170313
               MOVE WSAA-TU-COVERAGE       TO WSAA-RLDG-COVERAGE        <ATHB45> 170313
               MOVE WSAA-TU-RIDER          TO WSAA-RLDG-RIDER           <ATHB45> 170313
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151214
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151214
               MOVE WSAA-AGNTNUM           TO WSAA-TRANCHDR-TOP                  151214
               MOVE WSAA-TRANREF-TOP       TO LIFA-TRANREF                       151214
               MOVE 13                 TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
               MOVE 14                 TO IX-SA                                  151214
               PERFORM X1450-POST-COMM                                           151214
           END-IF                                                                151214
                                                                                 151214
           PERFORM X1900B-WRITE-ZCLB-TOPUP                                       151214
           .                                                                     151214
       2295-EXIT.                                                                151214
           EXIT.                                                                 151214
      /                                                                 <ATHD11> 181012
       2900-SURRF-CLAWBACK SECTION.                                     <ATHD11> 181012
      ****************************                                      <ATHD11> 181012
       2900-START.                                                      <ATHD11> 181012
           IF  CLAWBACK-REGP                                            <ATHD11> 181012
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHD11> 181012
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHD11> 181012
               END-IF                                                   <ATHD11> 181012
           END-IF                                                       <ATHD11> 181012
                                                                        <ATHD11> 181012
      * FOR REGULAR PREMIUM                                             <ATHD11> 181012
           IF  CLAWBACK-REGP                                            <ATHD11> 181012
               PERFORM 2250-READ-ACMV                                   <ATHD11> 181012
           END-IF                                                       <ATHD11> 181012
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHD11> 181012
           .                                                            <ATHD11> 181012
       2900-EXIT.                                                       <ATHD11> 181012
           EXIT.                                                        <ATHD11> 181012
      /                                                                          151116
       2400-SURCF-CLAWBACK SECTION.                                              151116
      ****************************                                               151116
       2400-START.                                                               151116
           IF  CLAWBACK-REGP                                            <ATHA67> 160408
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHA67> 160408
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHA67> 160408
               END-IF                                                   <ATHA67> 160408
           END-IF                                                       <ATHA67> 160408
                                                                                 151116
      * FOR REGULAR PREMIUM                                                      151116
      ***  IF  CLAWBACK-REGP                                            <ATHA67> 160512
               PERFORM 2250-READ-ACMV                                            151116
      ***  END-IF                                                       <ATHA67> 160512
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHA43> 160323
           SET NOT-CHECK-AGENT         TO TRUE                          <ATHA67> 160512
      * FOR TOP UP                                                               151116
           PERFORM X4400-GET-TU-COVR                                    <ATHB45> 170313
           IF  WSAA-TU-CRTABLE NOT = SPACES                             <ATHB45> 170313
               PERFORM X4800-READ-ZCOVCRT                               <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           PERFORM 2270-READ-ZTUD-TOPUP                                          151116
           PERFORM 2280-READ-ZTUD-ARRAY                                          151116
      **   PERFORM 2290-WRITE-LIFA-TOPUP                                <ATHA67> 160407
           .                                                                     151116
       2400-EXIT.                                                                151116
           EXIT.                                                                 151116
      /                                                                          151103
       2300-SURP-CLAWBACK SECTION.                                               151103
      ****************************                                               151103
       2300-START.                                                               151103
           IF  CLAWBACK-REGP                                            <ATHA67> 160408
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHA67> 160408
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHA67> 160408
               END-IF                                                   <ATHA67> 160408
           END-IF                                                       <ATHA67> 160408
           IF  CLAWBACK-REGP                                            <ATHA43> 160324
               PERFORM 2250-READ-ACMV                                   <ATHA43> 160324
           END-IF                                                       <ATHA43> 160324
                                                                        <ATHA43> 160323
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHA43> 160323
      * FOR TOP UP                                                      <ATHA43> 160205
           PERFORM X4400-GET-TU-COVR                                    <ATHB45> 170313
           IF  WSAA-TU-CRTABLE NOT = SPACES                             <ATHB45> 170313
               PERFORM X4800-READ-ZCOVCRT                               <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           PERFORM 2270-READ-ZTUD-TOPUP                                 <ATHA43> 160205
           PERFORM 2280-READ-ZTUD-ARRAY                                 <ATHA43> 160205
      ***  PERFORM 2290-WRITE-LIFA-TOPUP                        <ATHA67><ATHA43> 160407
           .                                                            <ATHA43> 160205
       2300-EXIT.                                                                151103
           EXIT.                                                                 151103
      /                                                                          151122
       2950-SURPC-CLAWBACK SECTION.                                     <ATHD11> 181016
      ****************************                                      <ATHD11> 181016
       2950-START.                                                      <ATHD11> 181016
                                                                        <ATHD11> 181016
           MOVE ZSCLABCK-CRTABLE       TO T5673-CTABLE                  <ATHD11> 181016
           MOVE WSCC-NUM-1             TO WSAA-IND1                     <ATHD11> 181016
           PERFORM X4450-GET-CRTABLE-TYPE                               <ATHD11> 181016
                                                                        <ATHD11> 181018
           IF CRTABLE-TYPE-UL                                           <ATHD11> 181016
              PERFORM 2900-SURRF-CLAWBACK                               <ATHD11> 181016
           END-IF                                                       <ATHD11> 181016
                                                                        <ATHD11> 181016
           IF CRTABLE-TYPE-TOP-UP                                       <ATHD11> 181016
              SET CLAWBACK-COVER       TO TRUE                          <ATHD11> 181018
              PERFORM 2270-READ-ZTUD-TOPUP                              <ATHD11> 181016
              PERFORM 2280-READ-ZTUD-ARRAY                              <ATHD11> 181016
      ****    PERFORM 2290-WRITE-LIFA-TOPUP                             <ATHD11> 181022
           END-IF                                                       <ATHD11> 181016
           .                                                            <ATHD11> 181016
       2950-EXIT.                                                       <ATHD11> 181016
           EXIT.                                                        <ATHD11> 181016
                                                                        <ATHD11> 181016
       2500-SURSP-CLAWBACK SECTION.                                              151122
      ****************************                                               151122
       2500-START.                                                               151122
                                                                                 151122
      * FOR SINGLE PREMIUM                                                       151122
           IF  CLAWBACK-REGP                                                     151122
               PERFORM 2550-READ-ACMV-SINGLE-PREM                                151122
           END-IF                                                                151122
           .                                                                     151122
       2500-EXIT.                                                                151122
           EXIT.                                                                 151122
      /                                                                 <ATHA67> 160407
       2600-SURGG-CLAWBACK SECTION.                                     <ATHA67> 160407
      ****************************                                      <ATHA67> 160407
       2600-START.                                                      <ATHA67> 160407
           IF  CLAWBACK-REGP                                            <ATHA67> 160408
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHA67> 160408
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHA67> 160408
               END-IF                                                   <ATHA67> 160408
           END-IF                                                       <ATHA67> 160408
                                                                        <ATHA67> 160407
      * FOR SINGLE PREMIUM                                              <ATHA67> 160407
           IF  CLAWBACK-REGP                                            <ATHA67> 160407
               PERFORM 2550-READ-ACMV-SINGLE-PREM                       <ATHA67> 160407
           END-IF                                                       <ATHA67> 160407
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHA67> 160407
                                                                        <ATHA67> 160407
           MOVE ZEROS                  TO WSAA-T8Z82                    <ATHA67> 160407
      * FOR TOP UP                                                      <ATHA67> 160407
           PERFORM X4400-GET-TU-COVR                                    <ATHB45> 170313
           IF  WSAA-TU-CRTABLE NOT = SPACES                             <ATHB45> 170313
               PERFORM X4800-READ-ZCOVCRT                               <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           PERFORM 2270-READ-ZTUD-TOPUP                                 <ATHA67> 160407
           PERFORM 2280-READ-ZTUD-ARRAY                                 <ATHA67> 160407
      **** PERFORM 2290-WRITE-LIFA-TOPUP                                <ATHA67> 160407
           .                                                            <ATHA67> 160407
       2600-EXIT.                                                       <ATHA67> 160413
           EXIT.                                                        <ATHA67> 160407
      /                                                                          151122
       2550-READ-ACMV-SINGLE-PREM SECTION.                                       151122
      ************************************                                       151122
       2550-START.                                                               151122
                                                                                 151122
           MOVE ZSCLABCK-CHDRNUM        TO WSAA-ACMV-CHDRNUM                     151122
           MOVE '01'                   TO WSAA-ACMV-LIFE                         151122
           MOVE '01'                   TO WSAA-ACMV-COVERAGE                     151122
           MOVE '00'                   TO WSAA-ACMV-RIDER                        151122
           MOVE '00'                   TO WSAA-ACMV-PLAN-SUFF                    151122
           INITIALIZE ACMVBK3-PARAMS                                             151122
           INITIALIZE ACMVBK3REC-KEY-DATA     OF ACMVBK3-PARAMS                  151122
           INITIALIZE ACMVBK3REC-NON-KEY-DATA OF ACMVBK3-PARAMS                  151122
           MOVE ZSCLABCK-CHDRCOY       TO ACMVBK3-RLDGCOY                        151122
           MOVE WSAA-ACMV-RLDGACCT     TO ACMVBK3-RLDGACCT                       151122
      *    MOVE WSCC-LE                TO ACMVBK3-SACSCODE                       151122
      *    MOVE WSCC-PS                TO ACMVBK3-SACSTYP                        151122
           MOVE BEGN                   TO ACMVBK3-FUNCTION                       151122
           PERFORM X1150-ACMVBK3-IO                                              151122
           PERFORM                                                               151122
             UNTIL ACMVBK3-STATUZ       = ENDP                                   151122
                                                                                 151122
                MOVE 'T642'            TO WSAA-BATCTRCDE                <ATHA67> 160413
                PERFORM X2200-READ-PTRNREV                              <ATHA67> 160413
                                                                                 151122
                IF  VALID-RECORD                                        <ATHA67> 160413
                IF  ACMVBK3-EFFDATE     = WSAA-OCCDATE                           151122
                AND ACMVBK3-RLDGACCT    = WSAA-ACMV-RLDGACCT                     151123
                    IF  ACMVBK3-SACSCODE = WSCC-LE                               151122
                    AND ACMVBK3-SACSTYP  = WSCC-PS                               151122
                        COMPUTE WSAA-PAID-PREM                                   151122
                                        = WSAA-PAID-PREM                         151122
                                        + ACMVBK3-ORIGAMT                        151122
                    END-IF                                                       151122
                    IF  ACMVBK3-SACSCODE = WSAA-T5645-SACSCODE(1)                151122
                    AND ACMVBK3-SACSTYP  = WSAA-T5645-SACSTYPE(1)                151122
                        COMPUTE WSAA-PAID-OVRCOM                                 151122
                                        = WSAA-PAID-OVRCOM                       151122
                                        + ACMVBK3-ORIGAMT                        151122
                    END-IF                                                       151122
                    IF  ACMVBK3-SACSCODE = WSAA-T5645-SACSCODE(17)               151122
                    AND ACMVBK3-SACSTYP  = WSAA-T5645-SACSTYPE(17)               151122
                        COMPUTE WSAA-PAID-COMM                                   151122
                                        = WSAA-PAID-COMM                         151122
                                        + ACMVBK3-ORIGAMT                        151122
                        MOVE ACMVBK3-GLCODE(11: 4)                               151122
                                       TO WSAA-CRTABLE                           151122
                    END-IF                                                       151122
                END-IF                                                           151122
                IF  ACMVBK3-EFFDATE  = WSAA-OCCDATE                     <ATHA67> 160414
                AND ACMVBK3-SACSCODE = 'LA'                             <ATHA67> 160414
                AND ACMVBK3-SACSTYP  = 'IP'                             <ATHA67> 160414
                    MOVE ACMVBK3-RLDGACCT(1:8)                          <ATHA67> 160414
                                       TO WSAA-AGNTNUM                  <ATHA67> 160413
                END-IF                                                  <ATHA67> 160414
                END-IF                                                  <ATHA67> 160413
                                                                                 151122
                MOVE NEXTR             TO ACMVBK3-FUNCTION                       151122
                PERFORM X1150-ACMVBK3-IO                                         151122
           END-PERFORM                                                           151122
                                                                                 151122
                                                                                 151122
           COMPUTE WSAA-PAID-PREM-CLAWB ROUNDED                                  151122
                                        = WSAA-PAID-PREM                         151122
                                        * WSAA-T8Z82                             151122
                                        * (WSAA-PARTS-PERC              <ATHA43> 160225
                                        / 100)                          <ATHA43> 160225
           COMPUTE WSAA-PAID-COMM-CLAWB ROUNDED                                  151122
                                        = WSAA-PAID-COMM                         151122
                                        * WSAA-T8Z82                             151122
                                        * (WSAA-PARTS-PERC              <ATHA43> 160225
                                        / 100)                          <ATHA43> 160225
           COMPUTE WSAA-PAID-OVRCOM-CLAWB ROUNDED                                151122
                                        = WSAA-PAID-OVRCOM                       151122
                                        * WSAA-T8Z82                             151122
                                        * (WSAA-PARTS-PERC              <ATHA43> 160225
                                        / 100)                          <ATHA43> 160225
      *******                                                           <ATHA67> 160404
           MOVE '01'                   TO WSAA-ZCLB-LIFE                <ATHA67> 160404
           MOVE '01'                   TO WSAA-ZCLB-COVERAGE            <ATHA67> 160404
           MOVE '00'                   TO WSAA-ZCLB-RIDER               <ATHA67> 160404
           MOVE '00'                   TO WSAA-ZCLB-RECODE              <ATHA67> 160408
           MOVE COVRAFI-CRTABLE        TO WSAA-CRTABLE                  <ATHB37> 170215
           PERFORM X3000-READ-ZCLBCOV                                   <ATHA67> 160404
           PERFORM X3100-FIND-CLAWB-REMN-REGP                           <ATHA67> 160404
                                                                        <ATHA67> 160404
           PERFORM X1900-WRITE-ZCLB                                              151122
                                                                                 151122
           PERFORM X1400-WRITE-LIFA-REGP                                         151122
           PERFORM X2110-SP-ACCOUNTINGS                                          151122
           .                                                                     151122
       2550-EXIT.                                                                151122
           EXIT.                                                                 151122
      /                                                                 <ATHA67> 160413
       2700-CFIGG-CLAWBACK SECTION.                                     <ATHA67> 160413
      ****************************                                      <ATHA67> 160413
       2700-START.                                                      <ATHA67> 160413
                                                                        <ATHA67> 160413
           SET NOT-CHECK-AGENT         TO TRUE                          <ATHA67> 160414
      * FOR SINGLE PREMIUM                                              <ATHA67> 160413
           PERFORM 2550-READ-ACMV-SINGLE-PREM                           <ATHA67> 160413
           PERFORM 2257-READ-ZTUD-REGP                                  <ATHA67> 160413
                                                                        <ATHA67> 160413
           MOVE ZEROS                  TO WSAA-T8Z82                    <ATHA67> 160413
      * FOR TOP UP                                                      <ATHA67> 160413
           PERFORM X4400-GET-TU-COVR                                    <ATHB45> 170313
           IF  WSAA-TU-CRTABLE NOT = SPACES                             <ATHB45> 170313
               PERFORM X4800-READ-ZCOVCRT                               <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           PERFORM 2270-READ-ZTUD-TOPUP                                 <ATHA67> 160413
           PERFORM 2280-READ-ZTUD-ARRAY                                 <ATHA67> 160413
      **** PERFORM 2290-WRITE-LIFA-TOPUP                                <ATHA67> 160413
           .                                                            <ATHA67> 160413
       2700-EXIT.                                                       <ATHA67> 160413
           EXIT.                                                        <ATHA67> 160413
      /                                                                 <ATHB37> 170208
       2800-DECRESE-PREM-CLAWBACK SECTION.                              <ATHB37> 170208
      ************************************                              <ATHB37> 170208
       2800-START.                                                      <ATHB37> 170208
           IF  CLAWBACK-REGP                                            <ATHB37> 170208
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHB37> 170208
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHB37> 170208
               END-IF                                                   <ATHB37> 170208
           END-IF                                                       <ATHB37> 170208
                                                                        <ATHB37> 170208
      * FOR REGULAR PREMIUM                                             <ATHB37> 170208
           IF  CLAWBACK-REGP                                            <ATHB37> 170208
               PERFORM 2850-FIND-INITIAL                                <ATHB37> 170210
               PERFORM 2860-FIND-PAID-PREM                              <ATHB37> 170213
           END-IF                                                       <ATHB37> 170208
           .                                                            <ATHB37> 170208
       2800-EXIT.                                                       <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170208
      /                                                                 <ATHB37> 170210
       2850-FIND-INITIAL SECTION.                                       <ATHB37> 170210
      ***************************                                       <ATHB37> 170210
       2850-START.                                                      <ATHB37> 170210
                                                                        <ATHB37> 170210
           INITIALIZE COVRAFI-PARAMS                                    <ATHB37> 170210
           INITIALIZE COVRAFIREC-KEY-DATA OF COVRAFI-PARAMS             <ATHB37> 170210
           INITIALIZE COVRAFIREC-NON-KEY-DATA                           <ATHB37> 170210
                                       OF COVRAFI-PARAMS                <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE ZSCLABCK-CHDRCOY       TO COVRAFI-CHDRCOY               <ATHB37> 170210
           MOVE ZSCLABCK-CHDRNUM       TO COVRAFI-CHDRNUM               <ATHB37> 170210
           MOVE ZSCLABCK-COVERAGE      TO COVRAFI-COVERAGE              <ATHB37> 170210
           MOVE ZSCLABCK-RIDER         TO COVRAFI-RIDER                 <ATHB37> 170210
           MOVE ZSCLABCK-LIFE          TO COVRAFI-LIFE                  <ATHB37> 170210
           MOVE ZSCLABCK-PLAN-SUFFIX   TO COVRAFI-PLAN-SUFFIX           <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE BEGN                   TO COVRAFI-FUNCTION              <ATHB37> 170210
           PERFORM X3600-COVRAFI-IO                                     <ATHB37> 170210
           IF  COVRAFI-STATUZ           = ENDP                          <ATHB37> 170210
               GO TO 2850-EXIT                                          <ATHB37> 170210
           END-IF                                                       <ATHB37> 170210
                                                                        <ATHB37> 170210
           INITIALIZE CHDRAFI-PARAMS                                    <ATHB37> 170210
           INITIALIZE CHDRAFIREC-KEY-DATA OF CHDRAFI-PARAMS             <ATHB37> 170210
           INITIALIZE CHDRAFIREC-NON-KEY-DATA                           <ATHB37> 170210
                                       OF CHDRAFI-PARAMS                <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE COVRAFI-CHDRCOY        TO CHDRAFI-CHDRCOY               <ATHB37> 170210
           MOVE COVRAFI-CHDRNUM        TO CHDRAFI-CHDRNUM               <ATHB37> 170210
           MOVE COVRAFI-TRANNO         TO CHDRAFI-TRANNO                <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE BEGN                   TO CHDRAFI-FUNCTION              <ATHB37> 170210
           PERFORM X3700-CHDRAFI-IO                                     <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE CHDRAFI-BILLFREQ       TO WSAA-BILLFREQ                 <ATHB37> 170210
                                                                        <ATHB37> 170210
           COMPUTE WSAA-INIT-ANNPREM ROUNDED                            <ATHB37> 170210
                                        = COVRAFI-INSTPREM              <ATHB37> 170210
                                        * WSAA-BILLFREQ-NUM             <ATHB37> 170210
           .                                                            <ATHB37> 170210
       2850-EXIT.                                                       <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB37> 170210
       2860-FIND-PAID-PREM SECTION.                                     <ATHB37> 170210
      ***************************                                       <ATHB37> 170210
       2860-START.                                                      <ATHB37> 170210
                                                                        <ATHB37> 170210
           PERFORM VARYING WSAA-IND2 FROM 1 BY 1                        <ATHB37> 170214
              UNTIL WSAA-IND2           > WSAA-COUNT-YEAR               <ATHB37> 170213
                    MOVE WSAA-FROM-DATE-W(WSAA-IND2)                    <ATHB37> 170210
                                       TO WSAA-OCCDATE                  <ATHB37> 170210
                    MOVE WSAA-TO-DATE-W(WSAA-IND2)                      <ATHB37> 170210
                                       TO WSAA-NEXT-ANNI-DATE           <ATHB37> 170210
                                                                        <ATHB37> 170210
                    PERFORM 2865-READ-ACMV-DECREASE                     <ATHB37> 170213
                                                                        <ATHB37> 170210
                    MOVE WSAA-PAID-PREM                                 <ATHB37> 170210
                                       TO WSAA-PAID-PREM-RP(WSAA-IND2)  <ATHB37> 170210
                    MOVE WSAA-PAID-OVRCOM                               <ATHB37> 170210
                                       TO WSAA-PAID-OVRC-RP(WSAA-IND2)  <ATHB37> 170210
                    MOVE WSAA-PAID-COMM                                 <ATHB37> 170210
                                       TO WSAA-PAID-COMM-RP(WSAA-IND2)  <ATHB37> 170210
           END-PERFORM                                                  <ATHB37> 170214
                                                                        <ATHB37> 170210
           EVALUATE WSAA-COUNT-YEAR                                     <ATHB37> 170214
           WHEN 1                                                       <ATHB37> 170214
                PERFORM 2861-FIRST-YEAR-CLAWB                           <ATHB37> 170214
           WHEN OTHER                                                   <ATHB37> 170214
                PERFORM 2862-NEXT-YEAR-CLAWB                            <ATHB37> 170214
           END-EVALUATE                                                 <ATHB37> 170214
                                                                        <ATHB37> 170215
           IF  WSAA-DIFF-PREM         <= 0                              <ATHB37> 170215
               GO TO 2860-EXIT                                          <ATHB37> 170215
           END-IF                                                       <ATHB37> 170215
                                                                        <ATHB37> 170214
      * COMMISSIONABLE PREMIUM                                          <ATHB37> 170214
           COMPUTE WSAA-PAID-PREM-CLAWB ROUNDED                         <ATHB37> 170214
                                       = (WSAA-DIFF-PREM                <ATHB37> 170214
                                       * WSAA-T8Z82)                    <ATHB37> 170214
           MOVE WSAA-PAID-PREM-CLAWB   TO WSAA-PREM-CLAWB               <ATHB37> 170215
                                                                        <ATHB37> 170215
           MOVE WSAA-PAID-PREM-RP(1)   TO WSAA-PAID-PREM                <ATHB37> 170215
           MOVE WSAA-PAID-OVRC-RP(1)   TO WSAA-PAID-OVRCOM              <ATHB37> 170215
           MOVE WSAA-PAID-COMM-RP(1)   TO WSAA-PAID-COMM                <ATHB37> 170215
      * CALCULATE COMMISSIONS                                           <ATHB37> 170214
           PERFORM 2868-CALC-COMM                                       <ATHB37> 170214
      * CALCULATE OVERCOMMISSIONS                                       <ATHB37> 170214
           PERFORM 2869-CALC-OVRCOM                                     <ATHB37> 170214
      * REGISTER CLAWBACK/ CHECK REMAINING AMOUNT                       <ATHB37> 170215
           MOVE ZSCLABCK-LIFE          TO WSAA-ZCLB-LIFE                <ATHB37> 170215
           MOVE ZSCLABCK-COVERAGE      TO WSAA-ZCLB-COVERAGE            <ATHB37> 170215
           MOVE ZSCLABCK-RIDER         TO WSAA-ZCLB-RIDER               <ATHB37> 170215
           MOVE '00'                   TO WSAA-ZCLB-RECODE              <ATHB37> 170215
           MOVE ZSCLABCK-CRTABLE       TO WSAA-CRTABLE                  <ATHB37> 170215
           PERFORM X3000-READ-ZCLBCOV                                   <ATHB37> 170215
           PERFORM X3100-FIND-CLAWB-REMN-REGP                           <ATHB37> 170215
           IF  WSAA-PAID-COMM-CLAWB     = ZEROS                         <ATHB37> 170215
               GO TO 2860-EXIT                                          <ATHB37> 170215
           END-IF                                                       <ATHB37> 170215
                                                                        <ATHB37> 170215
           PERFORM X1900-WRITE-ZCLB                                     <ATHB37> 170215
      * POST COMMISSIONABLE PREMIUM/ COMMISSIONS/OVERCOMMISSIONS        <ATHB37> 170215
           PERFORM X1400-WRITE-LIFA-REGP                                <ATHB37> 170214
           PERFORM X2000-DUE-ACCOUNTINGS                                <ATHB37> 170214
           PERFORM X2100-COLL-ACCOUNTINGS                               <ATHB37> 170214
           .                                                            <ATHB37> 170210
       2860-EXIT.                                                       <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB37> 170210
       2861-FIRST-YEAR-CLAWB SECTION.                                   <ATHB37> 170210
      ***************************                                       <ATHB37> 170210
       2861-START.                                                      <ATHB37> 170210
            IF  WSAA-INIT-ANNPREM       > WSAA-PAID-PREM-RP             <ATHB37> 170210
                                         (WSAA-COUNT-YEAR)              <ATHB37> 170213
                COMPUTE WSAA-DIFF-PREM  = WSAA-INIT-ANNPREM             <ATHB37> 170213
                                        - WSAA-PAID-PREM-RP             <ATHB37> 170210
                                         (WSAA-COUNT-YEAR)              <ATHB37> 170213
            END-IF                                                      <ATHB37> 170210
           .                                                            <ATHB37> 170210
       2861-EXIT.                                                       <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB37> 170210
       2862-NEXT-YEAR-CLAWB SECTION.                                    <ATHB37> 170213
      ******************************                                    <ATHB37> 170213
       2862-START.                                                      <ATHB37> 170210
                                                                        <ATHB37> 170214
      * FIND THE MINIMUM BETWEEN THE INITIAL PREMIUM                    <ATHB37> 170214
      * AND PREVIEWS YEARS PREMIUM                                      <ATHB37> 170214
                                                                        <ATHB37> 170214
            MOVE WSAA-INIT-ANNPREM     TO WSAA-MIN-ANNPREM              <ATHB37> 170214
            PERFORM VARYING WSAA-IND2 FROM 1 BY 1                       <ATHB37> 170214
              UNTIL WSAA-IND2           > (WSAA-COUNT-YEAR - 1)         <ATHB37> 170214
                  IF  WSAA-PAID-PREM-RP(WSAA-IND2)                      <ATHB37> 170214
                                        < WSAA-MIN-ANNPREM              <ATHB37> 170214
                      MOVE WSAA-PAID-PREM-RP(WSAA-IND2)                 <ATHB37> 170214
                                       TO WSAA-MIN-ANNPREM              <ATHB37> 170214
                  END-IF                                                <ATHB37> 170214
            END-PERFORM                                                 <ATHB37> 170214
                                                                        <ATHB37> 170213
            IF  WSAA-MIN-ANNPREM        > WSAA-PAID-PREM-RP             <ATHB37> 170214
                                         (WSAA-COUNT-YEAR)              <ATHB37> 170213
                COMPUTE WSAA-DIFF-PREM  = WSAA-MIN-ANNPREM              <ATHB37> 170214
                                        - WSAA-PAID-PREM-RP             <ATHB37> 170210
                                         (WSAA-COUNT-YEAR)              <ATHB37> 170213
            END-IF                                                      <ATHB37> 170214
           .                                                            <ATHB37> 170210
       2862-EXIT.                                                       <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB37> 170213
       2865-READ-ACMV-DECREASE SECTION.                                 <ATHB37> 170213
      *********************************                                 <ATHB37> 170213
       2865-START.                                                      <ATHB37> 170213
                                                                        <ATHB37> 170213
           INITIALIZE WSAA-ACMV-ARRAY                                   <ATHB37> 170213
           MOVE ZEROS                  TO WSAA-PAID-PREM                <ATHB37> 170215
           MOVE ZEROS                  TO WSAA-PAID-COMM                <ATHB37> 170215
           MOVE ZEROS                  TO WSAA-PAID-OVRCOM              <ATHB37> 170215
           MOVE ZEROS                  TO WSAA-LAST-TRANNO              <ATHB37> 170215
           MOVE ZEROS                  TO WSAA-ACMV-ARRAY-CNT           <ATHB37> 170213
           MOVE ZEROS                  TO WSAA-LAST-TRANNO-W            <ATHB37> 170213
           MOVE ZSCLABCK-CHDRNUM        TO WSAA-ACMV-CHDRNUM            <ATHB37> 170213
           MOVE '01'                   TO WSAA-ACMV-LIFE                <ATHB37> 170213
           MOVE '01'                   TO WSAA-ACMV-COVERAGE            <ATHB37> 170213
           MOVE '00'                   TO WSAA-ACMV-RIDER               <ATHB37> 170213
           MOVE '00'                   TO WSAA-ACMV-PLAN-SUFF           <ATHB37> 170213
                                                                        <ATHB37> 170213
           INITIALIZE ACMVBK3-PARAMS                                    <ATHB37> 170213
           INITIALIZE ACMVBK3REC-KEY-DATA     OF ACMVBK3-PARAMS         <ATHB37> 170213
           INITIALIZE ACMVBK3REC-NON-KEY-DATA OF ACMVBK3-PARAMS         <ATHB37> 170213
           MOVE ZSCLABCK-CHDRCOY       TO ACMVBK3-RLDGCOY               <ATHB37> 170213
           MOVE WSAA-ACMV-RLDGACCT     TO ACMVBK3-RLDGACCT              <ATHB37> 170213
           MOVE WSCC-LE                TO ACMVBK3-SACSCODE              <ATHB37> 170213
           MOVE WSCC-YC                TO ACMVBK3-SACSTYP               <ATHB37> 170213
           MOVE BEGN                   TO ACMVBK3-FUNCTION              <ATHB37> 170213
           PERFORM X1100-ACMVBK3-IO                                     <ATHB37> 170213
           PERFORM                                                      <ATHB37> 170213
             UNTIL ACMVBK3-STATUZ       = ENDP                          <ATHB37> 170213
                                                                        <ATHB37> 170213
                MOVE 'B522'            TO WSAA-BATCTRCDE                <ATHB37> 170213
                PERFORM X2200-READ-PTRNREV                              <ATHB37> 170213
                                                                        <ATHB37> 170213
                IF  VALID-RECORD                                        <ATHB37> 170213
                IF  ACMVBK3-EFFDATE    >= WSAA-OCCDATE                  <ATHB37> 170213
                AND ACMVBK3-EFFDATE    <  WSAA-NEXT-ANNI-DATE           <ATHB37> 170213
                                                                        <ATHB37> 170213
                    PERFORM 2250A-LOAD-ARRAY-ACMV                       <ATHB37> 170213
                                                                        <ATHB37> 170213
                    MOVE ACMVBK3-TRANREF(1:8)                           <ATHB37> 170213
                                        TO WSAA-ACMV-AGNTNUM            <ATHB37> 170213
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHB37> 170213
                    ADD ACMVBK3-ORIGAMT TO WSAA-ACMV-ZPREMAMT           <ATHB37> 170213
                                          (WSAA-ACMV-ARRAY-CNT)         <ATHB37> 170213
                                                                        <ATHB37> 170213
                    COMPUTE WSAA-PAID-PREM                              <ATHB37> 170213
                                        = WSAA-PAID-PREM                <ATHB37> 170213
                                        + ACMVBK3-ORIGAMT               <ATHB37> 170213
                    IF  ACMVBK3-TRANNO NOT = WSAA-LAST-TRANNO           <ATHB37> 170213
                    PERFORM  2255-FIND-COMMISSIONS                      <ATHB37> 170213
                    END-IF                                              <ATHB37> 170213
                    MOVE ACMVBK3-TRANNO TO WSAA-LAST-TRANNO             <ATHB37> 170213
                END-IF                                                  <ATHB37> 170213
                END-IF                                                  <ATHB37> 170213
                                                                        <ATHB37> 170213
                MOVE NEXTR             TO ACMVBK3-FUNCTION              <ATHB37> 170213
                PERFORM X1100-ACMVBK3-IO                                <ATHB37> 170213
           END-PERFORM                                                  <ATHB37> 170213
                                                                        <ATHB37> 170213
           .                                                            <ATHB37> 170213
       2865-EXIT.                                                       <ATHB37> 170213
           EXIT.                                                        <ATHB37> 170213
      /                                                                 <ATHB37> 170213
       2868-CALC-COMM SECTION.                                          <ATHB37> 170214
      ************************                                          <ATHB37> 170214
       2868-START.                                                      <ATHB37> 170213
                                                                        <ATHD11> 181019
           PERFORM X4250-READ-T8Z05                                     <ATHD11> 181019
                                                                        <ATHB37> 170214
           IF MCPPI-PRODUCT                                             <ATHD11> 181019
              MOVE AGCMBCR-RNWCPY     TO WSAA-METHOD-IT                 <ATHB37> 181019
              MOVE COVRAFI-CRTABLE    TO WSAA-CRTABLE-IT                <ATHB37> 181019
              PERFORM X4100-READ-T7Z11                                  <ATHB37> 181019
              PERFORM X4150-GET-T7Z11                                   <ATHB37> 181019
              MOVE WSAA-T7Z11         TO WSAA-COMM-RATE                 <ATHD11> 181019
           ELSE                                                         <ATHD11> 181019
              MOVE COVRAFI-CRTABLE    TO WSAA-READ-CRTABLE              <ATHD11> 181019
              PERFORM X4700-READ-T5687                                  <ATHD11> 181019
              MOVE T5687-RNWCPY       TO WSAA-METHOD-IT                 <ATHD11> 181019
              PERFORM X4300-READ-T5694                                  <ATHD11> 181019
              MOVE 1                  TO WSAA-TERMW                     <ATHD11> 181019
              PERFORM X4350-GET-T5694                                   <ATHD11> 181019
              VARYING WSAA-INDEX        FROM 1                          <ATHD11> 181019
                                          BY 1                          <ATHD11> 181019
                                        UNTIL WSAA-INDEX > 11           <ATHD11> 181019
              MOVE WSAA-T5694         TO WSAA-COMM-RATE                 <ATHD11> 181019
           END-IF                                                       <ATHD11> 181019
                                                                        <ATHD11> 181019
           COMPUTE WSAA-PAID-COMM-CLAWB ROUNDED                         <ATHB37> 170215
                                       = WSAA-PAID-PREM-CLAWB           <ATHB37> 170214
                                       * (WSAA-COMM-RATE                <ATHD11> 181019
                                       / 100)                           <ATHB37> 170214
           .                                                            <ATHB37> 170214
       2868-EXIT.                                                       <ATHB37> 170213
           EXIT.                                                        <ATHB37> 170213
      /                                                                 <ATHB37> 170214
       2869-CALC-OVRCOM SECTION.                                        <ATHB37> 170214
      **************************                                        <ATHB37> 170214
       2869-START.                                                      <ATHB37> 170214
                                                                        <ATHB37> 170214
           PERFORM X4200-READ-T5Z01                                     <ATHB37> 170214
           MOVE T5Z01-ZAACPY          TO WSAA-METHOD-IT                 <ATHB37> 181019
      **   MOVE COVRAFI-CRTABLE       TO WSAA-CRTABLE-IT                <ATHB37> 170302
           PERFORM X4300-READ-T5694                                     <ATHB37> 170302
           MOVE 1                     TO WSAA-TERMW                     <ATHB37> 170302
           PERFORM X4350-GET-T5694                                      <ATHB37> 170302
           VARYING WSAA-INDEX        FROM 1                             <ATHB37> 170302
                                       BY 1                             <ATHB37> 170302
                                    UNTIL WSAA-INDEX > 11               <ATHB37> 170302
                                                                        <ATHB37> 170214
           COMPUTE WSAA-PAID-OVRCOM-CLAWB ROUNDED                       <ATHB37> 170215
                                       = WSAA-PAID-PREM-CLAWB           <ATHB37> 170214
                                       * (WSAA-T5694                    <ATHB37> 170302
                                       / 100)                           <ATHB37> 170214
           .                                                            <ATHB37> 170214
       2869-EXIT.                                                       <ATHB37> 170214
           EXIT.                                                        <ATHB37> 170214
      /                                                                          151104
       3000-TERMINATION SECTION.                                                 151104
      **************************                                                 151104
       3000-START.                                                               151104
                                                                                 151104
            IF  ZSCLABCK-FUNCTION       = WSCC-DECRP                    <ATHB37> 170215
                MOVE WSAA-CLAW-COMM-REMN                                <ATHB37> 170215
                                       TO ZSCLABCK-COMM-REGP            <ATHB37> 170215
                MOVE WSAA-PREM-CLAWB   TO ZSCLABCK-PREM-REGP            <ATHB37> 170215
            ELSE                                                        <ATHB37> 170215
            MOVE WSAA-PAID-COMM-CLAWB  TO ZSCLABCK-COMM-REGP                     151109
            MOVE WSAA-TOT-CLAWB-TOPUP  TO ZSCLABCK-COMM-TOPUP                    151109
            END-IF                                                      <ATHB37> 170215
                                                                                 151104
           MOVE O-K                    TO ZSCLABCK-STATUZ                        151104
           .                                                                     151104
       3000-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                 <ATHD94> 190627
       3100-SURRT-CLAWBACK SECTION.                                     <ATHD94> 190627
      *****************************                                     <ATHD94> 190627
      *                                                                 <ATHD94> 190627
      *        Lapse for term TT05, TT06                                <ATHD94> 190627
      *                                                                 <ATHD94> 190627
       3100-START.                                                      <ATHD94> 190627
      *                                                                 <ATHD94> 190627
      * If clawback is valid then                                       <ATHD94> 190627
      * check that servicing agent is the initial.                      <ATHD94> 190627
      *                                                                 <ATHD94> 190627
           IF  CLAWBACK-REGP                                            <ATHD94> 190627
               IF WSAA-ZCHD-CLNTNUM NOT = WSAA-ZCHA-CLNTNUM             <ATHD94> 190627
                  SET NOT-CLAWBACK-REGP TO TRUE                         <ATHD94> 190627
               END-IF                                                   <ATHD94> 190627
           END-IF                                                       <ATHD94> 190627
                                                                        <ATHD94> 190627
      * FOR REGULAR PREMIUM                                             <ATHD94> 190627
           IF  CLAWBACK-REGP                                            <ATHD94> 190627
               PERFORM 2250-READ-ACMV                                   <ATHD94> 190627
           END-IF                                                       <ATHD94> 190627
                                                                        <ATHD94> 190627
           .                                                            <ATHD94> 190627
       3100-EXIT.                                                       <ATHD94> 190627
           EXIT.                                                        <ATHD94> 190627
                                                                                 151030
      /                                                                          151030
       9000-FATAL-ERROR SECTION.                                                 151030
      **************************                                                 151030
       9000-START.                                                               151030
                                                                                 151030
           MOVE WSAA-SUBR              TO SYSR-SUBRNAME                          151030
           MOVE SYSR-STATUZ            TO ZSCLABCK-STATUZ                        151109
                                                                                 151030
           IF  SYSR-SYSERR-TYPE     NOT = WSCC-TXT-2                             151030
               MOVE WSCC-TXT-1         TO SYSR-SYSERR-TYPE                       151030
           END-IF                                                                151030
                                                                                 151030
           CALL 'SYSERR'            USING SYSR-SYSERR-REC                        151030
           .                                                                     151030
       9000-EXIT.                                                                151030
           GOBACK.                                                               151030
      /                                                                          151112
       X100-ITEM-IO SECTION.                                                     151112
      **********************                                                     151112
       X100-START.                                                               151112
                                                                                 151112
           MOVE ITEMREC                TO ITEM-FORMAT                            151112
                                                                                 151112
           CALL 'ITEMIO'            USING ITEM-PARAMS                            151112
                                                                                 151112
           IF  ITEM-STATUZ          NOT = O-K                                    151112
               MOVE ITEM-PARAMS        TO SYSR-PARAMS                            151112
               MOVE ITEM-STATUZ        TO SYSR-STATUZ                            151112
               PERFORM 9000-FATAL-ERROR                                          151112
           END-IF                                                                151112
           .                                                                     151112
       X100-EXIT.                                                                151112
            EXIT.                                                                151112
      /                                                                          151030
       X200-ZTUD-IO SECTION.                                                     151030
      *************************                                                  151030
       X200-START.                                                               151030
                                                                                 151030
           MOVE ZTUDREC                TO ZTUD-FORMAT                            151030
           CALL 'ZTUDIO'            USING ZTUD-PARAMS.                           151030
                                                                                 151030
           EVALUATE ZTUD-FUNCTION                                                151109
           WHEN  BEGN                                                            151109
                 IF  ZTUD-STATUZ NOT = O-K                                       151109
                 AND ZTUD-STATUZ NOT = ENDP                                      151109
                     MOVE ZTUD-PARAMS         TO SYSR-PARAMS                     151109
                     PERFORM 9000-FATAL-ERROR                                    151109
                 END-IF                                                          151109
                 IF  ZTUD-CHDRCOY   NOT = ZSCLABCK-CHDRCOY                       151109
                 OR  ZTUD-CHDRNUM   NOT = ZSCLABCK-CHDRNUM                       151109
                     MOVE ENDP         TO ZTUD-STATUZ                            151109
                 END-IF                                                          151109
           WHEN  NEXTR                                                           151109
                 IF  ZTUD-STATUZ NOT = O-K                                       151109
                 AND ZTUD-STATUZ NOT = ENDP                                      151109
                     MOVE ZTUD-PARAMS         TO SYSR-PARAMS                     151109
                     PERFORM 9000-FATAL-ERROR                                    151109
                 END-IF                                                          151109
                 IF  ZTUD-CHDRCOY   NOT = ZSCLABCK-CHDRCOY                       151109
                 OR  ZTUD-CHDRNUM   NOT = ZSCLABCK-CHDRNUM                       151109
                     MOVE ENDP         TO ZTUD-STATUZ                            151109
                 END-IF                                                          151109
           WHEN  WRITR                                                           151109
                 IF  ZTUD-STATUZ NOT = O-K                                       151109
                     MOVE ZTUD-PARAMS         TO SYSR-PARAMS                     151109
                     PERFORM 9000-FATAL-ERROR                                    151109
                 END-IF                                                          151109
           END-EVALUATE                                                          151109
           .                                                                     151030
       X200-EXIT.                                                                151030
           EXIT.                                                                 151030
      /                                                                          151104
       X300-AGCMBCR-IO SECTION.                                                  151104
      *************************                                                  151104
       X300-START.                                                               151104
                                                                                 151104
           MOVE O-K                    TO AGCMBCR-STATUZ                         151104
           MOVE AGCMBCRREC             TO AGCMBCR-FORMAT                         151104
                                                                                 151104
           CALL 'AGCMBCRIO'         USING AGCMBCR-PARAMS                         151104
                                                                                 151104
           IF  AGCMBCR-STATUZ       NOT = O-K                                    151104
           AND AGCMBCR-STATUZ       NOT = ENDP                                   151104
              MOVE AGCMBCR-PARAMS      TO SYSR-PARAMS                            151104
              MOVE AGCMBCR-STATUZ      TO SYSR-STATUZ                            151104
              PERFORM 9000-FATAL-ERROR                                           151104
           END-IF                                                                151104
                                                                                 151104
           IF  AGCMBCR-CHDRCOY      NOT = ZSCLABCK-CHDRCOY                       151104
           OR  AGCMBCR-CHDRNUM      NOT = ZSCLABCK-CHDRNUM                       151104
           OR  AGCMBCR-LIFE         NOT = WSCC-01                                151104
           OR  AGCMBCR-COVERAGE     NOT = WSCC-01                                151104
           OR  AGCMBCR-RIDER        NOT = WSCC-00                                151104
               MOVE ENDP               TO AGCMBCR-STATUZ                         151104
           END-IF                                                                151104
           .                                                                     151104
       X300-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151104
       X400-ZCHD-IO SECTION.                                                     151104
      *************************                                                  151104
       X400-START.                                                               151104
                                                                                 151104
           MOVE O-K                 TO ZCHD-STATUZ                               151104
           MOVE ZCHDREC             TO ZCHD-FORMAT                               151104
           CALL 'ZCHDIO'         USING ZCHD-PARAMS                               151104
                                                                                 151104
           IF  ZCHD-STATUZ       NOT = O-K                                       151104
           AND ZCHD-STATUZ       NOT = MRNF                                      151104
              MOVE ZCHD-PARAMS      TO SYSR-PARAMS                               151104
              MOVE ZCHD-STATUZ      TO SYSR-STATUZ                               151104
              PERFORM 9000-FATAL-ERROR                                           151104
           END-IF                                                                151104
           .                                                                     151104
       X400-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151104
       X500-CHDRMJA-IO SECTION.                                                  151104
      *************************                                                  151104
       X500-START.                                                               151104
                                                                                 151104
           MOVE O-K                 TO CHDRMJA-STATUZ                            151104
           MOVE CHDRMJAREC          TO CHDRMJA-FORMAT                            151104
           CALL 'CHDRMJAIO'         USING CHDRMJA-PARAMS                         151104
                                                                                 151104
           IF  CHDRMJA-STATUZ       NOT = O-K                                    151104
           AND CHDRMJA-STATUZ       NOT = MRNF                                   151104
              MOVE CHDRMJA-PARAMS      TO SYSR-PARAMS                            151104
              MOVE CHDRMJA-STATUZ      TO SYSR-STATUZ                            151104
              PERFORM 9000-FATAL-ERROR                                           151104
           END-IF                                                                151104
           .                                                                     151104
       X500-EXIT.                                                                151104
           EXIT.                                                                 151104
      /                                                                          151109
       X600-READ-AGNT  SECTION.                                                  151109
      ***********************************                                        151109
       X600-START.                                                               151109
                                                                                 151109
           INITIALIZE AGNTREC-KEY-DATA     OF AGNT-PARAMS                        151109
           INITIALIZE AGNTREC-NON-KEY-DATA OF AGNT-PARAMS                        151109
                                                                                 151109
           MOVE WSCC-AG                TO AGNT-AGNTPFX                           151109
           MOVE ZSCLABCK-CHDRCOY       TO AGNT-AGNTCOY                           151109
           MOVE WSAA-AGNTNUM           TO AGNT-AGNTNUM                           151123
           MOVE READR                  TO AGNT-FUNCTION                          151109
                                                                                 151109
           PERFORM X650-AGNT-IO                                                  151109
                                                                                 151109
           .                                                                     151109
       X600-EXIT.                                                                151109
           EXIT.                                                                 151109
      /                                                                          151109
       X650-AGNT-IO SECTION.                                                     151109
      *************************                                                  151109
       X650-START.                                                               151109
                                                                                 151109
           MOVE O-K                 TO AGNT-STATUZ                               151109
           MOVE AGNTREC          TO AGNT-FORMAT                                  151109
           CALL 'AGNTIO'         USING AGNT-PARAMS                               151109
                                                                                 151109
           IF  AGNT-STATUZ       NOT = O-K                                       151109
           AND AGNT-STATUZ       NOT = MRNF                                      151109
              MOVE AGNT-PARAMS      TO SYSR-PARAMS                               151109
              MOVE AGNT-STATUZ      TO SYSR-STATUZ                               151109
              PERFORM 9000-FATAL-ERROR                                           151109
           END-IF                                                                151109
           .                                                                     151109
       X650-EXIT.                                                                151109
           EXIT.                                                                 151109
      /                                                                          151106
       X800-ACMVREV-IO SECTION.                                                  151106
      ************************                                                   151106
       X800-START.                                                               151106
                                                                                 151106
           MOVE O-K                    TO ACMVREV-STATUZ                         151106
           MOVE ACMVREVREC             TO ACMVREV-FORMAT                         151106
                                                                                 151106
           CALL 'ACMVREVIO'         USING ACMVREV-PARAMS                         151106
                                                                                 151106
           IF  ACMVREV-STATUZ       NOT = O-K                                    151106
           AND ACMVREV-STATUZ       NOT = ENDP                                   151106
               MOVE ACMVREV-STATUZ     TO SYSR-STATUZ                            151106
               MOVE ACMVREV-PARAMS     TO SYSR-PARAMS                            151106
               PERFORM 9000-FATAL-ERROR                                          151109
           END-IF                                                                151106
                                                                                 151106
           IF  ACMVREV-RLDGCOY      NOT = ACMVBK3-RLDGCOY                        151109
           OR  ACMVREV-RDOCNUM      NOT = ACMVBK3-RDOCNUM                        151109
           OR  ACMVREV-TRANNO       NOT = ACMVBK3-TRANNO                         151109
               MOVE ENDP               TO ACMVREV-STATUZ                         151106
           END-IF                                                                151106
           .                                                                     151106
       X800-EXIT.                                                                151106
           EXIT.                                                                 151106
      /                                                                          151118
       X800A-ACMVREV-IO SECTION.                                                 151118
      ************************                                                   151118
       X800A-START.                                                              151118
                                                                                 151118
           MOVE O-K                    TO ACMVREV-STATUZ                         151118
           MOVE ACMVREVREC             TO ACMVREV-FORMAT                         151118
                                                                                 151118
           CALL 'ACMVREVIO'         USING ACMVREV-PARAMS                         151118
                                                                                 151118
           IF  ACMVREV-STATUZ       NOT = O-K                                    151118
           AND ACMVREV-STATUZ       NOT = ENDP                                   151118
               MOVE ACMVREV-STATUZ     TO SYSR-STATUZ                            151118
               MOVE ACMVREV-PARAMS     TO SYSR-PARAMS                            151118
               PERFORM 9000-FATAL-ERROR                                          151118
           END-IF                                                                151118
                                                                                 151118
           IF  ACMVREV-RLDGCOY      NOT = ZTUD-CHDRCOY                           151118
           OR  ACMVREV-RDOCNUM      NOT = ZTUD-CHDRNUM                           151118
           OR  ACMVREV-TRANNO       NOT = ZTUD-TRANNO                            151118
               MOVE ENDP               TO ACMVREV-STATUZ                         151118
           END-IF                                                                151118
           .                                                                     151118
       X800A-EXIT.                                                               151118
           EXIT.                                                                 151118
      /                                                                          151108
       X900-CLAWBACK-RULES-PERC SECTION.                                         151108
      ***********************************                                        151108
       X900-START.                                                               151108
                                                                                 151108
      *    IF  CHDRMJA-BILLFREQ   NOT  = '00'                                    151123
                                                                                 151108
           MOVE WSAA-FROM-DATE         TO DTC3-INT-DATE-1                        151108
           MOVE ZSCLABCK-EFFDATE       TO DTC3-INT-DATE-2                        151108
                                                                        <ATHB37> 170208
           IF  ZSCLABCK-FUNCTION        = WSCC-DECRP                    <ATHB37> 170208
               MOVE WSAA-FROM-DATE-W(WSAA-COUNT-YEAR)                   <ATHB37> 170208
                                       TO DTC3-INT-DATE-2               <ATHB37> 170208
           END-IF                                                       <ATHB37> 170208
                                                                        <ATHB37> 170208
           MOVE '01'                   TO DTC3-FREQUENCY                         151108
           CALL 'DATCON3'           USING DTC3-DATCON3-REC                       151108
                                                                                 151108
           IF  DTC3-STATUZ          NOT = O-K                                    151108
               MOVE DTC3-DATCON3-REC   TO SYSR-PARAMS                            151108
               MOVE DTC3-STATUZ        TO SYSR-STATUZ                            151108
               PERFORM 9000-FATAL-ERROR                                          151108
           END-IF                                                                151108
           COMPUTE WSAA-TERM            = DTC3-FREQ-FACTOR                       151108
                                        + 0.99999                                151108
                                        + 0.00001                                151223
           END-COMPUTE                                                           151108
                                                                                 151108
      *    ELSE                                                                  151123
      *        MOVE 0                  TO WSAA-TERM                              151123
      *    END-IF                                                                151123
                                                                                 151108
           MOVE 0                      TO WSAA-T8Z82                             151108
                                                                                 151108
           PERFORM X950-GET-T8Z82                                                151108
           VARYING WSAA-INDEX        FROM 1                                      151108
                                       BY 1                                      151108
                                    UNTIL WSAA-INDEX > 11                        151108
           .                                                                     151108
       X900-EXIT.                                                                151108
           EXIT.                                                                 151108
      /                                                                 <ATHA67> 160407
       X900A-CLAWBACK-RULES-PERC-TOP SECTION.                           <ATHA67> 160407
      ***********************************                               <ATHA67> 160407
       X900A-START.                                                     <ATHA67> 160407
                                                                        <ATHA67> 160407
           IF  CHDRMJA-BILLFREQ        = '00'                           <ATHA67> 160407
               MOVE 0                  TO WSAA-TERM                     <ATHA67> 160407
               GO TO X900A-EXIT                                         <ATHA67> 160407
           END-IF                                                       <ATHA67> 160407
                                                                        <ATHA67> 160407
           MOVE WSAA-FROM-DATE         TO DTC3-INT-DATE-1               <ATHA67> 160407
           MOVE ZSCLABCK-EFFDATE       TO DTC3-INT-DATE-2               <ATHA67> 160407
           MOVE '01'                   TO DTC3-FREQUENCY                <ATHA67> 160407
           CALL 'DATCON3'           USING DTC3-DATCON3-REC              <ATHA67> 160407
                                                                        <ATHA67> 160407
           IF  DTC3-STATUZ          NOT = O-K                           <ATHA67> 160407
               MOVE DTC3-DATCON3-REC   TO SYSR-PARAMS                   <ATHA67> 160407
               MOVE DTC3-STATUZ        TO SYSR-STATUZ                   <ATHA67> 160407
               PERFORM 9000-FATAL-ERROR                                 <ATHA67> 160407
           END-IF                                                       <ATHA67> 160407
           COMPUTE WSAA-TERM            = DTC3-FREQ-FACTOR              <ATHA67> 160407
                                        + 0.99999                       <ATHA67> 160407
                                        + 0.00001                       <ATHA67> 160407
           END-COMPUTE                                                  <ATHA67> 160407
                                                                        <ATHA67> 160407
           MOVE 0                      TO WSAA-T8Z82                    <ATHA67> 160407
                                                                        <ATHA67> 160407
           PERFORM X950-GET-T8Z82                                       <ATHA67> 160407
           VARYING WSAA-INDEX        FROM 1                             <ATHA67> 160407
                                       BY 1                             <ATHA67> 160407
                                    UNTIL WSAA-INDEX > 11               <ATHA67> 160407
           .                                                            <ATHA67> 160407
       X900A-EXIT.                                                      <ATHA67> 160407
           EXIT.                                                        <ATHA67> 160407
      /                                                                          151108
       X950-GET-T8Z82 SECTION.                                                   151108
      ************************                                                   151108
       X950-START.                                                               151108
                                                                                 151108
      *  Access table value based on WSAA-TERM                                   151108
                                                                                 151108
           IF  WSAA-TERM            NOT > T8Z82-TO-YEAR(WSAA-INDEX)              151108
               MOVE T8Z82-INSTALPC(WSAA-INDEX)                                   151108
                                       TO WSAA-T8Z82                             151108
               MOVE 13                 TO WSAA-INDEX                             151108
           END-IF                                                                151108
           .                                                                     151108
       X950-EXIT.                                                                151108
           EXIT.                                                                 151108
      /                                                                          151030
       X1100-ACMVBK3-IO SECTION.                                                 151030
      **************************                                                 151030
       X1100-START.                                                              151030
                                                                                 151030
           MOVE O-K                    TO ACMVBK3-STATUZ                         151030
           MOVE ACMVBK3REC             TO ACMVBK3-FORMAT                         151030
                                                                                 151030
           CALL 'ACMVBK3IO'         USING ACMVBK3-PARAMS                         151030
                                                                                 151030
           IF  ACMVBK3-STATUZ       NOT = O-K                                    151030
           AND ACMVBK3-STATUZ       NOT = ENDP                                   151030
               MOVE ACMVBK3-STATUZ     TO SYSR-STATUZ                            151030
               MOVE ACMVBK3-PARAMS     TO SYSR-PARAMS                            151030
               PERFORM 9000-FATAL-ERROR                                          151030
           END-IF                                                                151030
                                                                                 151030
           IF  ACMVBK3-RLDGCOY      NOT = ZSCLABCK-CHDRCOY                       151109
           OR  ACMVBK3-RLDGACCT     NOT = WSAA-ACMV-RLDGACCT                     151030
           OR  ACMVBK3-SACSTYP      NOT = WSCC-YC                                151110
           OR  ACMVBK3-SACSCODE     NOT = WSCC-LE                                151030
               MOVE ENDP               TO ACMVBK3-STATUZ                         151030
           END-IF                                                                151030
           .                                                                     151030
       X1100-EXIT.                                                               151030
           EXIT.                                                                 151030
      /                                                                          151030
       X1150-ACMVBK3-IO SECTION.                                                 151122
      *****************************                                              151030
       X1150-START.                                                              151030
                                                                                 151030
           MOVE O-K                    TO ACMVBK3-STATUZ                         151030
           MOVE ACMVBK3REC             TO ACMVBK3-FORMAT                         151030
                                                                                 151030
           CALL 'ACMVBK3IO'         USING ACMVBK3-PARAMS                         151030
                                                                                 151030
           IF  ACMVBK3-STATUZ       NOT = O-K                                    151030
           AND ACMVBK3-STATUZ       NOT = ENDP                                   151030
               MOVE ACMVBK3-STATUZ     TO SYSR-STATUZ                            151030
               MOVE ACMVBK3-PARAMS     TO SYSR-PARAMS                            151030
               PERFORM 9000-FATAL-ERROR                                          151030
           END-IF                                                                151030
                                                                                 151030
           IF  ACMVBK3-RLDGCOY      NOT = ZSCLABCK-CHDRCOY                       151109
           OR  ACMVBK3-RLDGACCT     NOT = WSAA-ACMV-RLDGACCT                     151030
      **   OR  ACMVBK3-SACSTYP      NOT = WSCC-PS                                151122
      **   OR  ACMVBK3-SACSCODE     NOT = WSCC-LE                                151122
               MOVE ENDP               TO ACMVBK3-STATUZ                         151030
           END-IF                                                                151030
           .                                                                     151030
       X1150-EXIT.                                                               151030
           EXIT.                                                                 151030
      /                                                                          151110
       X1250-ZTUH-IO SECTION.                                                    151110
      **************************                                                 151110
       X1250-START.                                                              151110
                                                                                 151110
           MOVE O-K                    TO ZTUH-STATUZ                            151110
           MOVE ZTUHREC             TO ZTUH-FORMAT                               151110
                                                                                 151110
           CALL 'ZTUHIO'         USING ZTUH-PARAMS                               151110
                                                                                 151110
           IF  ZTUH-STATUZ       NOT = O-K                                       151110
           AND ZTUH-STATUZ       NOT = MRNF                                      151110
               MOVE ZTUH-STATUZ     TO SYSR-STATUZ                               151110
               MOVE ZTUH-PARAMS     TO SYSR-PARAMS                               151110
               PERFORM 9000-FATAL-ERROR                                          151110
           END-IF                                                                151110
                                                                                 151110
           .                                                                     151110
       X1250-EXIT.                                                               151110
           EXIT.                                                                 151110
      /                                                                 <ATHA39> 151110
       X1270-WRITE-ZTUHTRN SECTION.                                              151110
      *****************************                                     <ATHA39> 151110
       X1270-START.                                                     <ATHA39> 151110
           INITIALIZE ZTUHTRN-PARAMS                                             151110
           INITIALIZE ZTUHTRNREC-KEY-DATA  OF ZTUHTRN-PARAMS                     151110
           INITIALIZE ZTUHTRNREC-NON-KEY-DATA OF ZTUHTRN-PARAMS                  151110
                                                                        <ATHA39> 151110
           MOVE ZTUH-CHDRCOY           TO ZTUHTRN-CHDRCOY                        151110
           MOVE ZTUH-CHDRNUM           TO ZTUHTRN-CHDRNUM                        151110
           MOVE ZTUH-RECODE            TO ZTUHTRN-RECODE                         151110
           MOVE ZSCLABCK-TRANNO        TO ZTUHTRN-TRANNO                         151110
           MOVE ZSCLABCK-EFFDATE       TO ZTUHTRN-PRCDATE                        151110
           MOVE ZTUH-EFFDATE           TO ZTUHTRN-EFFDATE                        151123
           MOVE ZTUH-CNTTYPE           TO ZTUHTRN-CNTTYPE                        151123
           MOVE ZTUH-CRTABLE           TO ZTUHTRN-CRTABLE                        151123
           MOVE ZTUH-JSTATUS           TO ZTUHTRN-JSTATUS                        151208
           IF  ZSCLABCK-FUNCTION        = WSCC-SURFS                             151208
           MOVE WSCC-SU                TO ZTUHTRN-JSTATUS                        151208
           END-IF                                                                151208
           IF  ZSCLABCK-FUNCTION        = WSCC-SURCF                             151208
           MOVE WSCC-CF                TO ZTUHTRN-JSTATUS                        151208
           END-IF                                                                151208
           MOVE ZSCLABCK-EFFDATE       TO ZTUHTRN-STATDATE                       151110
                                                                        <ATHA43> 160323
           IF  ZSCLABCK-FUNCTION        = WSCC-SURFS                    <ATHA43> 160323
           OR  ZSCLABCK-FUNCTION        = WSCC-SURCF                    <ATHA43> 160323
           MOVE ZEROS                  TO ZTUHTRN-ORIG-INST                      151110
           MOVE ZEROS                  TO ZTUHTRN-ZREMPRM                        151110
           ELSE                                                         <ATHC41> 180308
                MOVE ZTUH-ORIG-INST    TO ZTUHTRN-ORIG-INST             <ATHC41> 180308
                MOVE ZTUH-ZREMPRM      TO ZTUHTRN-ZREMPRM               <ATHC41> 180308
           END-IF                                                       <ATHA43> 160323
                                                                                 151110
           MOVE WSCC-TXT-1             TO ZTUHTRN-VALIDFLAG                      151110
                                                                        <ATHA39> 151110
           MOVE WRITR                  TO ZTUHTRN-FUNCTION                       151110
           PERFORM X1275-ZTUHTRN-IO                                              151110
           .                                                            <ATHA39> 151110
       X1270-EXIT.                                                      <ATHA39> 151110
           EXIT.                                                        <ATHA39> 151110
      /                                                                 <ATHA39> 151110
       X1275-ZTUHTRN-IO SECTION.                                                 151110
      **************************                                        <ATHA39> 151110
       X1275-START.                                                     <ATHA39> 151110
                                                                        <ATHA39> 151110
           MOVE O-K                    TO ZTUHTRN-STATUZ                         151110
           MOVE ZTUHTRNREC             TO ZTUHTRN-FORMAT                         151110
                                                                        <ATHA39> 151110
           CALL 'ZTUHTRNIO'         USING ZTUHTRN-PARAMS                         151110
                                                                        <ATHA39> 151110
           IF  ZTUHTRN-STATUZ       NOT = O-K                                    151110
               MOVE ZTUHTRN-STATUZ     TO SYSR-STATUZ                            151110
               MOVE ZTUHTRN-PARAMS     TO SYSR-PARAMS                            151110
               PERFORM 9000-FATAL-ERROR                                          151110
           END-IF                                                       <ATHA39> 151110
           .                                                            <ATHA39> 151110
       X1275-EXIT.                                                               151110
           EXIT.                                                        <ATHA39> 151110
      /                                                                 <ATHA39> 151111
       X1400-WRITE-LIFA-REGP SECTION.                                            151111
      *******************************                                   <ATHA39> 151111
       X1400-START.                                                              151111
                                                                                 151116
           MOVE 'IT'                   TO DESC-DESCPFX.                          151116
           MOVE ZSCLABCK-CHDRCOY       TO DESC-DESCCOY.                          151116
           MOVE T5645                  TO DESC-DESCTABL.                         151116
           MOVE 'E'                    TO DESC-LANGUAGE.                         151116
           MOVE 'ZSCLAWBA'             TO DESC-DESCITEM                          151116
           MOVE READR                  TO DESC-FUNCTION.                         151116
           CALL 'DESCIO' USING DESC-PARAMS.                                      151116
           IF DESC-STATUZ              NOT = O-K                                 151116
               MOVE DESC-PARAMS        TO SYSR-PARAMS                            151116
               PERFORM 9000-FATAL-ERROR                                          151116
           END-IF                                                                151116
           MOVE DESC-LONGDESC          TO LIFA-TRANDESC                          151116
      *  Populate LIFA- common fields                                            151111
      *                                                                          151111
           MOVE ZSCLABCK-BATCKEY           TO LIFA-BATCKEY                       151111
           MOVE ZSCLABCK-TRANSACTION-TIME  TO LIFA-TRANSACTION-TIME              151111
           MOVE ZSCLABCK-TRANSACTION-DATE  TO LIFA-TRANSACTION-DATE              151111
           MOVE ZSCLABCK-TERMID            TO LIFA-TERMID                        151111
           MOVE ZSCLABCK-USER              TO LIFA-USER                          151111
           MOVE ZSCLABCK-CHDRNUM           TO LIFA-RDOCNUM                       151111
           MOVE ZSCLABCK-CHDRCOY       TO LIFA-RLDGCOY                           151111
                                          LIFA-GENLCOY                           151111
           MOVE CHDRMJA-CNTCURR        TO LIFA-ORIGCURR                          151111
           MOVE ZSCLABCK-TRANNO        TO LIFA-TRANNO                            151111
           MOVE +0                     TO WSAA-JRNSEQ                            151112
           MOVE 0                      TO LIFA-CRATE                             151111
                                          LIFA-ACCTAMT                           151111
                                          LIFA-RCAMT                             151111
           MOVE SPACES                 TO LIFA-GENLCUR                           151111
                                          LIFA-POSTYEAR                          151111
                                          LIFA-POSTMONTH                         151111
           MOVE ZSCLABCK-EFFDATE       TO LIFA-EFFDATE                           151111
           MOVE VRCM-MAX-DATE          TO LIFA-FRCDATE                           151111
           MOVE CHDRMJA-CNTTYPE        TO LIFA-SUBSTITUTE-CODE(01)               151111
           MOVE +0                     TO WSAA-JRNSEQ                            151111
           .                                                                     151111
       X1400-EXIT.                                                               151111
           EXIT.                                                                 151111
      /                                                                          151111
       X1450-POST-COMM SECTION.                                                  151111
      ************************                                                   151111
       X1450-START.                                                              151111
                                                                                 151111
           MOVE WSAA-T5645-SACSCODE(IX-SA)  TO LIFA-SACSCODE                     151113
           MOVE WSAA-T5645-SACSTYPE(IX-SA)  TO LIFA-SACSTYP                      151113
           MOVE WSAA-T5645-GLMAP   (IX-SA)  TO LIFA-GLCODE                       151113
           MOVE WSAA-T5645-SIGN    (IX-SA)  TO LIFA-GLSIGN                       151113
           MOVE WSAA-T5645-CNTTOT  (IX-SA)  TO LIFA-CONTOT                       151113
                                                                                 151111
           MOVE WSAA-CRTABLE           TO LIFA-SUBSTITUTE-CODE(06)               151111
                                                                                 151111
           ADD +1                      TO WSAA-JRNSEQ                            151111
           MOVE WSAA-JRNSEQ            TO LIFA-JRNSEQ                            151111
                                                                                 151111
           MOVE 'PSTW'                 TO LIFA-FUNCTION                          151111
                                                                                 151111
           CALL 'LIFACMV'           USING LIFA-LIFACMV-REC                       151111
                                                                                 151111
           IF  LIFA-STATUZ          NOT = O-K                                    151111
               MOVE LIFA-LIFACMV-REC   TO SYSR-PARAMS                            151111
               MOVE LIFA-STATUZ        TO SYSR-STATUZ                            151111
               PERFORM 9000-FATAL-ERROR                                          151111
           END-IF                                                                151111
           .                                                                     151111
       X1450-EXIT.                                                               151111
            EXIT.                                                                151111
      /                                                                 <ATHA07> 151110
       X1800-RETRIEVE-ZCHA-AGNTNUM SECTION.                                      151110
      *************************************                                      151110
       X1800-START.                                                              151110
                                                                                 151110
           INITIALIZE ZCHA-PARAMS                                                151110
           INITIALIZE ZCHAREC-KEY-DATA      OF ZCHA-PARAMS                       151110
           INITIALIZE ZCHAREC-NON-KEY-DATA  OF ZCHA-PARAMS                       151110
                                                                                 151110
           MOVE CHDRMJA-CHDRCOY        TO ZCHA-CHDRCOY                           151110
           MOVE CHDRMJA-CHDRNUM        TO ZCHA-CHDRNUM                           151110
           MOVE ZSCLABCK-EFFDATE       TO ZCHA-CURRFROM                          151110
                                                                                 151110
           MOVE ENDR                   TO ZCHA-FUNCTION                          151110
           PERFORM X1850-CALL-ZCHAIO                                             151110
           IF  ZCHA-CHDRCOY         NOT = CHDRMJA-CHDRCOY                        151110
           OR  ZCHA-CHDRNUM         NOT = CHDRMJA-CHDRNUM                        151110
               MOVE ENDP           TO ZCHA-STATUZ                                151110
           END-IF                                                                151110
                                                                                 151110
           MOVE ZCHA-FORMAT            TO WSAA-SYSR-FORMAT                       151110
           MOVE CHDRMJA-CHDRNUM        TO WSAA-SYSR-CHDRNUM                      151110
           IF  ZCHA-STATUZ      NOT = O-K                                        151110
               MOVE WSAA-SYSR-PARAMS                                             151110
                                   TO SYSR-PARAMS                                151110
               MOVE ZCHA-STATUZ    TO SYSR-STATUZ                                151110
               PERFORM 9000-FATAL-ERROR                                          151110
           END-IF                                                                151110
           MOVE ZCHA-CLNTNUM       TO WSAA-ZCHA-CLNTNUM                          151110
           .                                                                     151110
       X1800-EXIT.                                                               151110
           EXIT.                                                                 151110
      /                                                                          151110
       X1850-CALL-ZCHAIO SECTION.                                                151110
      ***************************                                                151110
       X1850-START.                                                              151110
                                                                                 151110
           MOVE O-K                    TO ZCHA-STATUZ                            151110
           MOVE ZCHAREC                TO ZCHA-FORMAT                            151110
                                                                                 151110
           CALL 'ZCHAIO'            USING ZCHA-PARAMS                            151110
                                                                                 151110
           MOVE ZCHA-FORMAT            TO WSAA-SYSR-FORMAT                       151110
           MOVE CHDRMJA-CHDRNUM        TO WSAA-SYSR-CHDRNUM                      151110
           IF  ZCHA-STATUZ          NOT = O-K                                    151110
           AND ZCHA-STATUZ          NOT = ENDP                                   151110
               MOVE WSAA-SYSR-PARAMS   TO SYSR-PARAMS                            151110
               MOVE ZCHA-STATUZ        TO SYSR-STATUZ                            151110
               PERFORM 9000-FATAL-ERROR                                          151110
           END-IF                                                                151110
           .                                                                     151110
       X1850-EXIT.                                                               151110
           EXIT.                                                                 151110
      /                                                                          151112
       X1900-WRITE-ZCLB SECTION.                                                 151112
      *********************************                                          151112
       X1900-START.                                                              151112
           IF  WSAA-PAID-COMM-CLAWB     = ZEROS                                  151112
               GO TO X1900-EXIT                                                  151112
           END-IF                                                                151112
                                                                                 151112
           INITIALIZE ZCLB-PARAMS                                                151112
           INITIALIZE ZCLBREC-KEY-DATA     OF ZCLB-PARAMS                        151112
           INITIALIZE ZCLBREC-NON-KEY-DATA OF ZCLB-PARAMS                        151112
                                                                                 151112
           MOVE CHDRMJA-CHDRCOY        TO ZCLB-CHDRCOY                           151112
           MOVE CHDRMJA-CHDRNUM        TO ZCLB-CHDRNUM                           151112
           MOVE ZSCLABCK-TRANNO        TO ZCLB-TRANNO                            151112
           MOVE '01'                   TO ZCLB-LIFE                              151112
           MOVE '01'                   TO ZCLB-COVERAGE                          151112
           MOVE '00'                   TO ZCLB-RIDER                             151112
           MOVE ZSCLABCK-EFFDATE       TO ZCLB-PRCDATE                           151112
           MOVE ZSCLABCK-EFFDATE       TO ZCLB-EFFDATE                           151112
           MOVE ZSCLABCK-BATCTRCDE     TO ZCLB-BATCTRCDE                         151112
                                                                                 151214
           MOVE WSAA-PAID-PREM         TO ZCLB-ZINTPREM                          151214
           MOVE WSAA-PAID-COMM         TO ZCLB-ZINTCOMM01                        151214
           MOVE WSAA-PAID-OVRCOM       TO ZCLB-ZINTCOMM02                        151214
                                                                                 151214
           COMPUTE ZCLB-ZPREMAMT        = WSAA-PAID-PREM-CLAWB                   151112
                                        * WSCC-NUM--1                            151112
           END-COMPUTE                                                           151112
           COMPUTE ZCLB-ZCOMMAMT01      = WSAA-PAID-COMM-CLAWB                   151112
                                        * WSCC-NUM--1                            151112
           END-COMPUTE                                                           151112
           COMPUTE ZCLB-ZCOMMAMT02      = WSAA-PAID-OVRCOM-CLAWB                 151112
                                        * WSCC-NUM--1                            151112
           END-COMPUTE                                                           151112
           MOVE WSAA-AGNTNUM                                                     151112
                                       TO ZCLB-AGNTNUM                           151112
           PERFORM XA25-CALL-ALOCNO                                              151112
           MOVE WSAA-JPREMREG          TO ZCLB-JPREMREG                          151112
           MOVE WSAA-ZCLB-RECODE       TO ZCLB-RECODE                   <ATHA67> 160408
           MOVE WSAA-PARTS-PERC        TO ZCLB-PERCREQD                 <ATHA67> 160406
           COMPUTE ZCLB-PRCNT ROUNDED   = WSAA-T8Z82                    <ATHA67> 160408
                                        * 100                           <ATHA67> 160408
                                                                                 151112
           MOVE WRITR                  TO ZCLB-FUNCTION                          151112
           PERFORM X1950-ZCLB-IO                                                 151112
           .                                                                     151112
       X1900-EXIT.                                                               151112
           EXIT.                                                                 151112
      /                                                                          151112
       X1950-ZCLB-IO SECTION.                                                    151112
      **************************                                                 151112
       X1950-START.                                                              151112
                                                                                 151112
           MOVE O-K                 TO ZCLB-STATUZ                               151112
           MOVE ZCLBREC             TO ZCLB-FORMAT                               151112
                                                                                 151112
           CALL 'ZCLBIO'         USING ZCLB-PARAMS                               151112
                                                                                 151112
           IF  ZCLB-STATUZ       NOT = O-K                                       151112
               MOVE ZCLB-STATUZ     TO SYSR-STATUZ                               151112
               MOVE ZCLB-PARAMS     TO SYSR-PARAMS                               151112
               PERFORM 9000-FATAL-ERROR                                          151112
           END-IF                                                                151112
           .                                                                     151112
       X1950-EXIT.                                                               151112
           EXIT.                                                        <ATHA39> 151112
      /                                                                          151116
       X1900A-WRITE-ZCLB-TOPUP SECTION.                                          151116
      *********************************                                          151116
       X1900A-START.                                                             151122
                                                                                 151116
           INITIALIZE ZCLB-PARAMS                                                151116
           INITIALIZE ZCLBREC-KEY-DATA     OF ZCLB-PARAMS                        151116
           INITIALIZE ZCLBREC-NON-KEY-DATA OF ZCLB-PARAMS                        151116
                                                                                 151116
           MOVE CHDRMJA-CHDRCOY        TO ZCLB-CHDRCOY                           151116
           MOVE CHDRMJA-CHDRNUM        TO ZCLB-CHDRNUM                           151116
           MOVE ZSCLABCK-TRANNO        TO ZCLB-TRANNO                            151116
      ***  MOVE '01'                   TO ZCLB-LIFE                     <ATHB45> 170313
      ***  MOVE '02'                   TO ZCLB-COVERAGE                 <ATHB45> 170313
      ***  MOVE '00'                   TO ZCLB-RIDER                    <ATHB45> 170313
           MOVE WSAA-TU-LIFE           TO ZCLB-LIFE                     <ATHB45> 170313
           MOVE WSAA-TU-COVERAGE       TO ZCLB-COVERAGE                 <ATHB45> 170313
           MOVE WSAA-TU-RIDER          TO ZCLB-RIDER                    <ATHB45> 170313
           MOVE ZSCLABCK-EFFDATE       TO ZCLB-PRCDATE                           151116
           MOVE ZSCLABCK-EFFDATE       TO ZCLB-EFFDATE                           151116
           MOVE ZSCLABCK-BATCTRCDE     TO ZCLB-BATCTRCDE                         151116
                                                                                 151214
           MOVE WSAA-PAID-PREM         TO ZCLB-ZINTPREM                          151214
           MOVE WSAA-PAID-COMM         TO ZCLB-ZINTCOMM01                        151214
           MOVE WSAA-PAID-OVRCOM       TO ZCLB-ZINTCOMM02                        151214
                                                                                 151214
           COMPUTE ZCLB-ZPREMAMT        = WSAA-TOT-CLAWB-NET                     151116
                                        * WSCC-NUM--1                            151116
           END-COMPUTE                                                           151116
           COMPUTE ZCLB-ZCOMMAMT01      = WSAA-TOT-CLAWB-TOPUP                   151116
                                        * WSCC-NUM--1                            151116
           END-COMPUTE                                                           151116
           COMPUTE ZCLB-ZCOMMAMT02      = WSAA-TOT-CLAWB-OVRAMT                  151116
                                        * WSCC-NUM--1                            151116
           END-COMPUTE                                                           151116
           MOVE WSAA-AGNTNUM                                                     151116
                                       TO ZCLB-AGNTNUM                           151116
           PERFORM XA25-CALL-ALOCNO                                              151116
           MOVE WSAA-JPREMREG          TO ZCLB-JPREMREG                          151116
                                                                                 151116
           MOVE WRITR                  TO ZCLB-FUNCTION                          151116
           PERFORM X1950-ZCLB-IO                                                 151116
           .                                                                     151116
       X1900A-EXIT.                                                              151116
           EXIT.                                                                 151116
      /                                                                          151214
       X1900B-WRITE-ZCLB-TOPUP SECTION.                                          151214
      *********************************                                          151214
       X1900B-START.                                                             151214
                                                                                 151214
           INITIALIZE ZCLB-PARAMS                                                151214
           INITIALIZE ZCLBREC-KEY-DATA     OF ZCLB-PARAMS                        151214
           INITIALIZE ZCLBREC-NON-KEY-DATA OF ZCLB-PARAMS                        151214
                                                                                 151214
           MOVE CHDRMJA-CHDRCOY        TO ZCLB-CHDRCOY                           151214
           MOVE CHDRMJA-CHDRNUM        TO ZCLB-CHDRNUM                           151214
           MOVE ZSCLABCK-TRANNO        TO ZCLB-TRANNO                            151214
      ***  MOVE '01'                   TO ZCLB-LIFE                     <ATHB45> 170313
      ***  MOVE '02'                   TO ZCLB-COVERAGE                 <ATHB45> 170313
      ***  MOVE '00'                   TO ZCLB-RIDER                    <ATHB45> 170313
           MOVE WSAA-TU-LIFE           TO ZCLB-LIFE                     <ATHB45> 170313
           MOVE WSAA-TU-COVERAGE       TO ZCLB-COVERAGE                 <ATHB45> 170313
           MOVE WSAA-TU-RIDER          TO ZCLB-RIDER                    <ATHB45> 170313
           MOVE ZSCLABCK-EFFDATE       TO ZCLB-PRCDATE                           151214
           MOVE WSAA-FROM-DATE         TO ZCLB-EFFDATE                           151214
           MOVE ZSCLABCK-BATCTRCDE     TO ZCLB-BATCTRCDE                         151214
           MOVE WSAA-PAID-PREM         TO ZCLB-ZINTPREM                          151214
           MOVE WSAA-PAID-COMM         TO ZCLB-ZINTCOMM01                        151214
           MOVE WSAA-PAID-OVRCOM       TO ZCLB-ZINTCOMM02                        151214
           COMPUTE ZCLB-ZPREMAMT        = WSAA-CLAWBACK-NET                      151214
                                        * WSCC-NUM--1                            151214
           END-COMPUTE                                                           151214
           COMPUTE ZCLB-ZCOMMAMT01      = WSAA-CLAWBACK-TOPUP                    151214
                                        * WSCC-NUM--1                            151214
           END-COMPUTE                                                           151214
           COMPUTE ZCLB-ZCOMMAMT02      = WSAA-CLAWBACK-OVRAMT                   151214
                                        * WSCC-NUM--1                            151214
           END-COMPUTE                                                           151214
           MOVE WSAA-AGNTNUM                                                     151214
                                       TO ZCLB-AGNTNUM                           151214
           PERFORM XA25-CALL-ALOCNO                                              151214
           MOVE WSAA-JPREMREG          TO ZCLB-JPREMREG                          151214
           MOVE WSAA-ZCLB-RECODE       TO ZCLB-RECODE                   <ATHA67> 160406
           MOVE WSAA-PARTS-PERC        TO ZCLB-PERCREQD                 <ATHA67> 160406
           COMPUTE ZCLB-PRCNT ROUNDED   = WSAA-T8Z82                    <ATHA67> 160408
                                        * 100                           <ATHA67> 160408
                                                                                 151214
           MOVE WRITR                  TO ZCLB-FUNCTION                          151214
           PERFORM X1950-ZCLB-IO                                                 151214
           .                                                                     151214
       X1900B-EXIT.                                                              151214
           EXIT.                                                                 151214
      /                                                                          151113
       X2000-DUE-ACCOUNTINGS SECTION.                                            151113
      *******************************                                            151113
       X2000-START.                                                              151113
                                                                                 151113
           PERFORM X2050-READ-AGLF                                               151113
                                                                                 151113
           IF  WSAA-PAID-OVRCOM-CLAWB                                            151113
                                        > ZEROS                                  151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151113
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151113
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151113
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151113
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
      **       MOVE WSAA-PAID-OVRCOM-CLAWB                                       151113
      **                               TO LIFA-ORIGAMT                           151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-OVRCOM-CLAWB                 151113
                                        * WSCC-NUM--1                            151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 11                 TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE 12                 TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
           IF  WSAA-PAID-COMM-CLAWB                                              151113
                                        > ZEROS                                  151113
      **       MOVE WSAA-PAID-COMM-CLAWB                                         151113
      **                               TO LIFA-ORIGAMT                           151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-COMM-CLAWB                   151113
                                        * WSCC-NUM--1                            151113
               MOVE SPACES             TO LIFA-RLDGACCT                          151113
               MOVE SPACES             TO LIFA-RLDGACCT                          151113
               MOVE WSAA-AGNTNUM       TO LIFA-RLDGACCT                          151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 8                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
                                                                                 151113
               MOVE SPACES             TO LIFA-RLDGACCT                          151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151113
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151113
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151113
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151113
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
               MOVE WSAA-AGNTNUM       TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 7                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
                                                                                 151113
           IF  WSAA-PAID-PREM-CLAWB                                              151113
                                        > ZEROS                                  151113
           AND WSAA-PAID-COMM-CLAWB                                              151113
                                        > ZEROS                                  151113
      **       MOVE WSAA-PAID-PREM-CLAWB                                         151113
      **                               TO LIFA-ORIGAMT                           151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-PREM-CLAWB                   151113
                                        * WSCC-NUM--1                            151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151113
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151113
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151113
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151113
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
               MOVE WSAA-AGNTNUM       TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 15                 TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
               MOVE 16                 TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
           .                                                                     151113
       X2000-EXIT.                                                               151113
           EXIT.                                                                 151113
      /                                                                          151113
       X2050-READ-AGLF SECTION.                                                  151113
      *******************************                                            151113
       X2050-START.                                                              151113
                                                                                 151113
           INITIALIZE AGLFREC-KEY-DATA OF AGLF-PARAMS                            151113
           INITIALIZE AGLFREC-NON-KEY-DATA                                       151113
                                       OF AGLF-PARAMS                            151113
           MOVE ZSCLABCK-CHDRCOY       TO AGLF-AGNTCOY                           151113
           MOVE WSAA-AGNTNUM           TO AGLF-AGNTNUM                           151113
           MOVE READR                  TO AGLF-FUNCTION                          151113
           CALL 'AGLFIO'            USING AGLF-PARAMS                            151113
                                                                                 151113
           IF  AGLF-STATUZ          NOT = O-K                                    151113
           AND AGLF-STATUZ          NOT = MRNF                                   151113
               MOVE AGLF-PARAMS         TO SYSR-PARAMS                           151113
               MOVE AGLF-STATUZ         TO SYSR-STATUZ                           151113
               PERFORM 9000-FATAL-ERROR                                          151113
           END-IF                                                                151113
                                                                                 151113
           MOVE AGLF-JAGNTLVL          TO WSAA-TRANAGNT                          151113
           MOVE AGLF-JAGNTLVL          TO WSAA-TRANAGNT-TOP                      151214
           .                                                                     151113
       X2050-EXIT.                                                               151113
           EXIT.                                                                 151113
      /                                                                          151113
       X2100-COLL-ACCOUNTINGS SECTION.                                           151113
      *******************************                                            151113
       X2100-START.                                                              151113
                                                                                 151113
           IF  WSAA-PAID-OVRCOM-CLAWB                                            151113
                                        > ZEROS                                  151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151113
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151113
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151113
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151113
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
      **                                                                         151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-OVRCOM-CLAWB                 151113
                                        * WSCC-NUM--1                            151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE 1                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE 2                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
                                                                                 151113
           IF  WSAA-PAID-COMM-CLAWB                                              151113
                                        > ZEROS                                  151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-COMM-CLAWB                   151113
                                        * WSCC-NUM--1                            151113
                                                                                 151113
               MOVE SPACES             TO LIFA-RLDGACCT                          151113
               MOVE WSAA-AGNTNUM       TO LIFA-RLDGACCT                          151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 3                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
               MOVE 'Y'                TO WSAA-EXT-IGNORE                        151113
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151114
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151114
               MOVE 4                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
           MOVE ' '                TO WSAA-EXT-IGNORE                            151113
           IF  WSAA-PAID-PREM-CLAWB                                              151113
                                        > ZEROS                                  151113
           AND WSAA-PAID-COMM-CLAWB                                              151113
                                        > ZEROS                                  151113
      **       MOVE WSAA-PAID-PREM-CLAWB                                         151113
      **                               TO LIFA-ORIGAMT                           151113
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-PREM-CLAWB                   151113
                                        * WSCC-NUM--1                            151113
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151113
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151113
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151113
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151113
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151113
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151113
               MOVE WSAA-AGNTNUM       TO WSAA-TRANCHDR                          151113
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151113
               MOVE 5                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
               MOVE 6                  TO IX-SA                                  151113
               PERFORM X1450-POST-COMM                                           151113
           END-IF                                                                151113
           .                                                                     151113
       X2100-EXIT.                                                               151113
           EXIT.                                                                 151113
      /                                                                          151122
       X2110-SP-ACCOUNTINGS SECTION.                                             151122
      *******************************                                            151122
       X2110-START.                                                              151122
                                                                                 151122
           PERFORM X2050-READ-AGLF                                               151123
           IF  WSAA-PAID-OVRCOM-CLAWB                                            151122
                                        > ZEROS                                  151122
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151122
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151122
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151122
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151122
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151122
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151122
      **                                                                         151122
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-OVRCOM-CLAWB                 151122
                                        * WSCC-NUM--1                            151122
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151122
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151122
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151122
               MOVE 1                  TO IX-SA                                  151122
               PERFORM X1450-POST-COMM                                           151122
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151122
               MOVE 11                 TO IX-SA                         <ATHA67> 160407
               PERFORM X1450-POST-COMM                                           151122
           END-IF                                                                151122
                                                                                 151122
           IF  WSAA-PAID-COMM-CLAWB                                              151122
                                        > ZEROS                                  151122
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-COMM-CLAWB                   151122
                                        * WSCC-NUM--1                            151122
               MOVE SPACES             TO LIFA-RLDGACCT                          151122
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151122
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151122
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151122
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151122
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151122
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151122
      *        MOVE WSAA-AGNTNUM       TO WSAA-TRANCHDR                          151123
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151123
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151122
               MOVE 17                 TO IX-SA                                  151122
               PERFORM X1450-POST-COMM                                           151122
               MOVE SPACES             TO LIFA-RLDGACCT                          151122
               MOVE WSAA-AGNTNUM       TO LIFA-RLDGACCT                          151122
               MOVE ZSCLABCK-CHDRNUM   TO WSAA-TRANCHDR                          151122
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151122
               MOVE 18                 TO IX-SA                                  151122
               PERFORM X1450-POST-COMM                                           151122
                                                                                 151122
           END-IF                                                                151122
                                                                                 151122
           MOVE ' '                TO WSAA-EXT-IGNORE                            151122
           IF  WSAA-PAID-PREM-CLAWB                                              151122
                                        > ZEROS                                  151122
           AND WSAA-PAID-COMM-CLAWB                                              151122
                                        > ZEROS                                  151122
      **       MOVE WSAA-PAID-PREM-CLAWB                                         151122
      **                               TO LIFA-ORIGAMT                           151122
               COMPUTE LIFA-ORIGAMT     = WSAA-PAID-PREM-CLAWB                   151122
                                        * WSCC-NUM--1                            151122
               MOVE ZSCLABCK-CHDRNUM       TO WSAA-RLDG-CHDRNUM                  151122
               MOVE '01'                   TO WSAA-RLDG-LIFE                     151122
               MOVE '01'                   TO WSAA-RLDG-COVERAGE                 151122
               MOVE '00'                   TO WSAA-RLDG-RIDER                    151122
               MOVE 0000                   TO WSAA-RLDG-PLAN-SUFFIX              151122
               MOVE WSAA-RLDGACCT          TO LIFA-RLDGACCT                      151122
               MOVE WSAA-AGNTNUM       TO WSAA-TRANCHDR                          151122
               MOVE WSAA-TRANREF           TO LIFA-TRANREF                       151122
               MOVE 13                 TO IX-SA                                  151123
               PERFORM X1450-POST-COMM                                           151122
               MOVE 14                 TO IX-SA                                  151123
               PERFORM X1450-POST-COMM                                           151122
           END-IF                                                                151122
           .                                                                     151122
       X2110-EXIT.                                                               151122
           EXIT.                                                                 151122
      /                                                                          151114
       X2200-READ-PTRNREV SECTION.                                               151114
      *******************************                                            151114
       X2200-START.                                                              151114
                                                                                 151114
           SET NOT-VALID-RECORD    TO TRUE                                       151114
           INITIALIZE PTRNREVREC-KEY-DATA OF PTRNREV-PARAMS                      151114
           INITIALIZE PTRNREVREC-NON-KEY-DATA                                    151114
                                       OF PTRNREV-PARAMS                         151114
           MOVE ACMVBK3-RLDGCOY       TO PTRNREV-CHDRCOY                         151114
           MOVE ACMVBK3-RDOCNUM        TO PTRNREV-CHDRNUM                        151114
           MOVE ACMVBK3-TRANNO         TO PTRNREV-TRANNO                         151114
           MOVE READR                  TO PTRNREV-FUNCTION                       151114
           CALL 'PTRNREVIO'            USING PTRNREV-PARAMS                      151114
                                                                                 151114
           IF  PTRNREV-STATUZ       NOT = O-K                                    151114
           AND PTRNREV-STATUZ          NOT = MRNF                                151114
               MOVE PTRNREV-PARAMS         TO SYSR-PARAMS                        151114
               MOVE PTRNREV-STATUZ         TO SYSR-STATUZ                        151114
               PERFORM 9000-FATAL-ERROR                                          151114
           END-IF                                                                151114
                                                                                 151114
           IF  PTRNREV-STATUZ           = O-K                                    151114
           AND PTRNREV-BATCTRCDE        = WSAA-BATCTRCDE                         151114
               SET VALID-RECORD        TO TRUE                                   151114
           END-IF                                                                151114
           .                                                                     151114
       X2200-EXIT.                                                               151114
           EXIT.                                                                 151114
      /                                                                 <ATHA67> 160404
       X3000-READ-ZCLBCOV SECTION.                                      <ATHA67> 160404
      *******************************                                   <ATHA67> 160404
       X3000-START.                                                     <ATHA67> 160404
                                                                        <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-PRV-CLAW-PREM            <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-PRV-CLAW-COMM            <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-PRV-CLAW-OVRC            <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-CLAW-PREM-REMN           <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-CLAW-COMM-REMN           <ATHA67> 160404
           MOVE ZEROS                  TO WSAA-CLAW-OVRC-REMN           <ATHA67> 160404
           INITIALIZE ZCLBCOVREC-KEY-DATA OF ZCLBCOV-PARAMS             <ATHA67> 160404
           INITIALIZE ZCLBCOVREC-NON-KEY-DATA                           <ATHA67> 160404
                                       OF ZCLBCOV-PARAMS                <ATHA67> 160404
           MOVE CHDRMJA-CHDRCOY       TO ZCLBCOV-CHDRCOY                <ATHA67> 160404
           MOVE CHDRMJA-CHDRNUM        TO ZCLBCOV-CHDRNUM               <ATHA67> 160404
           MOVE WSAA-ZCLB-LIFE         TO ZCLBCOV-LIFE                  <ATHA67> 160404
           MOVE WSAA-ZCLB-COVERAGE     TO ZCLBCOV-COVERAGE              <ATHA67> 160404
           MOVE WSAA-ZCLB-RIDER        TO ZCLBCOV-RIDER                 <ATHA67> 160404
           MOVE BEGN                   TO ZCLBCOV-FUNCTION              <ATHA67> 160404
           PERFORM X3050-ZCLBCOV-IO                                     <ATHA67> 160404
           PERFORM                                                      <ATHA67> 160404
              UNTIL ZCLBCOV-STATUZ      = ENDP                          <ATHA67> 160404
                                                                        <ATHA67> 160404
                    IF  ZCLBCOV-RECODE         = WSAA-ZCLB-RECODE       <ATHA67> 160406
                    AND WSAA-AGNTNUM           = ZCLBCOV-AGNTNUM        <ATHA67> 160513
                    COMPUTE WSAA-PRV-CLAW-PREM = ZCLBCOV-ZPREMAMT       <ATHA67> 160404
                                               + WSAA-PRV-CLAW-PREM     <ATHA67> 160404
                    COMPUTE WSAA-PRV-CLAW-COMM = ZCLBCOV-ZCOMMAMT01     <ATHA67> 160404
                                               + WSAA-PRV-CLAW-COMM     <ATHA67> 160404
                    COMPUTE WSAA-PRV-CLAW-OVRC = ZCLBCOV-ZCOMMAMT02     <ATHA67> 160404
                                               + WSAA-PRV-CLAW-OVRC     <ATHA67> 160404
                    END-IF                                              <ATHA67> 160406
                                                                        <ATHA67> 160404
              MOVE NEXTR               TO ZCLBCOV-FUNCTION              <ATHA67> 160404
              PERFORM X3050-ZCLBCOV-IO                                  <ATHA67> 160404
           END-PERFORM                                                  <ATHA67> 160404
                                                                        <ATHA67> 160404
           .                                                            <ATHA67> 160404
       X3000-EXIT.                                                      <ATHA67> 160404
           EXIT.                                                        <ATHA67> 160404
      /                                                                 <ATHA67> 160404
       X3050-ZCLBCOV-IO SECTION.                                        <ATHA67> 160404
      *************************                                         <ATHA67> 160404
       X3050-START.                                                     <ATHA67> 160404
                                                                        <ATHA67> 160404
           MOVE ZCLBCOVREC             TO ZCLBCOV-FORMAT                <ATHA67> 160404
           CALL 'ZCLBCOVIO'         USING ZCLBCOV-PARAMS.               <ATHA67> 160404
                                                                        <ATHA67> 160404
           IF  ZCLBCOV-STATUZ NOT = O-K                                 <ATHA67> 160404
           AND ZCLBCOV-STATUZ NOT = ENDP                                <ATHA67> 160404
               MOVE ZCLBCOV-PARAMS   TO SYSR-PARAMS                     <ATHA67> 160404
               PERFORM 9000-FATAL-ERROR                                 <ATHA67> 160404
           END-IF                                                       <ATHA67> 160404
           IF  ZCLBCOV-CHDRCOY   NOT = CHDRMJA-CHDRCOY                  <ATHA67> 160404
           OR  ZCLBCOV-CHDRNUM   NOT = CHDRMJA-CHDRNUM                  <ATHA67> 160404
           OR  ZCLBCOV-LIFE      NOT = WSAA-ZCLB-LIFE                   <ATHA67> 160404
           OR  ZCLBCOV-COVERAGE  NOT = WSAA-ZCLB-COVERAGE               <ATHA67> 160404
           OR  ZCLBCOV-RIDER     NOT = WSAA-ZCLB-RIDER                  <ATHA67> 160404
               MOVE ENDP         TO ZCLBCOV-STATUZ                      <ATHA67> 160404
           END-IF                                                       <ATHA67> 160404
           .                                                            <ATHA67> 160404
       X3050-EXIT.                                                      <ATHA67> 160404
           EXIT.                                                        <ATHA67> 160404
      /                                                                 <ATHA67> 160404
       X3100-FIND-CLAWB-REMN-REGP SECTION.                              <ATHA67> 160404
      ************************************                              <ATHA67> 160404
       X3100-START.                                                     <ATHA67> 160404
                                                                        <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-PREM   = WSAA-PRV-CLAW-PREM            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-COMM   = WSAA-PRV-CLAW-COMM            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-OVRC   = WSAA-PRV-CLAW-OVRC            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-CLAW-PREM-REMN  = WSAA-PAID-PREM                <ATHA67> 160404
                                        - WSAA-PRV-CLAW-PREM            <ATHA67> 160404
           COMPUTE WSAA-CLAW-COMM-REMN  = WSAA-PAID-COMM                <ATHA67> 160404
                                        - WSAA-PRV-CLAW-COMM            <ATHA67> 160404
           COMPUTE WSAA-CLAW-OVRC-REMN  = WSAA-PAID-OVRCOM              <ATHA67> 160404
                                        - WSAA-PRV-CLAW-OVRC            <ATHA67> 160404
                                                                        <ATHA67> 160404
           IF  WSAA-CLAW-COMM-REMN     <  WSAA-PAID-COMM-CLAWB          <ATHA67> 160404
               IF  WSAA-CLAW-COMM-REMN  <= ZEROS                        <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-PAID-COMM-CLAWB          <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-PAID-PREM-CLAWB          <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-PAID-OVRCOM-CLAWB        <ATHA67> 160404
               ELSE                                                     <ATHA67> 160404
                   MOVE WSAA-CLAW-COMM-REMN                             <ATHA67> 160404
                                       TO WSAA-PAID-COMM-CLAWB          <ATHA67> 160404
                   MOVE WSAA-CLAW-PREM-REMN                             <ATHA67> 160404
                                       TO WSAA-PAID-PREM-CLAWB          <ATHA67> 160404
                   MOVE WSAA-CLAW-OVRC-REMN                             <ATHA67> 160404
                                       TO WSAA-PAID-OVRCOM-CLAWB        <ATHA67> 160404
               END-IF                                                   <ATHA67> 160404
           END-IF                                                       <ATHA67> 160404
           .                                                            <ATHA67> 160404
       X3100-EXIT.                                                      <ATHA67> 160404
           EXIT.                                                        <ATHA67> 160404
      /                                                                 <ATHA67> 160404
       X3200-FIND-CLAWB-REMN-TOPUP SECTION.                             <ATHA67> 160404
      ************************************                              <ATHA67> 160404
       X3200-START.                                                     <ATHA67> 160404
                                                                        <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-PREM   = WSAA-PRV-CLAW-PREM            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-COMM   = WSAA-PRV-CLAW-COMM            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-PRV-CLAW-OVRC   = WSAA-PRV-CLAW-OVRC            <ATHA67> 160404
                                        * -1                            <ATHA67> 160404
           COMPUTE WSAA-CLAW-PREM-REMN  = WSAA-PAID-PREM                <ATHA67> 160404
                                        - WSAA-PRV-CLAW-PREM            <ATHA67> 160404
           COMPUTE WSAA-CLAW-COMM-REMN  = WSAA-PAID-COMM                <ATHA67> 160404
                                        - WSAA-PRV-CLAW-COMM            <ATHA67> 160404
           COMPUTE WSAA-CLAW-OVRC-REMN  = WSAA-PAID-OVRCOM              <ATHA67> 160404
                                        - WSAA-PRV-CLAW-OVRC            <ATHA67> 160404
                                                                        <ATHA67> 160404
           IF  WSAA-CLAW-COMM-REMN     <  WSAA-CLAWBACK-TOPUP           <ATHA67> 160404
               IF  WSAA-CLAW-COMM-REMN  <= ZEROS                        <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-CLAWBACK-TOPUP           <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-CLAWBACK-NET             <ATHA67> 160404
                   MOVE ZEROS          TO WSAA-CLAWBACK-OVRAMT          <ATHA67> 160404
               ELSE                                                     <ATHA67> 160404
                   MOVE WSAA-CLAW-COMM-REMN                             <ATHA67> 160404
                                       TO WSAA-CLAWBACK-TOPUP           <ATHA67> 160404
                   MOVE WSAA-CLAW-PREM-REMN                             <ATHA67> 160404
                                       TO WSAA-CLAWBACK-NET             <ATHA67> 160404
                   MOVE WSAA-CLAW-OVRC-REMN                             <ATHA67> 160404
                                       TO WSAA-CLAWBACK-OVRAMT          <ATHA67> 160404
               END-IF                                                   <ATHA67> 160404
           END-IF                                                       <ATHA67> 160404
           .                                                            <ATHA67> 160404
       X3200-EXIT.                                                      <ATHA67> 160404
           EXIT.                                                        <ATHA67> 160404
      /                                                                 <ATHB37> 170208
       X3500-FIND-ANNIVERSARY SECTION.                                  <ATHB37> 170208
      ********************************                                  <ATHB37> 170208
       X3500-START.                                                     <ATHB37> 170208
                                                                        <ATHB37> 170208
           MOVE ZEROS                  TO WSAA-COUNT-YEAR               <ATHB37> 170208
           MOVE CHDRMJA-OCCDATE        TO WSAA-NEXT-ANNI-WRK            <ATHB37> 170208
                                                                        <ATHB37> 170208
           PERFORM VARYING WSAA-IND2 FROM 1 BY 1                        <ATHB37> 170210
              UNTIL WSAA-IND2           > WSCC-MAX-ARRAY                <ATHB37> 170208
              OR    WSAA-NEXT-ANNI-WRK  > ZSCLABCK-EFFDATE              <ATHB37> 170208
                                                                        <ATHB37> 170208
                 INITIALIZE DTC4-DATCON4-REC                            <ATHB37> 170208
                 MOVE WSAA-NEXT-ANNI-WRK                                <ATHB37> 170208
                                       TO DTC4-INT-DATE-1               <ATHB37> 170208
                 MOVE WSCC-01          TO DTC4-FREQUENCY                <ATHB37> 170208
                 MOVE 1                TO DTC4-FREQ-FACTOR              <ATHB37> 170208
                                                                        <ATHB37> 170208
                 CALL 'DATCON4'     USING DTC4-DATCON4-REC              <ATHB37> 170208
                                                                        <ATHB37> 170208
                 IF  DTC4-STATUZ    NOT = O-K                           <ATHB37> 170208
                     MOVE DTC4-DATCON4-REC                              <ATHB37> 170208
                                       TO SYSR-PARAMS                   <ATHB37> 170208
                     MOVE DTC4-STATUZ  TO SYSR-STATUZ                   <ATHB37> 170208
                     PERFORM 9000-FATAL-ERROR                           <ATHB37> 170208
                 END-IF                                                 <ATHB37> 170208
                                                                        <ATHB37> 170208
                 IF  DTC4-INT-DATE-2   < ZSCLABCK-EFFDATE               <ATHB37> 170208
                     MOVE DTC4-INT-DATE-2                               <ATHB37> 170208
                                       TO WSAA-TO-DATE-W(WSAA-IND2)     <ATHB37> 170208
                     MOVE WSAA-NEXT-ANNI-WRK                            <ATHB37> 170213
                                       TO WSAA-FROM-DATE-W(WSAA-IND2)   <ATHB37> 170208
                     ADD 1             TO WSAA-COUNT-YEAR               <ATHB37> 170208
                 END-IF                                                 <ATHB37> 170208
                 MOVE DTC4-INT-DATE-2  TO WSAA-NEXT-ANNI-WRK            <ATHB37> 170208
                                                                        <ATHB37> 170208
           END-PERFORM                                                  <ATHB37> 170208
                                                                        <ATHB37> 170208
           IF  WSAA-COUNT-YEAR          = ZEROS                         <ATHB37> 170208
               SET MUST-EXIT-PGM       TO TRUE                          <ATHB37> 170208
           END-IF                                                       <ATHB37> 170208
           .                                                            <ATHB37> 170208
       X3500-EXIT.                                                      <ATHB37> 170208
           EXIT.                                                        <ATHB37> 170208
      /                                                                 <ATHB37> 170210
       X3600-COVRAFI-IO SECTION.                                        <ATHB37> 170210
      *************************                                         <ATHB37> 170210
       X3600-START.                                                     <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE COVRAFIREC             TO COVRAFI-FORMAT                <ATHB37> 170210
           CALL 'COVRAFIIO' USING COVRAFI-PARAMS.                       <ATHB37> 170210
                                                                        <ATHB37> 170210
           IF  COVRAFI-STATUZ NOT = O-K                                 <ATHB37> 170210
           AND COVRAFI-STATUZ NOT = ENDP                                <ATHB37> 170210
              MOVE COVRAFI-PARAMS     TO SYSR-PARAMS                    <ATHB37> 170210
              PERFORM 9000-FATAL-ERROR                                  <ATHB37> 170210
           END-IF                                                       <ATHB37> 170210
           IF  COVRAFI-CHDRCOY      NOT = ZSCLABCK-CHDRCOY              <ATHB37> 170210
           OR  COVRAFI-CHDRNUM      NOT = ZSCLABCK-CHDRNUM              <ATHB37> 170210
           OR  COVRAFI-LIFE         NOT = ZSCLABCK-LIFE                 <ATHB37> 170210
           OR  COVRAFI-COVERAGE     NOT = ZSCLABCK-COVERAGE             <ATHB37> 170210
           OR  COVRAFI-RIDER        NOT = ZSCLABCK-RIDER                <ATHB37> 170210
           OR  COVRAFI-PLAN-SUFFIX  NOT = ZSCLABCK-PLAN-SUFFIX          <ATHB37> 170210
               MOVE ENDP               TO COVRAFI-STATUZ                <ATHB37> 170210
           END-IF                                                       <ATHB37> 170210
           .                                                            <ATHB37> 170210
       X3600-EXIT.                                                      <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB87> 170824
       X3650-COVRAFI-IO SECTION.                                        <ATHB87> 170824
      *************************                                         <ATHB87> 170824
       X3650-START.                                                     <ATHB87> 170824
                                                                        <ATHB87> 170824
           MOVE COVRAFIREC             TO COVRAFI-FORMAT                <ATHB87> 170824
           CALL 'COVRAFIIO' USING COVRAFI-PARAMS.                       <ATHB87> 170824
                                                                        <ATHB87> 170824
           IF  COVRAFI-STATUZ NOT = O-K                                 <ATHB87> 170824
           AND COVRAFI-STATUZ NOT = ENDP                                <ATHB87> 170824
              MOVE COVRAFI-PARAMS     TO SYSR-PARAMS                    <ATHB87> 170824
              PERFORM 9000-FATAL-ERROR                                  <ATHB87> 170824
           END-IF                                                       <ATHB87> 170824
           IF  COVRAFI-CHDRCOY      NOT = ZSCLABCK-CHDRCOY              <ATHB87> 170824
           OR  COVRAFI-CHDRNUM      NOT = ZSCLABCK-CHDRNUM              <ATHB87> 170824
           OR  COVRAFI-LIFE         NOT = WSAA-ZCLB-LIFE                <ATHB87> 170824
           OR  COVRAFI-COVERAGE     NOT = WSAA-ZCLB-COVERAGE            <ATHB87> 170824
           OR  COVRAFI-RIDER        NOT = WSAA-ZCLB-RIDER               <ATHB87> 170824
           OR  COVRAFI-PLAN-SUFFIX  NOT = ZEROS                         <ATHB87> 170824
               MOVE ENDP               TO COVRAFI-STATUZ                <ATHB87> 170824
           END-IF                                                       <ATHB87> 170824
           .                                                            <ATHB87> 170824
       X3650-EXIT.                                                      <ATHB87> 170824
           EXIT.                                                        <ATHB87> 170824
      /                                                                 <ATHB37> 170210
       X3700-CHDRAFI-IO SECTION.                                        <ATHB37> 170210
      *************************                                         <ATHB37> 170210
       X3700-START.                                                     <ATHB37> 170210
                                                                        <ATHB37> 170210
           MOVE CHDRAFIREC             TO CHDRAFI-FORMAT                <ATHB37> 170210
           CALL 'CHDRAFIIO' USING CHDRAFI-PARAMS.                       <ATHB37> 170210
                                                                        <ATHB37> 170210
           IF  CHDRAFI-STATUZ NOT = O-K                                 <ATHB37> 170210
           AND CHDRAFI-STATUZ NOT = ENDP                                <ATHB37> 170210
              MOVE CHDRAFI-PARAMS     TO SYSR-PARAMS                    <ATHB37> 170210
              PERFORM 9000-FATAL-ERROR                                  <ATHB37> 170210
           END-IF                                                       <ATHB37> 170210
                                                                        <ATHB37> 170210
           IF  CHDRAFI-CHDRCOY      NOT = COVRAFI-CHDRCOY               <ATHB37> 170210
           OR  CHDRAFI-CHDRNUM      NOT = COVRAFI-CHDRNUM               <ATHB37> 170210
               MOVE ENDP               TO CHDRAFI-STATUZ                <ATHB37> 170210
           END-IF                                                       <ATHB37> 170210
           .                                                            <ATHB37> 170210
       X3700-EXIT.                                                      <ATHB37> 170210
           EXIT.                                                        <ATHB37> 170210
      /                                                                 <ATHB37> 170213
       X4000-CALL-ITDM-IO SECTION.                                      <ATHB37> 170213
      ***************************                                       <ATHB37> 170213
       X4000-START.                                                     <ATHB37> 170213
                                                                        <ATHB37> 170213
           MOVE O-K                    TO ITDM-STATUZ                   <ATHB37> 170213
           MOVE ITDMREC                TO ITDM-FORMAT                   <ATHB37> 170213
                                                                        <ATHB37> 170213
           CALL 'ITDMIO'            USING ITDM-PARAMS                   <ATHB37> 170213
                                                                        <ATHB37> 170213
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB37> 170213
           AND ITDM-STATUZ          NOT = ENDP                          <ATHB37> 170213
               MOVE ITDM-STATUZ        TO SYSR-STATUZ                   <ATHB37> 170213
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                   <ATHB37> 170213
               PERFORM 9000-FATAL-ERROR                                 <ATHB37> 170214
           END-IF                                                       <ATHB37> 170213
           .                                                            <ATHB37> 170213
       X4000-EXIT.                                                      <ATHB37> 170213
           EXIT.                                                        <ATHB37> 170213
      /                                                                 <ATHB37> 170214
       X4100-READ-T7Z11 SECTION.                                        <ATHB37> 170214
      ***************************                                       <ATHB37> 170214
       X4100-START.                                                     <ATHB37> 170214
           MOVE SPACES                 TO ITDM-DATA-KEY                 <ATHB37> 170214
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                  <ATHB37> 170214
           MOVE T7Z11                  TO ITDM-ITEMTABL                 <ATHB37> 170214
           MOVE WSAA-ITEMITEM-IT       TO ITDM-ITEMITEM                 <ATHB37> 170214
           MOVE COVRAFI-CRRCD          TO ITDM-ITMFRM                   <ATHB37> 170214
           MOVE ITDMREC                TO ITDM-FORMAT                   <ATHB37> 170214
                                                                        <ATHB37> 170214
           MOVE BEGN                   TO ITDM-FUNCTION                 <ATHB37> 170214
                                                                        <ATHB37> 170214
           CALL 'ITDMIO'            USING ITDM-PARAMS                   <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB37> 170214
           AND ITDM-STATUZ          NOT = ENDP                          <ATHB37> 170214
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                   <ATHB37> 170214
               PERFORM 9000-FATAL-ERROR                                 <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF  ITDM-ITEMCOY         NOT = ZSCLABCK-CHDRCOY              <ATHB37> 170214
           OR  ITDM-ITEMTABL        NOT = T7Z11                         <ATHB37> 170214
           OR  ITDM-ITEMITEM        NOT = WSAA-ITEMITEM-IT              <ATHB37> 170214
           OR  ITDM-STATUZ              = ENDP                          <ATHB37> 170214
               MOVE COVRAFI-CHDRNUM    TO SYSR-PARAMS                   <ATHB37> 170214
               PERFORM 9000-FATAL-ERROR                                 <ATHB37> 170214
           ELSE                                                         <ATHB37> 170214
               MOVE ITDM-GENAREA       TO T7Z11-T7Z11-REC               <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
           .                                                            <ATHB37> 170214
       X4100-EXIT.                                                      <ATHB37> 170214
           EXIT.                                                        <ATHB37> 170214
      /                                                                 <ATHB37> 170214
       X4150-GET-T7Z11 SECTION.                                         <ATHB37> 170214
      ************************                                          <ATHB37> 170214
       X4150-START.                                                     <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF COVRAFI-RISK-CESS-TERM    > 20                            <ATHB37> 170214
              MOVE 20                  TO WSAA-CESS-TERM                <ATHB37> 170214
           ELSE                                                         <ATHB37> 170214
              MOVE COVRAFI-RISK-CESS-TERM                               <ATHB37> 170214
                                       TO WSAA-CESS-TERM                <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
           PERFORM X4155-MATCH-DURATION                                 <ATHB37> 170214
                   VARYING WSAA-ARRAY-INDEX FROM 1 BY 1                 <ATHB37> 170214
                           UNTIL WSAA-ARRAY-INDEX = 11                  <ATHB37> 170214
                           OR T7Z11-ZDUR(WSAA-ARRAY-INDEX)              <ATHB37> 170214
                           = WSAA-CESS-TERM                             <ATHB37> 170214
           MOVE 1                      TO WSAA-TERMW                    <ATHB37> 170215
           IF  WSAA-TERMW               = 0                             <ATHB37> 170214
               MOVE 1                  TO WSAA-TERMW                    <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
           COMPUTE WSAA-ARRAY-INDEX2    = WSAA-TERMW                    <ATHB37> 170214
                                        + ((6 * WSAA-ARRAY-INDEX) - 6)  <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF  WSAA-ARRAY-INDEX2        > (6 * WSAA-ARRAY-INDEX)        <ATHB37> 170214
               MOVE ZEROS              TO WSAA-T7Z11                    <ATHB37> 170214
           ELSE                                                         <ATHB37> 170214
               MOVE T7Z11-ZCOMRAT(WSAA-ARRAY-INDEX2)                    <ATHB37> 170214
                                       TO WSAA-T7Z11                    <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
           .                                                            <ATHB37> 170214
       X4150-EXIT.                                                      <ATHB37> 170214
           EXIT.                                                        <ATHB37> 170214
      /                                                                 <ATHB37> 170214
       X4155-MATCH-DURATION SECTION.                                    <ATHB37> 170214
      ****************************                                      <ATHB37> 170214
       X4155-START.                                                     <ATHB37> 170214
      * DUMMY                                                           <ATHB37> 170214
       X4155-EXIT.                                                      <ATHB37> 170214
           EXIT.                                                        <ATHB37> 170214
      *                                                                 <ATHD11> 181019
       X4250-READ-T8Z05 SECTION.                                        <ATHD11> 181019
      *********************************                                 <ATHD11> 181019
       X4250-START.                                                     <ATHD11> 181019
      *                                                                 <ATHD11> 181019
           SET NOT-MCPPI-PRODUCT       TO TRUE                          <ATHD11> 181019
                                                                        <ATHD11> 181019
           MOVE SPACES                 TO ITDM-DATA-AREA                <ATHD11> 181019
                                                                        <ATHD11> 181019
           MOVE 'IT'                   TO ITDM-ITEMPFX                  <ATHD11> 181019
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                  <ATHD11> 181019
           MOVE T8Z05                  TO ITDM-ITEMTABL                 <ATHD11> 181019
           MOVE CHDRMJA-OCCDATE        TO ITDM-ITMFRM                   <ATHD11> 181019
           MOVE CHDRMJA-CNTTYPE        TO ITDM-ITEMITEM                 <ATHD11> 181019
           MOVE BEGN                   TO ITDM-FUNCTION                 <ATHD11> 181019
                                                                        <ATHD11> 181019
           CALL 'ITDMIO' USING         ITDM-PARAMS                      <ATHD11> 181019
                                                                        <ATHD11> 181019
           IF ITDM-STATUZ              NOT = O-K  AND                   <ATHD11> 181019
              ITDM-STATUZ              NOT = ENDP                       <ATHD11> 181019
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                   <ATHD11> 181019
               MOVE ITDM-STATUZ        TO SYSR-STATUZ                   <ATHD11> 181019
               PERFORM 9000-FATAL-ERROR                                 <ATHD11> 181019
                                                                        <ATHD11> 181019
           IF ITDM-ITEMCOY             NOT = ZSCLABCK-CHDRCOY OR        <ATHD11> 181019
              ITDM-ITEMTABL            NOT = T8Z05 OR                   <ATHD11> 181019
              ITDM-ITEMITEM            NOT = CHDRMJA-CNTTYPE OR         <ATHD11> 181019
              ITDM-STATUZ              = ENDP                           <ATHD11> 181019
               GO TO X4250-EXIT                                         <ATHD11> 181019
           ELSE                                                         <ATHD11> 181019
               SET MCPPI-PRODUCT       TO TRUE                          <ATHD11> 181019
           END-IF                                                       <ATHD11> 181019
           .                                                            <ATHD11> 181019
      *                                                                 <ATHD11> 181019
       X4250-EXIT.                                                      <ATHD11> 181019
           EXIT.                                                        <ATHD11> 181019
      /                                                                 <ATHB37> 170214
       X4200-READ-T5Z01 SECTION.                                        <ATHB37> 170214
      *************************                                         <ATHB37> 170214
       X4200-START.                                                     <ATHB37> 170214
                                                                        <ATHB37> 170214
           INITIALIZE T5Z01-T5Z01-REC                                   <ATHB37> 170214
           MOVE SPACES                TO ITEM-PARAMS                    <ATHB37> 170214
           MOVE SMTP-ITEM             TO ITEM-ITEMPFX                   <ATHB37> 170214
           MOVE ZSCLABCK-CHDRCOY      TO ITEM-ITEMCOY                   <ATHB37> 170214
           MOVE T5Z01                 TO ITEM-ITEMTABL                  <ATHB37> 170214
           MOVE COVRAFI-CRTABLE       TO ITEM-ITEMITEM                  <ATHB37> 170214
                                                                        <ATHB37> 170214
           MOVE READR                 TO ITEM-FUNCTION                  <ATHB37> 170214
                                                                        <ATHB37> 170214
           CALL 'ITEMIO'              USING ITEM-PARAMS                 <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF  ITEM-STATUZ            NOT = O-K                         <ATHB37> 170214
           AND ITEM-STATUZ            NOT = MRNF                        <ATHB37> 170214
              MOVE ITEM-PARAMS        TO SYSR-PARAMS                    <ATHB37> 170214
              MOVE ITEM-STATUZ        TO SYSR-STATUZ                    <ATHB37> 170214
              PERFORM 9000-FATAL-ERROR                                  <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
                                                                        <ATHB37> 170214
           IF  ITEM-STATUZ             = O-K                            <ATHB37> 170214
               MOVE ITEM-GENAREA      TO T5Z01-T5Z01-REC                <ATHB37> 170214
           END-IF                                                       <ATHB37> 170214
           .                                                            <ATHB37> 170214
       X4200-EXIT.                                                      <ATHB37> 170214
           EXIT.                                                        <ATHB37> 170214
      /                                                                 <ATHB37> 170302
       X4300-READ-T5694 SECTION.                                        <ATHB37> 170302
      ***************************                                       <ATHB37> 170302
       X4300-START.                                                     <ATHB37> 170302
           MOVE SPACES                 TO ITDM-DATA-KEY                 <ATHB37> 170302
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                  <ATHB37> 170302
           MOVE T5694                  TO ITDM-ITEMTABL                 <ATHB37> 170302
           MOVE WSAA-METHOD-IT         TO ITDM-ITEMITEM                 <ATHB37> 181019
           MOVE COVRAFI-CRRCD          TO ITDM-ITMFRM                   <ATHB37> 170302
           MOVE ITDMREC                TO ITDM-FORMAT                   <ATHB37> 170302
                                                                        <ATHB37> 170302
           MOVE BEGN                   TO ITDM-FUNCTION                 <ATHB37> 170302
                                                                        <ATHB37> 170302
           CALL 'ITDMIO'            USING ITDM-PARAMS                   <ATHB37> 170302
                                                                        <ATHB37> 170302
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB37> 170302
           AND ITDM-STATUZ          NOT = ENDP                          <ATHB37> 170302
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                   <ATHB37> 170302
               PERFORM 9000-FATAL-ERROR                                 <ATHB37> 170302
           END-IF                                                       <ATHB37> 170302
                                                                        <ATHB37> 170302
           IF  ITDM-ITEMCOY         NOT = ZSCLABCK-CHDRCOY              <ATHB37> 170302
           OR  ITDM-ITEMTABL        NOT = T5694                         <ATHB37> 170302
      **** OR  ITDM-ITEMITEM        NOT = T5Z01-ZAACPY          <ATHD11><ATHB37> 181023
           OR  ITDM-ITEMITEM        NOT = WSAA-METHOD-IT                <ATHD11> 181023
           OR  ITDM-STATUZ              = ENDP                          <ATHB37> 170302
               MOVE COVRAFI-CHDRNUM    TO SYSR-PARAMS                   <ATHB37> 170302
               PERFORM 9000-FATAL-ERROR                                 <ATHB37> 170302
           ELSE                                                         <ATHB37> 170302
               MOVE ITDM-GENAREA       TO T5694-T5694-REC               <ATHB37> 170302
           END-IF                                                       <ATHB37> 170302
           .                                                            <ATHB37> 170302
       X4300-EXIT.                                                      <ATHB37> 170302
           EXIT.                                                        <ATHB37> 170302
      /                                                                 <ATHB37> 170302
       X4350-GET-T5694 SECTION.                                         <ATHB37> 170302
      ************************                                          <ATHB37> 170302
       X4350-START.                                                     <ATHB37> 170302
                                                                        <ATHB37> 170302
      *  Access table value based on WSAA-TERM                          <ATHB37> 170302
                                                                        <ATHB37> 170302
           IF  WSAA-TERMW           NOT > T5694-TO-YEAR(WSAA-INDEX)     <ATHB37> 170302
               MOVE T5694-INSTALPC(WSAA-INDEX)                          <ATHB37> 170302
                                       TO WSAA-T5694                    <ATHB37> 170302
               MOVE 13                 TO WSAA-INDEX                    <ATHB37> 170302
           END-IF                                                       <ATHB37> 170302
           .                                                            <ATHB37> 170302
       X4350-EXIT.                                                      <ATHB37> 170302
           EXIT.                                                        <ATHB37> 170302
      /                                                                 <ATHB45> 170313
       X4400-GET-TU-COVR SECTION.                                       <ATHB45> 170313
      **************************                                        <ATHB45> 170313
       X4400-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE SPACES                 TO WSAA-TU-CRTABLE               <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE CHDRMJA-CNTTYPE        TO WSAA-T5673-ITEM               <ATHB45> 170313
           PERFORM X4500-READ-T5673                                     <ATHB45> 170313
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB45> 170313
               GO TO X4400-EXIT                                         <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
                                                                        <ATHB45> 170313
           SET NOT-MUST-EXIT-LOOP      TO TRUE                          <ATHB45> 170313
           PERFORM                                                      <ATHB45> 170313
             UNTIL MUST-EXIT-LOOP                                       <ATHB45> 170313
               PERFORM X4410-GET-TU-COVR-MAIN                           <ATHB45> 170313
                                                                        <ATHB45> 170313
               IF  WSAA-TU-CRTABLE  NOT = SPACES                        <ATHB45> 170313
                   SET MUST-EXIT-LOOP  TO TRUE                          <ATHB45> 170313
               END-IF                                                   <ATHB45> 170313
               IF  T5673-GITEM          = SPACES                        <ATHB45> 170313
                   SET MUST-EXIT-LOOP  TO TRUE                          <ATHB45> 170313
               END-IF                                                   <ATHB45> 170313
               IF  NOT MUST-EXIT-LOOP                                   <ATHB45> 170313
                   MOVE T5673-GITEM    TO WSAA-T5673-ITEM               <ATHB45> 170313
                   PERFORM X4500-READ-T5673                             <ATHB45> 170313
               END-IF                                                   <ATHB45> 170313
           END-PERFORM                                                  <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4400-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170313
       X4410-GET-TU-COVR-MAIN SECTION.                                  <ATHB45> 170313
      *******************************                                   <ATHB45> 170313
       X4410-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           PERFORM VARYING WSAA-IND1 FROM 1 BY 1                        <ATHB45> 170313
             UNTIL WSAA-TU-CRTABLE  NOT = SPACES                        <ATHB45> 170313
             OR    T5673-CTABLE (WSAA-IND1)                             <ATHB45> 170313
                                        = SPACES                        <ATHB45> 170313
               PERFORM X4450-GET-CRTABLE-TYPE                           <ATHB45> 170313
               IF  CRTABLE-TYPE-TOP-UP                                  <ATHB45> 170313
               AND T5673-CTABLE(WSAA-IND1)                              <ATHB45> 170313
                                    NOT = 'TULB'                        <ATHB45> 170313
               AND T5673-CTABLE(WSAA-IND1)                              <ATHB45> 170313
                                    NOT = 'TULA'                        <ATHB45> 170313
                   MOVE T5673-CTABLE (WSAA-IND1)                        <ATHB45> 170313
                                       TO WSAA-TU-CRTABLE               <ATHB45> 170313
               END-IF                                                   <ATHB45> 170313
           END-PERFORM                                                  <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4410-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170313
       X4450-GET-CRTABLE-TYPE SECTION.                                  <ATHB45> 170313
      *******************************                                   <ATHB45> 170313
       X4450-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE SPACES                 TO WS88-CRTABLE-TYPE             <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE T5673-CTABLE (WSAA-IND1)                                <ATHB45> 170313
                                       TO WSAA-READ-CRTABLE             <ATHB45> 170313
           PERFORM X4700-READ-T5687                                     <ATHB45> 170313
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB45> 170313
               GO TO X4450-EXIT                                         <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           MOVE T5687-ZCOMPONENT-TYPE  TO WS88-CRTABLE-TYPE             <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4450-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170313
       X4500-READ-T5673 SECTION.                                        <ATHB45> 170313
      *************************                                         <ATHB45> 170313
       X4500-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           INITIALIZE T5673-T5673-REC                                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           INITIALIZE ITDM-PARAMS                                       <ATHB45> 170313
           INITIALIZE ITEMREC-KEY-DATA     OF ITDM-PARAMS               <ATHB45> 170313
           INITIALIZE ITEMREC-NON-KEY-DATA OF ITDM-PARAMS               <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE SMTP-ITEM              TO ITDM-ITEMPFX                  <ATHB45> 170313
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                  <ATHB45> 170313
           MOVE T5673                  TO ITDM-ITEMTABL                 <ATHB45> 170313
           MOVE WSAA-T5673-ITEM        TO ITDM-ITEMITEM                 <ATHB45> 170313
           MOVE ZSCLABCK-EFFDATE       TO ITDM-ITMFRM                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE ITDM-DATA-KEY          TO WSAA-ITDMKEY                  <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE BEGN                   TO ITDM-FUNCTION                 <ATHB45> 170313
           PERFORM X4600-CALL-ITDM-IO                                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           IF  ITDM-ITEMPFX         NOT = SMTP-ITEM                     <ATHB45> 170313
           OR  ITDM-ITEMCOY         NOT = ZSCLABCK-CHDRCOY              <ATHB45> 170313
           OR  ITDM-ITEMTABL        NOT = T5673                         <ATHB45> 170313
           OR  ITDM-ITEMITEM        NOT = WSAA-T5673-ITEM               <ATHB45> 170313
               MOVE ENDP               TO ITDM-STATUZ                   <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
                                                                        <ATHB45> 170313
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB45> 170313
               GO TO X4500-EXIT                                         <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           MOVE ITDM-GENAREA           TO T5673-T5673-REC               <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4500-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170313
       X4600-CALL-ITDM-IO SECTION.                                      <ATHB45> 170313
      ***************************                                       <ATHB45> 170313
       X4600-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE O-K                    TO ITDM-STATUZ                   <ATHB45> 170313
           MOVE ITDMREC                TO ITDM-FORMAT                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           CALL 'ITDMIO'            USING ITDM-PARAMS                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB45> 170313
           AND ITDM-STATUZ          NOT = ENDP                          <ATHB45> 170313
               MOVE ITDM-STATUZ        TO SYSR-STATUZ                   <ATHB45> 170313
               MOVE ITDM-PARAMS        TO SYSR-PARAMS                   <ATHB45> 170313
               MOVE WSCC-TXT-2         TO SYSR-SYSERR-TYPE              <ATHB45> 170313
               PERFORM 9000-FATAL-ERROR                                 <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4600-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170313
       X4700-READ-T5687 SECTION.                                        <ATHB45> 170313
      *************************                                         <ATHB45> 170313
       X4700-START.                                                     <ATHB45> 170313
                                                                        <ATHB45> 170313
           INITIALIZE T5687-T5687-REC                                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           INITIALIZE ITDM-PARAMS                                       <ATHB45> 170313
           INITIALIZE ITEMREC-KEY-DATA     OF ITDM-PARAMS               <ATHB45> 170313
           INITIALIZE ITEMREC-NON-KEY-DATA OF ITDM-PARAMS               <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE SMTP-ITEM              TO ITDM-ITEMPFX                  <ATHB45> 170313
           MOVE ZSCLABCK-CHDRCOY       TO ITDM-ITEMCOY                  <ATHB45> 170313
           MOVE T5687                  TO ITDM-ITEMTABL                 <ATHB45> 170313
           MOVE WSAA-READ-CRTABLE      TO ITDM-ITEMITEM                 <ATHB45> 170313
           MOVE ZSCLABCK-EFFDATE       TO ITDM-ITMFRM                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE ITDM-DATA-KEY          TO WSAA-ITDMKEY                  <ATHB45> 170313
                                                                        <ATHB45> 170313
           MOVE BEGN                   TO ITDM-FUNCTION                 <ATHB45> 170313
           PERFORM X4600-CALL-ITDM-IO                                   <ATHB45> 170313
                                                                        <ATHB45> 170313
           IF  ITDM-ITEMPFX         NOT = SMTP-ITEM                     <ATHB45> 170313
           OR  ITDM-ITEMCOY         NOT = ZSCLABCK-CHDRCOY              <ATHB45> 170313
           OR  ITDM-ITEMTABL        NOT = T5687                         <ATHB45> 170313
           OR  ITDM-ITEMITEM        NOT = WSAA-READ-CRTABLE             <ATHB45> 170313
               MOVE ENDP               TO ITDM-STATUZ                   <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
                                                                        <ATHB45> 170313
           IF  ITDM-STATUZ          NOT = O-K                           <ATHB45> 170313
               GO TO X4700-EXIT                                         <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           MOVE ITDM-GENAREA           TO T5687-T5687-REC               <ATHB45> 170313
           .                                                            <ATHB45> 170313
       X4700-EXIT.                                                      <ATHB45> 170313
           EXIT.                                                        <ATHB45> 170313
      /                                                                 <ATHB45> 170310
       X4800-READ-ZCOVCRT SECTION.                                      <ATHB45> 170310
      ***************************                                       <ATHB45> 170310
       X4800-START.                                                     <ATHB45> 170310
                                                                        <ATHB45> 170310
           INITIALIZE ZCOVCRT-PARAMS                                    <ATHB45> 170310
           INITIALIZE ZCOVCRTREC-KEY-DATA     OF ZCOVCRT-PARAMS         <ATHB45> 170310
           INITIALIZE ZCOVCRTREC-NON-KEY-DATA OF ZCOVCRT-PARAMS         <ATHB45> 170310
                                                                        <ATHB45> 170310
           MOVE ZSCLABCK-CHDRCOY       TO ZCOVCRT-CHDRCOY               <ATHB45> 170310
           MOVE WSAA-TU-CRTABLE        TO ZCOVCRT-CRTABLE               <ATHB45> 170310
           MOVE ZSCLABCK-CHDRNUM       TO ZCOVCRT-CHDRNUM               <ATHB45> 170310
                                                                        <ATHB45> 170310
           MOVE BEGN                   TO ZCOVCRT-FUNCTION              <ATHB45> 170310
           PERFORM X4850-ZCOVCRT-IO                                     <ATHB45> 170310
           IF  ZCOVCRT-STATUZ           = O-K                           <ATHB45> 170313
               MOVE ZCOVCRT-LIFE           TO WSAA-TU-LIFE              <ATHB45> 170313
               MOVE ZCOVCRT-COVERAGE       TO WSAA-TU-COVERAGE          <ATHB45> 170313
               MOVE ZCOVCRT-RIDER          TO WSAA-TU-RIDER             <ATHB45> 170313
           ELSE                                                         <ATHB45> 170313
               MOVE '01'                   TO WSAA-TU-LIFE              <ATHB45> 170313
               MOVE '02'                   TO WSAA-TU-COVERAGE          <ATHB45> 170313
               MOVE '00'                   TO WSAA-TU-RIDER             <ATHB45> 170313
           END-IF                                                       <ATHB45> 170313
           .                                                            <ATHB45> 170310
       X4800-EXIT.                                                      <ATHB45> 170310
           EXIT.                                                        <ATHB45> 170310
      /                                                                 <ATHB45> 170310
       X4850-ZCOVCRT-IO SECTION.                                        <ATHB45> 170310
      *************************                                         <ATHB45> 170310
       X4850-START.                                                     <ATHB45> 170310
                                                                        <ATHB45> 170310
           MOVE O-K                    TO ZCOVCRT-STATUZ                <ATHB45> 170310
           MOVE ZCOVCRTREC             TO ZCOVCRT-FORMAT                <ATHB45> 170310
                                                                        <ATHB45> 170310
           CALL 'ZCOVCRTIO'         USING ZCOVCRT-PARAMS                <ATHB45> 170310
                                                                        <ATHB45> 170310
           IF  ZCOVCRT-STATUZ       NOT = O-K                           <ATHB45> 170310
           AND ZCOVCRT-STATUZ       NOT = ENDP                          <ATHB45> 170310
               MOVE ZCOVCRT-STATUZ     TO SYSR-STATUZ                   <ATHB45> 170310
               MOVE ZCOVCRT-PARAMS     TO SYSR-PARAMS                   <ATHB45> 170310
               MOVE WSCC-TXT-2         TO SYSR-SYSERR-TYPE              <ATHB45> 170310
               PERFORM 9000-FATAL-ERROR                                 <ATHB45> 170310
           END-IF                                                       <ATHB45> 170310
                                                                        <ATHB45> 170310
           IF  ZSCLABCK-CHDRCOY     NOT = ZCOVCRT-CHDRCOY               <ATHB45> 170310
           OR  WSAA-TU-CRTABLE      NOT = ZCOVCRT-CRTABLE               <ATHB45> 170310
           OR  ZSCLABCK-CHDRNUM     NOT = ZCOVCRT-CHDRNUM               <ATHB45> 170310
               MOVE ENDP               TO ZCOVCRT-STATUZ                <ATHB45> 170310
           END-IF                                                       <ATHB45> 170310
           .                                                            <ATHB45> 170310
       X4850-EXIT.                                                      <ATHB45> 170310
           EXIT.                                                        <ATHB45> 170310
      /                                                                 <ATHB87> 170824
       X5000-FIND-MAIN-COVR SECTION.                                    <ATHB87> 170824
      ******************************                                    <ATHB87> 170824
       X5000-START.                                                     <ATHB87> 170824
                                                                        <ATHB87> 170824
           INITIALIZE COVRAFI-PARAMS                                    <ATHB87> 170824
           INITIALIZE COVRAFIREC-KEY-DATA OF COVRAFI-PARAMS             <ATHB87> 170824
           INITIALIZE COVRAFIREC-NON-KEY-DATA                           <ATHB87> 170824
                                       OF COVRAFI-PARAMS                <ATHB87> 170824
                                                                        <ATHB87> 170824
           MOVE ZSCLABCK-CHDRCOY       TO COVRAFI-CHDRCOY               <ATHB87> 170824
           MOVE ZSCLABCK-CHDRNUM       TO COVRAFI-CHDRNUM               <ATHB87> 170824
           MOVE WSAA-ZCLB-COVERAGE     TO COVRAFI-COVERAGE              <ATHB87> 170824
           MOVE WSAA-ZCLB-RIDER        TO COVRAFI-RIDER                 <ATHB87> 170824
           MOVE WSAA-ZCLB-LIFE         TO COVRAFI-LIFE                  <ATHB87> 170824
           MOVE ZEROS                  TO COVRAFI-PLAN-SUFFIX           <ATHB87> 170824
                                                                        <ATHB87> 170824
           MOVE BEGN                   TO COVRAFI-FUNCTION              <ATHB87> 170824
           PERFORM X3650-COVRAFI-IO                                     <ATHB87> 170824
           IF  COVRAFI-STATUZ           = ENDP                          <ATHB87> 170824
               GO TO X5000-EXIT                                         <ATHB87> 170824
           END-IF                                                       <ATHB87> 170824
           MOVE COVRAFI-CRTABLE        TO WSAA-CRTABLE                  <ATHB87> 170824
                                                                        <ATHB87> 170824
           .                                                            <ATHB87> 170824
       X5000-EXIT.                                                      <ATHB87> 170824
           EXIT.                                                        <ATHB87> 170824
      /                                                                          151112
       XA25-CALL-ALOCNO  SECTION.                                                151112
      ***************************                                                151112
       XA25-START.                                                               151112
           INITIALIZE ALNO-ALOCNO-REC                                            151112
                                                                                 151112
           MOVE WSCC-CB                TO ALNO-PREFIX                            151116
           MOVE ZSCLABCK-CHDRCOY       TO ALNO-COMPANY                           151112
           MOVE ZSCLABCK-BATCTRCDE     TO ALNO-GENKEY                            151112
           IF  ZSCLABCK-FUNCTION        = WSCC-DECRP                    <ATHB37> 170215
               MOVE 'T512'             TO ALNO-GENKEY                   <ATHB37> 170215
           END-IF                                                       <ATHB37> 170215
           MOVE WSCC-NEXT              TO ALNO-FUNCTION                          151112
                                                                                 151112
           CALL 'ALOCNO'            USING ALNO-ALOCNO-REC                        151112
                                                                                 151112
           IF  ALNO-STATUZ          NOT = O-K                                    151112
               MOVE ALNO-ALOCNO-REC    TO SYSR-PARAMS                            151112
               MOVE ALNO-STATUZ        TO SYSR-STATUZ                            151112
               PERFORM 9000-FATAL-ERROR                                          151112
           END-IF                                                                151112
                                                                                 151112
           MOVE ALNO-ALOC-NO           TO WSAA-JPREMREG                          151112
           .                                                                     151112
       XA25-EXIT.                                                                151112
            EXIT.                                                                151112
