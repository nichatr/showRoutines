 0001.00       *------------------------------------------------------------------------------------------------------------- 181121 
 0002.00       * 1.Read portfolio from FCONTRACT, FCONLIF, FCONCOV, FCONFUND                                                  181121 
 0003.00       * 2.Create 4 model points files:                                                                               181121 
 0004.00       *         MPMDLPNT    : in force                                                                               181121 
 0005.00       *         MPMDLPNTNP  : new business                                                                           181121 
 0006.00       *         MDLNNONAPE  : new business non ape                                                                   181121 
 0007.00       *         MPMDLPNTRJ  : rejected                                                                               181121 
 0008.00       *------------------------------------------------------------------------------------------------------------- 190204 
 0009.00       * For compilation:                                                                                             190204 
 0010.00       *   CALL  PRDFIN/MPMDL001CO                                                                                    190204 
 0011.00       *                                                                                                              190204 
 0012.00       * For run (or standalone compilation):                                                                         190204 
 0013.00       * OVRDBF     FILE(FCONCOV1) TOFILE(FCONCOV) SHARE(*NO)                                                         190204 
 0014.00       * OVRDBF     FILE(FCONCOVM) TOFILE(FCONCOV) SHARE(*NO)                                                         190204 
 0015.00       * OVRDBF     FILE(FCONLIFM) TOFILE(FCONLIF) SHARE(*NO)                                                         190204 
 0016.00       * OVRDBF     FILE(MZAPE)    TOFILE(ATHATSRC/ZAPE) SHARE(*NO)                                                   190204 
 0017.00       *                                                                                                              190204 
 0018.00       * LIFE400 user needed for compile:                                                                             190204 
 0019.00       *                                                                                                              190204 
 0020.00       * CRTBNDCBL PGM(PRDFIN/MPMDL001)                                                                               190204 
 0021.00       *           SRCFILE(PRDFIN/QSRC)                                                                               190204 
 0022.00       *           CVTOPT(*DATETIME)                                                                                  190204 
 0023.00       *           DBGVIEW(*ALL)                                                                                      190204 
 0024.00       *                                                                                                              190204 
 0025.00       *============================================================================================================= 030728 
 0026.00        IDENTIFICATION DIVISION.                                                                                      030721 
 0027.00       *============================================================================================================= 030728 
 0028.00         PROGRAM-ID. MPDML001.                                                                                        150720 
 0029.00       * 09/10/2017 CHANGES FOR NEW BUSINESS TO BE COMPARED AND AGREED WITH NON APE                                   171012 
 0030.00       *            NEW FILE MDLNNONAPE                                                                               171012 
 0031.00       * 19/12/2017                                                                                                   171219 
 0032.00       * For Nelis all are non ape.The program reads with spcode=3 of Bif file                                        171219 
 0033.00       * and if concerns NELIS coverages then are written in non ape file.                                            171219 
 0034.00                                                                                                                      171219 
 0035.00       * 20/09/2017 CHANGES FOR NEW BUSINESS TO BE COMPARED AND AGREED WITH ZAPE,FAPEP(APE PIREAUS)                   171012 
 0036.00                                                                                                                      170920 
 0037.00       * 14/1/2016 ADD NEW FIELDS ON FILES FCONTRACT,FCONCOV,FCONCOVSLC (INIANETPRM,ININETPRM)                        160115 
 0038.00       * WE USE THOSE FIELDS INSTEAD OF ANNNETPRM AND ISTNETPRM                                                       160114 
 0039.00       *--------------------------------------------------------------------------------------------------            181120 
 0040.00       * 20/11/2018 -task 2169 devops- Model Points - 4rd Quarter 2018 Changes                                        181120 
 0041.00       *            N.Hatzirvasanis                                                                                   181120 
 0042.00       *            added two fields in model points file:                                                            181120 
 0043.00       *            MPVARDTA      13S 2       COLHDG('Var_Data_1')                                                    181205 
 0044.00       *            MPLDNDSC       7S 5       COLHDG('Premium_Loading')                                               181205 
 0045.00       *--------------------------------------------------------------------------------------------------            190204 
 0046.00       * 04/02/2019 -task 3095 devops- Model Points - changes:                                                        190204 
 0047.00       *            N.Hatzirvasanis                                                                                   190204 
 0048.00       *    1) Room,deductible,coinsurance must be updated with values valid on model point calculation date.         190204 
 0049.00       *       (It is updated correctly from Life400 program ZFINCOVR).                                               190204 
 0050.00       *    2) new field WOPACT = WoP_Activated (1=true, 0=false).                                                    190205 
 0051.00       *       For Piraeus is not applicable.                                                                         190205 
 0052.00       * 14/02/2019:                                                                                                  190214 
 0053.00       *    3) Loadings to be multiplied instead of added up to produce the total loading.                            190214 
 0054.00       * 19/02/2019:                                                                                                  190219 
 0055.00       *    4) The component identifier must be unique between all model point files.                                 190219 
 0056.00       *       All writes to the four model point files (bif, new business, non ape, rejected)                        190219 
 0057.00       *       were refactored into separate routines with a common counter.                                          190220 
 0058.00       *============================================================================================================= 030728 
 0059.00        ENVIRONMENT DIVISION.                                                                                         030721 
 0060.00       *============================================================================================================= 030728 
 0061.00                                                                                                                      031017 
 0062.00       * ======================                                                                                       030728 
 0063.00         CONFIGURATION SECTION.                                                                                       030729 
 0064.00       * ======================                                                                                       030728 
 0065.00          SOURCE-COMPUTER. IBM-AS400.                                                                                 030729 
 0066.00          OBJECT-COMPUTER. IBM-AS400.                                                                                 030729 
 0067.00          SPECIAL-NAMES. DATA-AREA IS DATAAREA.                                                                       031017 
 0068.00                                                                                                                      030721 
 0069.00       * ======================                                                                                       030728 
 0070.00         INPUT-OUTPUT SECTION.                                                                                        030729 
 0071.00       * ======================                                                                                       030728 
 0072.00          FILE-CONTROL.                                                                                               030729 
 0073.00                                                                                                                      150401 
 0074.00            SELECT LULV094A ASSIGN TO DATABASE-LULV094A                                                               150528 
 0075.00                   ORGANIZATION IS INDEXED                                                                            150416 
 0076.00                   ACCESS MODE  IS DYNAMIC                                                                            150416 
 0077.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150416 
 0078.00                   FILE STATUS  IS LULV094A-STATUS.                                                                   150528 
 0079.00                                                                                                                      150416 
 0080.00            SELECT REPLERR   ASSIGN TO DATABASE-REPLERR                                                               150407 
 0081.00                   ORGANIZATION IS INDEXED                                                                            150407 
 0082.00                   ACCESS MODE  IS DYNAMIC                                                                            150407 
 0083.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150407 
 0084.00                   WITH DUPLICATES                                                                                    150407 
 0085.00                   FILE STATUS  IS REPLERR-STATUS.                                                                    150407 
 0086.00                                                                                                                      150415 
 0087.00            SELECT COINS  ASSIGN TO DATABASE-COINS                                                                    150415 
 0088.00                   ORGANIZATION IS INDEXED                                                                            150415 
 0089.00                   ACCESS MODE  IS DYNAMIC                                                                            150415 
 0090.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150415 
 0091.00                   FILE STATUS  IS COINS-STATUS.                                                                      150415 
 0092.00                                                                                                                      150415 
 0093.00            SELECT DEDUCT ASSIGN TO DATABASE-DEDUCT                                                                   150415 
 0094.00                   ORGANIZATION IS INDEXED                                                                            150415 
 0095.00                   ACCESS MODE  IS DYNAMIC                                                                            150415 
 0096.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150415 
 0097.00                   FILE STATUS  IS DEDUCT-STATUS.                                                                     150415 
 0098.00                                                                                                                      150407 
 0099.00            SELECT PRDCOV ASSIGN TO DATABASE-PRDCOV                                                                   150402 
 0100.00                   ORGANIZATION IS INDEXED                                                                            150402 
 0101.00                   ACCESS MODE  IS DYNAMIC                                                                            150402 
 0102.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150402 
 0103.00                   FILE STATUS  IS PRDCOV-STATUS.                                                                     150402 
 0104.00                                                                                                                      150402 
 0105.00            SELECT FCONCOVSLC ASSIGN TO DATABASE-FCONCOVSLC                                                           150624 
 0106.00                   ORGANIZATION IS INDEXED                                                                            150401 
 0107.00                   ACCESS MODE  IS DYNAMIC                                                                            150401 
 0108.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150401 
 0109.00                   FILE STATUS  IS FCONCOVSLC-STATUS.                                                                 150624 
 0110.00                                                                                                                      030728 
 0111.00            SELECT FCONFUND ASSIGN TO DATABASE-FCONFUND                                                               150624 
 0112.00                   ORGANIZATION IS INDEXED                                                                            150331 
 0113.00                   ACCESS MODE  IS DYNAMIC                                                                            150331 
 0114.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150331 
 0115.00                   FILE STATUS  IS FCONFUND-STATUS.                                                                   150624 
 0116.00                                                                                                                      150430 
 0117.00            SELECT FCONFUNDIS ASSIGN TO DATABASE-FCONFUNDIS                                                           150624 
 0118.00                   ORGANIZATION IS INDEXED                                                                            150430 
 0119.00                   ACCESS MODE  IS DYNAMIC                                                                            150430 
 0120.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150430 
 0121.00                   FILE STATUS  IS FCONFUNDIS-STATUS.                                                                 150624 
 0122.00                                                                                                                      150331 
 0123.00            SELECT FCONTRACT ASSIGN TO DATABASE-FCONTRACT                                                             150624 
 0124.00                   ORGANIZATION IS INDEXED                                                                            150404 
 0125.00                   ACCESS MODE  IS DYNAMIC                                                                            150404 
 0126.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150404 
 0127.00                   FILE STATUS  IS FCONTRACT-STATUS.                                                                  150624 
 0128.00                                                                                                                      030730 
 0129.00            SELECT FCONLIF   ASSIGN TO DATABASE-FCONLIF                                                               150624 
 0130.00                   ORGANIZATION IS INDEXED                                                                            150324 
 0131.00                   ACCESS MODE  IS DYNAMIC                                                                            150324 
 0132.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150324 
 0133.00                   FILE STATUS  IS FCONLIF-STATUS.                                                                    150624 
 0134.00                                                                                                                      150324 
 0135.00            SELECT FCONCOV   ASSIGN TO DATABASE-FCONCOV                                                               150624 
 0136.00                   ORGANIZATION IS INDEXED                                                                            150324 
 0137.00                   ACCESS MODE  IS DYNAMIC                                                                            150324 
 0138.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150324 
 0139.00                   FILE STATUS  IS FCONCOV-STATUS.                                                                    150624 
 0140.00                                                                                                                      150328 
 0141.00            SELECT FCONCOV1  ASSIGN TO DATABASE-FCONCOV1                                                              150624 
 0142.00                   ORGANIZATION IS INDEXED                                                                            150421 
 0143.00                   ACCESS MODE  IS DYNAMIC                                                                            150421 
 0144.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150421 
 0145.00                   FILE STATUS  IS FCONCOV1-STATUS.                                                                   150624 
 0146.00                                                                                                                      150914 
 0147.00            SELECT FCONCOVM  ASSIGN TO DATABASE-FCONCOVM                                                              150918 
 0148.00                   ORGANIZATION IS INDEXED                                                                            150914 
 0149.00                   ACCESS MODE  IS DYNAMIC                                                                            150914 
 0150.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150914 
 0151.00                   FILE STATUS  IS FCONCOVM-STATUS.                                                                   150914 
 0152.00                                                                                                                      181211 
 0153.00       * logical on covers by life number and coverage code.                                                          181211 
 0154.00            SELECT LFCONCOV  ASSIGN TO DATABASE-LFCONCOV                                                              181211 
 0155.00                   ORGANIZATION IS INDEXED                                                                            181211 
 0156.00                   ACCESS MODE  IS DYNAMIC                                                                            181211 
 0157.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           181211 
 0158.00                   FILE STATUS  IS LFCONCOV-STATUS.                                                                   181211 
 0159.00                                                                                                                      150918 
 0160.00            SELECT FCONLIFM  ASSIGN TO DATABASE-FCONLIFM                                                              150918 
 0161.00                   ORGANIZATION IS INDEXED                                                                            150918 
 0162.00                   ACCESS MODE  IS DYNAMIC                                                                            150918 
 0163.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150918 
 0164.00                   FILE STATUS  IS FCONLIFM-STATUS.                                                                   150918 
 0165.00                                                                                                                      181120 
 0166.00       *  loadings/discounts.                                                                                         181120 
 0167.00            SELECT FCONSPCTRM ASSIGN TO DATABASE-FCONSPCTRM                                                           181120 
 0168.00                   ORGANIZATION IS INDEXED                                                                            181120 
 0169.00                   ACCESS MODE  IS DYNAMIC                                                                            181120 
 0170.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           181120 
 0171.00                   FILE STATUS  IS FCONSPCTRM-STATUS.                                                                 181120 
 0172.00                                                                                                                      181120 
 0173.00       *  loading codes for model points.                                                                             181120 
 0174.00            SELECT FLOAD      ASSIGN TO DATABASE-FLOAD                                                                181120 
 0175.00                   ORGANIZATION IS INDEXED                                                                            181120 
 0176.00                   ACCESS MODE  IS DYNAMIC                                                                            181120 
 0177.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           181120 
 0178.00                   FILE STATUS  IS FLOAD-STATUS.                                                                      181120 
 0179.00                                                                                                                      181211 
 0180.00       *  Covers replacing other covers.                                                                              181211 
 0181.00            SELECT FCOVREPL   ASSIGN TO DATABASE-FCOVREPL                                                             181211 
 0182.00                   ORGANIZATION IS INDEXED                                                                            181211 
 0183.00                   ACCESS MODE  IS DYNAMIC                                                                            181211 
 0184.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           181211 
 0185.00                   FILE STATUS  IS FCOVREPL-STATUS.                                                                   181211 
 0186.00                                                                                                                      150421 
 0187.00            SELECT MPCOVEXC ASSIGN TO DATABASE-MPCOVEXC                                                               150328 
 0188.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0189.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0190.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0191.00                   FILE STATUS  IS MPCOVEXC-STATUS.                                                                   150328 
 0192.00                                                                                                                      150328 
 0193.00            SELECT MPFILE  ASSIGN TO DATABASE-MPFILE                                                                  150401 
 0194.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0195.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0196.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0197.00                   FILE STATUS  IS MPFILE-STATUS.                                                                     150328 
 0198.00                                                                                                                      150511 
 0199.00            SELECT MPFILEPAR ASSIGN TO DATABASE-MPFILEPAR                                                             150511 
 0200.00                   ORGANIZATION IS INDEXED                                                                            150511 
 0201.00                   ACCESS MODE  IS DYNAMIC                                                                            150511 
 0202.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150511 
 0203.00                   FILE STATUS  IS MPFILEPAR-STATUS.                                                                  150511 
 0204.00                                                                                                                      150328 
 0205.00            SELECT MPFREQ   ASSIGN TO DATABASE-MPFREQ                                                                 150328 
 0206.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0207.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0208.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0209.00                   FILE STATUS  IS MPFREQ-STATUS.                                                                     150328 
 0210.00                                                                                                                      150328 
 0211.00            SELECT MPSEX    ASSIGN TO DATABASE-MPSEX                                                                  150328 
 0212.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0213.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0214.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0215.00                   FILE STATUS  IS MPSEX-STATUS.                                                                      150328 
 0216.00                                                                                                                      150418 
 0217.00            SELECT MPGROUP  ASSIGN TO DATABASE-MPGROUP                                                                150418 
 0218.00                   ORGANIZATION IS INDEXED                                                                            150418 
 0219.00                   ACCESS MODE  IS DYNAMIC                                                                            150418 
 0220.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150418 
 0221.00                   FILE STATUS  IS MPGROUP-STATUS.                                                                    150418 
 0222.00                                                                                                                      150324 
 0223.00            SELECT MPSTATUS ASSIGN TO DATABASE-MPSTATUS                                                               150328 
 0224.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0225.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0226.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0227.00                   FILE STATUS  IS MPSTATUS-STATUS.                                                                   150328 
 0228.00                                                                                                                      150420 
 0229.00            SELECT MPWOPRATE ASSIGN TO DATABASE-MPWOPRATE                                                             150420 
 0230.00                   ORGANIZATION IS INDEXED                                                                            150420 
 0231.00                   ACCESS MODE  IS DYNAMIC                                                                            150420 
 0232.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150420 
 0233.00                   FILE STATUS  IS MPWOPRATE-STATUS.                                                                  150420 
 0234.00                                                                                                                      150328 
 0235.00            SELECT MPMDLPNT ASSIGN TO DATABASE-MPMDLPNT                                                               150328 
 0236.00                   ORGANIZATION IS INDEXED                                                                            150328 
 0237.00                   ACCESS MODE  IS DYNAMIC                                                                            150328 
 0238.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150328 
 0239.00                   FILE STATUS  IS MPMDLPNT-STATUS.                                                                   150328 
 0240.00                                                                                                                      150402 
 0241.00            SELECT MPMDLPNTRJ ASSIGN TO DATABASE-MPMDLPNTRJ                                                           150418 
 0242.00                   ORGANIZATION IS INDEXED                                                                            150418 
 0243.00                   ACCESS MODE  IS DYNAMIC                                                                            150418 
 0244.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150418 
 0245.00                   FILE STATUS  IS MPMDLPNTRJ-STATUS.                                                                 150418 
 0246.00                                                                                                                      150428 
 0247.00            SELECT MPMDLPNTNP ASSIGN TO DATABASE-MPMDLPNTNP                                                           150428 
 0248.00                   ORGANIZATION IS INDEXED                                                                            150428 
 0249.00                   ACCESS MODE  IS DYNAMIC                                                                            150428 
 0250.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150428 
 0251.00                   FILE STATUS  IS MPMDLPNTNP-STATUS.                                                                 150428 
 0252.00                                                                                                                      150418 
 0253.00            SELECT MDLNNONAPE ASSIGN TO DATABASE-MDLNNONAPE                                                           171009 
 0254.00                   ORGANIZATION IS INDEXED                                                                            171009 
 0255.00                   ACCESS MODE  IS DYNAMIC                                                                            171009 
 0256.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           171009 
 0257.00                   FILE STATUS  IS MDLNNONAPE-STATUS.                                                                 171009 
 0258.00                                                                                                                      171009 
 0259.00            SELECT MPROOM   ASSIGN TO DATABASE-MPROOM                                                                 150418 
 0260.00                   ORGANIZATION IS INDEXED                                                                            150402 
 0261.00                   ACCESS MODE  IS DYNAMIC                                                                            150402 
 0262.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150402 
 0263.00                   FILE STATUS  IS MPROOM-STATUS.                                                                     150418 
 0264.00                                                                                                                      150616 
 0265.00            SELECT FCONMICRO ASSIGN TO DATABASE-FCONMICRO                                                             150624 
 0266.00                   ORGANIZATION IS INDEXED                                                                            150616 
 0267.00                   ACCESS MODE  IS DYNAMIC                                                                            150616 
 0268.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           150616 
 0269.00                   FILE STATUS  IS FCONMICRO-STATUS.                                                                  150624 
 0270.00                                                                                                                      170209 
 0271.00            SELECT MPANTASF  ASSIGN TO DATABASE-MPANTASF                                                              170209 
 0272.00                   ORGANIZATION IS INDEXED                                                                            170209 
 0273.00                   ACCESS MODE  IS DYNAMIC                                                                            170209 
 0274.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           170209 
 0275.00                   FILE STATUS  IS MPANTASF-STATUS.                                                                   170209 
 0276.00                                                                                                                      170915 
 0277.00            SELECT ZAPE ASSIGN TO DATABASE-ZAPE                                                                       170915 
 0278.00                   ORGANIZATION IS INDEXED                                                                            170915 
 0279.00                   ACCESS MODE  IS DYNAMIC                                                                            170915 
 0280.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           170915 
 0281.00                   FILE STATUS  IS ZAPE-STATUS.                                                                       170915 
 0282.00                                                                                                                      171018 
 0283.00            SELECT MZAPE ASSIGN TO DATABASE-MZAPE                                                                     171018 
 0284.00                   ORGANIZATION IS INDEXED                                                                            171018 
 0285.00                   ACCESS MODE  IS DYNAMIC                                                                            171018 
 0286.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           171018 
 0287.00                   FILE STATUS  IS MZAPE-STATUS.                                                                      171018 
 0288.00                                                                                                                      170927 
 0289.00            SELECT FAPEP ASSIGN TO DATABASE-FAPEP                                                                     170927 
 0290.00                   ORGANIZATION IS INDEXED                                                                            170927 
 0291.00                   ACCESS MODE  IS DYNAMIC                                                                            170927 
 0292.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           170927 
 0293.00                   FILE STATUS  IS FAPEP-STATUS.                                                                      170927 
 0294.00                                                                                                                      180420 
 0295.00            SELECT LHMPMDLPNT  ASSIGN TO DATABASE-LHMPMDLPNT                                                          180420 
 0296.00                   ORGANIZATION IS INDEXED                                                                            180420 
 0297.00                   ACCESS MODE  IS DYNAMIC                                                                            180420 
 0298.00                   RECORD KEY   IS EXTERNALLY-DESCRIBED-KEY                                                           180420 
 0299.00                   FILE STATUS  IS LHMPMDLPNT-STATUS.                                                                 180420 
 0300.00       *============================================================================================================= 030728 
 0301.00        DATA DIVISION.                                                                                                030721 
 0302.00       *============================================================================================================= 030728 
 0303.00                                                                                                                      030721 
 0304.00       * ======================                                                                                       030728 
 0305.00         FILE SECTION.                                                                                                030729 
 0306.00       * ======================                                                                                       030728 
 0307.00                                                                                                                      150407 
 0308.00           FD LULV094A.                                                                                               150528 
 0309.00           01 LULV094A-REC.                                                                                           150528 
 0310.00              COPY DDS-ALL-FORMATS OF LULV094A.                                                                       150528 
 0311.00                                                                                                                      150416 
 0312.00           FD REPLERR.                                                                                                150407 
 0313.00           01 REPLERR-REC.                                                                                            150407 
 0314.00              COPY DDS-ALL-FORMATS OF REPLERR.                                                                        150407 
 0315.00                                                                                                                      150407 
 0316.00           FD MPROOM.                                                                                                 150418 
 0317.00           01 MPROOM-REC.                                                                                             150418 
 0318.00              COPY DDS-ALL-FORMATS OF MPROOM.                                                                         150418 
 0319.00                                                                                                                      150402 
 0320.00           FD DEDUCT.                                                                                                 150415 
 0321.00           01 DEDUCT-REC.                                                                                             150415 
 0322.00              COPY DDS-ALL-FORMATS OF DEDUCT.                                                                         150415 
 0323.00                                                                                                                      150415 
 0324.00           FD COINS.                                                                                                  150415 
 0325.00           01 COINS-REC.                                                                                              150415 
 0326.00              COPY DDS-ALL-FORMATS OF COINS.                                                                          150415 
 0327.00                                                                                                                      150415 
 0328.00           FD PRDCOV.                                                                                                 150402 
 0329.00           01 PRDCOV-REC.                                                                                             150402 
 0330.00              COPY DDS-ALL-FORMATS OF PRDCOV.                                                                         150402 
 0331.00                                                                                                                      150402 
 0332.00           FD FCONCOVSLC.                                                                                             150624 
 0333.00           01 FCONCOVSLC-REC.                                                                                         150624 
 0334.00              COPY DDS-ALL-FORMATS OF FCONCOVSLC.                                                                     150624 
 0335.00                                                                                                                      150401 
 0336.00           FD FCONFUND.                                                                                               150624 
 0337.00           01 FCONFUND-REC.                                                                                           150624 
 0338.00              COPY DDS-ALL-FORMATS OF FCONFUND.                                                                       150624 
 0339.00                                                                                                                      150430 
 0340.00           FD FCONFUNDIS.                                                                                             150624 
 0341.00           01 FCONFUNDIS-REC.                                                                                         150624 
 0342.00              COPY DDS-ALL-FORMATS OF FCONFUNDIS.                                                                     150624 
 0343.00                                                                                                                      150331 
 0344.00           FD FCONTRACT.                                                                                              150624 
 0345.00           01 FCONTRACT-REC.                                                                                          150624 
 0346.00              COPY DDS-ALL-FORMATS OF FCONTRACT.                                                                      150624 
 0347.00                                                                                                                      130606 
 0348.00           FD FCONCOV.                                                                                                150624 
 0349.00           01 FCONCOV-REC.                                                                                            150624 
 0350.00              COPY DDS-ALL-FORMATS OF FCONCOV.                                                                        150624 
 0351.00                                                                                                                      150421 
 0352.00           FD FCONCOV1.                                                                                               150624 
 0353.00           01 FCONCOV1-REC.                                                                                           150624 
 0354.00              COPY DDS-ALL-FORMATS OF FCONCOV1.                                                                       150624 
 0355.00                                                                                                                      150914 
 0356.00           FD FCONCOVM.                                                                                               150914 
 0357.00           01 FCONCOVM-REC.                                                                                           150914 
 0358.00              COPY DDS-ALL-FORMATS OF FCONCOVM.                                                                       150914 
 0359.00                                                                                                                      181211 
 0360.00           FD LFCONCOV.                                                                                               181211 
 0361.00           01 LFCONCOV-REC.                                                                                           181211 
 0362.00              COPY DDS-ALL-FORMATS OF LFCONCOV.                                                                       181211 
 0363.00                                                                                                                      150324 
 0364.00           FD FCONLIF.                                                                                                150624 
 0365.00           01 FCONLIF-REC.                                                                                            150624 
 0366.00              COPY DDS-ALL-FORMATS OF FCONLIF.                                                                        150624 
 0367.00                                                                                                                      150324 
 0368.00           FD FCONLIFM.                                                                                               150918 
 0369.00           01 FCONLIFM-REC.                                                                                           150918 
 0370.00              COPY DDS-ALL-FORMATS OF FCONLIFM.                                                                       150918 
 0371.00                                                                                                                      181120 
 0372.00       *  loadings/discounts.                                                                                         181120 
 0373.00           FD FCONSPCTRM.                                                                                             181120 
 0374.00           01 FCONSPCTRM-REC.                                                                                         181120 
 0375.00              COPY DDS-ALL-FORMATS OF FCONSPCTRM.                                                                     181120 
 0376.00                                                                                                                      181120 
 0377.00       *  loading codes for model points.                                                                             181120 
 0378.00           FD FLOAD.                                                                                                  181120 
 0379.00           01 FLOAD-REC.                                                                                              181120 
 0380.00              COPY DDS-ALL-FORMATS OF FLOAD.                                                                          181120 
 0381.00                                                                                                                      181211 
 0382.00       *  Covers replacing other covers.                                                                              181211 
 0383.00           FD FCOVREPL.                                                                                               181211 
 0384.00           01 FCOVREPL-REC.                                                                                           181211 
 0385.00              COPY DDS-ALL-FORMATS OF FCOVREPL.                                                                       181211 
 0386.00                                                                                                                      150918 
 0387.00           FD MPCOVEXC.                                                                                               150328 
 0388.00           01 MPCOVEXC-REC.                                                                                           150328 
 0389.00              COPY DDS-ALL-FORMATS OF MPCOVEXC.                                                                       150328 
 0390.00                                                                                                                      150328 
 0391.00           FD MPFILE.                                                                                                 150328 
 0392.00           01 MPFILE-REC.                                                                                             150328 
 0393.00              COPY DDS-ALL-FORMATS OF MPFILE.                                                                         150328 
 0394.00                                                                                                                      150328 
 0395.00           FD MPFILEPAR.                                                                                              150511 
 0396.00           01 MPFILEPAR-REC.                                                                                          150511 
 0397.00              COPY DDS-ALL-FORMATS OF MPFILEPAR.                                                                      150511 
 0398.00                                                                                                                      150511 
 0399.00           FD MPFREQ.                                                                                                 150328 
 0400.00           01 MPFREQ-REC.                                                                                             150328 
 0401.00              COPY DDS-ALL-FORMATS OF MPFREQ.                                                                         150328 
 0402.00                                                                                                                      150328 
 0403.00           FD MPSEX.                                                                                                  150328 
 0404.00           01 MPSEX-REC.                                                                                              150402 
 0405.00              COPY DDS-ALL-FORMATS OF MPSEX.                                                                          150328 
 0406.00                                                                                                                      150418 
 0407.00           FD MPGROUP.                                                                                                150418 
 0408.00           01 MPGROUP-REC.                                                                                            150418 
 0409.00              COPY DDS-ALL-FORMATS OF MPGROUP.                                                                        150418 
 0410.00                                                                                                                      150328 
 0411.00           FD MPSTATUS.                                                                                               150328 
 0412.00           01 MPSTATUS-REC.                                                                                           150402 
 0413.00              COPY DDS-ALL-FORMATS OF MPSTATUS.                                                                       150328 
 0414.00                                                                                                                      150420 
 0415.00           FD MPWOPRATE.                                                                                              150420 
 0416.00           01 MPWOPRATE-REC.                                                                                          150420 
 0417.00              COPY DDS-ALL-FORMATS OF MPWOPRATE.                                                                      150420 
 0418.00                                                                                                                      150328 
 0419.00           FD MPMDLPNT.                                                                                               150328 
 0420.00           01 MPMDLPNT-REC.                                                                                           150328 
 0421.00              COPY DDS-ALL-FORMATS OF MPMDLPNT.                                                                       150328 
 0422.00                                                                                                                      180420 
 0423.00           FD LHMPMDLPNT.                                                                                             180420 
 0424.00           01 LHMPMDLPNT-REC.                                                                                         180420 
 0425.00              COPY DDS-ALL-FORMATS OF LHMPMDLPNT.                                                                     180420 
 0426.00                                                                                                                      171030 
 0427.00           FD MPMDLPNTRJ.                                                                                             150418 
 0428.00           01 MPMDLPNTRJ-REC.                                                                                         150418 
 0429.00              COPY DDS-ALL-FORMATS OF MPMDLPNTRJ.                                                                     150418 
 0430.00                                                                                                                      150402 
 0431.00           FD MPMDLPNTNP.                                                                                             150428 
 0432.00           01 MPMDLPNTNP-REC.                                                                                         150428 
 0433.00              COPY DDS-ALL-FORMATS OF MPMDLPNTNP.                                                                     150428 
 0434.00                                                                                                                      171030 
 0435.00           FD MDLNNONAPE.                                                                                             171009 
 0436.00           01 MDLNNONAPE-REC.                                                                                         171009 
 0437.00              COPY DDS-ALL-FORMATS OF MDLNNONAPE.                                                                     171009 
 0438.00                                                                                                                      150616 
 0439.00           FD FCONMICRO.                                                                                              150624 
 0440.00           01 FCONMICRO-REC.                                                                                          150624 
 0441.00              COPY DDS-ALL-FORMATS OF FCONMICRO.                                                                      150624 
 0442.00                                                                                                                      150328 
 0443.00           FD MPANTASF.                                                                                               170209 
 0444.00           01 MPANTASF-REC.                                                                                           170209 
 0445.00              COPY DDS-ALL-FORMATS OF MPANTASF.                                                                       170209 
 0446.00                                                                                                                      170915 
 0447.00           FD ZAPE.                                                                                                   170915 
 0448.00           01 ZAPE-REC.                                                                                               170915 
 0449.00              COPY DDS-ALL-FORMATS OF ZAPE.                                                                           170915 
 0450.00                                                                                                                      170209 
 0451.00           FD MZAPE.                                                                                                  171018 
 0452.00           01 MZAPE-REC.                                                                                              171018 
 0453.00              COPY DDS-ALL-FORMATS OF MZAPE.                                                                          171018 
 0454.00                                                                                                                      171018 
 0455.00           FD FAPEP.                                                                                                  171018 
 0456.00           01 FAPEP-REC.                                                                                              170927 
 0457.00              COPY DDS-ALL-FORMATS OF FAPEP.                                                                          170927 
 0458.00                                                                                                                      171004 
 0459.00         WORKING-STORAGE SECTION.                                                                                     030729 
 0460.00        01  WSAA-VARIABLES.                                                                                           150909 
 0461.00            03  WSAA-COV-ZAPE             PIC  X(10).                                                                 181227 
 0462.00            03  WSAA-IND                  PIC  9(02).                                                                 150909 
 0463.00            03  WSAA-TOP-IND              PIC  9(02).                                                                 171019 
 0464.00            03  WSAA-TOTAL-LOADINGS       PIC  S9(02)V9(5).                                                           181120 
 0465.00            03  WSAA-CURR-LOADING         PIC  S9(02)V9(5).                                                           190214 
 0466.00            03  WSAA-LOADING-1            PIC  S9(03)V9(2).                                                           181120 
 0467.00            03  GET-OLD-ISSUE             PIC  X(01).                                                                 181217 
 0468.00            03  WSAA-CALC-LOADING         PIC  9(01).                                                                 181217 
 0469.00       * used for marking wop activation.                                                                             190205 
 0470.00            03  WOP-STATUS                PIC  9(01).                                                                 190205 
 0471.00                                                                                                                      130520 
 0472.00           77 FOUND-REC                   PIC X(02) VALUE "00".                                                       141022 
 0473.00           77 WRK-FOUND-ZAPE              PIC X(02).                                                                  171004 
 0474.00           77 WRK-FOUND-ZAPE-SLC          PIC X(02).                                                                  171004 
 0475.00           77 WRK-FOUND-NON-APE           PIC X(02).                                                                  171009 
 0476.00           77 WRK-FOUND-ZAPE-SLC-NAPE     PIC X(02).                                                                  171009 
 0477.00           77 WRK-FOUND-FAPEP             PIC X(02).                                                                  171003 
 0478.00           77 WRK-FOUND-NFAPEP            PIC X(02).                                                                  171009 
 0479.00           77 WRK-FOUND-NEW-MODEL         PIC X(02).                                                                  180319 
 0480.00           77 WRK-PROCESS                 PIC X(01).                                                                  180423 
 0481.00           77 STATUS-OK                   PIC X(02) VALUE "00".                                                       141105 
 0482.00           77 FCONTRACT-STATUS            PIC X(02).                                                                  150624 
 0483.00           77 REPLERR-STATUS              PIC X(02).                                                                  150407 
 0484.00           77 MPROOM-STATUS               PIC X(02).                                                                  150418 
 0485.00           77 FCONFUND-STATUS             PIC X(02).                                                                  150624 
 0486.00           77 FCONFUNDIS-STATUS           PIC X(02).                                                                  150624 
 0487.00           77 FCONCOVSLC-STATUS           PIC X(02).                                                                  150624 
 0488.00           77 FCONCOV-STATUS              PIC X(02).                                                                  150624 
 0489.00           77 FCONCOV1-STATUS             PIC X(02).                                                                  150624 
 0490.00           77 FCONCOVM-STATUS             PIC X(02).                                                                  150914 
 0491.00           77 LFCONCOV-STATUS             PIC X(02).                                                                  181211 
 0492.00           77 FCONLIF-STATUS              PIC X(02).                                                                  150624 
 0493.00           77 FCONLIFM-STATUS             PIC X(02).                                                                  150918 
 0494.00       *  loadings/discounts.                                                                                         181120 
 0495.00           77 FCONSPCTRM-STATUS           PIC X(02).                                                                  181120 
 0496.00       *  loading codes for model points.                                                                             181120 
 0497.00           77 FLOAD-STATUS                PIC X(02).                                                                  181120 
 0498.00       *  covers to be considered original.                                                                           181217 
 0499.00           77 FCOVREPL-STATUS             PIC X(02).                                                                  181217 
 0500.00           77 LULV094A-STATUS             PIC X(02).                                                                  150528 
 0501.00           77 MPCOVEXC-STATUS             PIC X(02).                                                                  150328 
 0502.00           77 MPFILE-STATUS               PIC X(02).                                                                  150328 
 0503.00           77 MPFILEPAR-STATUS            PIC X(02).                                                                  150511 
 0504.00           77 MPFREQ-STATUS               PIC X(02).                                                                  150328 
 0505.00           77 MPSEX-STATUS                PIC X(02).                                                                  150328 
 0506.00           77 MPGROUP-STATUS              PIC X(02).                                                                  150418 
 0507.00           77 MPSTATUS-STATUS             PIC X(02).                                                                  150401 
 0508.00           77 MPWOPRATE-STATUS            PIC X(02).                                                                  150420 
 0509.00           77 MPMDLPNT-STATUS             PIC X(02).                                                                  150328 
 0510.00           77 LHMPMDLPNT-STATUS           PIC X(02).                                                                  180420 
 0511.00           77 MPMDLPNTRJ-STATUS           PIC X(02).                                                                  150418 
 0512.00           77 MPMDLPNTNP-STATUS           PIC X(02).                                                                  150428 
 0513.00           77 MDLNNONAPE-STATUS           PIC X(02).                                                                  171009 
 0514.00           77 WMPREJRESN                  PIC X(50).                                                                  150623 
 0515.00           77 FCONMICRO-STATUS            PIC X(02).                                                                  150624 
 0516.00           77 MPANTASF-STATUS             PIC X(02).                                                                  170209 
 0517.00           77 ZAPE-STATUS                 PIC X(02).                                                                  171004 
 0518.00           77 MZAPE-STATUS                PIC X(02).                                                                  171018 
 0519.00           77 FAPEP-STATUS                PIC X(02).                                                                  170927 
 0520.00           77 PRDCOV-STATUS               PIC X(02).                                                                  150402 
 0521.00           77 DEDUCT-STATUS               PIC X(02).                                                                  150415 
 0522.00           77 COINS-STATUS                PIC X(02).                                                                  150415 
 0523.00           77 RUNDATE                     PIC 9(08).                                                                  150327 
 0524.00           77 MSLICE                      PIC 9(01).                                                                  150423 
 0525.00           77 FND-MSLICE                  PIC 9(01).                                                                  150423 
 0526.00           77 W1POLNUM                    PIC X(07).                                                                  150402 
 0527.00           77 WPOLNUM1                    PIC 9(07).                                                                  150402 
 0528.00           77 W2POLNUM                    PIC X(08).                                                                  150402 
 0529.00           77 WPOLNUM2                    PIC 9(08).                                                                  150402 
 0530.00           77 D1                          PIC S9(15)V9(2).                                                            150607 
 0531.00           77 D2                          PIC S9(15)V9(2).                                                            150607 
 0532.00           77 D3                          PIC S9(15)V9(2).                                                            150607 
 0533.00           77 D4                          PIC S9(15).                                                                 150607 
 0534.00           77 WRK-FNDBAS                  PIC  9(01).                                                                 150422 
 0535.00           77 WRK-INCLUDE-COVER           PIC  9(01).                                                                 150601 
 0536.00           77 WRRN                        PIC  9(15).                                                                 180606 
 0537.00           77 WRRN1                       PIC  9(06).                                                                 150418 
 0538.00           77 WMINF                       PIC  9(06).                                                                 150417 
 0539.00           77 WFUNDUNTVAL                 PIC S9(15)V9(2).                                                            150417 
 0540.00           77 WRK-MPTOPUPTOT              PIC S9(13)V9(2).                                                            150909 
 0541.00           77 WRK-MPTOPUPTOTNP            PIC S9(13)V9(2).                                                            180320 
 0542.00           77 WRK-MPTOPUPTUL              PIC S9(13)V9(2).                                                            170505 
 0543.00           77 WRK-MPTOPUPY1               PIC S9(13)V9(2).                                                            170505 
 0544.00           77 WRK-MPTOPUPY2               PIC S9(13)V9(2).                                                            150909 
 0545.00           77 WRK-MPTOPUPY3               PIC S9(13)V9(2).                                                            150909 
 0546.00           77 WRK-MPTOPUPY4               PIC S9(13)V9(2).                                                            150909 
 0547.00           77 WRK-MPTOPUPY5               PIC S9(13)V9(2).                                                            150909 
 0548.00           77 WRK-MPTOPUP6PLUS            PIC S9(13)V9(2).                                                            150910 
 0549.00           77 WRK-MPTOPUPTOTGR            PIC S9(13)V9(2).                                                            170901 
 0550.00           77 WRK-MPTOPUPY1GR             PIC S9(13)V9(2).                                                            170901 
 0551.00           77 WRK-MPTOPUPY2GR             PIC S9(13)V9(2).                                                            170901 
 0552.00           77 WRK-MPTOPUPY3GR             PIC S9(13)V9(2).                                                            170901 
 0553.00           77 WRK-MPTOPUPY4GR             PIC S9(13)V9(2).                                                            170901 
 0554.00           77 WRK-MPTOPUPY5GR             PIC S9(13)V9(2).                                                            170901 
 0555.00           77 WRK-MPTOPUP6PLUSGR          PIC S9(13)V9(2).                                                            170901 
 0556.00           77 WRK-ZANNPRM                 PIC S9(15)V9(2).                                                            171018 
 0557.00           77 WRK-INIANETPRM              PIC S9(15)V9(2).                                                            180424 
 0558.00           77 WRATE                       PIC S9(16)V9(6).                                                            150420 
 0559.00           77 WSYMB                       PIC  X(07).                                                                 150417 
 0560.00           77 WRK-PRCAGE                  PIC  9(03).                                                                 150515 
 0561.00           77 WRK-RSKCESSBAS              PIC  9(03).                                                                 150516 
 0562.00           77 WRK-RSKCESSCOV              PIC  9(03).                                                                 150516 
 0563.00           77 WRK-CURRAGE                 PIC  9(03).                                                                 150516 
 0564.00           77 WRK-MPPRMTRM                PIC S9(04).                                                                 161209 
 0565.00           77 WRK-MPPRMTRM1               PIC S9(04).                                                                 161209 
 0566.00           77 WRSKCOMMAGE                 PIC  9(03).                                                                 150515 
 0567.00           77 WRK-WR-EXCL                 PIC  9(01).                                                                 150422 
 0568.00           77 WRK-FILFROMBASCOV           PIC  9(01).                                                                 150422 
 0569.00           77 WRK-MPPRDGRPBAS             PIC  X(50).                                                                 150521 
 0570.00           77 WRK-EXCLUDE                 PIC  9(01).                                                                 150423 
 0571.00           77 WRK-FOUNDFILFLD             PIC  9(01).                                                                 150511 
 0572.00           77 WRK-AGEDURATION             PIC  9(04).                                                                 150426 
 0573.00           77 WRK-1AGEDURATION            PIC  9(04).                                                                 150426 
 0574.00           77 WRK-2AGEDURATION            PIC  9(04).                                                                 150426 
 0575.00           77 WRK-3AGEDURATION            PIC S9(04).                                                                 161209 
 0576.00           77 WRK-4AGEDURATION            PIC S9(04).                                                                 161209 
 0577.00           77 WRK-MPMONIF                 PIC S9(07)V9(3).                                                            150910 
 0578.00           77 WRK-BAS-MPAGEENTR           PIC  9(03).                                                                 150509 
 0579.00           77 WRK-FRSTSLC                 PIC  9(03).                                                                 150509 
 0580.00           77 WRK-LEK                     PIC  X(07).                                                                 150520 
 0581.00           77 WRK-M1FPOLNUM               PIC  X(08).                                                                 150914 
 0582.00           77 WRK-MPFPOLNUM               PIC  9(08).                                                                 150914 
 0583.00           77 WRK-MPCLNTCOD               PIC  9(08).                                                                 150910 
 0584.00           77 WRK-MPNOTINV                PIC S9(13)V9(2).                                                            150910 
 0585.00           77 WRK-NPMPNOTINV              PIC S9(13)V9(2).                                                            150918 
 0586.00           77 WRK-NPMPIMPMLP              PIC S9(5)V9(2).                                                             150918 
 0587.00           77 WRK-NINVAMT                 PIC S9(13)V9(2).                                                            150911 
 0588.00           77 WRK-FINALMPNOTINV           PIC S9(13)V9(2).                                                            150910 
 0589.00           77 WRK-FNDSLICES               PIC  9(01).                                                                 150910 
 0590.00           77 WRK-FNDTUM                  PIC  X(01).                                                                 171019 
 0591.00           77 WRK-NEW-TOPUP               PIC  X(01).                                                                 171019 
 0592.00           77 WRK-FNDANTASF               PIC  9(01).                                                                 170209 
 0593.00           77 WRK-COVERNP                 PIC  X(10).                                                                 150915 
 0594.00           77 WRK-MPMAINCOD               PIC  X(30).                                                                 161121 
 0595.00           77 WRK-COVNO                   PIC  9(02).                                                                 170901 
 0596.00           77 WSAA-LIFENUM                PIC  X(08).                                                                 171004 
 0597.00           77 WRK-CHECKSLC-DATE           PIC  X(01).                                                                 171023 
 0598.00           77 WRK-FJCOVCODE               PIC  X(06).                                                                 180126 
 0599.00           77 WRK5-FJCOVCODE              PIC  X(06).                                                                 180126 
 0600.00                                                                                                                      180125 
 0601.00           01 WRK4-FJCOVCODE.                                                                                         180126 
 0602.00              03 WRK1-FJCOVCODE           PIC  X(02).                                                                 180126 
 0603.00              03 WRK2-FJCOVCODE           PIC  X(01).                                                                 180126 
 0604.00              03 WRK3-FJCOVCODE           PIC  X(03).                                                                 180126 
 0605.00                                                                                                                      170928 
 0606.00           01 WRKISSUE.                                                                                               150328 
 0607.00              03 WRKISSY                     PIC  9(04).                                                              161130 
 0608.00              03 WRKISSM                     PIC  9(02).                                                              150328 
 0609.00              03 WRKISSD                     PIC  9(02).                                                              150328 
 0610.00                                                                                                                      150330 
 0611.00           01 WRKFIRSTIS.                                                                                             150330 
 0612.00              03 WRKFIRY                     PIC  9(04).                                                              150330 
 0613.00              03 WRKFIRM                     PIC  9(02).                                                              150330 
 0614.00              03 WRKFIRD                     PIC  9(02).                                                              150330 
 0615.00       *                                                                                                              141110 
 0616.00                                                                                                                      161125 
 0617.00           01 WRK-DATE8.                                                                                              150427 
 0618.00              03 WRK-YEAR                    PIC  9(04).                                                              150427 
 0619.00              03 WRK-MONTH                   PIC  9(02).                                                              150427 
 0620.00              03 WRK-DAY                     PIC  9(02).                                                              150427 
 0621.00                                                                                                                      150328 
 0622.00            01 WRK-DATE9.                                                                                             150427 
 0623.00              03 WRK9YEAR                    PIC  9(04).                                                              150427 
 0624.00              03 WRK9MONTH                   PIC  9(02).                                                              150427 
 0625.00              03 WRK9DAY                     PIC  9(02).                                                              150427 
 0626.00                                                                                                                      150628 
 0627.00                                                                                                                      170921 
 0628.00            01 WRK-DT1.                                                                                               150628 
 0629.00              03 WRKYYYY                     PIC  S9(04).                                                             150628 
 0630.00              03 WRKMM                       PIC  S9(02).                                                             150628 
 0631.00              03 WRKDD                       PIC  S9(02).                                                             150628 
 0632.00                                                                                                                      150628 
 0633.00            01 WRK-DT2.                                                                                               150628 
 0634.00              03 WRKYYYY                     PIC  S9(04).                                                             150628 
 0635.00              03 WRKMM                       PIC  S9(02).                                                             150628 
 0636.00              03 WRKDD                       PIC  S9(02).                                                             150628 
 0637.00                                                                                                                      150331 
 0638.00            01 WRK-PAYDT.                                                                                             150427 
 0639.00               03 WRK-PAYDTYEAR              PIC  9(04).                                                              150427 
 0640.00               03 WRK-PAYDTMONTH             PIC  9(02).                                                              150427 
 0641.00               03 WRK-PAYDTDAY               PIC  9(02).                                                              150427 
 0642.00                                                                                                                      150424 
 0643.00            01 WRK-MPSTATUSDATE.                                                                                      150427 
 0644.00               03 WRK-MPSTATUSY              PIC  9(04).                                                              150427 
 0645.00               03 WRK-MPSTATUSM              PIC  9(02).                                                              150427 
 0646.00               03 WRK-MPSTATUSD              PIC  9(02).                                                              150427 
 0647.00                                                                                                                      150328 
 0648.00              03 WRK-RUNDT                   PIC  9(08).                                                              150427 
 0649.00              03  WRK-BREAK-RUNDT REDEFINES  WRK-RUNDT.                                                               150427 
 0650.00                  05 WRK-RUNY                PIC  9(04).                                                              150427 
 0651.00                  05 WRK-RUNM                PIC  9(02).                                                              150427 
 0652.00                  05 WRK-RUND                PIC  9(02).                                                              150427 
 0653.00                                                                                                                      180327 
 0654.00              03 WRK-FIRSTRUNDATE            PIC  9(08).                                                              180327 
 0655.00              03  WRK-BREAK-RUNDT REDEFINES  WRK-FIRSTRUNDATE.                                                        180327 
 0656.00                  05 WRK-FIRSTRUNYEAR        PIC  9(04).                                                              180327 
 0657.00                  05 WRK-FIRSTRUNMONTH       PIC  9(02).                                                              180327 
 0658.00                  05 WRK-FIRSTRUNDAY         PIC  9(02).                                                              180327 
 0659.00                                                                                                                      180319 
 0660.00              03 WRK-RUNDT-FROM              PIC  9(08).                                                              180319 
 0661.00              03  WRK-BREAK-RUNDTFROM REDEFINES  WRK-RUNDT-FROM.                                                      180319 
 0662.00                  05 WRK-RUNYFROM            PIC  9(04).                                                              180319 
 0663.00                  05 WRK-RUNMFROM            PIC  9(02).                                                              180319 
 0664.00                  05 WRK-RUNDFROM            PIC  9(02).                                                              180319 
 0665.00                                                                                                                      150428 
 0666.00              03 WRK-RUNDT-TO                PIC  9(08).                                                              180319 
 0667.00              03  WRK-BREAK-RUNDTO REDEFINES  WRK-RUNDT-TO.                                                           180319 
 0668.00                  05 WRK-RUNYTO              PIC  9(04).                                                              180319 
 0669.00                  05 WRK-RUNMTO              PIC  9(02).                                                              180319 
 0670.00                  05 WRK-RUNDTO              PIC  9(02).                                                              180319 
 0671.00                                                                                                                      180319 
 0672.00              03 WRK-EFFD-ZAPE               PIC  9(08).                                                              170921 
 0673.00              03  WRK-BREAK-WRK-EFFD-ZAPE REDEFINES WRK-EFFD-ZAPE.                                                    170921 
 0674.00                  05 WRKEFFZ-YEAR            PIC  9(04).                                                              170921 
 0675.00                  05 WRKEFFZ-MONTH           PIC  9(02).                                                              170921 
 0676.00                  05 WRKEFFZ-DAY             PIC  9(02).                                                              170921 
 0677.00                                                                                                                      171018 
 0678.00              03 WRK-EFFD-MZAPE              PIC  9(08).                                                              171018 
 0679.00              03  WRK-BREAK-WRK-EFFD-MZAPE REDEFINES WRK-EFFD-MZAPE.                                                  171018 
 0680.00                  05 WRKMEFFZ-YEAR           PIC  9(04).                                                              171018 
 0681.00                  05 WRKMEFFZ-MONTH          PIC  9(02).                                                              171018 
 0682.00                  05 WRKMEFFZ-DAY            PIC  9(02).                                                              171018 
 0683.00                                                                                                                      170928 
 0684.00              03 WRK-EFFD-FAPE               PIC  9(08).                                                              170928 
 0685.00              03  WRK-BREAK-WRK-EFFD-FAPE REDEFINES WRK-EFFD-FAPE.                                                    170928 
 0686.00                  05 WRKEFFP-YEAR            PIC  9(04).                                                              170928 
 0687.00                  05 WRKEFFP-MONTH           PIC  9(02).                                                              170928 
 0688.00                  05 WRKEFFP-DAY             PIC  9(02).                                                              170928 
 0689.00                                                                                                                      170921 
 0690.00              03 WRK-COMPCOD                 PIC  X(2).                                                               170929 
 0691.00              03  WRK-BREAK-COMPCOD REDEFINES  WRK-COMPCOD.                                                           170929 
 0692.00                  05 WRK-FCHDRCOY            PIC  9(01).                                                              170929 
 0693.00                  05 WRK-FILLER              PIC  9(01).                                                              170929 
 0694.00              03 WRK-CONNBR                  PIC  X(15).                                                              170928 
 0695.00              03  WRK-BREAK-CONNBR REDEFINES  WRK-CONNBR.                                                             170928 
 0696.00                  05 WRK-FCHDRNUM            PIC  9(07).                                                              170929 
 0697.00                                                                                                                      170929 
 0698.00              03 WRK-FREQCOD                 PIC  X(2).                                                               171002 
 0699.00              03  WRK-BREAK-FREQCOD REDEFINES  WRK-FREQCOD.                                                           171002 
 0700.00                  05 WRK-WFREQCOD            PIC  9(02).                                                              171002 
 0701.00                                                                                                                      171002 
 0702.00              03 WRK-CLNTCOD                 PIC  X(10).                                                              170929 
 0703.00              03  WRK-BREAK-CLNTCOD REDEFINES  WRK-CLNTCOD.                                                           170929 
 0704.00                  05 WRK-FLIFENUM            PIC  9(08).                                                              170929 
 0705.00                                                                                                                      170929 
 0706.00              03 WRK-CURRENTDATE             PIC  9(08).                                                              150428 
 0707.00              03  WRK-BREAK-WRK-CURRENTDATE REDEFINES  WRK-CURRENTDATE.                                               150428 
 0708.00                  05 WRK-CURRY               PIC  9(04).                                                              150428 
 0709.00                  05 WRK-CURRM               PIC  9(02).                                                              150428 
 0710.00                  05 WRK-CURRD               PIC  9(02).                                                              150428 
 0711.00                                                                                                                      150428 
 0712.00              03 WRK-CURRENTAPO              PIC  9(08).                                                              150428 
 0713.00              03  WRK-BREAK-WRK-CURRENTAPO  REDEFINES  WRK-CURRENTAPO.                                                150428 
 0714.00                  05 WRK-CURRAPOY            PIC  9(04).                                                              150428 
 0715.00                  05 WRK-CURRAPOM            PIC  9(02).                                                              150428 
 0716.00                  05 WRK-CURRAPOD            PIC  9(02).                                                              150428 
 0717.00                                                                                                                      150428 
 0718.00              03 WRK-CURRENTEOS              PIC  9(08).                                                              150428 
 0719.00              03  WRK-BREAK-WRK-CURRENTEOS  REDEFINES  WRK-CURRENTEOS.                                                150428 
 0720.00                  05 WRK-CURREOSY            PIC  9(04).                                                              150428 
 0721.00                  05 WRK-CURREOSM            PIC  9(02).                                                              150428 
 0722.00                  05 WRK-CURREOSD            PIC  9(02).                                                              150428 
 0723.00                                                                                                                      150427 
 0724.00              03  WRK-INCPDATE               PIC  9(08).                                                              150427 
 0725.00              03  WRK-BREAK-INCPDATE REDEFINES WRK-INCPDATE.                                                          150427 
 0726.00                  05 WRK-INCPYEAR            PIC  9(04).                                                              150427 
 0727.00                  05 WRK-INCPMON             PIC  9(02).                                                              150427 
 0728.00                  05 WRK-INCPDAY             PIC  9(02).                                                              150427 
 0729.00       *                                                                                                              150403 
 0730.00              03  WSAA-DATE                  PIC  9(08).                                                              150407 
 0731.00              03  WSAA-BREAK-DATE.                                                                                    150407 
 0732.00                  05  WSAA-BREAK-DATE-Y      PIC  X(04).                                                              150407 
 0733.00                  05  WSAA-BREAK-DATE-M      PIC  X(02).                                                              150407 
 0734.00                  05  WSAA-BREAK-DATE-D      PIC  X(02).                                                              150407 
 0735.00                                                                                                                      150910 
 0736.00              03  WSAA-COVER                 PIC  X(10).                                                              150910 
 0737.00              03  WSAA-BREAK-COVER.                                                                                   150910 
 0738.00                  05  WSAA-BREAK-COV3        PIC  X(03).                                                              150910 
 0739.00                  05  WSAA-BREAK-COV4        PIC  X(01).                                                              150910 
 0740.00                  05  WSAA-BREAK-COV6        PIC  X(06).                                                              150910 
 0741.00                                                                                                                      150910 
 0742.00              03  WSAA-TIME                  PIC  X(08).                                                              150407 
 0743.00              03  WSAA-BREAK-TIME.                                                                                    150407 
 0744.00                  05  WSAA-BREAK-TIME-H      PIC  X(02).                                                              150407 
 0745.00                  05  WSAA-BREAK-TIME-M      PIC  X(02).                                                              150407 
 0746.00                  05  WSAA-BREAK-TIME-S      PIC  X(02).                                                              150407 
 0747.00                  05  WSAA-BREAK-TIME-L      PIC  X(02).                                                              150407 
 0748.00              03  WSAA-TIMESTAMP.                                                                                     150407 
 0749.00                  05  WSAA-TIMESTAMP-D.                                                                               150407 
 0750.00                      07  WSAA-TIMESTAMP-D-Y PIC  X(04).                                                              150407 
 0751.00                      07  FILLER             PIC  X(01).                                                              150407 
 0752.00                      07  WSAA-TIMESTAMP-D-M PIC  X(02).                                                              150407 
 0753.00                      07  FILLER             PIC  X(01).                                                              150407 
 0754.00                      07  WSAA-TIMESTAMP-D-D PIC  X(02).                                                              150407 
 0755.00                      07  FILLER             PIC  X(01).                                                              150407 
 0756.00                  05  WSAA-TIMESTAMP-T.                                                                               150407 
 0757.00                      07  WSAA-TIMESTAMP-T-H PIC  X(02).                                                              150407 
 0758.00                      07  FILLER             PIC  X(01).                                                              150407 
 0759.00                      07  WSAA-TIMESTAMP-T-M PIC  X(02).                                                              150407 
 0760.00                      07  FILLER             PIC  X(01).                                                              150407 
 0761.00                      07  WSAA-TIMESTAMP-T-S PIC  X(02).                                                              150407 
 0762.00                      07  FILLER             PIC  X(01).                                                              150407 
 0763.00                      07  WSAA-TIMESTAMP-T-L PIC  X(02).                                                              150407 
 0764.00                  05  WSAA-TIMESTAMP-T-0     PIC  X(04).                                                              150407 
 0765.00       *                                                                                                              141106 
 0766.00           01 WSCC-CONSTANTS.                                                                                         150407 
 0767.00              03  WSCC-20000000              PIC  9(08) VALUE 20000000.                                               150407 
 0768.00              03  WSCC-PAVLA                 PIC  X(01) VALUE '-'.                                                    150407 
 0769.00              03  WSCC-TELEIA                PIC  X(01) VALUE '.'.                                                    150407 
 0770.00              03  WSCC-100                   PIC  9(03) VALUE 100.                                                    181120 
 0771.00              03  WSCC-MILLION               PIC  9(07) VALUE 1000000.                                                181120 
 0772.00              03  WSCC-1                     PIC  9(01) VALUE 1.                                                      181211 
 0773.00              03  WSCC-0                     PIC  9(01) VALUE 0.                                                      190205 
 0774.00              03  WSCC-Y                     PIC  X(01) VALUE 'Y'.                                                    181217 
 0775.00              03  WSCC-N                     PIC  X(01) VALUE 'N'.                                                    181217 
 0776.00       *                                                                                                              190204 
 0777.00       * This is the nelis client number (CCS), not the life400 one.                                                  190204 
 0778.00       * It is the same for both systems. For Piraeus is not applicable.                                              190204 
 0779.00              03  WSCC-NN-CLIENT             PIC  9(08) VALUE 210332.                                                 190204 
 0780.00                                                                                                                      181205 
 0781.00           01 WS88-CONTROL-FLAG.                                                                                      181205 
 0782.00              03  WS88-READ-LOADINGS         PIC  X(01).                                                              181205 
 0783.00                  88  READ-LOADINGS                  VALUE 'Y'.                                                       181205 
 0784.00                  88  NOT-READ-LOADINGS              VALUE 'N'.                                                       181205 
 0785.00                                                                                                                      150407 
 0786.00           03   WSAA-CONCOVSLC-RECS.                                                                                  150909 
 0787.00                05 WSAA-TOPUP  OCCURS  99.                                                                            150909 
 0788.00                   07 WSAA-RUNDT       PIC 9(08).                                                                     150909 
 0789.00                   07 WSAA-COMPCOD     PIC X(01).                                                                     150909 
 0790.00                   07 WSAA-DSBCHACOD   PIC X(02).                                                                     150909 
 0791.00                   07 WSAA-BRCHCOD     PIC X(02).                                                                     150909 
 0792.00                   07 WSAA-SYSAPPCOD   PIC X(02).                                                                     150909 
 0793.00                   07 WSAA-CONNBR      PIC X(15).                                                                     150909 
 0794.00                   07 WSAA-LIFNO       PIC 9(02).                                                                     150909 
 0795.00                   07 WSAA-COVNO       PIC 9(02).                                                                     150909 
 0796.00                   07 WSAA-COVCOD      PIC X(10).                                                                     150909 
 0797.00                   07 WSAA-STSCOD      PIC X(02).                                                                     150909 
 0798.00                   07 WSAA-STSDT       PIC 9(08).                                                                     150909 
 0799.00                   07 WSAA-RSKCOMMDT   PIC 9(08).                                                                     150909 
 0800.00                   07 WSAA-RSKCESSDT   PIC 9(08).                                                                     150909 
 0801.00                   07 WSAA-PRMCESSDT   PIC 9(08).                                                                     150909 
 0802.00                   07 WSAA-BENCESSDT   PIC 9(08).                                                                     150909 
 0803.00                   07 WSAA-PRCAGE      PIC 9(03).                                                                     150909 
 0804.00                   07 WSAA-RSKCOMMAGE  PIC 9(03).                                                                     150909 
 0805.00                   07 WSAA-RSKCESSAGE  PIC 9(03).                                                                     150909 
 0806.00                   07 WSAA-RSKCESSTRM  PIC 9(03).                                                                     150909 
 0807.00                   07 WSAA-COVYEARNO   PIC 9(03).                                                                     150909 
 0808.00                   07 WSAA-CONCESSAGE  PIC 9(03).                                                                     150909 
 0809.00                   07 WSAA-SUMINSAMT   PIC S9(15)V9(2).                                                               150909 
 0810.00                   07 WSAA-ANNNETPRM   PIC S9(15)V9(2).                                                               150909 
 0811.00                   07 WSAA-INIANETPRM  PIC S9(15)V9(2).                                                               160115 
 0812.00                   07 WSAA-ININETPRM   PIC S9(15)V9(2).                                                               160115 
 0813.00                   07 WSAA-SGLNETPRM   PIC S9(15)V9(2).                                                               150909 
 0814.00                   07 WSAA-ISTNETPRM   PIC S9(15)V9(2).                                                               150909 
 0815.00                   07 WSAA-ISTGRSPRM   PIC S9(15)V9(2).                                                               150909 
 0816.00                   07 WSAA-CLNTORGCOD  PIC X(02).                                                                     150909 
 0817.00                   07 WSAA-CAMPCOD     PIC X(06).                                                                     150909 
 0818.00                   07 WSAA-DIVAMT      PIC S9(15)V9(2).                                                               150909 
 0819.00                   07 WSAA-LOANOUTAMT  PIC S9(15)V9(2).                                                               150909 
 0820.00                   07 WSAA-NINVAMT     PIC S9(15)V9(2).                                                               150914 
 0821.00                   07 WSAA-CLNTCODL4   PIC X(08).                                                                     171004 
 0822.00                                                                                                                      171019 
 0823.00           03   WSAA-FCONCOVSLC-TOPUPS-RECS.                                                                          171019 
 0824.00                05 WSAA-TOPUP-NEW  OCCURS  99.                                                                        171019 
 0825.00                   07 WSAA-NRUNDT       PIC 9(08).                                                                    171019 
 0826.00                   07 WSAA-NCOMPCOD     PIC X(01).                                                                    171019 
 0827.00                   07 WSAA-NDSBCHACOD   PIC X(02).                                                                    171019 
 0828.00                   07 WSAA-NBRCHCOD     PIC X(02).                                                                    171019 
 0829.00                   07 WSAA-NSYSAPPCOD   PIC X(02).                                                                    171019 
 0830.00                   07 WSAA-NCONNBR      PIC X(15).                                                                    171019 
 0831.00                   07 WSAA-NLIFNO       PIC 9(02).                                                                    171019 
 0832.00                   07 WSAA-NCOVNO       PIC 9(02).                                                                    171019 
 0833.00                   07 WSAA-NCOVCOD      PIC X(10).                                                                    171019 
 0834.00                   07 WSAA-NSTSCOD      PIC X(02).                                                                    171019 
 0835.00                   07 WSAA-NSTSDT       PIC 9(08).                                                                    171019 
 0836.00                   07 WSAA-NRSKCOMMDT   PIC 9(08).                                                                    171019 
 0837.00                   07 WSAA-NRSKCESSDT   PIC 9(08).                                                                    171019 
 0838.00                   07 WSAA-NPRMCESSDT   PIC 9(08).                                                                    171019 
 0839.00                   07 WSAA-NBENCESSDT   PIC 9(08).                                                                    171019 
 0840.00                   07 WSAA-NPRCAGE      PIC 9(03).                                                                    171019 
 0841.00                   07 WSAA-NRSKCOMMAGE  PIC 9(03).                                                                    171019 
 0842.00                   07 WSAA-NRSKCESSAGE  PIC 9(03).                                                                    171019 
 0843.00                   07 WSAA-NRSKCESSTRM  PIC 9(03).                                                                    171019 
 0844.00                   07 WSAA-NCOVYEARNO   PIC 9(03).                                                                    171019 
 0845.00                   07 WSAA-NCONCESSAGE  PIC 9(03).                                                                    171019 
 0846.00                   07 WSAA-NSUMINSAMT   PIC S9(15)V9(2).                                                              171019 
 0847.00                   07 WSAA-NANNNETPRM   PIC S9(15)V9(2).                                                              171019 
 0848.00                   07 WSAA-NINIANETPRM  PIC S9(15)V9(2).                                                              171019 
 0849.00                   07 WSAA-NININETPRM   PIC S9(15)V9(2).                                                              171019 
 0850.00                   07 WSAA-NSGLNETPRM   PIC S9(15)V9(2).                                                              171019 
 0851.00                   07 WSAA-NISTNETPRM   PIC S9(15)V9(2).                                                              171019 
 0852.00                   07 WSAA-NISTGRSPRM   PIC S9(15)V9(2).                                                              171019 
 0853.00                   07 WSAA-NCLNTORGCOD  PIC X(02).                                                                    171019 
 0854.00                   07 WSAA-NCAMPCOD     PIC X(06).                                                                    171019 
 0855.00                   07 WSAA-NDIVAMT      PIC S9(15)V9(2).                                                              171019 
 0856.00                   07 WSAA-NLOANOUTAMT  PIC S9(15)V9(2).                                                              171019 
 0857.00                   07 WSAA-NNINVAMT     PIC S9(15)V9(2).                                                              171019 
 0858.00                   07 WSAA-NCLNTCODL4   PIC X(08).                                                                    171020 
 0859.00                                                                                                                      150909 
 0860.00           01 WRK-BASFCOV-REC.                                                                                        150624 
 0861.00              COPY DDS-ALL-FORMATS OF FCONCOV.                                                                        150624 
 0862.00                                                                                                                      150423 
 0863.00           01 WRK-FCONCOV-REC.                                                                                        150624 
 0864.00              COPY DDS-ALL-FORMATS OF FCONCOV.                                                                        150624 
 0865.00                                                                                                                      150610 
 0866.00           01 WRK-MPMDLPNT-REC.                                                                                       150610 
 0867.00              COPY DDS-ALL-FORMATS OF MPMDLPNT.                                                                       150610 
 0868.00                                                                                                                      150422 
 0869.00           01 WRK1-MPMDLPNT-REC.                                                                                      150914 
 0870.00              COPY DDS-ALL-FORMATS OF MPMDLPNT.                                                                       150914 
 0871.00                                                                                                                      150914 
 0872.00           01 WRK-MPFILE-REC.                                                                                         150422 
 0873.00              COPY DDS-ALL-FORMATS OF MPFILE.                                                                         150422 
 0874.00                                                                                                                      150422 
 0875.00           01 WRK-BASFCONLIF-REC.                                                                                     150624 
 0876.00              COPY DDS-ALL-FORMATS OF FCONLIF.                                                                        150624 
 0877.00                                                                                                                      150422 
 0878.00                                                                                                                      150909 
 0879.00         LINKAGE SECTION.                                                                                             141106 
 0880.00           01 PARAMETERS.                                                                                             141106 
 0881.00              03 DATE-KLEIS                  PIC X(08).                                                               141110 
 0882.00       *============================================================================================================= 030728 
 0883.00        PROCEDURE DIVISION USING PARAMETERS.                                                                          141110 
 0884.00       *============================================================================================================= 030728 
 0885.00                                                                                                                      030721 
 0886.00         MAIN SECTION.                                                                                                141029 
 0887.00                                                                                                                      130521 
 0888.00            OPEN INPUT FCONTRACT FCONCOV FCONLIF MPCOVEXC MPFILE MPFREQ            Open files                         150624 
 0889.00            OPEN INPUT MPSEX MPSTATUS FCONFUND FCONFUNDIS FCONCOVSLC                                                  150624 
 0890.00            OPEN INPUT PRDCOV DEDUCT COINS LULV094A MPROOM MPGROUP                                                    150528 
 0891.00            OPEN INPUT MPWOPRATE FCONCOV1 MPFILEPAR FCONMICRO FCONCOVM                                                150914 
 0892.00            OPEN INPUT FCONLIFM MPANTASF ZAPE FAPEP MZAPE                                                             171018 
 0893.00            OPEN INPUT LFCONCOV                                                   covers by cover code                181217 
 0894.00            OPEN INPUT LHMPMDLPNT                                                                                     180420 
 0895.00            OPEN INPUT FCONSPCTRM FLOAD                                           loadings/discounts                  181120 
 0896.00            OPEN INPUT FCOVREPL                                                   cover replacements                  181211 
 0897.00                 I-O   MPMDLPNT REPLERR MPMDLPNTRJ MPMDLPNTNP MDLNNONAPE                                              171009 
 0898.00                                                                                  Initial Routine                     150422 
 0899.00            PERFORM INITIALIZE-ROUTINE                                                                                150422 
 0900.00            PERFORM MAIN-ROUTINE                                                                                      150422 
 0901.00                                                                                  Close Files                         030730 
 0902.00            CLOSE FCONTRACT FCONCOV FCONLIF MPMDLPNT MPCOVEXC MPFILE                                                  150624 
 0903.00            CLOSE MPFREQ MDLNNONAPE                                                                                   171009 
 0904.00            CLOSE MPSEX MPSTATUS FCONFUND FCONFUNDIS FCONCOVSLC                                                       150624 
 0905.00            CLOSE PRDCOV REPLERR DEDUCT COINS LULV094A MPROOM MPMDLPNTRJ                                              150528 
 0906.00            CLOSE MPGROUP MPWOPRATE FCONCOV1 MPMDLPNTNP MPFILEPAR                                                     150624 
 0907.00            CLOSE FCONMICRO FCONCOVM FCONLIFM MPANTASF ZAPE FAPEP MZAPE                                               171018 
 0908.00            CLOSE LFCONCOV                                                        covers by cover code                181217 
 0909.00            CLOSE LHMPMDLPNT                                                                                          180507 
 0910.00            CLOSE FCONSPCTRM FLOAD                                                loadings/discounts                  181120 
 0911.00            CLOSE FCOVREPL                                                        cover replacements                  181211 
 0912.00                                                                                                                      030730 
 0913.00            GOBACK.                                                                                                   150422 
 0914.00                                                                                                                      150422 
 0915.00       *------------------------------------------------------------------------------------------------------------- 030730 
 0916.00         INITIALIZE-ROUTINE SECTION.                                                                                  141023 
 0917.00       *------------------------------------------------------------------------------------------------------------- 030730 
 0918.00       *    DATE-KLEISIMATOS                                                                                          150422 
 0919.00            MOVE DATE-KLEIS TO RUNDATE                                                                                150327 
 0920.00            MOVE RUNDATE    TO WRK-RUNDT                                                                              150422 
 0921.00            MOVE RUNDATE    TO WRK-FIRSTRUNDATE                                                                       180327 
 0922.00            MOVE 01         TO WRK-FIRSTRUNDAY                                                                        180327 
 0923.00            MOVE ZEROES     TO WRRN                                                                                   150511 
 0924.00            MOVE ZEROES     TO WRRN1                                                                                  150511 
 0925.00       * DATES FOR  HISTORY NEW BUSINESS READING                                                                      180319 
 0926.00       * FROM 31/01/RUNYEAR                                                                                           180319 
 0927.00       * TO 31/12/RUNYEAR  EXAMPLE: FOR  11/2017                                                                      180319 
 0928.00       * IT WILL SEARCH NEW BUSINESS FROM 01/01/2017 TO 31/12/2017                                                    180319 
 0929.00       * FOR THE FIRST MONTH DOES N'T CHECK PREVIOUS MONTH                                                            180319 
 0930.00            MOVE WRK-RUNY   TO WRK-RUNYFROM                                                                           180319 
 0931.00            MOVE 01         TO WRK-RUNMFROM                                                                           180319 
 0932.00            MOVE 31         TO WRK-RUNDFROM                                                                           180319 
 0933.00                                                                                                                      180319 
 0934.00            MOVE WRK-RUNY   TO WRK-RUNYTO                                                                             180319 
 0935.00            MOVE 12         TO WRK-RUNMTO                                                                             180319 
 0936.00            MOVE 31         TO WRK-RUNDTO                                                                             180322 
 0937.00                                                                                                                      150422 
 0938.00            .                                                                                                         141023 
 0939.00            END-INITIALIZE-ROUTINE.                                                                                   141023 
 0940.00            EXIT.                                                                                                     141023 
 0941.00                                                                                                                      150422 
 0942.00       *------------------------------------------------------------------------------------------------------------- 030730 
 0943.00         MAIN-ROUTINE SECTION.                                                                                        141023 
 0944.00       *------------------------------------------------------------------------------------------------------------- 030730 
 0945.00       *    READ FCONTRACT                                                                                            150624 
 0946.00       *    -------------                                                                                             150422 
 0947.00            INITIALIZE CONTRACTR       OF FCONTRACT-REC                                                               150624 
 0948.00            MOVE RUNDATE    TO RUNDT   OF FCONTRACT-REC                                                               150624 
 0949.00            MOVE LOW-VALUES TO COMPCOD OF FCONTRACT-REC                                                               150624 
 0950.00       *             WRK-FNDSLICES   SLICES   MC ME TUM  FCONCOVSLC                                150914 
 0951.00       *         OR  WRK-FNDSLICES   SLICES   UR ME TU05,06                                           180507 
 0952.00       *         OR  TU07,08,TU09  FCONCOVSLC                                                                      180507 
 0953.00            INITIALIZE WRK-FNDSLICES                                                                                  150915 
 0954.00            INITIALIZE WRK-COVERNP                                                                                    150915 
 0955.00                                                                                                                      150327 
 0956.00            START FCONTRACT KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                        150624 
 0957.00            READ  FCONTRACT NEXT                                                                                      150624 
 0958.00                                                                                                                      150327 
 0959.00            PERFORM UNTIL FCONTRACT-STATUS NOT = FOUND-REC                                                            150624 
 0960.00                       OR RUNDATE          NOT = RUNDT OF FCONTRACT-REC                                               150624 
 0961.00                                                                                                                      150422 
 0962.00               INITIALIZE WRK-BASFCOV-REC                                                                             150624 
 0963.00               INITIALIZE WRK-BASFCONLIF-REC                                                                          150624 
 0964.00               MOVE 0      TO WRK-FNDBAS                                                                              150521 
 0965.00               MOVE 0      TO WRK-FILFROMBASCOV                                                                       150521 
 0966.00               MOVE SPACES TO WRK-MPPRDGRPBAS                                                                         150521 
 0967.00                                                                                                                      150422 
 0968.00               PERFORM RFCONLIF-ROUTINE                                                                               150624 
 0969.00                                                                                                                      150422 
 0970.00               READ FCONTRACT NEXT                                                                                    150624 
 0971.00                                                                                                                      141022 
 0972.00            END-PERFORM                                                                                               141022 
 0973.00                                                                                                                      150422 
 0974.00            .                                                                                                         141023 
 0975.00            END-MAIN-ROUTINE.                                                                                         141105 
 0976.00            EXIT.                                                                                                     130706 
 0977.00                                                                                                                      150422 
 0978.00       *------------------------------------------------------------------------------------------------------------- 141023 
 0979.00         RFCONLIF-ROUTINE SECTION.                                                                                    150624 
 0980.00       *------------------------------------------------------------------------------------------------------------- 141023 
 0981.00            INITIALIZE CONLIFR  OF FCONLIF-REC                                                                        150624 
 0982.00                                                                                                                      150327 
 0983.00            MOVE RUNDT     OF FCONTRACT-REC TO RUNDT     OF FCONLIF-REC                                               150624 
 0984.00            MOVE COMPCOD   OF FCONTRACT-REC TO COMPCOD   OF FCONLIF-REC                                               150624 
 0985.00            MOVE DSBCHACOD OF FCONTRACT-REC TO DSBCHACOD OF FCONLIF-REC                                               150624 
 0986.00            MOVE BRCHCOD   OF FCONTRACT-REC TO BRCHCOD   OF FCONLIF-REC                                               150624 
 0987.00            MOVE SYSAPPCOD OF FCONTRACT-REC TO SYSAPPCOD OF FCONLIF-REC                                               150624 
 0988.00            MOVE CONNBR    OF FCONTRACT-REC TO CONNBR    OF FCONLIF-REC                                               150624 
 0989.00            MOVE LOW-VALUES                TO LIFNO      OF FCONLIF-REC                                               150624 
 0990.00                                                                                                                      150327 
 0991.00            START FCONLIF KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                          150624 
 0992.00            READ  FCONLIF  NEXT                                                                                       150624 
 0993.00                                                                                                                      150327 
 0994.00            PERFORM    UNTIL  FCONLIF-STATUS NOT = FOUND-REC                                                          150624 
 0995.00              OR RUNDT     OF FCONTRACT-REC NOT =                                                                     150624 
 0996.00                 RUNDT     OF FCONLIF-REC                                                                             150624 
 0997.00              OR COMPCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 0998.00                 COMPCOD   OF FCONLIF-REC                                                                             150624 
 0999.00              OR DSBCHACOD OF FCONTRACT-REC NOT =                                                                     150624 
 1000.00                 DSBCHACOD OF FCONLIF-REC                                                                             150624 
 1001.00              OR BRCHCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 1002.00                 BRCHCOD   OF FCONLIF-REC                                                                             150624 
 1003.00              OR SYSAPPCOD OF FCONTRACT-REC NOT =                                                                     150624 
 1004.00                 SYSAPPCOD OF FCONLIF-REC                                                                             150624 
 1005.00              OR CONNBR    OF FCONTRACT-REC NOT =                                                                     150624 
 1006.00                 CONNBR    OF FCONLIF-REC                                                                             150624 
 1007.00                                                                                                                      150327 
 1008.00              PERFORM PROCESS-COVER                                                                                   150422 
 1009.00                                                                                                                      150327 
 1010.00              READ FCONLIF   NEXT                                                                                     150624 
 1011.00                                                                                                                      150327 
 1012.00            END-PERFORM                                                                                               150327 
 1013.00                                                                                                                      150422 
 1014.00            .                                                                                                         141023 
 1015.00            END-RFCONLIF-ROUTINE.                                                                                     150624 
 1016.00            EXIT.                                                                                                     141023 
 1017.00                                                                                                                      150422 
 1018.00       *------------------------------------------------------------------------------------------------------------- 150327 
 1019.00         PROCESS-COVER SECTION.                                                                                       150402 
 1020.00       *------------------------------------------------------------------------------------------------------------- 150327 
 1021.00            INITIALIZE CONCOVR OF FCONCOV-REC                                                                         150624 
 1022.00                                                                                                                      150327 
 1023.00            MOVE RUNDT     OF FCONLIF-REC TO RUNDT     OF FCONCOV-REC                                                 150624 
 1024.00            MOVE COMPCOD   OF FCONLIF-REC TO COMPCOD   OF FCONCOV-REC                                                 150624 
 1025.00            MOVE DSBCHACOD OF FCONLIF-REC TO DSBCHACOD OF FCONCOV-REC                                                 150624 
 1026.00            MOVE BRCHCOD   OF FCONLIF-REC TO BRCHCOD   OF FCONCOV-REC                                                 150624 
 1027.00            MOVE SYSAPPCOD OF FCONLIF-REC TO SYSAPPCOD OF FCONCOV-REC                                                 150624 
 1028.00            MOVE CONNBR    OF FCONLIF-REC TO CONNBR    OF FCONCOV-REC                                                 150624 
 1029.00            MOVE LIFNO     OF FCONLIF-REC TO LIFNO     OF FCONCOV-REC                                                 150624 
 1030.00            MOVE LOW-VALUES              TO COVNO      OF FCONCOV-REC                                                 150624 
 1031.00                                                                                                                      150327 
 1032.00            START FCONCOV KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                          150624 
 1033.00            READ  FCONCOV  NEXT                                                                                       150624 
 1034.00                                                                                                                      150327 
 1035.00            PERFORM  UNTIL FCONCOV-STATUS NOT = FOUND-REC                                                             150624 
 1036.00              OR RUNDT     OF FCONLIF-REC NOT = RUNDT     OF FCONCOV-REC                                              150624 
 1037.00              OR COMPCOD   OF FCONLIF-REC NOT = COMPCOD   OF FCONCOV-REC                                              150624 
 1038.00              OR DSBCHACOD OF FCONLIF-REC NOT = DSBCHACOD OF FCONCOV-REC                                              150624 
 1039.00              OR BRCHCOD   OF FCONLIF-REC NOT = BRCHCOD   OF FCONCOV-REC                                              150624 
 1040.00              OR SYSAPPCOD OF FCONLIF-REC NOT = SYSAPPCOD OF FCONCOV-REC                                              150624 
 1041.00              OR CONNBR    OF FCONLIF-REC NOT = CONNBR    OF FCONCOV-REC                                              150624 
 1042.00              OR LIFNO     OF FCONLIF-REC NOT = LIFNO     OF FCONCOV-REC                                              150624 
 1043.00                                                                                                                      150401 
 1044.00              INITIALIZE MPMDLPNTR OF MPMDLPNT-REC                                                                    150422 
 1045.00              INITIALIZE MPMDLPNTR OF MPMDLPNTRJ-REC                                                                  150422 
 1046.00              INITIALIZE MPMDLPNTR OF MPMDLPNTNP-REC                                                                  150428 
 1047.00              INITIALIZE MDLNNONAPR OF MDLNNONAPE-REC                                                                 171009 
 1048.00       ****   MOVE ZEROES TO WRK-INCLUDE-COVER                                                                        170922 
 1049.00                                                                                                                      150422 
 1050.00              MOVE FCONCOV-REC TO WRK-FCONCOV-REC                                                                     150624 
 1051.00              MOVE RSKCOMMDT OF WRK-FCONCOV-REC TO WRK-DATE9                                                          150624 
 1052.00                                                                                                                      150515 
 1053.00              IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                    150624 
 1054.00                 PERFORM  READ-FCONFUNDBA                                                                             150624 
 1055.00              ELSE                                                                                                    150523 
 1056.00                 PERFORM  READ-FCONFUND                                                                               150624 
 1057.00              END-IF                                                                                                  150523 
 1058.00                                                                                                                      150429 
 1059.00              MOVE 0 TO WRK-WR-EXCL                                                                                   150601 
 1060.00              PERFORM CHECK-INFOMPF                                                                                   150601 
 1061.00                                                                                                                      150519 
 1062.00       ****   IF   COVTYPCOD OF MPFILE-REC   NOT = 'U'                                                                170922 
 1063.00       ****   AND  COVTYPCOD OF MPFILE-REC   NOT = 'M'                                                                170922 
 1064.00       ****      IF (STSCOD    OF FCONCOV-REC       = 'IF' OR                                                         170920 
 1065.00       ****          STSCOD    OF FCONCOV-REC       = 'PU'   )                                                        170920 
 1066.00       ****         MOVE 1 TO WRK-INCLUDE-COVER                                                                       170922 
 1067.00       ****      END-IF                                                                                               170920 
 1068.00       ****   ELSE                                                                                                    170922 
 1069.00       ****       IF  MPFNDAMT  OF MPMDLPNT-REC NOT = 0                                                               170922 
 1070.00       ****           MOVE 1  TO WRK-INCLUDE-COVER                                                                    170922 
 1071.00       ****           MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                              170922 
 1072.00       ****       END-IF                                                                                              170922 
 1073.00       ****       IF  MPFNDAMT  OF MPMDLPNT-REC     = 0                                                               170922 
 1074.00       ****       AND WRK9YEAR                      = WRK-RUNY                                                        170922 
 1075.00       ****       AND (STSCOD   OF FCONCOV-REC      = 'IF' OR                                                         170920 
 1076.00       ****            STSCOD   OF FCONCOV-REC      = 'PU'   )                                                        170920 
 1077.00       ****           MOVE 1 TO WRK-INCLUDE-COVER                                                                     170922 
 1078.00       ****           MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                              170922 
 1079.00       ****       END-IF                                                                                              170922 
 1080.00       ****   END-IF                                                                                                  170922 
 1081.00                                                                                                                      150606 
 1082.00       ****   IF WRK-INCLUDE-COVER = 1                                                                                170922 
 1083.00                 IF  MPFILE-STATUS = FOUND-REC                                                                        150601 
 1084.00       *                                                                                                              181121 
 1085.00       *       Var_Data_1 (not used).                                                                                 181205 
 1086.00                    MOVE ZEROS           TO MPVARDTA OF MPMDLPNT-REC                                                  181121 
 1087.00       *                                                                                                              181121 
 1088.00       *       loadings and reductions (sum).                                                                         181121 
 1089.00                    MOVE ZEROES          TO MPLDNDSC OF MPMDLPNT-REC                                                  181205 
 1090.00                    PERFORM CHK-COV-FOR-LOADINGS                                                                      181205 
 1091.00                    IF READ-LOADINGS                                                                                  181205 
 1092.00                        PERFORM GET-LOADINGS                                                                          181205 
 1093.00       *                                                                                                              190214 
 1094.00       *                Decrease by 1 to get final total loadings.                                                    190222 
 1095.00       *                Negative percentage means discount,                                                           190222 
 1096.00       *                Positive percentage means surcharge.                                                          190222 
 1097.00       *                                                                                                              190214 
 1098.00                        IF WSAA-TOTAL-LOADINGS NOT = ZERO                                                             190222 
 1099.00                          COMPUTE WSAA-TOTAL-LOADINGS                                                                 190222 
 1100.00                                        = WSAA-TOTAL-LOADINGS                                                         190226 
 1101.00                                        - WSCC-1                                                                      190226 
 1102.00                          END-COMPUTE                                                                                 190222 
 1103.00                        END-IF                                                                                        190214 
 1104.00                        MOVE WSAA-TOTAL-LOADINGS                                                                      181205 
 1105.00                                         TO MPLDNDSC OF MPMDLPNT-REC                                                  181121 
 1106.00                    END-IF                                                                                            181205 
 1107.00                                                                                                                      150423 
 1108.00                    IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                              150624 
 1109.00                       INITIALIZE MPFNDAMT  OF MPMDLPNT-REC                                                           150521 
 1110.00                       INITIALIZE MPUNIPRC  OF MPMDLPNT-REC                                                           150521 
 1111.00                       INITIALIZE MPUNINBR  OF MPMDLPNT-REC                                                           150521 
 1112.00                       IF COVTYPCOD OF MPFILE-REC = 'U'                                                               150521 
 1113.00                       OR COVTYPCOD OF MPFILE-REC = 'M'                                                               150620 
 1114.00                          PERFORM  READ-FCONFUNDBA                                                                    150624 
 1115.00                       END-IF                                                                                         150521 
 1116.00                    END-IF                                                                                            150521 
 1117.00                                                                                                                      150521 
 1118.00                    IF  MPMAINCOD  OF MPMDLPNT-REC = SPACES                                                           150423 
 1119.00                    AND MPRMAINCOD OF MPMDLPNT-REC = SPACES                                                           150423 
 1120.00                    AND MPULCOD    OF MPMDLPNT-REC = SPACES                                                           150423 
 1121.00                    AND MPRIDCOD   OF MPMDLPNT-REC = SPACES                                                           150423 
 1122.00                        PERFORM WRITE-REPLERR                                                                         150423 
 1123.00                    ELSE                                                                                              150423 
 1124.00                                                                                                                      150423 
 1125.00       *                FIND SLICES IF SLICED                                                                         150423 
 1126.00       *                AND IF SLICED WRITE FROM FCONCOVSLC                                                           150624 
 1127.00                        MOVE ZEROES TO FND-MSLICE                                                                     150423 
 1128.00       *    TWL2   LIFE400                                                    151103 
 1129.00       * KI OXI A  FCONCOVSLC                                                                                     151103 
 1130.00                        IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                          151103 
 1131.00                        IF MSLICE = 1                                                                                 150423 
 1132.00                           PERFORM CHECK-FCONCOVSLC                                                                   150624 
 1133.00                        END-IF                                                                                        150423 
 1134.00                        END-IF                                                                                        151103 
 1135.00                                                                                                                      150422 
 1136.00       *                IF NOT SLICED WRITE FROM FCONCOV                                                              150624 
 1137.00                        IF FND-MSLICE = 0                                                                             150423 
 1138.00                                                                                                                      150911 
 1139.00                                                                                                                      150911 
 1140.00       * load current cover to work field.                                                                            181211 
 1141.00                           MOVE FCONCOV-REC TO WRK-FCONCOV-REC                                                        150624 
 1142.00       * write model point record.                                                                                    181211 
 1143.00                           PERFORM  WRITE-MODELP                                                                      170920 
 1144.00                           PERFORM  PROCESS-NEWBUSINESS                                                               150430 
 1145.00       *  TUM      FCONCOVSLC                                                             171004 
 1146.00       *23/8/2017 same logic for TU05,TU06,TU07,TU08 with TUM                                                         180507 
 1147.00       ****                IF COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TUM'                                                 171009 
 1148.00                           IF COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TUM'                                                 171004 
 1149.00                           OR COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TU0'                                                 180507 
 1150.00                           AND WRK-FNDSLICES ='1'                                                                     171004 
 1151.00                              PERFORM PROCESS-NPFORTUM                                                                171004 
 1152.00                           END-IF                                                                                     171004 
 1153.00                                                                                                                      150429 
 1154.00                        END-IF                                                                                        150911 
 1155.00                                                                                                                      150423 
 1156.00                    END-IF                                                                                            150429 
 1157.00                                                                                                                      150423 
 1158.00                 END-IF                                                                                               150429 
 1159.00                                                                                                                      150327 
 1160.00       ****   END-IF                                                                                                  170922 
 1161.00                                                                                                                      150910 
 1162.00              READ FCONCOV   NEXT                                                                                     150624 
 1163.00                                                                                                                      150327 
 1164.00            END-PERFORM                                                                                               150911 
 1165.00                                                                                                                      150911 
 1166.00            .                                                                                                         150327 
 1167.00            END-PROCESS-COVER.                                                                                        150402 
 1168.00            EXIT.                                                                                                     150327 
 1169.00                                                                                                                      150423 
 1170.00       *------------------------------------------------------------------------------------------------------------- 150423 
 1171.00         CHECK-FCONCOVSLC SECTION.                                                                                    150624 
 1172.00       *------------------------------------------------------------------------------------------------------------- 150423 
 1173.00            INITIALIZE CONCOVSLCR OF FCONCOVSLC-REC                                                                   150624 
 1174.00            MOVE ZEROES TO WRK-FRSTSLC                                                                                150509 
 1175.00                                                                                                                      150423 
 1176.00            MOVE RUNDT     OF FCONCOV-REC TO RUNDT     OF FCONCOVSLC-REC                                              150624 
 1177.00            MOVE COMPCOD   OF FCONCOV-REC TO COMPCOD   OF FCONCOVSLC-REC                                              150624 
 1178.00            MOVE DSBCHACOD OF FCONCOV-REC TO DSBCHACOD OF FCONCOVSLC-REC                                              150624 
 1179.00            MOVE BRCHCOD   OF FCONCOV-REC TO BRCHCOD   OF FCONCOVSLC-REC                                              150624 
 1180.00            MOVE SYSAPPCOD OF FCONCOV-REC TO SYSAPPCOD OF FCONCOVSLC-REC                                              150624 
 1181.00            MOVE CONNBR    OF FCONCOV-REC TO CONNBR    OF FCONCOVSLC-REC                                              150624 
 1182.00            MOVE LIFNO     OF FCONCOV-REC TO LIFNO     OF FCONCOVSLC-REC                                              150624 
 1183.00            MOVE COVNO     OF FCONCOV-REC TO COVNO     OF FCONCOVSLC-REC                                              150624 
 1184.00            MOVE LOW-VALUES              TO RSKCOMMDT  OF FCONCOVSLC-REC                                              150624 
 1185.00                                                                                                                      150423 
 1186.00            START FCONCOVSLC KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                       150624 
 1187.00            READ  FCONCOVSLC NEXT                                                                                     150624 
 1188.00                                                                                                                      150423 
 1189.00            PERFORM UNTIL FCONCOVSLC-STATUS NOT = STATUS-OK                                                           150624 
 1190.00             OR RUNDT     OF FCONCOV-REC NOT =                                                                        150624 
 1191.00                RUNDT     OF FCONCOVSLC-REC                                                                           150624 
 1192.00             OR COMPCOD   OF FCONCOV-REC NOT =                                                                        150624 
 1193.00                COMPCOD   OF FCONCOVSLC-REC                                                                           150624 
 1194.00             OR DSBCHACOD OF FCONCOV-REC NOT =                                                                        150624 
 1195.00                DSBCHACOD OF FCONCOVSLC-REC                                                                           150624 
 1196.00             OR BRCHCOD   OF FCONCOV-REC NOT =                                                                        150624 
 1197.00                BRCHCOD   OF FCONCOVSLC-REC                                                                           150624 
 1198.00             OR SYSAPPCOD OF FCONCOV-REC NOT =                                                                        150624 
 1199.00                SYSAPPCOD OF FCONCOVSLC-REC                                                                           150624 
 1200.00             OR CONNBR    OF FCONCOV-REC NOT =                                                                        150624 
 1201.00                CONNBR    OF FCONCOVSLC-REC                                                                           150624 
 1202.00             OR LIFNO     OF FCONCOV-REC NOT =                                                                        150624 
 1203.00                LIFNO     OF FCONCOVSLC-REC                                                                           150624 
 1204.00             OR CONNBR    OF FCONCOV-REC NOT =                                                                        150624 
 1205.00                CONNBR    OF FCONCOVSLC-REC                                                                           150624 
 1206.00             OR LIFNO     OF FCONCOV-REC NOT =                                                                        150624 
 1207.00                LIFNO     OF FCONCOVSLC-REC                                                                           150624 
 1208.00             OR COVNO     OF FCONCOV-REC NOT =                                                                        150624 
 1209.00                COVNO     OF FCONCOVSLC-REC                                                                           150624 
 1210.00                                                                                                                      150423 
 1211.00                MOVE 1 TO FND-MSLICE                                                                                  150423 
 1212.00                ADD  1 TO WRK-FRSTSLC                                                                                 150509 
 1213.00                IF WRK-FRSTSLC > 1                                                                                    150509 
 1214.00                   MOVE ZEROES TO MPLOANAMT OF MPMDLPNT-REC                                                           150509 
 1215.00                   MOVE ZEROES TO MPDIVAMT  OF MPMDLPNT-REC                                                           150516 
 1216.00                END-IF                                                                                                150509 
 1217.00                                                                                                                      150423 
 1218.00                PERFORM MOVESLCWRK                                                                                    150423 
 1219.00       ****     IF  STSCOD  OF WRK-FCONCOV-REC       = 'IF'                                                           170920 
 1220.00       ****     OR  STSCOD  OF WRK-FCONCOV-REC       = 'PU'                                                           170920 
 1221.00                    PERFORM  WRITE-MODELP                                                                             150430 
 1222.00                    PERFORM  PROCESS-NEWBUSINESS                                                                      150430 
 1223.00       *****    END-IF                                                                                                170920 
 1224.00                                                                                                                      150423 
 1225.00                READ FCONCOVSLC  NEXT                                                                                 150624 
 1226.00            END-PERFORM                                                                                               150423 
 1227.00                                                                                                                      150909 
 1228.00            .                                                                                                         150423 
 1229.00         END-CHECK-FCONCOVSLC.                                                                                        150624 
 1230.00            EXIT.                                                                                                     150423 
 1231.00                                                                                                                      150423 
 1232.00       *------------------------------------------------------------------------------------------------------------- 150324 
 1233.00         MOVESLCWRK SECTION.                                                                                          150423 
 1234.00       *------------------------------------------------------------------------------------------------------------- 150324 
 1235.00       *                                                                                                              150402 
 1236.00            MOVE RUNDT     OF FCONCOVSLC-REC                                                                          150624 
 1237.00              TO RUNDT     OF WRK-FCONCOV-REC                                                                         150624 
 1238.00            MOVE COMPCOD   OF FCONCOVSLC-REC                                                                          150624 
 1239.00              TO COMPCOD   OF WRK-FCONCOV-REC                                                                         150624 
 1240.00            MOVE DSBCHACOD OF FCONCOVSLC-REC                                                                          150624 
 1241.00              TO DSBCHACOD OF WRK-FCONCOV-REC                                                                         150624 
 1242.00            MOVE BRCHCOD   OF FCONCOVSLC-REC                                                                          150624 
 1243.00              TO BRCHCOD   OF WRK-FCONCOV-REC                                                                         150624 
 1244.00            MOVE SYSAPPCOD OF FCONCOVSLC-REC                                                                          150624 
 1245.00              TO SYSAPPCOD OF WRK-FCONCOV-REC                                                                         150624 
 1246.00            MOVE CONNBR    OF FCONCOVSLC-REC                                                                          150624 
 1247.00              TO CONNBR    OF WRK-FCONCOV-REC                                                                         150624 
 1248.00            MOVE LIFNO     OF FCONCOVSLC-REC                                                                          150624 
 1249.00              TO LIFNO     OF WRK-FCONCOV-REC                                                                         150624 
 1250.00            MOVE COVNO     OF FCONCOVSLC-REC                                                                          150624 
 1251.00              TO COVNO     OF WRK-FCONCOV-REC                                                                         150624 
 1252.00            MOVE COVCOD    OF FCONCOVSLC-REC                                                                          150624 
 1253.00              TO COVCOD    OF WRK-FCONCOV-REC                                                                         150624 
 1254.00            MOVE STSCOD    OF FCONCOVSLC-REC                                                                          150624 
 1255.00              TO STSCOD    OF WRK-FCONCOV-REC                                                                         150624 
 1256.00            MOVE STSDT     OF FCONCOVSLC-REC                                                                          150624 
 1257.00              TO STSDT     OF WRK-FCONCOV-REC                                                                         150624 
 1258.00            MOVE RSKCOMMDT OF FCONCOVSLC-REC                                                                          150624 
 1259.00              TO RSKCOMMDT OF WRK-FCONCOV-REC                                                                         150624 
 1260.00            MOVE RSKCESSDT OF FCONCOVSLC-REC                                                                          150624 
 1261.00              TO RSKCESSDT OF WRK-FCONCOV-REC                                                                         150624 
 1262.00            MOVE PRMCESSDT OF FCONCOVSLC-REC                                                                          150624 
 1263.00              TO PRMCESSDT OF WRK-FCONCOV-REC                                                                         150624 
 1264.00            MOVE BENCESSDT OF FCONCOVSLC-REC                                                                          150624 
 1265.00              TO BENCESSDT OF WRK-FCONCOV-REC                                                                         150624 
 1266.00            MOVE PRCAGE    OF FCONCOVSLC-REC                                                                          150624 
 1267.00              TO PRCAGE    OF WRK-FCONCOV-REC                                                                         150624 
 1268.00            MOVE RSKCOMMAGE OF FCONCOVSLC-REC                                                                         150624 
 1269.00              TO RSKCOMMAGE OF WRK-FCONCOV-REC                                                                        150624 
 1270.00            MOVE RSKCESSAGE OF FCONCOVSLC-REC                                                                         150624 
 1271.00              TO RSKCESSAGE OF WRK-FCONCOV-REC                                                                        150624 
 1272.00            MOVE RSKCESSTRM OF FCONCOVSLC-REC                                                                         150624 
 1273.00              TO RSKCESSTRM OF WRK-FCONCOV-REC                                                                        150624 
 1274.00            MOVE COVYEARNO  OF FCONCOVSLC-REC                                                                         150624 
 1275.00              TO COVYEARNO  OF WRK-FCONCOV-REC                                                                        150624 
 1276.00            MOVE CONCESSAGE OF FCONCOVSLC-REC                                                                         150624 
 1277.00              TO CONCESSAGE OF WRK-FCONCOV-REC                                                                        150624 
 1278.00            MOVE SUMINSAMT  OF FCONCOVSLC-REC                                                                         150624 
 1279.00              TO SUMINSAMT  OF WRK-FCONCOV-REC                                                                        150624 
 1280.00            MOVE INIANETPRM OF FCONCOVSLC-REC                                                                         160114 
 1281.00              TO INIANETPRM OF WRK-FCONCOV-REC                                                                        160114 
 1282.00            MOVE SGLNETPRM OF FCONCOVSLC-REC                                                                          150624 
 1283.00              TO SGLNETPRM OF WRK-FCONCOV-REC                                                                         150624 
 1284.00            MOVE ISTNETPRM OF FCONCOVSLC-REC                                                                          150624 
 1285.00              TO ISTNETPRM OF WRK-FCONCOV-REC                                                                         150624 
 1286.00            MOVE ININETPRM OF FCONCOVSLC-REC                                                                          160115 
 1287.00              TO ININETPRM OF WRK-FCONCOV-REC                                                                         160115 
 1288.00            MOVE ISTGRSPRM OF FCONCOVSLC-REC                                                                          150624 
 1289.00              TO ISTGRSPRM OF WRK-FCONCOV-REC                                                                         150624 
 1290.00            MOVE CLNTORGCOD OF FCONCOVSLC-REC                                                                         150624 
 1291.00              TO CLNTORGCOD OF WRK-FCONCOV-REC                                                                        150624 
 1292.00            MOVE CAMPCOD    OF FCONCOVSLC-REC                                                                         150624 
 1293.00              TO CAMPCOD    OF WRK-FCONCOV-REC                                                                        150624 
 1294.00            MOVE TIMESTMP   OF FCONCOVSLC-REC                                                                         150624 
 1295.00              TO TIMESTMP   OF WRK-FCONCOV-REC                                                                        150624 
 1296.00            MOVE LOANOUTAMT OF FCONCOVSLC-REC                                                                         150624 
 1297.00              TO MPLOANAMT  OF MPMDLPNT-REC                                                                           150610 
 1298.00            .                                                                                                         150423 
 1299.00         END-MOVESLCWRK.                                                                                              150423 
 1300.00            EXIT.                                                                                                     150423 
 1301.00                                                                                                                      150423 
 1302.00       *------------------------------------------------------------------------------------------------------------- 150423 
 1303.00         WRITE-MODELP SECTION.                                                                                        150423 
 1304.00       *------------------------------------------------------------------------------------------------------------- 150423 
 1305.00                                                                                                                      150423 
 1306.00       *    it is refactored into BIF writing routine WRITE-BIF-REC.                                                  190220 
 1307.00       **** COMPUTE WRRN = WRRN + 1                                                                                   190220 
 1308.00       **** MOVE WRRN TO MPCMPIDF OF MPMDLPNT-REC                                                                     190220 
 1309.00                                                                                                                      150513 
 1310.00       * calculate actual cover issue date.                                                                           181217 
 1311.00            PERFORM  CALC-ISSUE-DATE                                                                                  181217 
 1312.00                                                                                                                      181217 
 1313.00       *                                                                                                              181217 
 1314.00       *    if cover is flagged as the primary hospital cover                                                         181217 
 1315.00       *    the old cover's issue date & age at entry are used.                                                       181217 
 1316.00       *                                                                                                              181217 
 1317.00            IF GET-OLD-ISSUE             = WSCC-Y                                                                     181217 
 1318.00                MOVE RSKCOMMDT OF LFCONCOV-REC                                                                        181217 
 1319.00                                         TO WRK-DATE9                                                                 181217 
 1320.00                MOVE RSKCOMMDT OF LFCONCOV-REC                                                                        181217 
 1321.00                                         TO WRKISSUE                                                                  181217 
 1322.00                MOVE RSKCOMMDT OF LFCONCOV-REC                                                                        181217 
 1323.00                                         TO WRKFIRSTIS                                                                181217 
 1324.00       *                                                                                                              181217 
 1325.00       *    otherwise the current cover is used.                                                                      181217 
 1326.00       *                                                                                                              181217 
 1327.00            ELSE                                                                                                      181217 
 1328.00                MOVE RSKCOMMDT OF WRK-FCONCOV-REC                                                                     181217 
 1329.00                                         TO WRK-DATE9                                                                 181217 
 1330.00                MOVE ISSUEDT   OF FCONTRACT-REC                                                                       181217 
 1331.00                                         TO WRKISSUE                                                                  181217 
 1332.00                MOVE ISSFRSTDT OF FCONTRACT-REC                                                                       181217 
 1333.00                                         TO WRKFIRSTIS                                                                181217 
 1334.00            END-IF                                                                                                    181217 
 1335.00       **** MOVE RSKCOMMDT OF WRK-FCONCOV-REC TO WRK-DATE9                                                            181217 
 1336.00       **** MOVE ISSUEDT   OF FCONTRACT-REC TO WRKISSUE                                                               181217 
 1337.00       **** MOVE ISSFRSTDT OF FCONTRACT-REC TO WRKFIRSTIS                                                             181217 
 1338.00                                                                                                                      150513 
 1339.00       ****     MPISSYEAR  MPISSDATE 18/11/2016                                                161118 
 1340.00       **** MOVE WRKISSY              TO MPISSYEAR  OF MPMDLPNT-REC                                                   161118 
 1341.00            MOVE WRKISSUE                                                                                             161130 
 1342.00                                      TO MPISSDATE  OF MPMDLPNT-REC                                                   161118 
 1343.00            MOVE WRK9DAY              TO MPINCPDAY  OF MPMDLPNT-REC                                                   150513 
 1344.00            MOVE WRK9MONTH            TO MPINCPMON  OF MPMDLPNT-REC                                                   150513 
 1345.00            MOVE WRK9YEAR             TO MPINCPYEAR OF MPMDLPNT-REC                                                   150513 
 1346.00                                                                                                                      150513 
 1347.00            PERFORM PROCESS-SPCODE                                                                                    150513 
 1348.00                                                                                                                      150513 
 1349.00            IF  SYSAPPCOD  OF FCONTRACT-REC   = '01'                                                                  150624 
 1350.00            IF  CLNTORGCOD OF WRK-FCONCOV-REC = SPACES                                                                150624 
 1351.00                MOVE 0 TO MPCLNTORG  OF MPMDLPNT-REC                                                                  150513 
 1352.00            ELSE                                                                                                      150513 
 1353.00                MOVE CLNTORGCOD OF WRK-FCONCOV-REC                                                                    150624 
 1354.00                  TO MPCLNTORG  OF MPMDLPNT-REC                                                                       150513 
 1355.00            END-IF                                                                                                    150513 
 1356.00            END-IF                                                                                                    150520 
 1357.00                                                                                                                      150513 
 1358.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1359.00            OR SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1360.00               MOVE CLNTORGCOD OF WRK-FCONCOV-REC                                                                     150624 
 1361.00                 TO MPCLNTORG  OF MPMDLPNT-REC                                                                        150513 
 1362.00            END-IF                                                                                                    150513 
 1363.00                                                                                                                      150423 
 1364.00       ****  2/12/2016    clntorgcod    FCONCOV                                            161202 
 1365.00       **** IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      161202 
 1366.00       ****    MOVE 1 TO MPCLNTORG  OF MPMDLPNT-REC                                                                   161202 
 1367.00       **** END-IF                                                                                                    161202 
 1368.00                                                                                                                      150513 
 1369.00            PERFORM PROCESS-DEDUCT                                                                                    150513 
 1370.00            PERFORM PROCESS-COINS                                                                                     150513 
 1371.00            PERFORM FIND-AAHR                                                                                         150513 
 1372.00            PERFORM FIND-MPSEX                                                                                        150506 
 1373.00                                                                                                                      150513 
 1374.00            PERFORM FIND-MPFILESPLIT                                                                                  150513 
 1375.00            IF MPFILFLD OF MPMDLPNT-REC ='I40OLD'                                                                     150516 
 1376.00               MOVE 3 TO MPAAHROOM OF MPMDLPNT-REC                                                                    150516 
 1377.00            END-IF                                                                                                    150516 
 1378.00                                                                                                                      150506 
 1379.00       *                                                                                                              181217 
 1380.00       *    if cover is flagged as the primary hospital cover                                                         181217 
 1381.00       *    the old cover's issue date & age at entry are used.                                                       181217 
 1382.00       *                                                                                                              181217 
 1383.00            IF GET-OLD-ISSUE             = WSCC-Y                                                                     181217 
 1384.00                MOVE RSKCOMMAGE OF LFCONCOV-REC                                                                       181217 
 1385.00                                         TO MPAGEENTR  OF MPMDLPNT-REC                                                181217 
 1386.00            ELSE                                                                                                      181217 
 1387.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    181217 
 1388.00                                         TO MPAGEENTR  OF MPMDLPNT-REC                                                181217 
 1389.00            END-IF                                                                                                    181217 
 1390.00                                                                                                                      181217 
 1391.00       **** MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                        181217 
 1392.00       ****   TO MPAGEENTR  OF MPMDLPNT-REC                                                                           181217 
 1393.00            MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                        150624 
 1394.00              TO MPAGERDF   OF MPMDLPNT-REC                                                                           150606 
 1395.00                                                                                                                      150606 
 1396.00       *    NELIS                                                                                                     150506 
 1397.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1398.00               PERFORM NELIS-AGEATENTRY                                                                               150506 
 1399.00            END-IF                                                                                                    150506 
 1400.00                                                                                                                      150407 
 1401.00       *    MPMONIF (MONTHS IN FORCE)                                                                                 150430 
 1402.00       *    -------------------------                                                                                 150430 
 1403.00       *    IF STSCOD OF WRK-FCONCOV-REC = 'IF' OR 'PU'                                                               150704 
 1404.00               PERFORM CALC-MONTHSINF                                                                                 150509 
 1405.00       *    ELSE                                                                                                      150704 
 1406.00       *       MOVE ZEROES TO MPMONIF OF MPMDLPNT-REC                                                                 150704 
 1407.00       *    END-IF                                                                                                    150704 
 1408.00                                                                                                                      150423 
 1409.00       *    TERM FIELDS                                                                                               150509 
 1410.00       *    ------------                                                                                              150509 
 1411.00            PERFORM CALC-TERMFLDS                                                                                     150509 
 1412.00                                                                                                                      150415 
 1413.00            PERFORM FIND-MPFREQ                                                                                       150328 
 1414.00                                                                                                                      150423 
 1415.00       *    LIFE 400  KAI NELIS                                                                                       150423 
 1416.00                                                                                                                      150516 
 1417.00       *    STATUS DATE                                                                                               150511 
 1418.00       *    ------------                                                                                              150516 
 1419.00                                                                                                                      150511 
 1420.00            IF  SYSAPPCOD OF FCONTRACT-REC NOT = '03'                                                                 150624 
 1421.00               IF  PAYDT  OF FCONTRACT-REC     < STSDT OF FCONTRACT-REC                                               150624 
 1422.00               AND PAYDT  OF FCONTRACT-REC NOT = 0                                                                    150624 
 1423.00                   MOVE PAYDT OF FCONTRACT-REC   TO WRK-DATE8                                                         150624 
 1424.00               ELSE                                                                                                   150520 
 1425.00                   MOVE STSDT OF FCONTRACT-REC TO WRK-DATE8                                                           150624 
 1426.00               END-IF                                                                                                 150520 
 1427.00            ELSE                                                                                                      150520 
 1428.00               MOVE STSDT OF WRK-FCONCOV-REC TO WRK-DATE8                                                             150624 
 1429.00            END-IF                                                                                                    150520 
 1430.00                                                                                                                      150511 
 1431.00            MOVE WRK-DAY                 TO MPSTSDAY   OF MPMDLPNT-REC                                                150423 
 1432.00            MOVE WRK-MONTH               TO MPSTSMON   OF MPMDLPNT-REC                                                150423 
 1433.00            MOVE WRK-YEAR                TO MPSTSYEAR  OF MPMDLPNT-REC                                                150423 
 1434.00                                                                                                                      150424 
 1435.00            MOVE MPSTSDAY   OF MPMDLPNT-REC TO WRK-MPSTATUSD                                                          150424 
 1436.00            MOVE MPSTSMON   OF MPMDLPNT-REC TO WRK-MPSTATUSM                                                          150424 
 1437.00            MOVE MPSTSYEAR  OF MPMDLPNT-REC TO WRK-MPSTATUSY                                                          150424 
 1438.00                                                                                                                      150424 
 1439.00       *                                                                                                      150423 
 1440.00                                                                                                                      150423 
 1441.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1442.00                                                                                                                      150416 
 1443.00               IF MPSPCOD OF MPMDLPNT-REC=2                                                                           150423 
 1444.00                  MOVE WRK-DAY   TO MPSTSDAY  OF MPMDLPNT-REC                                                         150423 
 1445.00                  MOVE WRK-MONTH TO MPSTSMON  OF MPMDLPNT-REC                                                         150423 
 1446.00                  MOVE WRK-YEAR  TO MPSTSYEAR OF MPMDLPNT-REC                                                         150423 
 1447.00               ELSE                                                                                                   150423 
 1448.00                  MOVE MPINCPDAY  OF  MPMDLPNT-REC                                                                    150423 
 1449.00                    TO MPSTSDAY   OF MPMDLPNT-REC                                                                     150423 
 1450.00                  MOVE MPINCPMON  OF  MPMDLPNT-REC                                                                    150423 
 1451.00                    TO MPSTSMON   OF MPMDLPNT-REC                                                                     150423 
 1452.00                  MOVE MPINCPYEAR OF  MPMDLPNT-REC                                                                    150423 
 1453.00                    TO MPSTSYEAR  OF MPMDLPNT-REC                                                                     150423 
 1454.00               END-IF                                                                                                 150423 
 1455.00                                                                                                                      150423 
 1456.00            END-IF                                                                                                    150416 
 1457.00                                                                                                                      150423 
 1458.00            PERFORM CALC-MPPAIDUP                                                                                     150511 
 1459.00                                                                                                                      150511 
 1460.00       *    NELIS                                                                                          150423 
 1461.00                                                                                                                      150511 
 1462.00            MOVE 1 TO MPPOLNO OF MPMDLPNT-REC                                                                         150423 
 1463.00                                                                                                                      150423 
 1464.00       *    NELIS                                                                                          150423 
 1465.00                                                                                                                      150423 
 1466.00            MOVE SUMINSAMT OF WRK-FCONCOV-REC                                                                         150624 
 1467.00              TO MPSUMINS  OF MPMDLPNT-REC                                                                            150606 
 1468.00                                                                                                                      150601 
 1469.00       **** IF  SYSAPPCOD OF WRK-FCONCOV-REC      = '03'                                                              171020 
 1470.00       **** AND COVCOD    OF WRK-FCONCOV-REC(1:2) = '05'                                                              171020 
 1471.00       ****   MOVE ZEROES                                                                                             171020 
 1472.00       ****     TO MPSUMINS  OF MPMDLPNT-REC                                                                          171020 
 1473.00       **** END-IF                                                                                                    171020 
 1474.00                                                                                                                      150601 
 1475.00            IF  SYSAPPCOD OF WRK-FCONCOV-REC = '03'                                                                   150624 
 1476.00            AND COVCOD    OF WRK-FCONCOV-REC = '00/303'                                                               150624 
 1477.00              COMPUTE MPSUMINS OF MPMDLPNT-REC =                                                                      150601 
 1478.00                      MPSUMINS OF MPMDLPNT-REC / 12                                                                   150601 
 1479.00            END-IF                                                                                                    150601 
 1480.00                                                                                                                      150519 
 1481.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '02'                                                                    150624 
 1482.00            AND (COVCOD  OF WRK-FCONCOV-REC ='12002'  OR                                                              150624 
 1483.00                 COVCOD  OF WRK-FCONCOV-REC ='12003')                                                                 150624 
 1484.00              MOVE SUMINSAMT OF WRK-BASFCOV-REC                                                                       150624 
 1485.00                TO MPSUMINS  OF MPMDLPNT-REC                                                                          150519 
 1486.00            END-IF                                                                                                    150519 
 1487.00                                                                                                                      150510 
 1488.00       *                                                        150510 
 1489.00            IF  SYSAPPCOD OF WRK-FCONCOV-REC = '01'                                                                   150624 
 1490.00            AND COVCOD    OF WRK-FCONCOV-REC = 'SP01'                                                                 150624 
 1491.00            AND MPSUMINS  OF MPMDLPNT-REC   < 15                                                                      150510 
 1492.00                MOVE 15 TO MPSUMINS OF MPMDLPNT-REC                                                                   150510 
 1493.00            END-IF                                                                                                    150510 
 1494.00                                                                                                                      150426 
 1495.00                                                                                                                      150426 
 1496.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1497.00               IF MPULCOD   OF MPMDLPNT-REC(1:6) = '70/785'                                                           150426 
 1498.00               OR MPULCOD   OF MPMDLPNT-REC(1:6) = '70/786'                                                           150521 
 1499.00               OR MPULCOD   OF MPMDLPNT-REC(1:6) = '70/787'                                                           150521 
 1500.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6) = '00/785'                                                           150426 
 1501.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6) = '00/786'                                                           150426 
 1502.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6) = '00/787'                                                           150426 
 1503.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6) = '00/303'                                                           150426 
 1504.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6) = '00/302'                                                           150426 
 1505.00                                                                                                                      150426 
 1506.00                  MOVE SGLNETPRM OF WRK-FCONCOV-REC                                                                   150624 
 1507.00                    TO MPSGLPRM  OF MPMDLPNT-REC                                                                      150511 
 1508.00               END-IF                                                                                                 150511 
 1509.00            END-IF                                                                                                    150426 
 1510.00                                                                                                                      150426 
 1511.00       *                                                                                             150511 
 1512.00       *    NELIS                                                                                                     150511 
 1513.00                                                                                                                      150511 
 1514.00       *    LIFE400 MPANNPRM                                                                                          150511 
 1515.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      150624 
 1516.00                                                                                                                      150511 
 1517.00               EVALUATE TRUE                                                                                          150519 
 1518.00               WHEN (COVCOD OF WRK-FCONCOV-REC   = 'WPL3' OR                                                          150624 
 1519.00                     COVCOD OF WRK-FCONCOV-REC   = 'WL92' OR                                                          150624 
 1520.00                     COVCOD OF WRK-FCONCOV-REC   = 'WOPU'   )                                                         150624 
 1521.00                    COMPUTE MPANNPRM  OF MPMDLPNT-REC   =                                                             150519 
 1522.00                            MDPNETPRM OF WRK-FCONCOV-REC                                                              150624 
 1523.00                                                                                                                      150511 
 1524.00               WHEN (COVCOD OF WRK-FCONCOV-REC    = 'WPP3' OR                                                         150624 
 1525.00                     COVCOD OF WRK-FCONCOV-REC    = 'WP92'   )                                                        150624 
 1526.00                AND MPSEXCOD  OF MPSEX-REC      = '0'                                                                 150519 
 1527.00                    PERFORM FIND-MPWOPR                                                                               150519 
 1528.00                    COMPUTE MPANNPRM   OF MPMDLPNT-REC ROUNDED =                                                      150723 
 1529.00                           (MDPNETPRM OF WRK-FCONCOV-REC * WRATE)                                                     150624 
 1530.00                                                                                                                      150511 
 1531.00               WHEN (COVCOD  OF WRK-FCONCOV-REC   = 'WPP3' OR                                                         150624 
 1532.00                     COVCOD  OF WRK-FCONCOV-REC   = 'WP92'   )                                                        150624 
 1533.00                AND MPSEXCOD  OF MPSEX-REC      = '1'                                                                 150519 
 1534.00                    PERFORM FIND-MPWOPR                                                                               150519 
 1535.00                    COMPUTE MPANNPRM   OF MPMDLPNT-REC ROUNDED =                                                      150723 
 1536.00                           (MDPNETPRM OF WRK-FCONCOV-REC * WRATE)                                                     150624 
 1537.00                                                                                                                      150620 
 1538.00               WHEN COVCOD  OF WRK-FCONCOV-REC(1:2) = 'MC'                                                            150624 
 1539.00               AND  STSCOD  OF WRK-FCONCOV-REC      = 'IF'                                                            180530 
 1540.00       *       AND  STSCOD  OF WRK-FCONCOV-REC  NOT = 'PU'                                                            180530 
 1541.00               AND FREQCOD OF MPFREQ-REC      NOT   = '00'                                                            150624 
 1542.00                   PERFORM FIND-ANNPREMMCPPI                                                                          150620 
 1543.00                                                                                                                      150513 
 1544.00               WHEN OTHER                                                                                             150519 
 1545.00                  IF FREQCOD OF MPFREQ-REC  = '00'                                                                    150513 
 1546.00                     MOVE SGLNETPRM OF WRK-FCONCOV-REC                                                                150624 
 1547.00                       TO MPSGLPRM  OF MPMDLPNT-REC                                                                   150513 
 1548.00                  ELSE                                                                                                150513 
 1549.00                     MOVE INIANETPRM OF WRK-FCONCOV-REC                                                               160114 
 1550.00                       TO MPANNPRM  OF MPMDLPNT-REC                                                                   150513 
 1551.00                  END-IF                                                                                              150513 
 1552.00               END-EVALUATE                                                                                           150519 
 1553.00               IF  CAMPCOD OF WRK-FCONCOV-REC = 'HR1-1'                                                               170224 
 1554.00               OR  CAMPCOD OF WRK-FCONCOV-REC = 'HR1-2'                                                               170224 
 1555.00                     MOVE ANNNETPRM OF WRK-FCONCOV-REC                                                                170224 
 1556.00                       TO MPANNPRM  OF MPMDLPNT-REC                                                                   170224 
 1557.00               END-IF                                                                                                 170224 
 1558.00       *       BRS                                                       170821 
 1559.00       *     /   HRP2 .                                                                             170821 
 1560.00               IF  COVCOD  OF WRK-FCONCOV-REC = 'HRP2'                                                                170821 
 1561.00               OR  COVCOD  OF WRK-FCONCOV-REC = 'HRP3'                                                                180308 
 1562.00                   MOVE ANNNETPRM OF WRK-FCONCOV-REC                                                                  170821 
 1563.00                       TO MPANNPRM  OF MPMDLPNT-REC                                                                   170821 
 1564.00               END-IF                                                                                                 170821 
 1565.00       *       9/02/2017                                                    170209 
 1566.00       *       0.01                                                             170209 
 1567.00       *           'HRP1'                                                               170209 
 1568.00                  IF MPANNPRM  OF MPMDLPNT-REC                                                                        170209 
 1569.00                                         = 0                                                                          170209 
 1570.00                  AND (MPRIDCOD OF MPMDLPNT-REC                                                                       170717 
 1571.00                                         = 'HRP1'                                                                     170209 
 1572.00                       OR MPRIDCOD OF MPMDLPNT-REC                                                                    170717 
 1573.00                                         = 'HRP2'                                                                     180308 
 1574.00                       OR MPRIDCOD OF MPMDLPNT-REC                                                                    180308 
 1575.00                                         = 'HRP3' )                                                                   180308 
 1576.00                     MOVE 0.01          TO MPANNPRM  OF MPMDLPNT-REC                                                  170209 
 1577.00                  END-IF                                                                                              170209 
 1578.00            END-IF                                                                                                    150513 
 1579.00                                                                                                                      150519 
 1580.00       ****    13/12/2106                                                         161213 
 1581.00       **** IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      161213 
 1582.00       ****    IF  STSCOD OF WRK-FCONCOV-REC = 'PU'                                                                   161213 
 1583.00       ****    AND (MPMAINCOD OF MPMDLPNT-REC NOT = SPACES                                                            161213 
 1584.00       ****         OR MPRMAINCOD OF MPMDLPNT-REC NOT = SPACES)                                                       161213 
 1585.00       ****         MOVE 0 TO MPANNPRM OF MPMDLPNT-REC                                                                161213 
 1586.00       ****    END-IF                                                                                                 161213 
 1587.00       **** END-IF                                                                                                    161213 
 1588.00                                                                                                                      150516 
 1589.00       *    NELIS SGLNETPRM                                                                                           150516 
 1590.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1591.00               IF  COVCOD OF WRK-FCONCOV-REC(1:2) NOT = '10'                                                          150624 
 1592.00               AND COVCOD OF WRK-FCONCOV-REC(1:2) NOT = '11'                                                          150624 
 1593.00                  IF FREQCOD OF MPFREQ-REC  = '00'                                                                    150514 
 1594.00                     MOVE SGLNETPRM OF WRK-FCONCOV-REC                                                                150624 
 1595.00                       TO MPSGLPRM  OF MPMDLPNT-REC                                                                   150514 
 1596.00                  END-IF                                                                                              150514 
 1597.00               END-IF                                                                                                 150514 
 1598.00            END-IF                                                                                                    150516 
 1599.00                                                                                                                      150511 
 1600.00       *    NELIS   MPANNPRM                                                                                          150513 
 1601.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1602.00                                                                                                                      150516 
 1603.00               MOVE INIANETPRM OF WRK-FCONCOV-REC                                                                     160114 
 1604.00                 TO MPANNPRM   OF MPMDLPNT-REC                                                                        160114 
 1605.00                                                                                                                      150516 
 1606.00               IF COVCOD OF WRK-FCONCOV-REC(1:2) = '11'                                                               150624 
 1607.00               OR COVCOD OF WRK-FCONCOV-REC(1:2) = '10'                                                               150624 
 1608.00                                                                                                                      150516 
 1609.00                 IF FREQCOD OF FCONTRACT-REC = '00'                                                                   150624 
 1610.00                    COMPUTE MPANNPRM   OF MPMDLPNT-REC  ROUNDED =                                                     150723 
 1611.00                            SGLNETPRM  OF WRK-FCONCOV-REC  /                                                          150624 
 1612.00                            MPPRMTRM   OF MPMDLPNT-REC                                                                150526 
 1613.00                 END-IF                                                                                               150513 
 1614.00               END-IF                                                                                                 150513 
 1615.00            END-IF                                                                                                    150513 
 1616.00                                                                                                                      150511 
 1617.00       *     MPANNPRM                                                                                         150511 
 1618.00                                                                                                                      150511 
 1619.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1620.00                                                                                                                      150519 
 1621.00               IF MPMAINCOD OF MPMDLPNT-REC(1:6)='00/785'                                                             150520 
 1622.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/786'                                                             150519 
 1623.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/787'                                                             150519 
 1624.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/302'                                                             150519 
 1625.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/303'                                                             150519 
 1626.00                  MOVE ZEROES                                                                                         150519 
 1627.00                    TO MPANNPRM  OF MPMDLPNT-REC                                                                      150519 
 1628.00               ELSE                                                                                                   150519 
 1629.00                  MOVE INIANETPRM OF WRK-FCONCOV-REC                                                                  160114 
 1630.00                    TO MPANNPRM   OF MPMDLPNT-REC                                                                     160114 
 1631.00               END-IF                                                                                                 150519 
 1632.00                                                                                                                      150519 
 1633.00               IF MPULCOD OF MPMDLPNT-REC(1:6)='60/660'                                                               150530 
 1634.00               OR MPULCOD OF MPMDLPNT-REC(1:6)='60/685'                                                               150530 
 1635.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/785'                                                             150530 
 1636.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/786'                                                             150530 
 1637.00               OR MPMAINCOD OF MPMDLPNT-REC(1:6)='00/787'                                                             150530 
 1638.00                  PERFORM FIND-FULV094A                                                                               150530 
 1639.00               END-IF                                                                                                 150530 
 1640.00                                                                                                                      150519 
 1641.00               IF MPRIDCOD OF MPMDLPNT-REC ='WPP_I12'                                                                 150601 
 1642.00                  IF  WRK-FILFROMBASCOV = 1                                                                           150511 
 1643.00                      MOVE RSKCOMMAGE OF WRK-BASFCOV-REC                                                              150624 
 1644.00                        TO MPWOPAGE   OF MPMDLPNT-REC                                                                 150511 
 1645.00                      PERFORM FIND-MPSEXBAS                                                                           150523 
 1646.00                   END-IF                                                                                             150511 
 1647.00               ELSE                                                                                                   150511 
 1648.00                  MOVE 999                                                                                            150511 
 1649.00                    TO MPWOPAGE   OF MPMDLPNT-REC                                                                     150511 
 1650.00                  MOVE 999                                                                                            150511 
 1651.00                    TO MPWOPSEX   OF MPMDLPNT-REC                                                                     150511 
 1652.00               END-IF                                                                                                 150511 
 1653.00            END-IF                                                                                                    150511 
 1654.00                                                                                                                      150509 
 1655.00       *    NELIS                                                                                                     150630 
 1656.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                   DSB                                150630 
 1657.00               IF MPRIDCOD OF MPMDLPNT-REC ='10002'                                                                   150630 
 1658.00                  MOVE RSKCOMMAGE OF WRK-BASFCOV-REC                                                                  150630 
 1659.00                    TO MPWOPAGE   OF MPMDLPNT-REC                                                                     150630 
 1660.00                  PERFORM FIND-MPSEXBAS                                                                               150630 
 1661.00               ELSE                                                                                                   150630 
 1662.00                  MOVE 999  TO MPWOPAGE OF MPMDLPNT-REC                           CHAC                                150630 
 1663.00                  MOVE 999  TO MPWOPSEX OF MPMDLPNT-REC                                                               150630 
 1664.00               END-IF                                                                                                 150630 
 1665.00            END-IF                                                                                                    150630 
 1666.00                                                                                                                      150630 
 1667.00       *    LIFE400                                                                                                   150423 
 1668.00                                                                                                                      150423 
 1669.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      150624 
 1670.00                                                                                                                      150423 
 1671.00                                                                                                                      150911 
 1672.00               IF COVCOD OF WRK-FCONCOV-REC ='WPP2'                                                                   150624 
 1673.00               OR COVCOD OF WRK-FCONCOV-REC ='WPP5'                                                                   150917 
 1674.00               OR MPRIDCOD OF MPMDLPNT-REC  ='WPP6'                                                                   170720 
 1675.00               OR COVCOD OF WRK-FCONCOV-REC ='WPP7'                                                                   170718 
 1676.00               OR COVCOD OF WRK-FCONCOV-REC ='WPP8'                                                                   170718 
 1677.00               OR MPRIDCOD OF MPMDLPNT-REC  ='WPP6'                                                                   150917 
 1678.00               OR MPRIDCOD OF MPMDLPNT-REC  ='WPP3'                                                                   150630 
 1679.00               OR MPRIDCOD OF MPMDLPNT-REC  ='WP92'                                                                   150630 
 1680.00               OR MPRIDCOD OF MPMDLPNT-REC  ='PH'                                                                     150630 
 1681.00               OR MPRIDCOD OF MPMDLPNT-REC  ='PH_AD'                                                                  170720 
 1682.00               OR MPRIDCOD OF MPMDLPNT-REC  ='ADP3'                                                                   180308 
 1683.00       *30/6/2015                                                                                                     150630 
 1684.00                                                                                                                      150423 
 1685.00                  IF  WRK-FILFROMBASCOV = 1                                                                           150423 
 1686.00                      MOVE RSKCOMMAGE OF WRK-BASFCOV-REC                                                              150624 
 1687.00                        TO MPWOPAGE   OF MPMDLPNT-REC                                                                 150423 
 1688.00                      PERFORM FIND-MPSEXBAS                                                                           150523 
 1689.00                  END-IF                                                                                              150423 
 1690.00               ELSE                                                                                                   150509 
 1691.00                  MOVE 999 TO MPWOPAGE OF MPMDLPNT-REC                                                                150423 
 1692.00                  MOVE 999 TO MPWOPSEX OF MPMDLPNT-REC                                                                150423 
 1693.00               END-IF                                                                                                 150420 
 1694.00                                                                                                                      150423 
 1695.00               MOVE CONNBR OF WRK-FCONCOV-REC(1:8) TO W2POLNUM                                                        150624 
 1696.00               MOVE W2POLNUM                      TO WPOLNUM2                                                         150423 
 1697.00               MOVE WPOLNUM2 TO MPFPOLNUM  OF MPMDLPNT-REC                                                            150423 
 1698.00                                                                                                                      150423 
 1699.00            END-IF                                                                                                    150331 
 1700.00                                                                                                                      150509 
 1701.00       *    L400    A 8/12/2016                                                                                  161208 
 1702.00       *         W002     10002                                                    161208 
 1703.00       *       MPWOPAGE ,MPWOPSEX                                                                           161208 
 1704.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      161208 
 1705.00               IF MPRIDCOD OF MPMDLPNT-REC ='W002'                                                                    161208 
 1706.00                  MOVE RSKCOMMAGE OF WRK-BASFCOV-REC                                                                  161208 
 1707.00                    TO MPWOPAGE   OF MPMDLPNT-REC                                                                     161208 
 1708.00                  PERFORM FIND-MPSEXBAS                                                                               161208 
 1709.00               END-IF                                                                                                 161208 
 1710.00            END-IF                                                                                                    161208 
 1711.00                                                                                                                      161208 
 1712.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      150624 
 1713.00       *17/6/2015                                                                                                     150617 
 1714.00               IF  AUTINCRCOD OF FCONTRACT-REC >= '00'                                                                150624 
 1715.00               AND AUTINCRCOD OF FCONTRACT-REC <= '99'                                                                150624 
 1716.00               AND COVCOD  OF WRK-FCONCOV-REC(1:2) NOT = 'MC'                                                         150629 
 1717.00                   MOVE AUTINCRCOD OF FCONTRACT-REC                                                                   150624 
 1718.00                     TO MPAUTINCPC OF MPMDLPNT-REC                                                                    150516 
 1719.00               ELSE                                                                                                   150516 
 1720.00                   MOVE 0  TO MPAUTINCPC OF MPMDLPNT-REC                                                              150516 
 1721.00               END-IF                                                                                                 150516 
 1722.00       *16/08/2017 it was asked for HRP1,HRP2 to have a new field from FCONCOV                                        170816 
 1723.00       *16/02/2018 HRP3 added                                                                                         180308 
 1724.00               IF  COVCOD OF WRK-FCONCOV-REC    = 'HRP1'                                                              170816 
 1725.00               OR  COVCOD OF WRK-FCONCOV-REC    = 'HRP2'                                                              170816 
 1726.00               OR  COVCOD OF WRK-FCONCOV-REC    = 'HRP3'                                                              180308 
 1727.00               OR  COVCOD OF WRK-FCONCOV-REC    = 'HRC4'                                                              180507 
 1728.00               OR  COVCOD OF WRK-FCONCOV-REC    = 'ORP1'                                                              170818 
 1729.00               OR  COVCOD OF WRK-FCONCOV-REC    = 'ORP2'                                                              170818 
 1730.00                   MOVE COMMPRC OF WRK-FCONCOV-REC                                                                    170817 
 1731.00                     TO MPAUTINCPC OF MPMDLPNT-REC                                                                    170816 
 1732.00               END-IF                                                                                                 170816 
 1733.00       *16/08/2017 it was asked for HRP1,HRP2 to have a new field from FCONCOV                                        170816 
 1734.00       *17/6/2015                                                                                                     150630 
 1735.00               IF  COVCOD  OF WRK-FCONCOV-REC(1:2) = 'MC'                                                             150630 
 1736.00                   MOVE 1   TO MPAUTINCPC OF MPMDLPNT-REC                                                             150630 
 1737.00               END-IF                                                                                                 150630 
 1738.00       ****    IF  COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG1'                                                           180530 
 1739.00       ****    OR  COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG2'                                                           180530 
 1740.00       ****        MOVE 0   TO MPAUTINCPC OF MPMDLPNT-REC                                                             180530 
 1741.00       ****    END-IF                                                                                                 180530 
 1742.00            END-IF                                                                                                    150510 
 1743.00                                                                                                                      150510 
 1744.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1745.00            OR SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1746.00               MOVE 0  TO MPAUTINCPC OF MPMDLPNT-REC                                                                  150510 
 1747.00            END-IF                                                                                                    150510 
 1748.00                                                                                                                      150407 
 1749.00            MOVE 1 TO MPPAYMETH  OF MPMDLPNT-REC                                                                      150516 
 1750.00                                                                                                                      150603 
 1751.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1752.00               IF PAYMETHCOD OF FCONTRACT-REC='1'                                                                     150624 
 1753.00                  MOVE 01                                                                                             150602 
 1754.00                  TO MPPAYMETH  OF MPMDLPNT-REC                                                                       150602 
 1755.00               END-IF                                                                                                 150602 
 1756.00               IF PAYMETHCOD OF FCONTRACT-REC='2'                                                                     150624 
 1757.00                  MOVE 02                                                                                             150602 
 1758.00                  TO MPPAYMETH  OF MPMDLPNT-REC                                                                       150602 
 1759.00               END-IF                                                                                                 150602 
 1760.00            END-IF                                                                                                    150602 
 1761.00                                                                                                                      150516 
 1762.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1763.00            OR SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1764.00               MOVE CONNBR OF WRK-FCONCOV-REC(1:8) TO W1POLNUM                                                        150624 
 1765.00               MOVE W1POLNUM                      TO WPOLNUM1                                                         150423 
 1766.00               MOVE WPOLNUM1 TO MPFPOLNUM  OF MPMDLPNT-REC                                                            150423 
 1767.00            END-IF                                                                                                    150402 
 1768.00                                                                                                                      150423 
 1769.00       *    PERFORM PROCESS-FCONFUND                                                                                  150624 
 1770.00            IF MPULCOD OF MPMDLPNT-REC = SPACES                                                                       150520 
 1771.00               MOVE ZEROES      TO MPFNDAMT OF MPMDLPNT-REC                                                           150520 
 1772.00            END-IF                                                                                                    150520 
 1773.00                                                                                                                      150520 
 1774.00       *    LIFE400                                                                                                   150520 
 1775.00            IF SYSAPPCOD OF WRK-FCONCOV-REC          = '01'                                                           150624 
 1776.00               IF COVCOD   OF WRK-FCONCOV-REC(1:2)  NOT = 'ML'                                                        150629 
 1777.00                  MOVE 1 TO MPUNINBR OF MPMDLPNT-REC                                                                  150601 
 1778.00                  MOVE 1 TO MPUNIPRC OF MPMDLPNT-REC                                                                  150601 
 1779.00               ELSE                                                                                                   150601 
 1780.00                  MOVE 1 TO MPUNINBR OF MPMDLPNT-REC                                                                  150601 
 1781.00                  MOVE 1 TO MPUNIPRC OF MPMDLPNT-REC                                                                  150601 
 1782.00                  PERFORM READ-FCONFUNDIS                                                                             150624 
 1783.00                  PERFORM READ-FCONFUND                                                                               150624 
 1784.00               END-IF                                                                                                 150601 
 1785.00               IF COVCOD   OF WRK-FCONCOV-REC(1:2)   = 'MC'                                                           150629 
 1786.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPL6'                                                         150630 
 1787.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPP6'                                                         150630 
 1788.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPL5'                                                         150917 
 1789.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPP5'                                                         150917 
 1790.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPL7'                                                         170718 
 1791.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPP7'                                                         170718 
 1792.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPL8'                                                         170718 
 1793.00               OR COVCOD   OF WRK-FCONCOV-REC        = 'WPP8'                                                         170718 
 1794.00                  MOVE 0 TO MPUNIPRC OF MPMDLPNT-REC                                                                  150629 
 1795.00               END-IF                                                                                                 150629 
 1796.00            END-IF                                                                                                    150520 
 1797.00                                                                                                                      150520 
 1798.00       *    NELIS                                                                                                     150520 
 1799.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '02'                                                                    150624 
 1800.00               MOVE 1 TO MPUNINBR OF MPMDLPNT-REC                                                                     150520 
 1801.00               MOVE 0 TO MPUNIPRC OF MPMDLPNT-REC                                                                     150520 
 1802.00            END-IF                                                                                                    150520 
 1803.00                                                                                                                      150407 
 1804.00       *                                                                                                      150423 
 1805.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1806.00               MOVE 0 TO MPLOANAMT OF MPMDLPNT-REC                                                                    150423 
 1807.00               MOVE 1 TO MPUNINBR  OF MPMDLPNT-REC                                                                    150423 
 1808.00               MOVE 1 TO MPUNIPRC  OF MPMDLPNT-REC                                                                    150427 
 1809.00            END-IF                                                                                                    150416 
 1810.00                                                                                                                      150423 
 1811.00            MOVE CLNTCOD OF FCONLIF-REC(1:8) TO MPCLNTCOD OF MPMDLPNT-REC                                             150624 
 1812.00       *26/6/2015                                                                                                     150626 
 1813.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      150626 
 1814.00            MOVE CLNTCODL4 OF FCONLIF-REC(1:8) TO                                                                     150626 
 1815.00                 MPCLNTCOD OF MPMDLPNT-REC                                                                            150626 
 1816.00            END-IF                                                                                                    150626 
 1817.00                                                                                                                      150626 
 1818.00            PERFORM FIND-MPSTATUS                                                                                     150421 
 1819.00                                                                                                                      150416 
 1820.00            IF DSBCHACOD OF FCONTRACT-REC = '01'                                                                      150630 
 1821.00               MOVE "TA_0000" TO MPDSBCHA OF MPMDLPNT-REC                                                             150423 
 1822.00            END-IF                                                                                                    150421 
 1823.00            IF  DSBCHACOD OF FCONTRACT-REC                                                                            180507 
 1824.00                                         = '01'                                                                       180507 
 1825.00            AND PRDCOD OF FCONTRACT-REC  = 'FS1'                                                                      180507 
 1826.00                MOVE "BA_0000"          TO MPDSBCHA OF MPMDLPNT-REC                                                   180507 
 1827.00            END-IF                                                                                                    180507 
 1828.00                                                                                                                      150423 
 1829.00       *       H LIFE400 ME DSBCHACOD='02'                                                                    150720 
 1830.00            IF DSBCHACOD OF FCONTRACT-REC = '02'                                                                      150720 
 1831.00               MOVE "BA_0000" TO MPDSBCHA   OF MPMDLPNT-REC                                                           150423 
 1832.00            END-IF                                                                                                    150421 
 1833.00       *    PRODUCT HM1                                                                                               151218 
 1834.00            IF DSBCHACOD OF FCONTRACT-REC = '03'                                                                      151218 
 1835.00               MOVE "DI_0000" TO MPDSBCHA   OF MPMDLPNT-REC                                                           151218 
 1836.00            END-IF                                                                                                    151218 
 1837.00                                                                                                                      150423 
 1838.00            IF COMMLPPC  OF FCONTRACT-REC NOT = 0                                                                     150624 
 1839.00               MOVE COMMLPPC  OF FCONTRACT-REC                                                                        150624 
 1840.00                 TO MPCOMMFLG OF MPMDLPNT-REC                                                                         150423 
 1841.00            ELSE                                                                                                      150331 
 1842.00               MOVE 0 TO MPCOMMFLG  OF MPMDLPNT-REC                                                                   150513 
 1843.00            END-IF                                                                                                    150331 
 1844.00                                                                                                                      151218 
 1845.00            IF MPDSBCHA   OF MPMDLPNT-REC     = "DI_0000"                                                             151218 
 1846.00               MOVE 0 TO MPCOMMFLG  OF MPMDLPNT-REC                                                                   160111 
 1847.00            END-IF                                                                                                    151218 
 1848.00                                                                                                                      150415 
 1849.00       *                                                                                                      150423 
 1850.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 1851.00               MOVE 1 TO MPCOMMFLG OF MPMDLPNT-REC                                                                    150423 
 1852.00            END-IF                                                                                                    150416 
 1853.00                                                                                                                      150423 
 1854.00       *      FROM ISSFRSTDT - PPOLICY ISSUE YEAR                                                          150423 
 1855.00       *    COMPUTE MPISSYEAR OF MPMDLPNT-REC  = WRKFIRY - WRKISSY                                                    150408 
 1856.00                                                                                                                      150516 
 1857.00       *    NELIS                                                                                                     150516 
 1858.00       *    IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 1859.00       *       PERFORM PREM-PAYBL-YNELIS                                                                              150517 
 1860.00       *    END-IF                                                                                                    150517 
 1861.00                                                                                                                      150423 
 1862.00       *    IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      150624 
 1863.00                                                                                                                      150520 
 1864.00       *    END-IF                                                                                                    150520 
 1865.00                                                                                                                      150520 
 1866.00            PERFORM FIND-MPGROUP                                                                                      150521 
 1867.00                                                                                                                      150521 
 1868.00       *    TRANFORM DATES                                                                                            150523 
 1869.00       *    --------------                                                                                            150523 
 1870.00            IF  MPINCPMON OF MPMDLPNT-REC = 2                                                                         150523 
 1871.00            AND MPINCPDAY OF MPMDLPNT-REC > 28                                                                        150523 
 1872.00                MOVE 28 TO MPINCPDAY OF MPMDLPNT-REC                                                                  150523 
 1873.00            END-IF                                                                                                    150523 
 1874.00            IF  (MPINCPMON OF MPMDLPNT-REC = 4 OR                                                                     150523 
 1875.00                 MPINCPMON OF MPMDLPNT-REC = 6 OR                                                                     150523 
 1876.00                 MPINCPMON OF MPMDLPNT-REC = 9 OR                                                                     150523 
 1877.00                 MPINCPMON OF MPMDLPNT-REC = 11  )                                                                    150523 
 1878.00            AND MPINCPDAY OF MPMDLPNT-REC > 30                                                                        150523 
 1879.00                MOVE 30 TO MPINCPDAY OF MPMDLPNT-REC                                                                  150523 
 1880.00            END-IF                                                                                                    150523 
 1881.00            IF  MPSTSMON OF MPMDLPNT-REC = 2                                                                          150523 
 1882.00            AND MPSTSDAY OF MPMDLPNT-REC > 28                                                                         150523 
 1883.00                MOVE 28 TO MPSTSDAY OF MPMDLPNT-REC                                                                   150523 
 1884.00            END-IF                                                                                                    150523 
 1885.00            IF  (MPSTSMON OF MPMDLPNT-REC = 4 OR                                                                      150523 
 1886.00                 MPSTSMON OF MPMDLPNT-REC = 6 OR                                                                      150523 
 1887.00                 MPSTSMON OF MPMDLPNT-REC = 9 OR                                                                      150523 
 1888.00                 MPSTSMON OF MPMDLPNT-REC = 11  )                                                                     150523 
 1889.00            AND MPSTSDAY OF MPMDLPNT-REC > 30                                                                         150523 
 1890.00                MOVE 30 TO MPSTSDAY OF MPMDLPNT-REC                                                                   150523 
 1891.00            END-IF                                                                                                    150523 
 1892.00                                                                                                                      150524 
 1893.00       *    TRANFORM AMOUNTS (LESS THAN ZERO)                                                                         150524 
 1894.00       *    ---------------------------------                                                                         150524 
 1895.00            IF MPCOVTRM OF MPMDLPNT-REC < 0                                                                           150524 
 1896.00               MOVE 0 TO MPCOVTRM OF MPMDLPNT-REC                                                                     150524 
 1897.00            END-IF                                                                                                    150524 
 1898.00            IF MPPRMTRM OF MPMDLPNT-REC < 0                                                                           150524 
 1899.00               MOVE 0 TO MPPRMTRM OF MPMDLPNT-REC                                                                     150524 
 1900.00            END-IF                                                                                                    150524 
 1901.00            IF MPEXTTRM OF MPMDLPNT-REC < 0                                                                           150524 
 1902.00               MOVE 0 TO MPEXTTRM OF MPMDLPNT-REC                                                                     150524 
 1903.00            END-IF                                                                                                    150524 
 1904.00            IF MPLOANAMT OF MPMDLPNT-REC < 0                                                                          150524 
 1905.00               MOVE 0 TO MPLOANAMT OF MPMDLPNT-REC                                                                    150524 
 1906.00            END-IF                                                                                                    150524 
 1907.00                                                                                                                      150610 
 1908.00       *    TRANFORM COVER CODES                                                                                      150610 
 1909.00       *    --------------------                                                                                      150610 
 1910.00            IF  MPMAINCOD OF MPMDLPNT-REC(1:2)     = '00'                                                             150610 
 1911.00            AND MPMAINCOD OF MPMDLPNT-REC(3:1) NOT = '/'                                                              150610 
 1912.00                IF MPMAINCOD OF MPMDLPNT-REC(3:1)  = '0'                                                              150610 
 1913.00                   MOVE MPMAINCOD OF MPMDLPNT-REC(4:10)                                                               150610 
 1914.00                     TO MPMAINCOD OF MPMDLPNT-REC                                                                     150610 
 1915.00                ELSE                                                                                                  150610 
 1916.00                   MOVE MPMAINCOD OF MPMDLPNT-REC(3:10)                                                               150610 
 1917.00                     TO MPMAINCOD OF MPMDLPNT-REC                                                                     150610 
 1918.00                END-IF                                                                                                150610 
 1919.00            END-IF                                                                                                    150610 
 1920.00            IF  MPRMAINCOD OF MPMDLPNT-REC(1:2)     = '00'                                                            150610 
 1921.00            AND MPRMAINCOD OF MPMDLPNT-REC(3:1) NOT = '/'                                                             150610 
 1922.00                IF MPRMAINCOD OF MPMDLPNT-REC(3:1)  = '0'                                                             150610 
 1923.00                   MOVE MPRMAINCOD OF MPMDLPNT-REC(4:10)                                                              150610 
 1924.00                     TO MPRMAINCOD OF MPMDLPNT-REC                                                                    150610 
 1925.00                ELSE                                                                                                  150610 
 1926.00                   MOVE MPRMAINCOD OF MPMDLPNT-REC(3:10)                                                              150610 
 1927.00                     TO MPRMAINCOD OF MPMDLPNT-REC                                                                    150610 
 1928.00                END-IF                                                                                                150610 
 1929.00            END-IF                                                                                                    150610 
 1930.00                                                                                                                      150523 
 1931.00            MOVE 1 TO MPSALMON OF MPMDLPNT-REC                                                                        150610 
 1932.00       *9/2/2017                                                                                 170209 
 1933.00       *                                                                                      170209 
 1934.00       *          30/11/2016   /  <= 30/11/2016                                                 170209 
 1935.00       *                MPANTASF                                                         170209 
 1936.00       *          MPSALMON=0                                                                                      170209 
 1937.00            IF  MPSTSCOD OF MPMDLPNT-REC         = 0                                                                  170209 
 1938.00            AND MPISSDATE  OF MPMDLPNT-REC      <= 20161130                                                           170209 
 1939.00                PERFORM CHECK-MPANTASF                                                                                170209 
 1940.00            END-IF                                                                                                    170209 
 1941.00       *26/6/2015     MPMDLPNT                                                                                150626 
 1942.00            IF  SYSAPPCOD OF FCONTRACT-REC       = '01'                                                               150701 
 1943.00            AND COVCOD  OF WRK-FCONCOV-REC(1:2)  = 'MC'                                                               150701 
 1944.00               PERFORM FIND-FCONMICRO                                                                                 150626 
 1945.00       *1                                                                      150626 
 1946.00               MOVE 1 TO MPAVIDXDTA OF MPMDLPNT-REC                                                                   150626 
 1947.00            END-IF                                                                                                    150626 
 1948.00       *08/09/2017   MPPROTAMT,MPNOTINV FOR UR1                                                                170908 
 1949.00            IF  SYSAPPCOD OF FCONTRACT-REC       = '01'                                                               170908 
 1950.00            AND COVCOD  OF WRK-FCONCOV-REC(1:2)  = 'UR'                                                               180515 
 1951.00                  MOVE NINVAMT OF WRK-FCONCOV-REC                                                                     170908 
 1952.00                                        TO MPNOTINV  OF MPMDLPNT-REC                                                  170912 
 1953.00                  MOVE INVAMT OF WRK-FCONCOV-REC                                                                      170912 
 1954.00                                        TO MPPROTAMT OF MPMDLPNT-REC                                                  170912 
 1955.00            END-IF                                                                                                    170908 
 1956.00                                                                                                                      150701 
 1957.00            IF  SYSAPPCOD OF FCONTRACT-REC       = '01'                                                               150701 
 1958.00               MOVE 1 TO MPAVIDXDTA OF MPMDLPNT-REC                                                                   150701 
 1959.00            END-IF                                                                                                    150701 
 1960.00                                                                                                                      150626 
 1961.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150626 
 1962.00            OR SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150626 
 1963.00               MOVE 1 TO MPAVIDXDTA OF MPMDLPNT-REC                                                                   150626 
 1964.00            END-IF                                                                                                    150626 
 1965.00                                                                                                                      150626 
 1966.00            PERFORM PROCESS-EXCLUDE                                                                                   150424 
 1967.00                                                                                                                      150523 
 1968.00            IF  MPRIDCOD OF MPMDLPNT-REC(1:2) = 'HR'                                                                  150630 
 1969.00                MOVE MPMDLPNT-REC TO WRK-MPMDLPNT-REC                                                                 150630 
 1970.00            END-IF                                                                                                    150630 
 1971.00                                                                                                                      150910 
 1972.00            IF COVCOD  OF WRK-FCONCOV-REC(1:2) = 'MC'                                                                 150914 
 1973.00            OR COVCOD  OF WRK-FCONCOV-REC(1:2) = 'UR'                                                                 180515 
 1974.00               MOVE COVCOD OF WRK-FCONCOV-REC TO WRK-COVERNP                                                          150915 
 1975.00               PERFORM  PROCESS-TOPUP                                                                                 150915 
 1976.00            END-IF                                                                                                    170308 
 1977.00                                                                                                                      150914 
 1978.00       *     HK          MC                                       150917 
 1979.00            IF COVCOD OF WRK-FCONCOV-REC(1:2)  = 'MC'                                                                 150917 
 1980.00            OR COVCOD OF WRK-FCONCOV-REC(1:2)  = 'UR'                                                                 180515 
 1981.00               PERFORM CHECK-MCWOPAGESEX                                                                              150917 
 1982.00            END-IF                                                                                                    150914 
 1983.00                                                                                                                      150911 
 1984.00       *  MPRMAINCOD   '00/178'---> '00/175'                                                         150925 
 1985.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150925 
 1986.00            AND MPRMAINCOD OF MPMDLPNT-REC ='00/178'                                                                  150925 
 1987.00               MOVE '00/175' TO MPRMAINCOD OF MPMDLPNT-REC                                                            150925 
 1988.00            END-IF                                                                                                    150925 
 1989.00                                                                                                                      150925 
 1990.00       *8/12/2016   MPRIDCOD   'W001'---> '10001'                                                    161208 
 1991.00       *KAI         MPRIDCOD   'W002'---> '10002'                                                    161208 
 1992.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      161208 
 1993.00               IF  MPRIDCOD OF MPMDLPNT-REC                                                                           161208 
 1994.00                                          ='W001'                                                                     161208 
 1995.00                   MOVE '10001'          TO MPRIDCOD  OF MPMDLPNT-REC                                                 161208 
 1996.00               END-IF                                                                                                 161208 
 1997.00               IF  MPRIDCOD OF MPMDLPNT-REC                                                                           161208 
 1998.00                                          ='W002'                                                                     161208 
 1999.00                   MOVE '10002'          TO MPRIDCOD  OF MPMDLPNT-REC                                                 161208 
 2000.00               END-IF                                                                                                 161208 
 2001.00            END-IF                                                                                                    161208 
 2002.00       *16/02/2018                                                                                                    180308 
 2003.00            IF SYSAPPCOD OF FCONTRACT-REC = '01'                                                                      180308 
 2004.00               IF  MPRIDCOD OF MPMDLPNT-REC                                                                           180308 
 2005.00                                          ='HRP3'                                                                     180308 
 2006.00                   MOVE 'HRP2'           TO MPRIDCOD  OF MPMDLPNT-REC                                                 180308 
 2007.00               END-IF                                                                                                 180308 
 2008.00            END-IF                                                                                                    180308 
 2009.00                                                                                                                      161208 
 2010.00       * mark if it is a wop activated.                                                                               190205 
 2011.00            PERFORM CHECK-WOP-ACTIVATION                                                                              190205 
 2012.00            MOVE WOP-STATUS             TO WOPACT OF MPMDLPNT-REC                                                     190205 
 2013.00                                                                                                                      190205 
 2014.00       *--------------------------------                                                                              190205 
 2015.00       * here a record is written.                                                                                    190205 
 2016.00       *--------------------------------                                                                              190205 
 2017.00            IF  WRK-WR-EXCL =0                                                                                        150422 
 2018.00                IF  COVTYPCOD OF MPFILE-REC    NOT = 'U'                                                              170922 
 2019.00                AND  COVTYPCOD OF MPFILE-REC   NOT = 'M'                                                              170922 
 2020.00                    IF  (STSCOD OF WRK-FCONCOV-REC = 'IF' OR                                                          180530 
 2021.00                         STSCOD OF WRK-FCONCOV-REC = 'PU'   )                                                         180530 
 2022.00                         PERFORM WRITE-BIF-REC                                                                        190219 
 2023.00       ****              WRITE MPMDLPNT-REC                                                                           190219 
 2024.00                    END-IF                                                                                            170922 
 2025.00                ELSE                                                                                                  170922 
 2026.00                    IF  MPFNDAMT  OF MPMDLPNT-REC NOT     = 0                                                         180530 
 2027.00                        IF  MPSPCOD   OF MPMDLPNT-REC     = 0                                                         180530 
 2028.00                            MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                        180530 
 2029.00                            END-IF                                                                                    180530 
 2030.00                        PERFORM WRITE-BIF-REC                                                                         190219 
 2031.00       ****             WRITE MPMDLPNT-REC                                                                            190219 
 2032.00                    END-IF                                                                                            170922 
 2033.00                    IF  MPFNDAMT  OF MPMDLPNT-REC     = 0                                                             170922 
 2034.00                    AND WRK9YEAR                      = WRK-RUNY                                                      170922 
 2035.00                    AND (STSCOD   OF FCONCOV-REC      = 'IF' OR                                                       170922 
 2036.00                         STSCOD   OF FCONCOV-REC      = 'PU'   )                                                      170922 
 2037.00       *                MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                            180530 
 2038.00                        PERFORM WRITE-BIF-REC                                                                         190219 
 2039.00       ****             WRITE MPMDLPNT-REC                                                                            190219 
 2040.00                    END-IF                                                                                            170922 
 2041.00                END-IF                                                                                                170922 
 2042.00       ******   IF  MPSPCOD OF MPMDLPNT-REC      = 3                                                                  180315 
 2043.00       *****    AND SYSAPPCOD OF WRK-FCONCOV-REC = '02'                                                               180315 
 2044.00       *****       INITIALIZE MDLNNONAPR OF MDLNNONAPE-REC                                                            180315 
 2045.00       *****       MOVE MPMDLPNT-REC  TO MDLNNONAPE-REC                                                               180315 
 2046.00       *****       READ MDLNNONAPE                                                                                    180315 
 2047.00       *****       IF MDLNNONAPE-STATUS  NOT = FOUND-REC                                                              180315 
 2048.00       *****          WRITE MDLNNONAPE-REC                                                                            180315 
 2049.00       *****       END-IF                                                                                             180315 
 2050.00       *****    END-IF          15/03/2018                                                                            180315 
 2051.00                                                                                                                      171030 
 2052.00                IF  MPMDLPNT-STATUS     NOT = STATUS-OK                                                               171030 
 2053.00                    PERFORM WRITE-REPLERR                                                                             150423 
 2054.00                END-IF                                                                                                150421 
 2055.00            END-IF                                                                                                    150422 
 2056.00            .                                                                                                         150324 
 2057.00         END-WRITE-MODELP.                                                                                            150428 
 2058.00            EXIT.                                                                                                     150324 
 2059.00                                                                                                                      150324 
 2060.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2061.00         FIND-MPFILESPLIT SECTION.                                                                                    150328 
 2062.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2063.00                                                                                                                      150423 
 2064.00            EVALUATE TRUE                                                                                             150514 
 2065.00            WHEN COVCOD OF WRK-FCONCOV-REC(1:2) = 'HR'                                                                150624 
 2066.00                 EVALUATE TRUE                                                                                        150514 
 2067.00       ****5/2/18  WHEN MPDEDUCT OF MPMDLPNT-REC = 0                                                                  180308 
 2068.00       ****        AND  MPCOINS  OF MPMDLPNT-REC = 10                                                                 180308 
 2069.00       ****             MOVE 1 TO MPAAHCOD OF MPMDLPNT-REC                                                            180308 
 2070.00                   WHEN MPDEDUCT OF MPMDLPNT-REC = 0                                                                  180308 
 2071.00                   AND  MPCOINS  OF MPMDLPNT-REC = 20                                                                 180308 
 2072.00                        MOVE 1 TO MPAAHCOD OF MPMDLPNT-REC                                                            180308 
 2073.00                   WHEN MPDEDUCT OF MPMDLPNT-REC = 500                                                                170718 
 2074.00                   AND  MPCOINS  OF MPMDLPNT-REC = 0                                                                  170718 
 2075.00                        MOVE 5 TO MPAAHCOD OF MPMDLPNT-REC                                                            170718 
 2076.00                   WHEN MPDEDUCT OF MPMDLPNT-REC = 1500                                                               150514 
 2077.00                   AND  MPCOINS  OF MPMDLPNT-REC = 0                                                                  150514 
 2078.00                        MOVE 2 TO MPAAHCOD OF MPMDLPNT-REC                                                            150514 
 2079.00                   WHEN MPDEDUCT OF MPMDLPNT-REC = 3000                                                               150514 
 2080.00                   AND  MPCOINS  OF MPMDLPNT-REC = 0                                                                  150514 
 2081.00                        MOVE 3 TO MPAAHCOD OF MPMDLPNT-REC                                                            150514 
 2082.00                   WHEN MPDEDUCT OF MPMDLPNT-REC = 10000                                                              150514 
 2083.00                   AND  MPCOINS  OF MPMDLPNT-REC = 0                                                                  150514 
 2084.00                        MOVE 4 TO MPAAHCOD OF MPMDLPNT-REC                                                            150514 
 2085.00                   WHEN OTHER                                                                                         150514 
 2086.00                        MOVE 1 TO MPAAHCOD OF MPMDLPNT-REC                                                            150514 
 2087.00                   END-EVALUATE                                                                                       150514 
 2088.00            WHEN COVCOD OF WRK-FCONCOV-REC(1:2) = 'OR'                                                                150630 
 2089.00                   MOVE MPAAHCOD OF WRK-MPMDLPNT-REC                                                                  150630 
 2090.00                     TO MPAAHCOD OF MPMDLPNT-REC                                                                      150630 
 2091.00            WHEN OTHER                                                                                                150514 
 2092.00                 IF MPFILE-STATUS = FOUND-REC                                                                         150514 
 2093.00                    MOVE MPAAHCOD OF MPFILE-REC                                                                       150514 
 2094.00                      TO MPAAHCOD OF MPMDLPNT-REC                                                                     150514 
 2095.00                 ELSE                                                                                                 150514 
 2096.00                    MOVE 1 TO MPAAHCOD OF MPMDLPNT-REC                                                                150514 
 2097.00                 END-IF                                                                                               150514 
 2098.00            END-EVALUATE                                                                                              150514 
 2099.00                                                                                                                      150630 
 2100.00            EVALUATE TRUE                                                                                             180507 
 2101.00            WHEN COVCOD OF WRK-FCONCOV-REC      = 'HRP1'                                                              180622 
 2102.00                 AND  MPDEDUCT OF MPMDLPNT-REC  = 0                                                                   180625 
 2103.00                 AND  MPCOINS  OF MPMDLPNT-REC  = 0                                                                   180625 
 2104.00                        MOVE 0 TO MPAAHCOD OF MPMDLPNT-REC                                                            180507 
 2105.00            END-EVALUATE                                                                                              180507 
 2106.00                                                                                                                      180507 
 2107.00            EVALUATE TRUE                                                                                             150515 
 2108.00            WHEN COVCOD OF WRK-FCONCOV-REC(1:3) = 'HRC'                                                               150624 
 2109.00                   AND  MPDEDUCT OF MPMDLPNT-REC = 1000                                                               150515 
 2110.00                        MOVE 2 TO MPAAHCOD OF MPMDLPNT-REC                                                            150515 
 2111.00            END-EVALUATE                                                                                              150515 
 2112.00                                                                                                                      151218 
 2113.00            EVALUATE TRUE                                                                                             151218 
 2114.00            WHEN COVCOD OF WRK-FCONCOV-REC(1:3) = 'HCM'                                                               151218 
 2115.00                   AND  MPDEDUCT OF MPMDLPNT-REC = 1500                                                               151218 
 2116.00                   AND  MPCOINS  OF MPMDLPNT-REC = 0                                                                  151218 
 2117.00                        MOVE 2 TO MPAAHCOD OF MPMDLPNT-REC                                                            151218 
 2118.00            END-EVALUATE                                                                                              151218 
 2119.00                                                                                                                      151218 
 2120.00       ****14/03/2018                                                                                                 180314 
 2121.00            EVALUATE TRUE                                                                                             151218 
 2122.00            WHEN ((COVCOD OF WRK-FCONCOV-REC(1:3) = 'HOM'                                                             170425 
 2123.00             OR   COVCOD OF WRK-FCONCOV-REC(1:3) = 'HOE')                                                             180507 
 2124.00                  AND  MPDEDUCT OF MPMDLPNT-REC = 1500                                                                180507 
 2125.00                  AND  MPCOINS  OF MPMDLPNT-REC = 0 )                                                                 180507 
 2126.00                        MOVE 2 TO MPAAHCOD OF MPMDLPNT-REC                                                            151218 
 2127.00            END-EVALUATE                                                                                              151218 
 2128.00                                                                                                                      171106 
 2129.00       * 17/10/2017 HRC4 CHANGE                                                                                       171106 
 2130.00            EVALUATE TRUE                                                                                             171106 
 2131.00            WHEN  (COVCOD OF WRK-FCONCOV-REC(1:4) = 'HRC4'                                                            171106 
 2132.00                  AND  MPDEDUCT OF MPMDLPNT-REC = 1500                                                                171106 
 2133.00                  AND  MPCOINS  OF MPMDLPNT-REC = 0 )                                                                 171106 
 2134.00                        MOVE 3 TO MPAAHCOD OF MPMDLPNT-REC                                                            171106 
 2135.00            END-EVALUATE                                                                                              171106 
 2136.00                                                                                                                      151218 
 2137.00            IF SYSAPPCOD OF WRK-FCONCOV-REC ='03'                                                                     150624 
 2138.00               MOVE 1 TO MPAAHCOD OF MPMDLPNT-REC                                                                     150423 
 2139.00            END-IF                                                                                                    150423 
 2140.00                                                                                                                      150423 
 2141.00            IF  SYSAPPCOD OF WRK-FCONCOV-REC ='03'                                                                    150624 
 2142.00            AND (MPRIDCOD  OF MPMDLPNT-REC   ='05Y00'                                                                 151218 
 2143.00            OR  MPRIDCOD  OF MPMDLPNT-REC   ='05Y01'                                                                  150626 
 2144.00            OR  MPRIDCOD  OF MPMDLPNT-REC   ='05Y02')                                                                 151218 
 2145.00               MOVE 5 TO MPAAHCOD OF MPMDLPNT-REC                                                                     150626 
 2146.00            END-IF                                                                                                    150423 
 2147.00                                                                                                                      150511 
 2148.00            IF  MPFILE-STATUS          = FOUND-REC                                                                    150513 
 2149.00            AND MPFILFLD OF MPFILE-REC = SPACES                                                                       150513 
 2150.00                PERFORM PROCESS-MPFILFLD                                                                              150513 
 2151.00            END-IF                                                                                                    150511 
 2152.00                                                                                                                      150423 
 2153.00            IF  SYSAPPCOD OF WRK-FCONCOV-REC ='03'                                                                    150624 
 2154.00            AND (COVCOD   OF WRK-FCONCOV-REC ='60/660' OR                                                             150624 
 2155.00                 COVCOD   OF WRK-FCONCOV-REC ='60/685'   )                                                            150624 
 2156.00                PERFORM FIND-FULFILFLD                                                                                150530 
 2157.00            END-IF                                                                                                    150530 
 2158.00            .                                                                                                         150328 
 2159.00         END-MPFILESPLIT.                                                                                             150328 
 2160.00            EXIT.                                                                                                     150328 
 2161.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2162.00         FIND-MPFREQ    SECTION.                                                                                      150328 
 2163.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2164.00            INITIALIZE MPFREQR  OF  MPFREQ-REC                                                                        150328 
 2165.00            MOVE FREQCOD OF FCONTRACT-REC TO FREQCOD OF MPFREQ-REC                                                    150624 
 2166.00            READ MPFREQ                                                                                               150328 
 2167.00            IF MPFREQ-STATUS = FOUND-REC                                                                              150328 
 2168.00               MOVE MPPRMFREQ OF MPFREQ-REC TO MPPRMFREQ OF MPMDLPNT-REC                                              150328 
 2169.00                                                                                                                      150423 
 2170.00       *       NELIS                                                                                                  150423 
 2171.00               IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                   150624 
 2172.00       *         AJTP=99                                                                                              150430 
 2173.00                 IF AUTINCRCOD OF FCONTRACT-REC ='00'                                                                 150624 
 2174.00       *               1                                                                      150424 
 2175.00                   IF COVCOD OF WRK-FCONCOV-REC(1:2) = '00'                                                           150624 
 2176.00                     IF COVCOD OF WRK-FCONCOV-REC(3:3) = '012'  OR                                                    150624 
 2177.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '032'  OR                                                    150624 
 2178.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '013'  OR                                                    150624 
 2179.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '016'  OR                                                    150624 
 2180.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '017'  OR                                                    150624 
 2181.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '018'  OR                                                    150624 
 2182.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '021'  OR                                                    150624 
 2183.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '022'  OR                                                    150624 
 2184.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '023'  OR                                                    150624 
 2185.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '033'  OR                                                    150624 
 2186.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '014'  OR                                                    150624 
 2187.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '015'  OR                                                    150624 
 2188.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '024'  OR                                                    150624 
 2189.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '034'  OR                                                    150624 
 2190.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '035'  OR                                                    150624 
 2191.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '083'  OR                                                    150624 
 2192.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '084'  OR                                                    150624 
 2193.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '085'  OR                                                    150624 
 2194.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '183'  OR                                                    150624 
 2195.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '184'  OR                                                    150624 
 2196.00                        COVCOD OF WRK-FCONCOV-REC(3:3) = '185'                                                        150624 
 2197.00                        MOVE '1'   TO MPPRMFREQ OF MPMDLPNT-REC                                                       150424 
 2198.00                     END-IF                                                                                           150424 
 2199.00                                                                                                                      150423 
 2200.00                   END-IF                                                                                             150424 
 2201.00                        IF    COVCOD OF WRK-FCONCOV-REC(1:2) = '10'                                                   150624 
 2202.00                        OR    COVCOD OF WRK-FCONCOV-REC(1:2) = '11'                                                   150624 
 2203.00                           MOVE '1'   TO MPPRMFREQ OF MPMDLPNT-REC                                                    150424 
 2204.00                        END-IF                                                                                        150424 
 2205.00                 END-IF                                                                                               150424 
 2206.00               END-IF                                                                                                 150424 
 2207.00            END-IF                                                                                                    150424 
 2208.00            .                                                                                                         150328 
 2209.00         END-MPFREQ.                                                                                                  150328 
 2210.00            EXIT.                                                                                                     150328 
 2211.00                                                                                                                      150423 
 2212.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2213.00         FIND-MPSEX     SECTION.                                                                                      150418 
 2214.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2215.00            INITIALIZE MPSEXR  OF  MPSEX-REC                                                                          150328 
 2216.00            MOVE SEXCOD OF FCONLIF-REC TO SEXCOD OF MPSEX-REC                                                         150624 
 2217.00            READ MPSEX                                                                                                150328 
 2218.00            IF MPSEX-STATUS = FOUND-REC                                                                               150402 
 2219.00               MOVE MPSEXCOD OF MPSEX-REC TO MPSEXCOD OF MPMDLPNT-REC                                                 150402 
 2220.00            ELSE                                                                                                      150513 
 2221.00       *       UNKNOWN - ERROR                                                                                        150513 
 2222.00               MOVE 0                     TO MPSEXCOD OF MPMDLPNT-REC                                                 150723 
 2223.00            END-IF                                                                                                    150402 
 2224.00            .                                                                                                         150328 
 2225.00         END-MPSEX.                                                                                                   150328 
 2226.00            EXIT.                                                                                                     150328 
 2227.00       *------------------------------------------------------------------------------------------------------------- 150523 
 2228.00         FIND-MPSEXBAS     SECTION.                                                                                   150523 
 2229.00       *------------------------------------------------------------------------------------------------------------- 150523 
 2230.00            INITIALIZE MPSEXR  OF  MPSEX-REC                                                                          150523 
 2231.00            MOVE SEXCOD OF WRK-BASFCONLIF-REC TO SEXCOD OF MPSEX-REC                                                  150624 
 2232.00            READ MPSEX                                                                                                150523 
 2233.00            IF MPSEX-STATUS = FOUND-REC                                                                               150523 
 2234.00               MOVE MPSEXCOD OF MPSEX-REC TO MPWOPSEX OF MPMDLPNT-REC                                                 150523 
 2235.00            ELSE                                                                                                      150523 
 2236.00       *       UNKNOWN - ERROR                                                                                        150523 
 2237.00               MOVE 0                     TO MPWOPSEX OF MPMDLPNT-REC                                                 150723 
 2238.00            END-IF                                                                                                    150523 
 2239.00            .                                                                                                         150523 
 2240.00         END-MPSEXBAS.                                                                                                150523 
 2241.00            EXIT.                                                                                                     150523 
 2242.00                                                                                                                      150423 
 2243.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2244.00         FIND-MPSTATUS  SECTION.                                                                                      150328 
 2245.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2246.00            INITIALIZE MPSTATUSR OF  MPSTATUS-REC                                                                     150328 
 2247.00                                                                                                                      150514 
 2248.00            MOVE STSCOD OF WRK-FCONCOV-REC TO STSCOD OF MPSTATUS-REC                                                  150624 
 2249.00            READ MPSTATUS                                                                                             150328 
 2250.00            IF MPSTATUS-STATUS = FOUND-REC                                                                            150402 
 2251.00               MOVE MPSTSCOD OF MPSTATUS-REC TO MPSTSCOD OF MPMDLPNT-REC                                              150402 
 2252.00            END-IF                                                                                                    150402 
 2253.00                                                                                                                      150530 
 2254.00                                                                                                                      150530 
 2255.00            .                                                                                                         150328 
 2256.00         END-MPSTATUS.                                                                                                150328 
 2257.00            EXIT.                                                                                                     150328 
 2258.00                                                                                                                      150423 
 2259.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2260.00         PROCESS-SPCODE SECTION.                                                                                      150328 
 2261.00       *------------------------------------------------------------------------------------------------------------- 150328 
 2262.00                                                                                                                      150423 
 2263.00       *    LIFE400 KAI NELIS KAI                                                                             150423 
 2264.00                                                                                                                      150423 
 2265.00       *    STSCOD = 'PU'                                                                                             150423 
 2266.00            IF  STSCOD OF WRK-FCONCOV-REC = 'PU'                                                                      150624 
 2267.00                MOVE 02 TO MPSPCOD OF MPMDLPNT-REC                                                                    150423 
 2268.00            END-IF                                                                                                    150423 
 2269.00                                                                                                                      150423 
 2270.00       *    STSCOD = 'IF'                                                                                             150423 
 2271.00            IF  STSCOD OF WRK-FCONCOV-REC = 'IF'                                                                      150624 
 2272.00                MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                                    150423 
 2273.00            END-IF                                                                                                    150423 
 2274.00                                                                                                                      150328 
 2275.00       *    INCEPT YEAR = RUNYEAR                                                                                     150423 
 2276.00       *    IF  STSCOD OF WRK-FCONCOV-REC = 'IF'                                                                      150704 
 2277.00            IF  STSCOD OF WRK-FCONCOV-REC NOT = 'PU'                                                                  150704 
 2278.00                IF WRK9YEAR  = WRK-RUNY                                                                               150427 
 2279.00                   MOVE 03 TO MPSPCOD OF MPMDLPNT-REC                                                                 150423 
 2280.00                END-IF                                                                                                150423 
 2281.00            END-IF                                                                                                    150704 
 2282.00                                                                                                                      150624 
 2283.00       *    INCEPT YEAR < RUNYEAR                                                                                     150624 
 2284.00       *    IF STSCOD OF WRK-FCONCOV-REC = 'IF'                                                                       150704 
 2285.00       *    IF  STSCOD OF WRK-FCONCOV-REC NOT = 'PU'                                                                  150704 
 2286.00       *       IF WRK9YEAR  < WRK-RUNY                                                                                150704 
 2287.00       *          MOVE 01 TO MPSPCOD OF MPMDLPNT-REC                                                                  150704 
 2288.00       *       END-IF                                                                                                 150704 
 2289.00       *    END-IF                                                                                                    150704 
 2290.00                                                                                                                      150624 
 2291.00       *    MCPPI                                                                                                     150624 
 2292.00            IF COVCOD OF WRK-FCONCOV-REC(1:2) = 'MC'                                                                  150624 
 2293.00              IF FCSHLCK  OF FCONMICRO-REC = 'Y'                                                                      150624 
 2294.00                MOVE 04 TO MPSPCOD OF MPMDLPNT-REC                                                                    150624 
 2295.00              END-IF                                                                                                  150624 
 2296.00              IF FCSHLCK  OF FCONMICRO-REC = 'Y'                                                                      170224 
 2297.00                MOVE 04 TO MPSPCOD OF MPMDLPNT-REC                                                                    170224 
 2298.00              END-IF                                                                                                  170224 
 2299.00       *                                                                                                              181205 
 2300.00       *      MCG4 has same rules as MCG2.                                                                            190328 
 2301.00       *                                                                                                              181205 
 2302.00              IF COVCOD OF WRK-FCONCOV-REC = 'MCG2'                                                                   170224 
 2303.00       ****?? OR COVCOD OF WRK-FCONCOV-REC = 'MCG4'                                                                   190402 
 2304.00       ****** OR COVCOD OF WRK-FCONCOV-REC = 'MCG3'                                                                   190328 
 2305.00                MOVE CSHLCKDNBR OF FCONMICRO                                                                          170224 
 2306.00                        TO MPCASHLCKD OF MPMDLPNT-REC                                                                 170224 
 2307.00              END-IF                                                                                                  170224 
 2308.00            END-IF                                                                                                    150624 
 2309.00                                                                                                                      150423 
 2310.00       *    NELIS                                                                                                     150423 
 2311.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 2312.00               IF COVCOD OF WRK-FCONCOV-REC(1:2) = '00'                                                               150624 
 2313.00                  IF (COVCOD OF WRK-FCONCOV-REC(3:3) = '012'                                                          150624 
 2314.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '032'                                                           150624 
 2315.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '013'                                                           150624 
 2316.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '016'                                                           150624 
 2317.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '017'                                                           150624 
 2318.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '018'                                                           150624 
 2319.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '021'                                                           150624 
 2320.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '022'                                                           150624 
 2321.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '023'                                                           150624 
 2322.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '033'                                                           150624 
 2323.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '014'                                                           150624 
 2324.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '015'                                                           150624 
 2325.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '024'                                                           150624 
 2326.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '034'                                                           150624 
 2327.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '035'                                                           150624 
 2328.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '083'                                                           150624 
 2329.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '084'                                                           150624 
 2330.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '085'                                                           150624 
 2331.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '183'                                                           150624 
 2332.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '184'                                                           150624 
 2333.00                  OR COVCOD OF WRK-FCONCOV-REC(3:3) = '185')                                                          150624 
 2334.00                  AND FREQCOD OF FCONTRACT-REC   = '00'                                                               150624 
 2335.00                     MOVE 02 TO MPSPCOD OF MPMDLPNT-REC                                                               150423 
 2336.00                  END-IF                                                                                              150428 
 2337.00               END-IF                                                                                                 150423 
 2338.00            END-IF                                                                                                    150416 
 2339.00                                                                                                                      150423 
 2340.00            .                                                                                                         150328 
 2341.00         END-PROCESS-SPCODE.                                                                                          150328 
 2342.00            EXIT.                                                                                                     150328 
 2343.00                                                                                                                      150423 
 2344.00       *------------------------------------------------------------------------------------------------------------- 150330 
 2345.00         NELIS-AGEATENTRY SECTION.                                                                                    150330 
 2346.00       *------------------------------------------------------------------------------------------------------------- 150330 
 2347.00            IF COVCOD OF WRK-FCONCOV-REC(1:2) NOT = '00'                                                              150624 
 2348.00       *       MOVE PRCAGE OF WRK-FCONCOV-REC TO                                                                      150625 
 2349.00       *            MPAGEENTR OF MPMDLPNT-REC                                                                         150625 
 2350.00       *       MOVE PRCAGE OF WRK-FCONCOV-REC TO                                                                      150625 
 2351.00       *            MPAGERDF  OF MPMDLPNT-REC                                                                         150625 
 2352.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO                                                                  150625 
 2353.00                    MPAGEENTR  OF MPMDLPNT-REC                                                                        150625 
 2354.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO                                                                  150625 
 2355.00                    MPAGERDF   OF MPMDLPNT-REC                                                                        150625 
 2356.00            END-IF                                                                                                    150423 
 2357.00                                                                                                                      150330 
 2358.00            IF COVCOD OF WRK-FCONCOV-REC(1:2) = '00'                                                                  150624 
 2359.00                                                                                                                      150423 
 2360.00               IF  COVCOD   OF WRK-FCONCOV-REC(3:3)='043'                                                             150624 
 2361.00               AND MPSEXCOD OF MPSEX-REC = 0                                                                          150418 
 2362.00                  MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                  150624 
 2363.00                    TO MPAGEENTR  OF MPMDLPNT-REC                                                                     150423 
 2364.00                  COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                150423 
 2365.00                          MPAGEENTR OF MPMDLPNT-REC  + 3                                                              150423 
 2366.00               END-IF                                                                                                 150330 
 2367.00                                                                                                                      150423 
 2368.00               IF  COVCOD OF WRK-FCONCOV-REC(3:3)='043'                                                               150624 
 2369.00               AND MPSEXCOD OF MPSEX-REC = 1                                                                          150423 
 2370.00                   MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                 150624 
 2371.00                     TO MPAGEENTR  OF MPMDLPNT-REC                                                                    150423 
 2372.00               END-IF                                                                                                 150423 
 2373.00                                                                                                                      150423 
 2374.00            END-IF                                                                                                    150423 
 2375.00                                                                                                                      150506 
 2376.00       *    IENDOW AND AJFYL=0 AND AJHLK1>=1                                                                          150423 
 2377.00            IF  MPFILFLD   OF MPMDLPNT-REC    ='IENDOW'                                                               150424 
 2378.00            AND MPSEXCOD   OF MPSEX-REC       = 0                                                                     150423 
 2379.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC >=1                                                                     150624 
 2380.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                     150624 
 2381.00                 TO MPAGEENTR  OF MPMDLPNT-REC                                                                        150423 
 2382.00               COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                   150423 
 2383.00                       MPAGEENTR OF MPMDLPNT-REC  + 5                                                                 150423 
 2384.00            END-IF                                                                                                    150423 
 2385.00                                                                                                                      150423 
 2386.00       *    IENDOW AND AJFYL=0 AND AJHLK=0                                                                            150423 
 2387.00            IF  MPFILFLD   OF MPMDLPNT-REC ='IENDOW'                                                                  150424 
 2388.00            AND MPSEXCOD   OF MPSEX-REC    = 0                                                                        150423 
 2389.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC   = 0                                                                   150624 
 2390.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                     150624 
 2391.00                 TO MPAGEENTR  OF MPMDLPNT-REC                                                                        150423 
 2392.00               COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                   150423 
 2393.00                       MPAGEENTR OF MPMDLPNT-REC  + 6                                                                 150423 
 2394.00            END-IF                                                                                                    150423 
 2395.00                                                                                                                      150423 
 2396.00       *    IENDOW AND AJFYL=1 AND AJHLK>=1 AND AJHLK<=18                                                             150423 
 2397.00            IF  MPFILFLD   OF MPMDLPNT-REC ='IENDOW'                                                                  150424 
 2398.00            AND MPSEXCOD   OF MPSEX-REC    = 1                                                                        150423 
 2399.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC  >= 1                                                                   150624 
 2400.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC  <= 18                                                                  150624 
 2401.00              MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                      150624 
 2402.00                TO MPAGEENTR  OF MPMDLPNT-REC                                                                         150423 
 2403.00              COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                    150423 
 2404.00                      MPAGEENTR OF MPMDLPNT-REC  + 5                                                                  150423 
 2405.00            END-IF                                                                                                    150423 
 2406.00                                                                                                                      150423 
 2407.00       *    IENDOW AND AJFYL=1 AND AJHLK=0                                                                            150423 
 2408.00            IF  MPFILFLD   OF MPMDLPNT-REC = 'IENDOW'                                                                 150424 
 2409.00            AND MPSEXCOD   OF MPSEX-REC    = 1                                                                        150423 
 2410.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC   = 0                                                                   150624 
 2411.00              MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                      150624 
 2412.00                TO MPAGEENTR  OF MPMDLPNT-REC                                                                         150423 
 2413.00              COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                    150408 
 2414.00                      MPAGEENTR OF MPMDLPNT-REC  + 6                                                                  150423 
 2415.00            END-IF                                                                                                    150423 
 2416.00                                                                                                                      150423 
 2417.00       *    IENDOW AND AJFYL=1 AND AJHLK >18                                                                          150423 
 2418.00            IF  MPFILFLD OF MPMDLPNT-REC     = 'IENDOW'                                                               150424 
 2419.00            AND MPSEXCOD OF MPSEX-REC        = 1                                                                      150423 
 2420.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC > 18                                                                    150624 
 2421.00              MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                      150624 
 2422.00                TO MPAGEENTR  OF MPMDLPNT-REC                                                                         150426 
 2423.00              COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                    150426 
 2424.00                      MPAGEENTR OF MPMDLPNT-REC  + 2                                                                  150426 
 2425.00            END-IF                                                                                                    150423 
 2426.00                                                                                                                      150423 
 2427.00       *    IPEND_ AND AJFYL=0                                                                                        150508 
 2428.00            IF  MPFILFLD OF MPMDLPNT-REC     ='IPEND_'                                                                150508 
 2429.00            AND MPSEXCOD OF MPSEX-REC=0                                                                               150508 
 2430.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    150624 
 2431.00                  TO MPAGEENTR OF MPMDLPNT-REC                                                                        150508 
 2432.00                COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                  150508 
 2433.00                        MPAGEENTR OF MPMDLPNT-REC  + 3                                                                150508 
 2434.00            END-IF                                                                                                    150508 
 2435.00                                                                                                                      150508 
 2436.00       *    IPEND_ AND AJFYL=1 AND AJHLK <=18                                                                         150508 
 2437.00            IF MPFILFLD OF MPMDLPNT-REC       ='IPEND_'                                                               150426 
 2438.00            AND  MPSEXCOD OF  MPSEX-REC       =  1                                                                    150426 
 2439.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC >=  0                                                                   150624 
 2440.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC <= 18                                                                   150624 
 2441.00              MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                      150624 
 2442.00                TO MPAGEENTR OF MPMDLPNT-REC                                                                          150423 
 2443.00              COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                    150408 
 2444.00                      MPAGEENTR OF MPMDLPNT-REC  + 3                                                                  150506 
 2445.00            END-IF                                                                                                    150506 
 2446.00                                                                                                                      150508 
 2447.00       *    IPEND_ AND AJFYL=1 AND AJHLK >18                                                                          150508 
 2448.00            IF MPFILFLD OF MPMDLPNT-REC      ='IPEND_'                                                                150508 
 2449.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC > 18                                                                    150624 
 2450.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                     150624 
 2451.00                 TO MPAGEENTR OF MPMDLPNT-REC                                                                         150508 
 2452.00            END-IF                                                                                                    150508 
 2453.00                                                                                                                      150506 
 2454.00       *                                                                                                              150408 
 2455.00            IF COVCOD OF WRK-FCONCOV-REC          = '00042'                                                           150624 
 2456.00               IF MPSEXCOD OF MPSEX-REC = 0                                                                           150511 
 2457.00                  COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                150511 
 2458.00                          MPAGEENTR OF MPMDLPNT-REC - 2                                                               150511 
 2459.00               END-IF                                                                                                 150511 
 2460.00               IF MPSEXCOD OF MPSEX-REC = 1                                                                           150511 
 2461.00                  COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                150511 
 2462.00                          MPAGEENTR OF MPMDLPNT-REC - 5                                                               150511 
 2463.00               END-IF                                                                                                 150511 
 2464.00               IF MPAGEENTR OF MPMDLPNT-REC < 0                                                                       150511 
 2465.00                  MOVE ZEROES TO MPAGEENTR OF MPMDLPNT-REC                                                            150511 
 2466.00               END-IF                                                                                                 150511 
 2467.00            END-IF                                                                                                    150511 
 2468.00                                                                                                                      150506 
 2469.00       *    IWL_   AND AJFYL=0 AND AJHLK <= 1                                                                         150506 
 2470.00            IF MPFILFLD OF MPMDLPNT-REC       = 'IWL___'                                                              150508 
 2471.00            AND MPSEXCOD OF  MPSEX-REC        = 0                                                                     150506 
 2472.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC <= 1                                                                    150624 
 2473.00                MOVE 1 TO MPAGEENTR OF MPMDLPNT-REC                                                                   150506 
 2474.00            END-IF                                                                                                    150506 
 2475.00                                                                                                                      150506 
 2476.00       *    IWL_   AND AJFYL=0 AND AJHLK > 1                                                                          150506 
 2477.00            IF  MPFILFLD  OF MPMDLPNT-REC     = 'IWL___ '                                                             150506 
 2478.00            AND MPSEXCOD OF MPSEX-REC         = 0                                                                     150506 
 2479.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC  > 1                                                                    150624 
 2480.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    150624 
 2481.00                  TO MPAGEENTR OF MPMDLPNT-REC                                                                        150506 
 2482.00            END-IF                                                                                                    150506 
 2483.00                                                                                                                      150506 
 2484.00       *    IWL_   AND AJFYL=1 AND AJHLK < 1                                                                          150506 
 2485.00            IF  MPFILFLD OF MPMDLPNT-REC      = 'IWL___'                                                              150506 
 2486.00            AND MPSEXCOD OF MPSEX-REC         = 1                                                                     150506 
 2487.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC  < 1                                                                    150624 
 2488.00                MOVE 1 TO MPAGEENTR OF MPMDLPNT-REC                                                                   150506 
 2489.00            END-IF                                                                                                    150506 
 2490.00                                                                                                                      150506 
 2491.00       *    IWL_   AND AJFYL=1 AND AJHLK >= 1  AND AGE_AT ENTRY <=15                                                  150506 
 2492.00            IF  MPFILFLD OF MPMDLPNT-REC      = 'IWL___'                                                              150506 
 2493.00            AND MPSEXCOD OF MPSEX-REC         = 1                                                                     150506 
 2494.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC >= 1                                                                    150624 
 2495.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC <= 15                                                                   150624 
 2496.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    150624 
 2497.00                  TO MPAGEENTR OF MPMDLPNT-REC                                                                        150506 
 2498.00            END-IF                                                                                                    150506 
 2499.00                                                                                                                      150330 
 2500.00       *    IWL_   AND AJFYL=1 AND AJHLK >= 1  AND AGE_AT ENTRY >16                                                   150506 
 2501.00       *    AND AGE_AT ENTRY <=18                                                                                     150506 
 2502.00            IF MPFILFLD  OF MPMDLPNT-REC      = 'IWL___'                                                              150506 
 2503.00            AND MPSEXCOD OF  MPSEX-REC        = 1                                                                     150506 
 2504.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC >= 16                                                                   150624 
 2505.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC <= 18                                                                   150624 
 2506.00                MOVE 15 TO MPAGEENTR OF MPMDLPNT-REC                                                                  150506 
 2507.00            END-IF                                                                                                    150506 
 2508.00                                                                                                                      150506 
 2509.00       *    IWL_   AND AJFYL=1 AND AJHLK >18                                                                          150506 
 2510.00            IF MPFILFLD  OF MPMDLPNT-REC      = 'IWL___'                                                              150506 
 2511.00            AND RSKCOMMAGE OF WRK-FCONCOV-REC  > 18                                                                   150624 
 2512.00            AND MPSEXCOD   OF MPSEX-REC       = 1                                                                     150506 
 2513.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    150624 
 2514.00                  TO MPAGEENTR OF MPMDLPNT-REC                                                                        150506 
 2515.00                COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                  150506 
 2516.00                        MPAGEENTR OF MPMDLPNT-REC  - 3                                                                150506 
 2517.00            END-IF                                                                                                    150506 
 2518.00                                                                                                                      150506 
 2519.00       *    ITERM_  AND AJFYL=0                                                                                       150506 
 2520.00            IF  MPFILFLD  OF MPMDLPNT-REC     = 'ITERM_'                                                              150506 
 2521.00            AND MPSEXCOD  OF MPSEX-REC        = 0                                                                     150506 
 2522.00                MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                    150624 
 2523.00                  TO MPAGEENTR OF MPMDLPNT-REC                                                                        150506 
 2524.00            END-IF                                                                                                    150506 
 2525.00                                                                                                                      150506 
 2526.00       *    ITERM_  AND AJFYL=1 AND AJHLK 0,1,2,3                                                                     150606 
 2527.00            IF MPFILFLD OF MPMDLPNT-REC       ='ITERM_'                                                               150509 
 2528.00            AND MPSEXCOD OF MPSEX-REC=1                                                                               150509 
 2529.00            AND (RSKCOMMAGE OF WRK-FCONCOV-REC  = 0                                                                   150624 
 2530.00            OR RSKCOMMAGE  OF WRK-FCONCOV-REC   = 1                                                                   150624 
 2531.00            OR RSKCOMMAGE  OF WRK-FCONCOV-REC   = 2                                                                   150624 
 2532.00            OR RSKCOMMAGE  OF WRK-FCONCOV-REC   = 3 )                                                                 150624 
 2533.00               MOVE 0  TO MPAGEENTR OF MPMDLPNT-REC                                                                   150509 
 2534.00            END-IF                                                                                                    150509 
 2535.00                                                                                                                      150606 
 2536.00       *    ITERM_  AND AJFYL=1 AND AJHLK >3                                                                          150606 
 2537.00            IF  MPFILFLD OF MPMDLPNT-REC       ='ITERM_'                                                              150509 
 2538.00            AND MPSEXCOD OF MPSEX-REC          =1                                                                     150509 
 2539.00            AND  RSKCOMMAGE OF WRK-FCONCOV-REC  >3                                                                    150624 
 2540.00                COMPUTE MPAGEENTR OF MPMDLPNT-REC  =                                                                  150509 
 2541.00                        MPAGEENTR OF MPMDLPNT-REC - 3                                                                 150509 
 2542.00            END-IF                                                                                                    150509 
 2543.00                                                                                                                      150508 
 2544.00       *    HOSPITAL PLUS - AAH -                                                                         150509 
 2545.00            IF COVCOD OF WRK-FCONCOV-REC(1:2) = '11'                                                                  150624 
 2546.00               IF COVCOD OF WRK-FCONCOV-REC(3:3)='132'                                                                150624 
 2547.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='133'                                                                150624 
 2548.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='134'                                                                150624 
 2549.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='135'                                                                150624 
 2550.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='232'                                                                150624 
 2551.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='233'                                                                150624 
 2552.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='234'                                                                150624 
 2553.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='235'                                                                150624 
 2554.00               OR COVCOD OF WRK-FCONCOV-REC(3:3)='236'                                                                160603 
 2555.00               OR (COVCOD OF WRK-FCONCOV-REC(3:3) >= '300' AND                                                        150626 
 2556.00                   COVCOD OF WRK-FCONCOV-REC(3:3) <= '998'    )                                                       150624 
 2557.00               OR ((COVCOD  OF WRK-FCONCOV-REC(3:3) = '011' OR                                                        150624 
 2558.00                    COVCOD  OF WRK-FCONCOV-REC(3:3) = '012'   ) AND                                                   150624 
 2559.00                    CAMPCOD OF WRK-FCONCOV-REC      = 'A1'         )                                                  150624 
 2560.00                  MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                  150624 
 2561.00                    TO MPAGEENTR  OF MPMDLPNT-REC                                                                     150509 
 2562.00                  MOVE RSKCOMMAGE OF WRK-FCONCOV-REC                                                                  150624 
 2563.00                    TO MPAGERDF   OF MPMDLPNT-REC                                                                     150606 
 2564.00               END-IF                                                                                                 150509 
 2565.00            END-IF                                                                                                    150509 
 2566.00                                                                                                                      150509 
 2567.00            IF COVCOD OF WRK-FCONCOV-REC = COVCOD OF WRK-BASFCOV-REC                                                  150624 
 2568.00               MOVE MPAGEENTR OF MPMDLPNT-REC                                                                         150509 
 2569.00                 TO WRK-BAS-MPAGEENTR                                                                                 150509 
 2570.00            ELSE                                                                                                      150509 
 2571.00               MOVE ZEROES                                                                                            150509 
 2572.00                 TO WRK-BAS-MPAGEENTR                                                                                 150509 
 2573.00            END-IF                                                                                                    150509 
 2574.00                                                                                                                      150509 
 2575.00            .                                                                                                         150330 
 2576.00         END-NELIS-AGEATENTRY.                                                                                        150330 
 2577.00            EXIT.                                                                                                     150330 
 2578.00                                                                                                                      150423 
 2579.00       *------------------------------------------------------------------------------------------------------------- 150330 
 2580.00         CALC-MPPAIDUP SECTION.                                                                                       150331 
 2581.00       *------------------------------------------------------------------------------------------------------------- 150330 
 2582.00            MOVE PAYDT OF FCONTRACT-REC TO WRK-PAYDT                                                                  150624 
 2583.00                                                                                                                      150427 
 2584.00            IF SYSAPPCOD OF FCONTRACT-REC  = '01'                                                                     150624 
 2585.00               IF STSCOD OF WRK-FCONCOV-REC = 'PU'                                                                    150624 
 2586.00                  IF PAYDT OF FCONTRACT-REC <                                                                         150624 
 2587.00                     STSDT OF FCONTRACT-REC                                                                           150624 
 2588.00                     MOVE PAYDT OF FCONTRACT-REC TO WRK-PAYDT                                                         150624 
 2589.00                  ELSE                                                                                                150612 
 2590.00                     MOVE STSDT OF FCONTRACT-REC TO WRK-PAYDT                                                         150624 
 2591.00                  END-IF                                                                                              150612 
 2592.00                  COMPUTE D1 = (WRK-PAYDTYEAR * 360 ) +                                                               150520 
 2593.00                               (WRK-PAYDTMONTH * 30) +                                                                150520 
 2594.00                               WRK-PAYDTDAY                                                                           150520 
 2595.00                  COMPUTE D2 = (MPINCPYEAR OF MPMDLPNT-REC * 360 ) +                                                  150520 
 2596.00                               (MPINCPMON  OF MPMDLPNT-REC * 30)   +                                                  150520 
 2597.00                                MPINCPDAY  OF MPMDLPNT-REC                                                            150520 
 2598.00                  COMPUTE D3 ROUNDED =  (D1 - D2) / 360                                                               150612 
 2599.00                                                                                                                      150612 
 2600.00                  COMPUTE D3 =  (D1 - D2) / 360                                                                       150612 
 2601.00                  COMPUTE D4 =  (D1 - D2) / 360                                                                       150612 
 2602.00                  IF D3 > D4                                                                                          150612 
 2603.00                     COMPUTE D4 = D4 + 1                                                                              150612 
 2604.00                  END-IF                                                                                              150612 
 2605.00                  MOVE D4  TO MPPAIDUPY OF MPMDLPNT-REC                                                               150612 
 2606.00       *          COMPUTE MPPAIDUPY OF MPMDLPNT-REC ROUNDED =                                                         150612 
 2607.00       *                  D3                                                                                          150612 
 2608.00               ELSE                                                                                                   150520 
 2609.00                  MOVE 0   TO MPPAIDUPY OF MPMDLPNT-REC                                                               150520 
 2610.00               END-IF                                                                                                 150520 
 2611.00            END-IF                                                                                                    150426 
 2612.00                                                                                                                      150426 
 2613.00            IF SYSAPPCOD OF FCONTRACT-REC  = '02'                                                                     150624 
 2614.00               PERFORM NELIS-STATUSDATE                                                                               150520 
 2615.00               IF STSCOD OF WRK-FCONCOV-REC = 'PU'                                                                    150624 
 2616.00                  COMPUTE D1 = (WRK-PAYDTYEAR * 360 ) +                                                               150520 
 2617.00                               (WRK-PAYDTMONTH * 30) +                                                                150520 
 2618.00                               WRK-PAYDTDAY                                                                           150520 
 2619.00                  COMPUTE D2 = (MPINCPYEAR  OF MPMDLPNT-REC   * 360 ) +                                               150520 
 2620.00                               (MPINCPMON   OF MPMDLPNT-REC * 30)   +                                                 150520 
 2621.00                                MPINCPDAY   OF MPMDLPNT-REC                                                           150520 
 2622.00                  COMPUTE D3 =  (D1 - D2) / 360                                                                       150520 
 2623.00                  MOVE D3  TO MPPAIDUPY OF MPMDLPNT-REC                                                               150520 
 2624.00               ELSE                                                                                                   150520 
 2625.00       *          For all other life coverages                                                                        150520 
 2626.00                  IF COVCOD OF WRK-FCONCOV-REC(1:2) = '00'                                                            150624 
 2627.00                     IF COVCOD OF WRK-FCONCOV-REC(3:3) = '012'                                                        150624 
 2628.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '032'                                                        150624 
 2629.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '013'                                                        150624 
 2630.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '016'                                                        150624 
 2631.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '017'                                                        150624 
 2632.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '018'                                                        150624 
 2633.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '021'                                                        150624 
 2634.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '022'                                                        150624 
 2635.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '023'                                                        150624 
 2636.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '033'                                                        150624 
 2637.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '014'                                                        150624 
 2638.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '015'                                                        150624 
 2639.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '024'                                                        150624 
 2640.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '034'                                                        150624 
 2641.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '083'                                                        150624 
 2642.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '084'                                                        150624 
 2643.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '085'                                                        150624 
 2644.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '183'                                                        150624 
 2645.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '184'                                                        150624 
 2646.00                     OR COVCOD OF WRK-FCONCOV-REC(3:3) = '185'                                                        150624 
 2647.00                     AND AUTINCRCOD OF FCONTRACT-REC ='00'                                                            150624 
 2648.00                        MOVE 1 TO MPPAIDUPY OF MPMDLPNT-REC                                                           150520 
 2649.00       *                AJTP=99                                                                                       150520 
 2650.00                        IF AUTINCRCOD OF FCONTRACT-REC ='00'                                                          150624 
 2651.00                           MOVE 1 TO MPPAIDUPY OF MPMDLPNT-REC                                                        150520 
 2652.00                        ELSE                                                                                          150520 
 2653.00                           MOVE 0 TO MPPAIDUPY OF MPMDLPNT-REC                                                        150520 
 2654.00                        END-IF                                                                                        150520 
 2655.00                     END-IF                                                                                           150520 
 2656.00                  END-IF                                                                                              150520 
 2657.00               END-IF                                                                                                 150520 
 2658.00                                                                                                                      150426 
 2659.00            END-IF                                                                                                    150417 
 2660.00                                                                                                                      150426 
 2661.00       *                                                                                                      150520 
 2662.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 2663.00               IF STSCOD OF WRK-FCONCOV-REC = 'PU'                                                                    150624 
 2664.00                  MOVE STSDT OF WRK-FCONCOV-REC TO WRK-PAYDT                                                          150624 
 2665.00       *          STATUS DATE - INCEPT DATE                                                                           150520 
 2666.00                  COMPUTE D1 = (WRK-PAYDTYEAR * 360 ) +                                                               150607 
 2667.00                               (WRK-PAYDTMONTH * 30) +                                                                150607 
 2668.00                               WRK-PAYDTDAY                                                                           150607 
 2669.00                  COMPUTE D2 = (MPINCPYEAR OF MPMDLPNT-REC * 360 ) +                                                  150520 
 2670.00                               (MPINCPMON  OF MPMDLPNT-REC * 30)   +                                                  150520 
 2671.00                                MPINCPDAY  OF MPMDLPNT-REC                                                            150520 
 2672.00                  COMPUTE D3 =  (D1 - D2) / 360                                                                       150520 
 2673.00                  COMPUTE D4 =  (D1 - D2) / 360                                                                       150607 
 2674.00                  IF D3 > D4                                                                                          150607 
 2675.00                     COMPUTE D4 = D4 + 1                                                                              150607 
 2676.00                  END-IF                                                                                              150607 
 2677.00                  MOVE D4  TO MPPAIDUPY OF MPMDLPNT-REC                                                               150607 
 2678.00               ELSE                                                                                                   150417 
 2679.00                  MOVE 0 TO MPPAIDUPY OF MPMDLPNT-REC                                                                 150520 
 2680.00               END-IF                                                                                                 150417 
 2681.00            END-IF                                                                                                    150417 
 2682.00            .                                                                                                         150331 
 2683.00         END-CALC-MPPAIDUP.                                                                                           150331 
 2684.00            EXIT.                                                                                                     150330 
 2685.00       *------------------------------------------------------------------------------------------------------------- 150331 
 2686.00         NELIS-STATUSDATE  SECTION.                                                                                   150331 
 2687.00       *------------------------------------------------------------------------------------------------------------- 150331 
 2688.00       *    IF STSCOD OF WRK-FCONCOV-REC = 'IF'                                                                       150624 
 2689.00       *    OR  WRK-PAYDT  =  0                                                                                       150604 
 2690.00       *          MOVE MPINCPDAY  OF MPMDLPNT-REC  TO                                                                 150604 
 2691.00       *                            MPSTSDAY   OF MPMDLPNT-REC                                                        150604 
 2692.00       *          MOVE MPINCPMON  OF MPMDLPNT-REC  TO                                                                 150604 
 2693.00       *                            MPSTSMON   OF MPMDLPNT-REC                                                        150604 
 2694.00       *          MOVE MPINCPYEAR OF MPMDLPNT-REC  TO                                                                 150604 
 2695.00       *                            MPSTSYEAR  OF MPMDLPNT-REC                                                        150604 
 2696.00       *    END-IF                                                                                                    150604 
 2697.00       *If status date is later than the last payment date then is equal to the last payment month. If there is no    150331 
 2698.00       * change then is equal to the inception month.                                                                 150331 
 2699.00       * IF AJTMD_AJTMM_AJTMY  is  > SBEPD_ SBEPM_SBEPY THEN  value = SBEPM                                           150331 
 2700.00       * IF AJTMD_AJTMM_AJTMY  is  < SBEPD_ SBEPM_SBEPY THEN  value = AJTMM                                           150331 
 2701.00                                                                                                                      150424 
 2702.00            IF STSCOD OF WRK-FCONCOV-REC NOT = 'IF'                                                                   150624 
 2703.00                                                                                                                      150426 
 2704.00                IF WRK-MPSTATUSDATE  < WRK-PAYDT                                                                      150424 
 2705.00                  MOVE WRK-MPSTATUSD   TO MPSTSDAY   OF MPMDLPNT-REC                                                  150424 
 2706.00                  MOVE WRK-MPSTATUSM   TO MPSTSMON   OF MPMDLPNT-REC                                                  150424 
 2707.00                  MOVE WRK-MPSTATUSY   TO MPSTSYEAR  OF MPMDLPNT-REC                                                  150424 
 2708.00                END-IF                                                                                                150424 
 2709.00                                                                                                                      150426 
 2710.00                IF WRK-MPSTATUSDATE  > WRK-PAYDT                                                                      150426 
 2711.00                  MOVE WRK-PAYDTDAY    TO MPSTSDAY   OF MPMDLPNT-REC                                                  150426 
 2712.00                  MOVE WRK-PAYDTMONTH  TO MPSTSMON   OF MPMDLPNT-REC                                                  150426 
 2713.00                  MOVE WRK-PAYDTYEAR   TO MPSTSYEAR  OF MPMDLPNT-REC                                                  150426 
 2714.00                END-IF                                                                                                150426 
 2715.00                                                                                                                      150426 
 2716.00            END-IF                                                                                                    150426 
 2717.00            .                                                                                                         150424 
 2718.00         END-NELIS-STATUSDATE.                                                                                        150331 
 2719.00            EXIT.                                                                                                     150331 
 2720.00                                                                                                                      150430 
 2721.00       *------------------------------------------------------------------------------------------------------------- 150331 
 2722.00         READ-FCONFUND SECTION.                                                                                       150624 
 2723.00       *------------------------------------------------------------------------------------------------------------- 150331 
 2724.00                                                                                                                      150423 
 2725.00            INITIALIZE CONFUNDR  OF FCONFUND-REC                                                                      150624 
 2726.00            INITIALIZE MPFNDAMT  OF MPMDLPNT-REC                                                                      150430 
 2727.00       *    INITIALIZE MPUNIPRC  OF MPMDLPNT-REC                                                                      150606 
 2728.00            INITIALIZE MPUNINBR  OF MPMDLPNT-REC                                                                      150606 
 2729.00                                                                                                                      150331 
 2730.00            MOVE RUNDT     OF WRK-FCONCOV-REC  TO                                                                     150624 
 2731.00                 RUNDT     OF FCONFUND-REC                                                                            150624 
 2732.00            MOVE COMPCOD   OF WRK-FCONCOV-REC  TO                                                                     150624 
 2733.00                 COMPCOD   OF FCONFUND-REC                                                                            150624 
 2734.00            MOVE DSBCHACOD OF WRK-FCONCOV-REC  TO                                                                     150624 
 2735.00                 DSBCHACOD OF FCONFUND-REC                                                                            150624 
 2736.00            MOVE BRCHCOD   OF WRK-FCONCOV-REC  TO                                                                     150624 
 2737.00                 BRCHCOD   OF FCONFUND-REC                                                                            150624 
 2738.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC  TO                                                                     150624 
 2739.00                 SYSAPPCOD OF FCONFUND-REC                                                                            150624 
 2740.00            MOVE CONNBR    OF WRK-FCONCOV-REC  TO                                                                     150624 
 2741.00                 CONNBR    OF FCONFUND-REC                                                                            150624 
 2742.00             MOVE LOW-VALUES  TO LIFNO     OF FCONFUND-REC                                                            150624 
 2743.00                                                                                                                      150331 
 2744.00            START FCONFUND KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150624 
 2745.00            READ  FCONFUND NEXT                                                                                       150624 
 2746.00                                                                                                                      150429 
 2747.00            PERFORM  UNTIL FCONFUND-STATUS NOT  = FOUND-REC                                                           150624 
 2748.00            OR RUNDT     OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2749.00               RUNDT     OF FCONFUND-REC                                                                              150624 
 2750.00            OR COMPCOD   OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2751.00               COMPCOD   OF FCONFUND-REC                                                                              150624 
 2752.00            OR DSBCHACOD OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2753.00               DSBCHACOD OF FCONFUND-REC                                                                              150624 
 2754.00            OR BRCHCOD   OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2755.00               BRCHCOD   OF FCONFUND-REC                                                                              150624 
 2756.00            OR SYSAPPCOD OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2757.00               SYSAPPCOD OF FCONFUND-REC                                                                              150624 
 2758.00            OR CONNBR    OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2759.00               CONNBR    OF FCONFUND-REC                                                                              150624 
 2760.00                                                                                                                      150430 
 2761.00               COMPUTE MPFNDAMT   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2762.00                       MPFNDAMT   OF MPMDLPNT-REC +                                                                   150612 
 2763.00                       FUNDUNTVAL OF FCONFUND-REC                                                                     150624 
 2764.00               COMPUTE MPUNINBR   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2765.00                       MPUNINBR   OF MPMDLPNT-REC +                                                                   150612 
 2766.00                       FUNDUNTNBR OF FCONFUND-REC                                                                     150624 
 2767.00               IF COVCOD OF WRK-FCONCOV-REC(1:2) NOT = 'ML'                                                           150624 
 2768.00                  COMPUTE MPUNIPRC   OF MPMDLPNT-REC ROUNDED =                                                        150612 
 2769.00                          FUNDUNTPRC OF FCONFUND-REC                                                                  150624 
 2770.00               END-IF                                                                                                 150606 
 2771.00                                                                                                                      150430 
 2772.00               READ  FCONFUND NEXT                                                                                    150624 
 2773.00                                                                                                                      150429 
 2774.00            END-PERFORM                                                                                               150430 
 2775.00                                                                                                                      150422 
 2776.00            IF COVCOD  OF WRK-FCONCOV-REC(1:2) = 'MC'                                                                 150624 
 2777.00                                                                                                                      150616 
 2778.00               MOVE ZEROES TO WRK-NPMPNOTINV                                                                          150918 
 2779.00                                                                                                                      150918 
 2780.00               INITIALIZE CONMICROR OF FCONMICRO-REC                                                                  150624 
 2781.00               MOVE RUNDT   OF WRK-FCONCOV-REC TO                                                                     150624 
 2782.00                    RUNDT   OF FCONMICRO-REC                                                                          150624 
 2783.00               MOVE COMPCOD OF WRK-FCONCOV-REC TO                                                                     150624 
 2784.00                    COMPCOD OF FCONMICRO-REC                                                                          150624 
 2785.00               MOVE DSBCHACOD  OF WRK-FCONCOV-REC TO                                                                  150624 
 2786.00                    DSBCHACOD OF FCONMICRO-REC                                                                        150624 
 2787.00               MOVE BRCHCOD  OF WRK-FCONCOV-REC TO                                                                    150624 
 2788.00                    BRCHCOD OF FCONMICRO-REC                                                                          150624 
 2789.00               MOVE SYSAPPCOD OF WRK-FCONCOV-REC TO                                                                   150624 
 2790.00                    SYSAPPCOD OF FCONMICRO-REC                                                                        150624 
 2791.00               MOVE CONNBR    OF WRK-FCONCOV-REC TO                                                                   150624 
 2792.00                    CONNBR    OF FCONMICRO-REC                                                                        150624 
 2793.00                                                                                                                      150616 
 2794.00               READ FCONMICRO                                                                                         150624 
 2795.00               IF FCONMICRO-STATUS = FOUND-REC                                                                        150624 
 2796.00                  MOVE NAVAMT OF FCONMICRO-REC TO                                                                     150624 
 2797.00                  MPFNDAMT OF MPMDLPNT-REC                                                                            150620 
 2798.00       *SAVE FOR NEW BUSINESS MPNOTINV  FOR MC                                                                        150918 
 2799.00                  MOVE NINVAMT OF FCONMICRO-REC TO                                                                    150918 
 2800.00                  WRK-NPMPNOTINV                                                                                      150918 
 2801.00               END-IF                                                                                                 150620 
 2802.00            END-IF                                                                                                    150620 
 2803.00                                                                                                                      150620 
 2804.00            .                                                                                                         150331 
 2805.00         END-READ-FCONFUND.                                                                                           150624 
 2806.00            EXIT.                                                                                                     150331 
 2807.00                                                                                                                      150521 
 2808.00       *------------------------------------------------------------------------------------------------------------- 150521 
 2809.00         READ-FCONFUNDBA SECTION.                                                                                     150624 
 2810.00       *------------------------------------------------------------------------------------------------------------- 150521 
 2811.00       *            FUNDS                                                150521 
 2812.00       *          UL                                                                       150521 
 2813.00                                                                                                                      150521 
 2814.00            INITIALIZE CONFUNDR  OF FCONFUND-REC                                                                      150624 
 2815.00            INITIALIZE MPFNDAMT  OF MPMDLPNT-REC                                                                      150624 
 2816.00            INITIALIZE MPUNIPRC  OF MPMDLPNT-REC                                                                      150521 
 2817.00            INITIALIZE MPUNINBR  OF MPMDLPNT-REC                                                                      150521 
 2818.00                                                                                                                      150521 
 2819.00            MOVE RUNDT      OF WRK-FCONCOV-REC TO                                                                     150624 
 2820.00                 RUNDT      OF FCONFUND-REC                                                                           150624 
 2821.00            MOVE COMPCOD    OF WRK-FCONCOV-REC TO                                                                     150624 
 2822.00                 COMPCOD    OF FCONFUND-REC                                                                           150624 
 2823.00            MOVE DSBCHACOD  OF WRK-FCONCOV-REC TO                                                                     150624 
 2824.00                 DSBCHACOD  OF FCONFUND-REC                                                                           150624 
 2825.00            MOVE BRCHCOD    OF WRK-FCONCOV-REC TO                                                                     150624 
 2826.00                 BRCHCOD    OF FCONFUND-REC                                                                           150624 
 2827.00            MOVE SYSAPPCOD  OF WRK-FCONCOV-REC TO                                                                     150624 
 2828.00                 SYSAPPCOD  OF FCONFUND-REC                                                                           150624 
 2829.00            MOVE CONNBR     OF WRK-FCONCOV-REC TO                                                                     150624 
 2830.00                 CONNBR     OF FCONFUND-REC                                                                           150624 
 2831.00            MOVE LOW-VALUES TO LIFNO  OF FCONFUND-REC                                                                 150624 
 2832.00                                                                                                                      150521 
 2833.00            START FCONFUND KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150624 
 2834.00            READ  FCONFUND NEXT                                                                                       150624 
 2835.00                                                                                                                      150521 
 2836.00            PERFORM  UNTIL FCONFUND-STATUS NOT = FOUND-REC                                                            150624 
 2837.00            OR RUNDT     OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2838.00               RUNDT     OF FCONFUND-REC                                                                              150624 
 2839.00            OR COMPCOD   OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2840.00               COMPCOD   OF FCONFUND-REC                                                                              150624 
 2841.00            OR DSBCHACOD OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2842.00               DSBCHACOD OF FCONFUND-REC                                                                              150624 
 2843.00            OR BRCHCOD   OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2844.00               BRCHCOD   OF FCONFUND-REC                                                                              150624 
 2845.00            OR SYSAPPCOD OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2846.00               SYSAPPCOD OF FCONFUND-REC                                                                              150624 
 2847.00            OR CONNBR    OF WRK-FCONCOV-REC NOT =                                                                     150624 
 2848.00               CONNBR    OF FCONFUND-REC                                                                              150624 
 2849.00                                                                                                                      150521 
 2850.00               COMPUTE MPFNDAMT   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2851.00                       MPFNDAMT   OF MPMDLPNT-REC +                                                                   150612 
 2852.00                       FUNDUNTVAL OF FCONFUND-REC                                                                     150624 
 2853.00               COMPUTE MPUNINBR   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2854.00                       MPUNINBR   OF MPMDLPNT-REC +                                                                   150612 
 2855.00                       FUNDUNTNBR OF FCONFUND-REC                                                                     150624 
 2856.00               COMPUTE MPUNIPRC   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2857.00                       FUNDUNTPRC OF FCONFUND-REC                                                                     150624 
 2858.00                                                                                                                      150521 
 2859.00               READ  FCONFUND NEXT                                                                                    150624 
 2860.00                                                                                                                      150521 
 2861.00            END-PERFORM                                                                                               150521 
 2862.00                                                                                                                      150521 
 2863.00            .                                                                                                         150521 
 2864.00         END-READ-FCONFUNDBA.                                                                                         150624 
 2865.00            EXIT.                                                                                                     150521 
 2866.00                                                                                                                      150422 
 2867.00                                                                                                                      150430 
 2868.00       *------------------------------------------------------------------------------------------------------------- 150430 
 2869.00         READ-FCONFUNDIS SECTION.                                                                                     150624 
 2870.00       *------------------------------------------------------------------------------------------------------------- 150430 
 2871.00                                                                                                                      150430 
 2872.00            INITIALIZE CONFUNDISR  OF FCONFUNDIS-REC                                                                  150624 
 2873.00                                                                                                                      150430 
 2874.00            MOVE RUNDT     OF WRK-FCONCOV-REC                                                                         150624 
 2875.00              TO RUNDT     OF FCONFUNDIS-REC                                                                          150624 
 2876.00            MOVE COMPCOD   OF WRK-FCONCOV-REC                                                                         150624 
 2877.00              TO COMPCOD   OF FCONFUNDIS-REC                                                                          150624 
 2878.00            MOVE DSBCHACOD OF WRK-FCONCOV-REC                                                                         150624 
 2879.00              TO DSBCHACOD OF FCONFUNDIS-REC                                                                          150624 
 2880.00            MOVE BRCHCOD   OF WRK-FCONCOV-REC                                                                         150624 
 2881.00              TO BRCHCOD   OF FCONFUNDIS-REC                                                                          150624 
 2882.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                         150624 
 2883.00              TO SYSAPPCOD OF FCONFUNDIS-REC                                                                          150624 
 2884.00            MOVE CONNBR    OF WRK-FCONCOV-REC                                                                         150624 
 2885.00              TO CONNBR    OF FCONFUNDIS-REC                                                                          150624 
 2886.00            MOVE LIFNO     OF WRK-FCONCOV-REC                                                                         150624 
 2887.00              TO LIFNO     OF FCONFUNDIS-REC                                                                          150624 
 2888.00            MOVE COVNO     OF WRK-FCONCOV-REC                                                                         150624 
 2889.00              TO COVNO     OF FCONFUNDIS-REC                                                                          150624 
 2890.00            MOVE LOW-VALUES                                                                                           150430 
 2891.00              TO FUNDCOD   OF FCONFUNDIS-REC                                                                          150624 
 2892.00                                                                                                                      150430 
 2893.00            START FCONFUNDIS KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                       150624 
 2894.00            READ  FCONFUNDIS NEXT                                                                                     150624 
 2895.00                                                                                                                      150430 
 2896.00            PERFORM  UNTIL  FCONFUNDIS-STATUS NOT = FOUND-REC                                                         150624 
 2897.00            OR RUNDT     OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2898.00               RUNDT     OF FCONFUNDIS-REC                                                                            150624 
 2899.00            OR COMPCOD   OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2900.00               COMPCOD   OF FCONFUNDIS-REC                                                                            150624 
 2901.00            OR DSBCHACOD OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2902.00               DSBCHACOD OF FCONFUNDIS-REC                                                                            150624 
 2903.00            OR BRCHCOD   OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2904.00               BRCHCOD   OF FCONFUNDIS-REC                                                                            150624 
 2905.00            OR SYSAPPCOD OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2906.00               SYSAPPCOD OF FCONFUNDIS-REC                                                                            150624 
 2907.00            OR CONNBR    OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2908.00               CONNBR    OF FCONFUNDIS-REC                                                                            150624 
 2909.00            OR LIFNO     OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2910.00               LIFNO     OF FCONFUNDIS-REC                                                                            150624 
 2911.00            OR COVNO     OF WRK-FCONCOV-REC  NOT  =                                                                   150624 
 2912.00               COVNO     OF FCONFUNDIS-REC                                                                            150624 
 2913.00                                                                                                                      150430 
 2914.00               COMPUTE MPUNINBR   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2915.00                       FUNDUNTNBR OF FCONFUNDIS-REC                                                                   150624 
 2916.00               COMPUTE MPUNIPRC   OF MPMDLPNT-REC ROUNDED =                                                           150612 
 2917.00                       FUNDUNTPRC OF FCONFUNDIS-REC                                                                   150624 
 2918.00                                                                                                                      150430 
 2919.00               READ  FCONFUNDIS NEXT                                                                                  150624 
 2920.00                                                                                                                      150430 
 2921.00            END-PERFORM                                                                                               150430 
 2922.00                                                                                                                      150430 
 2923.00            .                                                                                                         150430 
 2924.00         END-READ-FCONFUNDIS.                                                                                         150624 
 2925.00            EXIT.                                                                                                     150430 
 2926.00       *------------------------------------------------------------------------------------------------------------- 150401 
 2927.00         CHECK-INFOMPF SECTION.                                                                                       150407 
 2928.00       *------------------------------------------------------------------------------------------------------------- 150401 
 2929.00            MOVE 0      TO MSLICE                                                                                     150515 
 2930.00                                                                                                                      181227 
 2931.00       * save initial cover only for ZAPE.                                                                            181227 
 2932.00            MOVE COVCOD OF FCONCOV-REC   TO WSAA-COV-ZAPE                                                             181227 
 2933.00                                                                                                                      150420 
 2934.00            INITIALIZE MPFILER OF MPFILE-REC                                                                          150401 
 2935.00            MOVE SYSAPPCOD OF FCONCOV-REC TO SYSAPPCOD OF MPFILE-REC                                                  150624 
 2936.00            MOVE COVCOD    OF FCONCOV-REC TO COVCOD    OF MPFILE-REC                                                  150624 
 2937.00                                                                                                                      150407 
 2938.00            READ MPFILE                                                                                               150401 
 2939.00            IF MPFILE-STATUS = FOUND-REC                                                                              150401 
 2940.00               MOVE MLOADING OF MPFILE-REC                                                                            181217 
 2941.00                                         TO WSAA-CALC-LOADING                                                         181217 
 2942.00                                                                                                                      150424 
 2943.00               IF  WRK-FNDBAS             NOT = 1                                                                     150422 
 2944.00               AND FCOVMAIN OF MPFILE-REC NOT = '1'                                                                   150422 
 2945.00       *          FIND MAIN                                                                                           150422 
 2946.00                  PERFORM FIND-MAINCOV                                                                                150422 
 2947.00                                                                                                                      150422 
 2948.00       *          READ AGAIN COVERAGE                                                                                 150422 
 2949.00                  INITIALIZE MPFILER OF MPFILE-REC                                                                    150422 
 2950.00                  MOVE SYSAPPCOD OF FCONCOV-REC TO                                                                    150624 
 2951.00                       SYSAPPCOD OF MPFILE-REC                                                                        150624 
 2952.00                  MOVE COVCOD    OF FCONCOV-REC TO                                                                    150624 
 2953.00                       COVCOD    OF MPFILE-REC                                                                        150624 
 2954.00                  READ MPFILE                                                                                         150422 
 2955.00                                                                                                                      150422 
 2956.00               END-IF                                                                                                 150422 
 2957.00                                                                                                                      150424 
 2958.00               IF  MPCOVCOD OF MPFILE-REC NOT = SPACES                                                                150424 
 2959.00                   MOVE MPCOVCOD OF MPFILE-REC                                                                        150424 
 2960.00                     TO COVCOD   OF FCONCOV-REC                                                                       150624 
 2961.00               END-IF                                                                                                 150424 
 2962.00                                                                                                                      150424 
 2963.00               IF FCOVMAIN OF MPFILE-REC ='1'                                                                         150422 
 2964.00       *          KEEP MAIN                                                                                           150422 
 2965.00                  MOVE FCONCOV-REC TO WRK-BASFCOV-REC                                                                 150624 
 2966.00                  MOVE FCONLIF-REC TO WRK-BASFCONLIF-REC                                                              150624 
 2967.00                  MOVE 1          TO WRK-FILFROMBASCOV                                                                150422 
 2968.00                  MOVE 1          TO WRK-FNDBAS                                                                       150422 
 2969.00                  MOVE LOANOUTAMT OF FCONTRACT-REC                                                                    150624 
 2970.00                    TO MPLOANAMT  OF MPMDLPNT-REC                                                                     150610 
 2971.00                  MOVE DIVAMT     OF FCONCOV-REC                                                                      150624 
 2972.00                    TO MPDIVAMT   OF MPMDLPNT-REC                                                                     150516 
 2973.00               END-IF                                                                                                 150422 
 2974.00                                                                                                                      150422 
 2975.00               IF FCOVSLC OF MPFILE-REC ='1'                                                                          150422 
 2976.00                  MOVE 1 TO MSLICE                                                                                    150423 
 2977.00               END-IF                                                                                                 150422 
 2978.00                                                                                                                      150407 
 2979.00       *        RIDER KAI B                                                                                  150422 
 2980.00               IF COVTYPCOD OF MPFILE-REC = 'R'                                                                       150422 
 2981.00                  MOVE COVCOD     OF FCONCOV-REC                                                                      150624 
 2982.00                    TO MPRIDCOD   OF MPMDLPNT-REC                                                                     150422 
 2983.00                  IF  PRDCATCOD OF WRK-BASFCOV-REC NOT = 'H'                                                          150624 
 2984.00                  AND PRDCATCOD OF   FCONTRACT-REC NOT = 'H'                                                          150624 
 2985.00       **         AND PRDCATCOD OF WRK-BASFCOV-REC NOT = 'U'                                                          150627 
 2986.00                  AND COVCOD    OF WRK-BASFCOV-REC NOT = '00086'                                                      150624 
 2987.00                  AND COVCOD    OF WRK-BASFCOV-REC NOT = '00186'                                                      150624 
 2988.00                     MOVE COVCOD     OF WRK-BASFCOV-REC                                                               150624 
 2989.00                       TO MPRMAINCOD   OF MPMDLPNT-REC                                                                150504 
 2990.00                  END-IF                                                                                              150504 
 2991.00               END-IF                                                                                                 150504 
 2992.00                                                                                                                      150512 
 2993.00       *        UL or MCPPI                                                                                         150627 
 2994.00               IF COVTYPCOD OF MPFILE-REC = 'U'                                                                       150422 
 2995.00               OR COVTYPCOD OF MPFILE-REC = 'M'                                                                       150620 
 2996.00                                                                                                                      150627 
 2997.00                  MOVE COVCOD  OF FCONCOV-REC                                                                         150624 
 2998.00                    TO MPULCOD OF MPMDLPNT-REC                                                                        150422 
 2999.00                                                                                                                      150627 
 3000.00       *          For Specific Campain 091-095                                                                        150627 
 3001.00                  IF SYSAPPCOD OF FCONCOV-REC ='01'                                                                   150624 
 3002.00                     PERFORM FIND-UL                                                                                  150422 
 3003.00                  END-IF                                                                                              150422 
 3004.00                                                                                                                      150627 
 3005.00       *          IF WOP exists then PH or LA on MPRidCod                                                             150627 
 3006.00                  IF COVTYPCOD OF MPFILE-REC = 'M'                                                                    150627 
 3007.00                     PERFORM FIND-WOPMCPPI                                                                            150627 
 3008.00                  END-IF                                                                                              150627 
 3009.00                                                                                                                      170921 
 3010.00       *          15/09/2017 for UR01 to take ADL1,ADP1                                                               170921 
 3011.00                  IF COVTYPCOD OF MPFILE-REC      = 'U'                                                               180515 
 3012.00                  AND COVCOD OF FCONCOV-REC(1:2)  = 'UR'                                                              180515 
 3013.00                     PERFORM FIND-WOPMCPPI                                                                            170921 
 3014.00                  END-IF                                                                                              170921 
 3015.00                                                                                                                      150627 
 3016.00               END-IF                                                                                                 150627 
 3017.00                                                                                                                      150407 
 3018.00               IF  COVTYPCOD OF MPFILE-REC = 'L'                                                                      150422 
 3019.00                   MOVE COVCOD    OF FCONCOV-REC                                                                      150624 
 3020.00                     TO MPMAINCOD OF MPMDLPNT-REC                                                                     150422 
 3021.00               END-IF                                                                                                 150422 
 3022.00       * Keep the main code of Nelis , it 's needed for the new                                                       161128 
 3023.00       * calculation of MPCOVTRM,MPEXTTRM                                                                             161128 
 3024.00       * Fcovmain field of mpfile is the basic for Nelis the others                                                   161207 
 3025.00       * are like riders for Nelis                                                                                    161207 
 3026.00               IF  COVTYPCOD OF MPFILE-REC = 'L'                                                                      161121 
 3027.00               AND FCOVMAIN  OF MPFILE-REC = '1'                                                                      161207 
 3028.00               AND SYSAPPCOD OF FCONCOV-REC                                                                           161121 
 3029.00                                           =  '02'                                                                    161121 
 3030.00                   MOVE COVCOD    OF FCONCOV-REC                                                                      161121 
 3031.00                     TO WRK-MPMAINCOD                                                                                 161121 
 3032.00               END-IF                                                                                                 161121 
 3033.00                                                                                                                      150513 
 3034.00               IF MPFILFLD OF MPFILE-REC NOT = SPACES                                                                 150513 
 3035.00                  MOVE MPFILFLD OF MPFILE-REC TO MPFILFLD OF MPMDLPNT-REC                                             150513 
 3036.00               END-IF                                                                                                 150513 
 3037.00                                                                                                                      150513 
 3038.00            ELSE                                                                                                      150513 
 3039.00               MOVE 'Un_modelled' TO MPFILFLD OF MPMDLPNT-REC                                                         150513 
 3040.00            END-IF                                                                                                    150420 
 3041.00       *Change 21/08/2017 they decided the Gold Staff to be included.                                                 170821 
 3042.00       * 23/06/2017                                                                                                   170623 
 3043.00       * Change for Gold Staff only for campaign '003' and client origin ='11'                                        170623 
 3044.00       * to be deleted when analogistes decide the rules.                                                             170623 
 3045.00       *    IF  SYSAPPCOD  OF FCONCOV-REC  =  '03'                                                                    170821 
 3046.00       *    AND CAMPCOD    OF FCONCOV-REC  =  '003'                                                                   170821 
 3047.00       *    AND CLNTORGCOD OF FCONCOV-REC  =  '11'                                                                    170821 
 3048.00       *        MOVE 'Un_modelled' TO MPFILFLD OF MPMDLPNT-REC                                                        170821 
 3049.00       *    END-IF                                                                                                    170821 
 3050.00       * 23/06/2017                                                                                                   170623 
 3051.00            .                                                                                                         150401 
 3052.00         END-CHECK-INFOMPF.                                                                                           150407 
 3053.00            EXIT.                                                                                                     150401 
 3054.00       *------------------------------------------------------------------------------------------------------------- 150402 
 3055.00         FIND-UL  SECTION.                                                                                            150402 
 3056.00       *------------------------------------------------------------------------------------------------------------- 150402 
 3057.00             IF  COVCOD  OF FCONCOV-REC = 'SP01'                                                                      150624 
 3058.00             AND CAMPCOD OF FCONCOV-REC = '091'                                                                       150624 
 3059.00                 MOVE 'SP01091' TO MPULCOD OF MPMDLPNT-REC                                                            150422 
 3060.00             END-IF                                                                                                   150402 
 3061.00                                                                                                                      150402 
 3062.00             IF  COVCOD  OF FCONCOV-REC = 'SP01'                                                                      150624 
 3063.00             AND CAMPCOD OF FCONCOV-REC = '095'                                                                       150624 
 3064.00                 MOVE 'SP01095' TO MPULCOD OF MPMDLPNT-REC                                                            150422 
 3065.00             END-IF                                                                                                   150402 
 3066.00                                                                                                                      150402 
 3067.00            .                                                                                                         150402 
 3068.00         END-FIND-UL.                                                                                                 150402 
 3069.00            EXIT.                                                                                                     150402 
 3070.00       *------------------------------------------------------------------------------------------------------------- 150403 
 3071.00         FIND-AAHR  SECTION.                                                                                          150403 
 3072.00       *------------------------------------------------------------------------------------------------------------- 150403 
 3073.00            INITIALIZE MPROOMR OF MPROOM-REC                                                                          150418 
 3074.00                                                                                                                      150405 
 3075.00            MOVE ROOMCOD OF WRK-FCONCOV-REC TO ROOMCOD OF MPROOM-REC                                                  150624 
 3076.00            IF ROOMCOD OF WRK-FCONCOV-REC NOT = ' '                                                                   150624 
 3077.00               READ MPROOM                                                                                            150423 
 3078.00               IF MPROOM-STATUS = FOUND-REC                                                                           150423 
 3079.00                  MOVE MPAAHROOM  OF MPROOM-REC                                                                       150423 
 3080.00                    TO MPAAHROOM  OF MPMDLPNT-REC                                                                     150423 
 3081.00               END-IF                                                                                                 150423 
 3082.00            ELSE                                                                                                      150421 
 3083.00               MOVE 1 TO MPAAHROOM OF MPMDLPNT-REC                                                                    150423 
 3084.00               IF SYSAPPCOD OF WRK-FCONCOV-REC      = '03'                                                            150624 
 3085.00                  MOVE 3 TO MPAAHROOM OF MPMDLPNT-REC                                                                 150515 
 3086.00               END-IF                                                                                                 150515 
 3087.00                                                                                                                      150515 
 3088.00            END-IF                                                                                                    150417 
 3089.00                                                                                                                      150510 
 3090.00              IF SYSAPPCOD OF WRK-FCONCOV-REC      = '03'                                                             150624 
 3091.00       *17/6/2015                                                                                                     150617 
 3092.00       *         IF COVCOD OF WRK-FCONCOV-REC(1:3) ='05/'                                                             150624 
 3093.00       *            MOVE 3 TO MPAAHROOM OF MPMDLPNT-REC                                                               150617 
 3094.00       *         END-IF                                                                                               150617 
 3095.00                 IF COVCOD OF WRK-FCONCOV-REC(1:3) ='05/'                                                             150624 
 3096.00                 IF ROOMCOD OF WRK-FCONCOV-REC = 'S'                                                                  150624 
 3097.00                    MOVE 4 TO MPAAHROOM OF MPMDLPNT-REC                                                               150516 
 3098.00                 END-IF                                                                                               150516 
 3099.00              END-IF                                                                                                  150510 
 3100.00            .                                                                                                         150403 
 3101.00         END-FIND-AAHR.                                                                                               150403 
 3102.00            EXIT.                                                                                                     150403 
 3103.00       *------------------------------------------------------------------------------------------------------------- 150402 
 3104.00         CALC-MONTHSINF SECTION.                                                                                      150509 
 3105.00       *------------------------------------------------------------------------------------------------------------- 150402 
 3106.00            COMPUTE WMINF = (WRK-RUNY - MPINCPYEAR OF MPMDLPNT-REC) * 12                                              150429 
 3107.00                            +                                                                                         150429 
 3108.00                            (WRK-RUNM - MPINCPMON  OF MPMDLPNT-REC) + 1                                               150429 
 3109.00                                                                                                                      150429 
 3110.00            IF WMINF < 1                                                                                              150430 
 3111.00               MOVE 1     TO MPMONIF OF MPMDLPNT-REC                                                                  150430 
 3112.00            ELSE                                                                                                      150430 
 3113.00               MOVE WMINF TO MPMONIF OF MPMDLPNT-REC                                                                  150430 
 3114.00            END-IF                                                                                                    150403 
 3115.00            .                                                                                                         150402 
 3116.00         END-CALC-MONTHSINF.                                                                                          150509 
 3117.00            EXIT.                                                                                                     150402 
 3118.00                                                                                                                      150509 
 3119.00       *------------------------------------------------------------------------------------------------------------- 150509 
 3120.00         CALC-TERMFLDS SECTION.                                                                                       150509 
 3121.00       *------------------------------------------------------------------------------------------------------------- 150509 
 3122.00                                                                                                                      150509 
 3123.00       *    LIFE400                                                                                                   150509 
 3124.00            IF  SYSAPPCOD OF FCONTRACT-REC   = '01'                                                                   150624 
 3125.00                                                                                                                      150509 
 3126.00              IF  COVCOD    OF WRK-FCONCOV-REC = 'SPDA'                                                               150624 
 3127.00                                                                                                                      150509 
 3128.00                  MOVE DEFANYTRM  OF FCONTRACT-REC                                                                    150624 
 3129.00                    TO MPCOVTRM   OF MPMDLPNT-REC                                                                     150509 
 3130.00                                                                                                                      150509 
 3131.00                  MOVE ANYTRM     OF WRK-FCONCOV-REC                                                                  150624 
 3132.00                    TO MPEXTTRM   OF MPMDLPNT-REC                                                                     150509 
 3133.00                                                                                                                      150509 
 3134.00                  COMPUTE MPMAINTRM OF MPMDLPNT-REC  =                                                                150509 
 3135.00                          MPCOVTRM  OF MPMDLPNT-REC  +                                                                150509 
 3136.00                          MPEXTTRM  OF MPMDLPNT-REC                                                                   150509 
 3137.00                                                                                                                      150509 
 3138.00                  IF MPMAINTRM OF MPMDLPNT-REC  > 120                                                                 150509 
 3139.00                     MOVE 120 TO MPMAINTRM OF MPMDLPNT-REC                                                            150509 
 3140.00                  END-IF                                                                                              150509 
 3141.00                                                                                                                      150509 
 3142.00              END-IF                                                                                                  150509 
 3143.00                                                                                                                      150509 
 3144.00              IF COVCOD OF WRK-FCONCOV-REC NOT = 'SPDA'                                                               150624 
 3145.00       *         IF  RSKCESSTRM OF WRK-FCONCOV-REC NOT = 0                                                            150624 
 3146.00       *         AND RSKCESSTRM OF WRK-FCONCOV-REC NOT = 99                                                           150624 
 3147.00       *             MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                               150624 
 3148.00       *               TO MPCOVTRM   OF MPMDLPNT-REC                                                                  150509 
 3149.00       *         ELSE                                                                                                 150509 
 3150.00                     COMPUTE MPCOVTRM   OF MPMDLPNT-REC   =                                                           150509 
 3151.00                             RSKCESSAGE OF WRK-FCONCOV-REC -                                                          150624 
 3152.00                             RSKCOMMAGE OF WRK-FCONCOV-REC                                                            150624 
 3153.00       *         END-IF                                                                                               150509 
 3154.00                                                                                                                      150509 
 3155.00                 IF  RSKCESSTRM OF WRK-BASFCOV-REC NOT = 0                                                            150624 
 3156.00                 AND RSKCESSTRM OF WRK-BASFCOV-REC NOT = 99                                                           150624 
 3157.00                    MOVE RSKCESSTRM OF WRK-BASFCOV-REC                                                                150624 
 3158.00                      TO MPMAINTRM  OF MPMDLPNT-REC                                                                   150509 
 3159.00                 ELSE                                                                                                 150509 
 3160.00                      COMPUTE MPMAINTRM  OF MPMDLPNT-REC   =                                                          150509 
 3161.00                              RSKCESSAGE OF WRK-BASFCOV-REC -                                                         150624 
 3162.00                              RSKCOMMAGE OF WRK-BASFCOV-REC                                                           150624 
 3163.00                 END-IF                                                                                               150509 
 3164.00                                                                                                                      150509 
 3165.00                 MOVE 0                                                                                               150509 
 3166.00                   TO MPEXTTRM   OF MPMDLPNT-REC                                                                      150509 
 3167.00                                                                                                                      150509 
 3168.00              END-IF                                                                                                  150509 
 3169.00                                                                                                                      150509 
 3170.00              IF COVCOD OF WRK-FCONCOV-REC(1:2) = 'HR'                                                                150627 
 3171.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'ORP'                                                               150627 
 3172.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'HCM'                                                               151218 
 3173.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'HOM'                                                               151218 
 3174.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'HOE'                                                               170425 
 3175.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'OFC'                                                               161104 
 3176.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'OFS'                                                               170913 
 3177.00              OR COVCOD OF WRK-FCONCOV-REC(1:3) = 'OVT'                                                               170809 
 3178.00                  COMPUTE MPCOVTRM   OF MPMDLPNT-REC   =                                                              150509 
 3179.00                          106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                         150624 
 3180.00                  MOVE 0  TO MPMAINTRM  OF MPMDLPNT-REC                                                               150509 
 3181.00                                                                                                                      150509 
 3182.00              END-IF                                                                                                  150509 
 3183.00                                                                                                                      150509 
 3184.00              COMPUTE MPPRMTRM   OF MPMDLPNT-REC   =                                                                  150509 
 3185.00                      MPCOVTRM   OF MPMDLPNT-REC                                                                      150509 
 3186.00                                                                                                                      150509 
 3187.00            END-IF                                                                                                    150509 
 3188.00                                                                                                                      150509 
 3189.00       *    NELIS                                                                                                     150509 
 3190.00       *    --------                                                                                                  150509 
 3191.00            IF SYSAPPCOD OF FCONTRACT-REC = '02'                                                                      150624 
 3192.00                                                                                                                      150510 
 3193.00       *       MPMAINTRM                                                                                150510 
 3194.00       *       -------------------------                                                                              150510 
 3195.00               IF  COVCOD     OF WRK-FCONCOV-REC(1:2) = '00'                                                          150624 
 3196.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00026'                                                       150624 
 3197.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00076'                                                       150624 
 3198.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00176'                                                       150624 
 3199.00               AND RSKCESSDT  OF WRK-BASFCOV-REC = 99999999                                                           150624 
 3200.00                   IF FND-MSLICE = 0                                                                                  150510 
 3201.00                      COMPUTE MPMAINTRM OF MPMDLPNT-REC =                                                             150510 
 3202.00                              106 - RSKCOMMAGE OF WRK-BASFCOV-REC                                                     150624 
 3203.00                   ELSE                                                                                               150510 
 3204.00                      COMPUTE MPMAINTRM OF MPMDLPNT-REC =                                                             150510 
 3205.00                              106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                     150624 
 3206.00                   END-IF                                                                                             150510 
 3207.00               END-IF                                                                                                 150510 
 3208.00                                                                                                                      150510 
 3209.00       *       MPMAINTRM                                                                             150510 
 3210.00       *       -----------------------------                                                                          150510 
 3211.00               IF  COVCOD     OF WRK-FCONCOV-REC(1:2) = '00'                                                          150624 
 3212.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00026'                                                       150624 
 3213.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00076'                                                       150624 
 3214.00               AND COVCOD     OF WRK-FCONCOV-REC  NOT = '00176'                                                       150624 
 3215.00               AND RSKCESSDT  OF WRK-FCONCOV-REC  NOT = 99999999                                                      150624 
 3216.00                   IF FND-MSLICE = 0                                                                                  150510 
 3217.00                      MOVE RSKCESSTRM OF WRK-BASFCOV-REC                                                              150624 
 3218.00                        TO MPMAINTRM  OF MPMDLPNT-REC                                                                 150510 
 3219.00                   ELSE                                                                                               150510 
 3220.00                      MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                              150624 
 3221.00                        TO MPMAINTRM  OF MPMDLPNT-REC                                                                 150510 
 3222.00                   END-IF                                                                                             150510 
 3223.00               END-IF                                                                                                 150510 
 3224.00                                                                                                                      150510 
 3225.00       *       MPMAINTRM                                                                             150510 
 3226.00       *       ----------------------------                                                                           150510 
 3227.00               IF COVCOD OF WRK-FCONCOV-REC(1:2) NOT = '00'                                                           150624 
 3228.00               OR COVCOD OF WRK-FCONCOV-REC          = '00026'                                                        150624 
 3229.00               OR COVCOD OF WRK-FCONCOV-REC          = '00076'                                                        150624 
 3230.00               OR COVCOD OF WRK-FCONCOV-REC          = '00176'                                                        150624 
 3231.00                  IF RSKCESSDT OF WRK-BASFCOV-REC = 99999999                                                          150624 
 3232.00                     COMPUTE MPMAINTRM OF MPMDLPNT-REC =                                                              150510 
 3233.00                             106 - RSKCOMMAGE OF WRK-BASFCOV-REC                                                      150624 
 3234.00                  ELSE                                                                                                150510 
 3235.00                     MOVE RSKCESSTRM OF WRK-BASFCOV-REC                                                               150624 
 3236.00                       TO MPMAINTRM  OF MPMDLPNT-REC                                                                  150510 
 3237.00                  END-IF                                                                                              150510 
 3238.00               END-IF                                                                                                 150510 
 3239.00                                                                                                                      150509 
 3240.00                                                                                                                      150510 
 3241.00       *       MPCOVTRM                                                                                               150510 
 3242.00       *       --------                                                                                               150510 
 3243.00                                                                                                                      150515 
 3244.00               EVALUATE TRUE                                                                                          150515 
 3245.00                 WHEN COVCOD  OF WRK-FCONCOV-REC(1:2) = '11'                                                          150624 
 3246.00                  AND COVCOD  OF WRK-FCONCOV-REC(3:3) = '011'                                                         150624 
 3247.00                  AND CAMPCOD OF WRK-FCONCOV-REC      = 'A1'                                                          150624 
 3248.00                      MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150624 
 3249.00                 WHEN COVCOD  OF WRK-FCONCOV-REC(1:2) = '11'                                                          150624 
 3250.00                  AND COVCOD  OF WRK-FCONCOV-REC(3:3) = '012'                                                         150624 
 3251.00                  AND CAMPCOD OF WRK-FCONCOV-REC      = 'A1'                                                          150624 
 3252.00                      MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150624 
 3253.00                 WHEN COVCOD  OF WRK-FCONCOV-REC(1:2)  = '11'                                                         150624 
 3254.00                  AND COVCOD  OF WRK-FCONCOV-REC(3:3) >= '301'                                                        150624 
 3255.00                  AND COVCOD  OF WRK-FCONCOV-REC(3:3) <= '997'                                                        150624 
 3256.00                      MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150624 
 3257.00                 WHEN COVCOD  OF WRK-FCONCOV-REC(1:2)  = '11'                                                         150624 
 3258.00                  AND (COVCOD  OF WRK-FCONCOV-REC(3:3) = '132' OR                                                     150624 
 3259.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '133' OR                                                     150624 
 3260.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '134' OR                                                     150624 
 3261.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '135' OR                                                     150624 
 3262.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '232' OR                                                     150624 
 3263.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '233' OR                                                     150624 
 3264.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '234' OR                                                     150624 
 3265.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '235' OR                                                     160603 
 3266.00                       COVCOD  OF WRK-FCONCOV-REC(3:3) = '236'   )                                                    160603 
 3267.00                      MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150624 
 3268.00                 WHEN OTHER                                                                                           150515 
 3269.00                      MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150627 
 3270.00       *              MOVE PRCAGE     OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                150627 
 3271.00               END-EVALUATE                                                                                           150515 
 3272.00                                                                                                                      150627 
 3273.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRK-PRCAGE                                                       150627 
 3274.00                                                                                                                      150516 
 3275.00               COMPUTE WRK-RSKCESSBAS             =                                                                   150516 
 3276.00       ****            MPISSYEAR  OF MPMDLPNT-REC +                                                                   161118 
 3277.00                       WRKISSY                    +                                                                   161118 
 3278.00                       MPMAINTRM  OF MPMDLPNT-REC                                                                     150516 
 3279.00                                                                                                                      150603 
 3280.00               COMPUTE WRK-RSKCESSCOV             =                                                                   150603 
 3281.00                       MPINCPYEAR OF MPMDLPNT-REC +                                                                   150603 
 3282.00                       (106 - MPAGEENTR OF MPMDLPNT-REC)                                                              150603 
 3283.00                                                                                                                      150603 
 3284.00               EVALUATE TRUE                                                                                          150509 
 3285.00                                                                                                                      150509 
 3286.00       *                                                                                                        150603 
 3287.00       *       ------                                                                                                 150603 
 3288.00               WHEN COVCOD     OF WRK-FCONCOV-REC(1:2) = '00'                                                         150624 
 3289.00                AND RSKCESSDT  OF WRK-FCONCOV-REC = 99999999                                                          150624 
 3290.00                    COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                                150516 
 3291.00                            106 - MPAGEENTR  OF MPMDLPNT-REC                                                          150516 
 3292.00                                                                                                                      150509 
 3293.00       *       UNIT LINKED                                                                                            150603 
 3294.00       *       -----------                                                                                            150603 
 3295.00               WHEN COVCOD     OF WRK-FCONCOV-REC(1:2) = '12'                                                         150624 
 3296.00                    COMPUTE MPCOVTRM   OF MPMDLPNT-REC =                                                              150509 
 3297.00                            RSKCESSTRM OF FCONTRACT-REC                                                               150624 
 3298.00                                                                                                                      150603 
 3299.00       *                                                                                                     150628 
 3300.00       *       -----------                                                                                            150628 
 3301.00               WHEN COVCOD     OF WRK-FCONCOV-REC(1:2) = '00'                                                         150628 
 3302.00                AND RSKCESSDT  OF WRK-FCONCOV-REC  NOT = 99999999                                                     150628 
 3303.00                    COMPUTE MPCOVTRM   OF MPMDLPNT-REC =                                                              150603 
 3304.00                            RSKCESSTRM OF WRK-FCONCOV-REC                                                             150624 
 3305.00                                                                                                                      150509 
 3306.00       *       RIDER ME                                                                                         150603 
 3307.00       *       ---------------                                                                                        150603 
 3308.00               WHEN (COVCOD  OF WRK-FCONCOV-REC(1:2) NOT = '00' OR '12')                                              150624 
 3309.00                AND RSKCESSDT OF WRK-BASFCOV-REC = 99999999                                                           150624 
 3310.00                                                                                                                      150603 
 3311.00                    EVALUATE TRUE                                                                                     150603 
 3312.00                                                                                                                      150603 
 3313.00       *               397-398-399                                                                    150628 
 3314.00       *            4/11/2016   11393,11394,11395,11396,11397,11398,11399                                 161121 
 3315.00       *            ------------------------------                                                                    150628 
 3316.00                    WHEN ((COVCOD OF WRK-FCONCOV-REC = '11011' OR                                                     150624 
 3317.00                           COVCOD OF WRK-FCONCOV-REC = '11012'   ) AND                                                150624 
 3318.00                          CAMPCOD OF WRK-FCONCOV-REC = 'A1'           )                                               150624 
 3319.00                      OR COVCOD OF WRK-FCONCOV-REC = '11393'                                                          161104 
 3320.00                      OR COVCOD OF WRK-FCONCOV-REC = '11394'                                                          161104 
 3321.00                      OR COVCOD OF WRK-FCONCOV-REC = '11395'                                                          161104 
 3322.00                      OR COVCOD OF WRK-FCONCOV-REC = '11396'                                                          161104 
 3323.00                      OR COVCOD OF WRK-FCONCOV-REC = '11397'                                                          150628 
 3324.00                      OR COVCOD OF WRK-FCONCOV-REC = '11398'                                                          150628 
 3325.00                      OR COVCOD OF WRK-FCONCOV-REC = '11399'                                                          150624 
 3326.00                                                                                                                      150603 
 3327.00       *                                                                                               150628 
 3328.00                       IF (RELTCOD OF FCONLIF-REC = '  ' OR 'WI' OR 'HU')                                             150628 
 3329.00                                                                                                                      150628 
 3330.00       *                      >=    106                                                    150628 
 3331.00                           IF WRK-RSKCESSBAS >= WRK-RSKCESSCOV                                                        150603 
 3332.00                              COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                      150603 
 3333.00                                      106 - MPAGEENTR OF MPMDLPNT-REC                                                 150603 
 3334.00                                                                                                                      150628 
 3335.00                           ELSE                                                                                       150603 
 3336.00                               COMPUTE MPCOVTRM   OF MPMDLPNT-REC =                                                   150603 
 3337.00                                       MPMAINTRM  OF MPMDLPNT-REC -                                                   150603 
 3338.00                                       MPINCPYEAR OF MPMDLPNT-REC +                                                   150603 
 3339.00       ****                            MPISSYEAR  OF MPMDLPNT-REC                                                     161118 
 3340.00                                       WRKISSY                                                                        161206 
 3341.00                           END-IF                                                                                     150603 
 3342.00                                                                                                                      150628 
 3343.00                       ELSE                                                                                           150628 
 3344.00                           IF RSKCESSDT OF WRK-FCONCOV-REC = 99999999                                                 150628 
 3345.00                              COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                      150628 
 3346.00                                      25 - WRK-PRCAGE                                                                 150628 
 3347.00                           ELSE                                                                                       150628 
 3348.00                             PERFORM CALC-DURFROMDATES                                                                150628 
 3349.00                           END-IF                                                                                     150628 
 3350.00                       END-IF                                                                                         150628 
 3351.00                                                                                                                      150603 
 3352.00                                                                                                                      150603 
 3353.00       *             OXI   397-398-399                                                                150628 
 3354.00       *                                                                                    150628 
 3355.00       *            ----------------------------------                                                                150628 
 3356.00                    WHEN RSKCESSDT OF WRK-FCONCOV-REC = 99999999                                                      150628 
 3357.00                                                                                                                      150603 
 3358.00       *                                                                                          150628 
 3359.00       *               (+.-.RIDER)                                                                   150628 
 3360.00                       IF RELTCOD OF FCONLIF-REC = '  '                                                               150628 
 3361.00                          COMPUTE MPCOVTRM   OF MPMDLPNT-REC     =                                                    150628 
 3362.00                                  MPMAINTRM  OF MPMDLPNT-REC     +                                                    150628 
 3363.00                                  RSKCOMMAGE OF WRK-BASFCOV-REC  -                                                    150628 
 3364.00                                  WRK-PRCAGE                                                                          150628 
 3365.00                       END-IF                                                                                         150628 
 3366.00                                                                                                                      150603 
 3367.00       *                                                                                                       150628 
 3368.00       *               MIN(, +.-.RIDER-+)                                          150628 
 3369.00                       IF RELTCOD OF FCONLIF-REC = 'WI' OR 'HU'                                                       150624 
 3370.00                          IF MPMAINTRM  OF MPMDLPNT-REC     +                                                         150603 
 3371.00                             RSKCOMMAGE OF WRK-BASFCOV-REC  -                                                         150628 
 3372.00                             WRK-PRCAGE                     -                                                         150603 
 3373.00                             MPINCPYEAR OF MPMDLPNT-REC     +                                                         150603 
 3374.00       ****                  MPISSYEAR  OF MPMDLPNT-REC                                                               161118 
 3375.00                             WRKISSY                                                                                  161118 
 3376.00                             <                                                                                        150603 
 3377.00                             MPMAINTRM  OF MPMDLPNT-REC                                                               150603 
 3378.00                             COMPUTE MPCOVTRM   OF MPMDLPNT-REC     =                                                 150603 
 3379.00                                     MPMAINTRM  OF MPMDLPNT-REC     +                                                 150603 
 3380.00                                     RSKCOMMAGE OF WRK-BASFCOV-REC  -                                                 150628 
 3381.00                                     WRK-PRCAGE                     -                                                 150603 
 3382.00                                     MPINCPYEAR OF MPMDLPNT-REC     +                                                 150603 
 3383.00       ****                          MPISSYEAR  OF MPMDLPNT-REC                                                       161118 
 3384.00                                     WRKISSY                                                                          161118 
 3385.00                          ELSE                                                                                        150603 
 3386.00                             COMPUTE MPCOVTRM   OF MPMDLPNT-REC     =                                                 150603 
 3387.00                                     MPMAINTRM  OF MPMDLPNT-REC                                                       150603 
 3388.00                          END-IF                                                                                      150603 
 3389.00                       END-IF                                                                                         150603 
 3390.00                                                                                                                      150628 
 3391.00       *                                                                                                  150628 
 3392.00       *               (25 - .RIDER)                                                                                150628 
 3393.00                       IF  RELTCOD OF FCONLIF-REC NOT = '  '                                                          150628 
 3394.00                       AND RELTCOD OF FCONLIF-REC NOT = 'WI'                                                          150628 
 3395.00                       AND RELTCOD OF FCONLIF-REC NOT = 'HU'                                                          150628 
 3396.00                           COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                         150628 
 3397.00                                   25 - WRK-PRCAGE                                                                    150628 
 3398.00                       END-IF                                                                                         150628 
 3399.00                                                                                                                      150603 
 3400.00       *                                                                                 150603 
 3401.00       *            ----------------------------------                                                                150603 
 3402.00                    WHEN RSKCESSDT OF WRK-FCONCOV-REC NOT = 99999999                                                  150624 
 3403.00                       MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                             150628 
 3404.00                         TO MPCOVTRM   OF MPMDLPNT-REC                                                                150628 
 3405.00                                                                                                                      150628 
 3406.00                       IF (RELTCOD OF FCONLIF-REC = 'SO' OR 'DA' OR 'AD')                                             150624 
 3407.00       *               AND (COVCOD OF WRK-FCONCOV-REC = '11135' OR                                                    150628 
 3408.00       *                    COVCOD OF WRK-FCONCOV-REC = '11235'   )                                                   150628 
 3409.00                           PERFORM CALC-DURFROMDATES                                                                  150628 
 3410.00                       END-IF                                                                                         150624 
 3411.00                    END-EVALUATE                                                                                      150603 
 3412.00                                                                                                                      150509 
 3413.00       *       RIDER ME                                                                                      150628 
 3414.00       *       -------------------                                                                                    150628 
 3415.00               WHEN (COVCOD  OF WRK-FCONCOV-REC(1:2) NOT = '00' OR '12')                                              150628 
 3416.00                AND RSKCESSDT OF WRK-BASFCOV-REC NOT = 99999999                                                       150628 
 3417.00                    IF RSKCESSTRM OF WRK-FCONCOV-REC NOT = 0                                                          150624 
 3418.00                                                                                                                      150628 
 3419.00                       IF (RELTCOD OF FCONLIF-REC = 'SO' OR 'DA' OR 'AD')                                             150628 
 3420.00                                                                                                                      150628 
 3421.00                       OR ( ((COVCOD OF WRK-FCONCOV-REC = '11011' OR                                                  150628 
 3422.00                             COVCOD OF WRK-FCONCOV-REC = '11012'   ) AND                                              150628 
 3423.00                             CAMPCOD OF WRK-FCONCOV-REC = 'A1'          )                                             150628 
 3424.00                           OR COVCOD OF WRK-FCONCOV-REC = '11393'                                                     161104 
 3425.00                           OR COVCOD OF WRK-FCONCOV-REC = '11394'                                                     161104 
 3426.00                           OR COVCOD OF WRK-FCONCOV-REC = '11395'                                                     161104 
 3427.00                           OR COVCOD OF WRK-FCONCOV-REC = '11396'                                                     161104 
 3428.00                           OR COVCOD OF WRK-FCONCOV-REC = '11397'                                                     150628 
 3429.00                           OR COVCOD OF WRK-FCONCOV-REC = '11398'                                                     150628 
 3430.00                           OR COVCOD OF WRK-FCONCOV-REC = '11399'       )                                             150628 
 3431.00                           PERFORM CALC-DURFROMDATES                                                                  150628 
 3432.00                       ELSE                                                                                           150628 
 3433.00                          MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                          150628 
 3434.00                            TO MPCOVTRM   OF MPMDLPNT-REC                                                             150628 
 3435.00                       END-IF                                                                                         150628 
 3436.00                    ELSE                                                                                              150509 
 3437.00                       IF  RSKCOMMAGE OF WRK-FCONCOV-REC NOT = 0                                                      150624 
 3438.00                           COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                         150509 
 3439.00                                   106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                150624 
 3440.00                       ELSE                                                                                           150509 
 3441.00                           COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                         150509 
 3442.00                                   106 - MPAGEENTR  OF MPMDLPNT-REC                                                   150509 
 3443.00                        END-IF                                                                                        150509 
 3444.00                    END-IF                                                                                            150509 
 3445.00                                                                                                                      150628 
 3446.00               WHEN OTHER                                                                                             150628 
 3447.00                    IF RSKCESSTRM OF WRK-FCONCOV-REC NOT = 0                                                          150628 
 3448.00                          MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                          150628 
 3449.00                            TO MPCOVTRM   OF MPMDLPNT-REC                                                             150628 
 3450.00                    ELSE                                                                                              150628 
 3451.00                       IF  RSKCOMMAGE OF WRK-FCONCOV-REC NOT = 0                                                      150628 
 3452.00                           COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                         150628 
 3453.00                                   106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                150628 
 3454.00                       ELSE                                                                                           150628 
 3455.00                           COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                         150628 
 3456.00                                   106 - MPAGEENTR  OF MPMDLPNT-REC                                                   150628 
 3457.00                        END-IF                                                                                        150628 
 3458.00                    END-IF                                                                                            150628 
 3459.00                                                                                                                      150509 
 3460.00               END-EVALUATE                                                                                           150509 
 3461.00                                                                                                                      150603 
 3462.00               IF  MPCOVTRM OF MPMDLPNT-REC > 120                                                                     150509 
 3463.00                   MOVE 120 TO MPCOVTRM OF MPMDLPNT-REC                                                               150509 
 3464.00               END-IF                                                                                                 150509 
 3465.00                                                                                                                      150509 
 3466.00       *      MPPRMTERM - MPEXTTRM                                                                                    150516 
 3467.00       *      --------------------                                                                                    150516 
 3468.00              COMPUTE MPPRMTRM   OF MPMDLPNT-REC   =                                                                  150509 
 3469.00                      MPCOVTRM   OF MPMDLPNT-REC                                                                      150509 
 3470.00              COMPUTE MPEXTTRM   OF MPMDLPNT-REC   = 0                                                                150516 
 3471.00                                                                                                                      150509 
 3472.00       *      AN HEALTH (11)   < 11020  11026-11027                                                       150516 
 3473.00       *        11011-12                                                                            150517 
 3474.00       *        DEPENDANT                                                                                       150516 
 3475.00              IF  COVCOD OF WRK-FCONCOV-REC(1:2) = '11'                                                               150624 
 3476.00              AND (COVCOD OF WRK-FCONCOV-REC(3:3) < '020' OR                                                          150624 
 3477.00                   COVCOD OF WRK-FCONCOV-REC(3:3) = '026' OR                                                          150624 
 3478.00                   COVCOD OF WRK-FCONCOV-REC(3:3) = '027'   )                                                         150624 
 3479.00              AND (COVCOD  OF WRK-FCONCOV-REC(3:3)  NOT = '011' OR                                                    150624 
 3480.00                   CAMPCOD OF WRK-FCONCOV-REC       NOT = 'A1'    )                                                   150624 
 3481.00              AND (COVCOD  OF WRK-FCONCOV-REC(3:3)  NOT = '012' OR                                                    150624 
 3482.00                   CAMPCOD OF WRK-FCONCOV-REC       NOT = 'A1'    )                                                   150624 
 3483.00              AND (RELTCOD   OF FCONLIF-REC = '  ' OR 'WI' OR 'HU')                                                   150624 
 3484.00                                                                                                                      150516 
 3485.00                   COMPUTE WRK-CURRAGE               =                                                                150516 
 3486.00                           MPAGEENTR OF MPMDLPNT-REC +                                                                150516 
 3487.00                           MPMONIF   OF MPMDLPNT-REC / 12                                                             150516 
 3488.00                                                                                                                      150516 
 3489.00       *           Curr.Age < 65  AgeAtEntry > 60                                                                  150603 
 3490.00       *           Then Prem_Term =                                                                                   150603 
 3491.00       *           Min(65 - AgeAtEntry, MainTerm + IssueY - InceptY)                                                  150603 
 3492.00       *           &    Ext_Term  = 0                                                                                 150603 
 3493.00       *           -------------------------------------------------                                                  150603 
 3494.00                   IF  WRK-CURRAGE               <  65                                                                150516 
 3495.00                   AND MPAGEENTR OF MPMDLPNT-REC >  60                                                                150516 
 3496.00                                                                                                                      150626 
 3497.00                       IF RELTCOD OF FCONLIF-REC = '  '                                                               150626 
 3498.00                          COMPUTE MPPRMTRM   OF MPMDLPNT-REC     =                                                    150626 
 3499.00                                  MPMAINTRM  OF MPMDLPNT-REC      +                                                   150626 
 3500.00                                  RSKCOMMAGE OF WRK-BASFCOV-REC   -                                                   150626 
 3501.00                                  WRK-PRCAGE                                                                          150626 
 3502.00                                                                                                                      150626 
 3503.00                       ELSE                                                                                           150626 
 3504.00                          IF MPMAINTRM  OF MPMDLPNT-REC      +                                                        150626 
 3505.00                             RSKCOMMAGE OF WRK-BASFCOV-REC   -                                                        150626 
 3506.00                             WRK-PRCAGE                      -                                                        150626 
 3507.00                             MPINCPYEAR OF MPMDLPNT-REC      +                                                        150626 
 3508.00       ****                  MPISSYEAR  OF MPMDLPNT-REC                                                               161118 
 3509.00                             WRKISSY                                                                                  161118 
 3510.00                             <                                                                                        150626 
 3511.00                             MPMAINTRM  OF MPMDLPNT-REC                                                               150626 
 3512.00                             COMPUTE MPPRMTRM   OF MPMDLPNT-REC      =                                                150626 
 3513.00                                     MPMAINTRM  OF MPMDLPNT-REC      +                                                150626 
 3514.00                                     RSKCOMMAGE OF WRK-BASFCOV-REC   -                                                150626 
 3515.00                                     WRK-PRCAGE                      -                                                150626 
 3516.00                                     MPINCPYEAR OF MPMDLPNT-REC      +                                                150626 
 3517.00       ****                          MPISSYEAR  OF MPMDLPNT-REC                                                       161118 
 3518.00                                     WRKISSY                                                                          161118 
 3519.00                          ELSE                                                                                        150626 
 3520.00                             COMPUTE MPPRMTRM   OF MPMDLPNT-REC     =                                                 150626 
 3521.00                                     MPMAINTRM  OF MPMDLPNT-REC                                                       150626 
 3522.00                          END-IF                                                                                      150626 
 3523.00                                                                                                                      150626 
 3524.00       *                  IF MPMAINTRM  OF MPMDLPNT-REC +                                                             150626 
 3525.00       *                     MPISSYEAR  OF MPMDLPNT-REC -                                                             150626 
 3526.00       *                     MPINCPYEAR OF MPMDLPNT-REC >                                                             150626 
 3527.00       *                     65 - MPAGEENTR OF MPMDLPNT-REC                                                           150626 
 3528.00       *                     COMPUTE MPPRMTRM OF MPMDLPNT-REC =                                                       150626 
 3529.00       *                             65 - MPAGEENTR OF MPMDLPNT-REC                                                   150626 
 3530.00       *                  ELSE                                                                                        150626 
 3531.00       *                     COMPUTE MPPRMTRM   OF MPMDLPNT-REC =                                                     150626 
 3532.00       *                             MPMAINTRM  OF MPMDLPNT-REC +                                                     150626 
 3533.00       *                             MPISSYEAR  OF MPMDLPNT-REC -                                                     150626 
 3534.00       *                             MPINCPYEAR OF MPMDLPNT-REC                                                       150626 
 3535.00       *                  END-IF                                                                                      150626 
 3536.00                                                                                                                      150603 
 3537.00                       END-IF                                                                                         150626 
 3538.00                                                                                                                      150626 
 3539.00                   END-IF                                                                                             150626 
 3540.00                                                                                                                      150516 
 3541.00       *           Curr.Age < 65  AgeAtEntry <= 60                                                                 150603 
 3542.00       *           & MainCover not up to 106 (Type Not WholeLife)                                                     150603 
 3543.00       *           Then Prem_Term = Premium Cover Term (CoverTerm)                                                    150603 
 3544.00       *           &    Ext_Term  =                                                                                   150603 
 3545.00       *           Max(MainTerm + IssueY - InceptY - PremTerm , 0)                                                    150603 
 3546.00       *           -------------------------------------------------                                                  150603 
 3547.00                   IF  WRK-CURRAGE                      <  65                                                         150603 
 3548.00                   AND MPAGEENTR  OF MPMDLPNT-REC       <= 60                                                         150603 
 3549.00                   AND RSKCESSTRM OF WRK-BASFCOV-REC NOT =  0                                                         150624 
 3550.00       *           AND PRMCESSDT  OF WRK-BASFCOV-REC NOT = 99999999                                                   150624 
 3551.00                                                                                                                      150516 
 3552.00                       COMPUTE MPEXTTRM   OF MPMDLPNT-REC =                                                           150603 
 3553.00                               MPMAINTRM  OF MPMDLPNT-REC +                                                           150603 
 3554.00       ****                    MPISSYEAR  OF MPMDLPNT-REC -                                                           161118 
 3555.00                               WRKISSY                    -                                                           161118 
 3556.00                               MPINCPYEAR OF MPMDLPNT-REC -                                                           150603 
 3557.00                               MPCOVTRM   OF MPMDLPNT-REC                                                             150603 
 3558.00                       IF MPEXTTRM OF MPMDLPNT-REC < 0                                                                150603 
 3559.00                          MOVE ZEROES TO MPEXTTRM OF MPMDLPNT-REC                                                     150603 
 3560.00                       END-IF                                                                                         150603 
 3561.00                                                                                                                      150603 
 3562.00                   END-IF                                                                                             150603 
 3563.00                                                                                                                      150603 
 3564.00       *           Curr.Age < 65  AgeAtEntry <= 60                                                                 150603 
 3565.00       *           & MainCover up to 106 (Type WholeLife)                                                             150603 
 3566.00       *           Then Prem_Term = 65 - AgeAtEntry                                                                   150603 
 3567.00       *           &    Ext_Term  =                                                                                   150603 
 3568.00       *           For SamePerson = 106 - 65                                                                          150603 
 3569.00       *           For Husb/Wife  = Max(CoverTerm - Prem.Pay , 0)                                                     150603 
 3570.00       *           For Dependant  = 0                                                                                 150603 
 3571.00       *           -------------------------------------------------                                                  150603 
 3572.00                   IF  WRK-CURRAGE                      <  65                                                         150603 
 3573.00                   AND MPAGEENTR  OF MPMDLPNT-REC       <= 60                                                         150603 
 3574.00                   AND RSKCESSTRM OF WRK-BASFCOV-REC     =  0                                                         150624 
 3575.00       *           AND PRMCESSDT  OF WRK-BASFCOV-REC     = 99999999                                                   150624 
 3576.00                                                                                                                      150603 
 3577.00                       COMPUTE MPPRMTRM OF MPMDLPNT-REC =                                                             150603 
 3578.00                               65 - MPAGEENTR OF MPMDLPNT-REC                                                         150603 
 3579.00                                                                                                                      150603 
 3580.00                       IF RELTCOD OF FCONLIF-REC = '  '                                                               150624 
 3581.00                          COMPUTE MPEXTTRM OF MPMDLPNT-REC =                                                          150603 
 3582.00                                  106 - 65                                                                            150603 
 3583.00                       END-IF                                                                                         150603 
 3584.00                                                                                                                      150603 
 3585.00                       IF RELTCOD OF FCONLIF-REC = 'WI' OR 'HU'                                                       150624 
 3586.00                          COMPUTE MPEXTTRM OF MPMDLPNT-REC  =                                                         150603 
 3587.00                                  MPCOVTRM OF MPMDLPNT-REC -                                                          150603 
 3588.00                                  MPPRMTRM OF MPMDLPNT-REC                                                            150603 
 3589.00                          IF MPEXTTRM OF MPMDLPNT-REC < 0                                                             150603 
 3590.00                             MOVE ZEROES TO MPEXTTRM OF MPMDLPNT-REC                                                  150603 
 3591.00                          END-IF                                                                                      150603 
 3592.00                       END-IF                                                                                         150603 
 3593.00                   END-IF                                                                                             150516 
 3594.00                                                                                                                      150603 
 3595.00                   IF CAMPCOD OF WRK-FCONCOV-REC = 'A1' OR 'A2' OR 'A3'                                               150624 
 3596.00                      COMPUTE MPEXTTRM OF MPMDLPNT-REC  = 0                                                           150517 
 3597.00                   END-IF                                                                                             150517 
 3598.00              END-IF                                                                                                  150516 
 3599.00                                                                                                                      150516 
 3600.00       *                                                                                         150509 
 3601.00              IF COVCOD OF WRK-FCONCOV-REC(1:2) = '00'                                                                150624 
 3602.00                 IF COVCOD OF WRK-FCONCOV-REC(3:3) = '035'                                                            150624 
 3603.00                 OR COVCOD OF WRK-FCONCOV-REC(3:3) = '085'                                                            150624 
 3604.00                 OR COVCOD OF WRK-FCONCOV-REC(3:3) = '185'                                                            150624 
 3605.00                 OR COVCOD OF WRK-FCONCOV-REC(3:3) = '077'                                                            150624 
 3606.00                    IF PRMCESSDT OF WRK-FCONCOV-REC NOT = 99999999                                                    150624 
 3607.00                       COMPUTE MPPRMTRM  OF MPMDLPNT-REC =                                                            150509 
 3608.00                               (PRMCESSDT OF WRK-FCONCOV-REC -                                                        150624 
 3609.00                                RSKCOMMDT OF WRK-FCONCOV-REC  ) / 10000                                               150624 
 3610.00                    END-IF                                                                                            150509 
 3611.00                 END-IF                                                                                               150509 
 3612.00              END-IF                                                                                                  150509 
 3613.00                                                                                                                      150509 
 3614.00       *      New  Way of calulation MPCOVTRM,MPEXTTRM for specific                                                   161121 
 3615.00       *      covers of Nelis                                                                                         161121 
 3616.00              PERFORM NEWCALCTRM                                                                                      161121 
 3617.00            END-IF                                                                                                    150509 
 3618.00                                                                                                                      150509 
 3619.00       *    MOVE RSKCESSTRM OF WRK-BASFCOV-REC                                                                        150624 
 3620.00       *      TO MPPRMTRM   OF MPMDLPNT-REC                                                                           150509 
 3621.00                                                                                                                      150509 
 3622.00       *    IF RSKCESSTRM OF WRK-BASFCOV-REC = 0                                                                      150624 
 3623.00       *       COMPUTE MPPRMTRM   OF MPMDLPNT-REC =                                                                   150509 
 3624.00       *               RSKCOMMAGE OF WRK-FCONCOV-REC                                                                  150624 
 3625.00       *    END-IF                                                                                                    150509 
 3626.00                                                                                                                      150509 
 3627.00                                                                                                                      150509 
 3628.00       *                                                                                                      150509 
 3629.00       *    ---------                                                                                                 150509 
 3630.00            IF SYSAPPCOD OF FCONTRACT-REC = '03'                                                                      150624 
 3631.00               MOVE 0  TO MPMAINTRM  OF MPMDLPNT-REC                                                                  150509 
 3632.00               MOVE 0  TO MPEXTTRM   OF MPMDLPNT-REC                                                                  150509 
 3633.00                                                                                                                      150509 
 3634.00               IF COVCOD OF WRK-FCONCOV-REC(1:6) = '00/303'                                                           150624 
 3635.00                  MOVE ANYTRM    OF WRK-FCONCOV-REC                                                                   150624 
 3636.00                    TO MPEXTTRM  OF MPMDLPNT-REC                                                                      150509 
 3637.00               END-IF                                                                                                 150509 
 3638.00                                                                                                                      150509 
 3639.00               IF COVCOD OF WRK-FCONCOV-REC(1:6) NOT = '00/303'                                                       150624 
 3640.00                  IF RSKCESSTRM OF WRK-FCONCOV-REC NOT = 0                                                            150624 
 3641.00                     MOVE RSKCESSTRM OF WRK-FCONCOV-REC                                                               150624 
 3642.00                       TO MPCOVTRM   OF MPMDLPNT-REC                                                                  150509 
 3643.00                  ELSE                                                                                                150509 
 3644.00                     COMPUTE MPCOVTRM   OF MPMDLPNT-REC   =                                                           150509 
 3645.00                             106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                      150624 
 3646.00                  END-IF                                                                                              150509 
 3647.00                  IF RSKCESSTRM OF WRK-BASFCOV-REC NOT = 0                                                            150624 
 3648.00                  MOVE RSKCESSTRM OF WRK-BASFCOV-REC                                                                  150624 
 3649.00                    TO MPPRMTRM   OF MPMDLPNT-REC                                                                     150509 
 3650.00                  ELSE                                                                                                150509 
 3651.00                     COMPUTE MPPRMTRM   OF MPMDLPNT-REC   =                                                           150509 
 3652.00                             106 - RSKCOMMAGE OF WRK-BASFCOV-REC                                                      150624 
 3653.00                  END-IF                                                                                              150509 
 3654.00               END-IF                                                                                                 150509 
 3655.00                                                                                                                      150509 
 3656.00               IF COVCOD OF WRK-FCONCOV-REC(1:6) = '00/303'                                                           150624 
 3657.00                  MOVE DEFANYTRM OF WRK-FCONCOV-REC                                                                   150624 
 3658.00                    TO MPCOVTRM  OF MPMDLPNT-REC                                                                      150509 
 3659.00                  MOVE DEFANYTRM OF WRK-FCONCOV-REC                                                                   150624 
 3660.00                    TO MPPRMTRM  OF MPMDLPNT-REC                                                                      150509 
 3661.00               END-IF                                                                                                 150509 
 3662.00                                                                                                                      150509 
 3663.00               IF COVCOD OF WRK-FCONCOV-REC(1:3) = '05Y'                                                              150624 
 3664.00                  COMPUTE MPCOVTRM   OF MPMDLPNT-REC   =                                                              150509 
 3665.00                          106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                         150624 
 3666.00                  COMPUTE MPPRMTRM   OF MPMDLPNT-REC   =                                                              150509 
 3667.00                          106 - RSKCOMMAGE OF WRK-FCONCOV-REC                                                         150624 
 3668.00               END-IF                                                                                                 150509 
 3669.00                                                                                                                      150509 
 3670.00               IF MPCOVTRM OF MPMDLPNT-REC  > 106                                                                     150603 
 3671.00                  MOVE 106 TO MPPRMTRM OF MPMDLPNT-REC                                                                150603 
 3672.00               END-IF                                                                                                 150509 
 3673.00                                                                                                                      150509 
 3674.00               IF MPPRMTRM OF MPMDLPNT-REC  > 106                                                                     150603 
 3675.00                  MOVE 106 TO MPPRMTRM OF MPMDLPNT-REC                                                                150603 
 3676.00               END-IF                                                                                                 150509 
 3677.00                                                                                                                      150509 
 3678.00               COMPUTE MPPRMTRM   OF MPMDLPNT-REC   =                                                                 150509 
 3679.00                       MPCOVTRM   OF MPMDLPNT-REC                                                                     150509 
 3680.00                                                                                                                      150509 
 3681.00            END-IF                                                                                                    150509 
 3682.00                                                                                                                      150509 
 3683.00            .                                                                                                         150509 
 3684.00         END-CALC-TERMFLDS.                                                                                           150509 
 3685.00            EXIT.                                                                                                     150509 
 3686.00                                                                                                                      150628 
 3687.00       *------------------------------------------------------------------------------------------------------------- 150628 
 3688.00         CALC-DURFROMDATES SECTION.                                                                                   150628 
 3689.00       *------------------------------------------------------------------------------------------------------------- 150628 
 3690.00            MOVE RSKCESSDT OF WRK-FCONCOV-REC TO WRK-DT2                                                              150628 
 3691.00            MOVE RSKCOMMDT OF WRK-FCONCOV-REC TO WRK-DT1                                                              150628 
 3692.00            COMPUTE MPCOVTRM OF MPMDLPNT-REC =                                                                        150628 
 3693.00                    WRKYYYY OF WRK-DT2      -                                                                         150628 
 3694.00                    WRKYYYY OF WRK-DT1                                                                                150628 
 3695.00            IF WRKMM OF WRK-DT2 - WRKMM OF WRK-DT1 > 6                                                                150628 
 3696.00               ADD 1 TO MPCOVTRM OF MPMDLPNT-REC                                                                      150628 
 3697.00            END-IF                                                                                                    150628 
 3698.00            IF  WRKMM OF WRK-DT2 - WRKMM OF WRK-DT1  = 6                                                              150628 
 3699.00            AND WRKDD OF WRK-DT2 - WRKDD OF WRK-DT1 >= 0                                                              150628 
 3700.00                ADD 1 TO MPCOVTRM OF MPMDLPNT-REC                                                                     150628 
 3701.00            END-IF                                                                                                    150628 
 3702.00            IF WRKMM OF WRK-DT2 - WRKMM OF WRK-DT1 < -6                                                               150628 
 3703.00               SUBTRACT 1 FROM MPCOVTRM OF MPMDLPNT-REC                                                               150628 
 3704.00            END-IF                                                                                                    150628 
 3705.00            IF  WRKMM OF WRK-DT2 - WRKMM OF WRK-DT1 = -6                                                              150628 
 3706.00            AND WRKDD OF WRK-DT2 - WRKDD OF WRK-DT1 < 0                                                               150628 
 3707.00               SUBTRACT 1 FROM MPCOVTRM OF MPMDLPNT-REC                                                               150628 
 3708.00            END-IF                                                                                                    150628 
 3709.00                                                                                                                      150628 
 3710.00            .                                                                                                         150628 
 3711.00         END-CALC-DURFROMDATES.                                                                                       150628 
 3712.00            EXIT.                                                                                                     150628 
 3713.00       *------------------------------------------------------------------------------------------------------------- 150407 
 3714.00         GET-TIMESTAMP         SECTION.                                                                               150407 
 3715.00       *------------------------------------------------------------------------------------------------------------- 150407 
 3716.00            MOVE SPACES                TO WSAA-TIMESTAMP                                                              150407 
 3717.00                                                                                                                      150407 
 3718.00            ACCEPT WSAA-DATE  FROM DATE                                                                               150407 
 3719.00            ACCEPT WSAA-TIME  FROM TIME                                                                               150407 
 3720.00            ADD WSCC-20000000          TO WSAA-DATE                                                                   150407 
 3721.00                                                                                                                      150407 
 3722.00            MOVE WSAA-DATE             TO WSAA-BREAK-DATE                                                             150407 
 3723.00            MOVE WSAA-BREAK-DATE-Y     TO WSAA-TIMESTAMP-D-Y                                                          150407 
 3724.00            MOVE WSAA-BREAK-DATE-M     TO WSAA-TIMESTAMP-D-M                                                          150407 
 3725.00            MOVE WSAA-BREAK-DATE-D     TO WSAA-TIMESTAMP-D-D                                                          150407 
 3726.00            INSPECT WSAA-TIMESTAMP-D                                                                                  150407 
 3727.00              REPLACING ALL SPACES     BY WSCC-PAVLA                                                                  150407 
 3728.00                                                                                                                      150407 
 3729.00            MOVE WSAA-TIME             TO WSAA-BREAK-TIME                                                             150407 
 3730.00            MOVE WSAA-BREAK-TIME-H     TO WSAA-TIMESTAMP-T-H                                                          150407 
 3731.00            MOVE WSAA-BREAK-TIME-M     TO WSAA-TIMESTAMP-T-M                                                          150407 
 3732.00            MOVE WSAA-BREAK-TIME-S     TO WSAA-TIMESTAMP-T-S                                                          150407 
 3733.00            MOVE WSAA-BREAK-TIME-L     TO WSAA-TIMESTAMP-T-L                                                          150407 
 3734.00            INSPECT WSAA-TIMESTAMP-T                                                                                  150407 
 3735.00              REPLACING ALL SPACES     BY WSCC-TELEIA                                                                 150407 
 3736.00                                                                                                                      150407 
 3737.00            MOVE ZEROES                TO WSAA-TIMESTAMP-T-0                                                          150407 
 3738.00            .                                                                                                         150407 
 3739.00         END-GET-TIMESTAMP.                                                                                           150407 
 3740.00            EXIT.                                                                                                     150407 
 3741.00                                                                                                                      150407 
 3742.00       *------------------------------------------------------------------------------------------------------------- 150415 
 3743.00         PROCESS-DEDUCT SECTION.                                                                                      150415 
 3744.00       *------------------------------------------------------------------------------------------------------------- 150415 
 3745.00            INITIALIZE DEDUCTR OF DEDUCT-REC                                                                          150423 
 3746.00                                                                                                                      150415 
 3747.00            IF DEDUCTCOD OF WRK-FCONCOV-REC = ' '                                                                     150624 
 3748.00               MOVE 0 TO MPDEDUCT OF MPMDLPNT-REC                                                                     150512 
 3749.00            ELSE                                                                                                      150513 
 3750.00               MOVE DEDUCTCOD OF WRK-FCONCOV-REC                                                                      150624 
 3751.00                 TO DEDUCTCOD OF DEDUCT-REC                                                                           150513 
 3752.00               READ DEDUCT                                                                                            150513 
 3753.00               IF DEDUCT-STATUS = FOUND-REC                                                                           150513 
 3754.00                  MOVE DEDUCTAMT OF DEDUCT-REC                                                                        150513 
 3755.00                    TO MPDEDUCT  OF MPMDLPNT-REC                                                                      150513 
 3756.00               ELSE                                                                                                   150513 
 3757.00                  MOVE 99                                                                                             150513 
 3758.00                    TO MPDEDUCT OF MPMDLPNT-REC                                                                       150513 
 3759.00               END-IF                                                                                                 150513 
 3760.00            END-IF                                                                                                    150513 
 3761.00                                                                                                                      150605 
 3762.00            IF  SYSAPPCOD OF WRK-FCONCOV-REC          = '03'                                                          150624 
 3763.00            AND MPRIDCOD  OF MPMDLPNT-REC(1:2)       = '05'                                                           150605 
 3764.00                                                                                                                      150605 
 3765.00                MOVE SUMINSAMT  OF WRK-FCONCOV-REC                                                                    150626 
 3766.00                  TO MPDEDUCT  OF MPMDLPNT-REC                                                                        150626 
 3767.00                MOVE SUMINSAMT  OF WRK-FCONCOV-REC                                                                    150626 
 3768.00                  TO MPSUMINS  OF MPMDLPNT-REC                                                                        150626 
 3769.00                                                                                                                      150625 
 3770.00                IF  MPRIDCOD OF MPMDLPNT-REC(1:3)    = '05/'                                                          150625 
 3771.00                AND MPRIDCOD OF MPMDLPNT-REC(4:2) IS NUMERIC                                                          150625 
 3772.00                    MOVE ZEROES                                                                                       150625 
 3773.00                      TO MPDEDUCT  OF MPMDLPNT-REC                                                                    150625 
 3774.00                END-IF                                                                                                150625 
 3775.00                                                                                                                      150626 
 3776.00            END-IF                                                                                                    150626 
 3777.00            .                                                                                                         150415 
 3778.00         END-PROCESS-DEDUCT.                                                                                          150415 
 3779.00            EXIT.                                                                                                     150415 
 3780.00       *------------------------------------------------------------------------------------------------------------- 150407 
 3781.00         PROCESS-COINS  SECTION.                                                                                      150415 
 3782.00       *------------------------------------------------------------------------------------------------------------- 150415 
 3783.00            INITIALIZE COINSR OF COINS-REC                                                                            150423 
 3784.00                                                                                                                      150415 
 3785.00            IF COINSCOD OF WRK-FCONCOV-REC = SPACES                                                                   150624 
 3786.00               MOVE 0  TO MPCOINS OF MPMDLPNT-REC                                                                     150513 
 3787.00            ELSE                                                                                                      150513 
 3788.00               MOVE COINSCOD OF WRK-FCONCOV-REC                                                                       150624 
 3789.00                 TO COINSCOD OF COINS-REC                                                                             150513 
 3790.00               READ COINS                                                                                             150513 
 3791.00               IF COINS-STATUS = FOUND-REC                                                                            150513 
 3792.00                  MOVE COINSPC OF COINS-REC                                                                           150513 
 3793.00                    TO MPCOINS OF MPMDLPNT-REC                                                                        150513 
 3794.00               ELSE                                                                                                   150513 
 3795.00                  MOVE 99                                                                                             150513 
 3796.00                    TO MPCOINS OF MPMDLPNT-REC                                                                        150513 
 3797.00               END-IF                                                                                                 150513 
 3798.00            END-IF                                                                                                    150513 
 3799.00            .                                                                                                         150415 
 3800.00         END-PROCESS-COINS.                                                                                           150415 
 3801.00            EXIT.                                                                                                     150415 
 3802.00                                                                                                                      150530 
 3803.00       *------------------------------------------------------------------------------------------------------------- 150530 
 3804.00         FIND-FULV094A  SECTION.                                                                                      150530 
 3805.00       *------------------------------------------------------------------------------------------------------------- 150530 
 3806.00            INITIALIZE FULV094AR  OF LULV094A-REC                                                                     150530 
 3807.00                                                                                                                      150530 
 3808.00            MOVE CONNBR    OF FCONCOV-REC(1:7) TO WSYMB                                                               150624 
 3809.00            MOVE WSYMB                        TO SYMBL  OF LULV094A-REC                                               150530 
 3810.00            MOVE SPACES                       TO ULPRDB OF LULV094A-REC                                               150530 
 3811.00            STRING '00'                          DELIMITED BY SIZE                                                    150530 
 3812.00                   COVCOD OF WRK-FCONCOV-REC(3:4) DELIMITED BY SIZE                                                   150624 
 3813.00              INTO ULPRDB OF LULV094A-REC                                                                             150530 
 3814.00                                                                                                                      150530 
 3815.00            READ LULV094A                                                                                             150530 
 3816.00            IF   LULV094A-STATUS  = STATUS-OK                                                                         150530 
 3817.00               MOVE SYF41 OF LULV094A-REC TO MPSUMINS OF MPMDLPNT-REC                                                 150530 
 3818.00            ELSE                                                                                                      150601 
 3819.00               MOVE ZEROES                TO MPSUMINS OF MPMDLPNT-REC                                                 150601 
 3820.00            END-IF                                                                                                    150530 
 3821.00            .                                                                                                         150530 
 3822.00         END-FIND-FULV094A.                                                                                           150530 
 3823.00            EXIT.                                                                                                     150530 
 3824.00       *------------------------------------------------------------------------------------------------------------- 150415 
 3825.00         FIND-FULFILFLD SECTION.                                                                                      150530 
 3826.00       *------------------------------------------------------------------------------------------------------------- 150416 
 3827.00            INITIALIZE FULV094AR  OF LULV094A-REC                                                                     150528 
 3828.00                                                                                                                      150416 
 3829.00            MOVE CONNBR    OF FCONCOV-REC(1:7) TO WSYMB                                                               150624 
 3830.00            MOVE WSYMB                        TO SYMBL  OF LULV094A-REC                                               150528 
 3831.00            MOVE SPACES                       TO ULPRDB OF LULV094A-REC                                               150530 
 3832.00            STRING '00'                          DELIMITED BY SIZE                                                    150530 
 3833.00                   COVCOD OF WRK-FCONCOV-REC(3:4) DELIMITED BY SIZE                                                   150624 
 3834.00              INTO ULPRDB OF LULV094A-REC                                                                             150530 
 3835.00                                                                                                                      150416 
 3836.00            READ LULV094A                                                                                             150528 
 3837.00            IF LULV094A-STATUS  = STATUS-OK                                                                           150530 
 3838.00               IF  COVCOD OF WRK-FCONCOV-REC = '60/685'                                                               150624 
 3839.00               AND SYF41B OF LULV094A-REC   = '4'                                                                     150530 
 3840.00                   MOVE 'UL_P_2' TO MPFILFLD OF MPMDLPNT-REC                                                          150530 
 3841.00               END-IF                                                                                                 150530 
 3842.00               IF  COVCOD OF WRK-FCONCOV-REC = '60/660'                                                               150624 
 3843.00               AND SYF41B OF LULV094A-REC   = '1'                                                                     150530 
 3844.00                   MOVE 'ULINGP' TO MPFILFLD OF MPMDLPNT-REC                                                          150530 
 3845.00               END-IF                                                                                                 150530 
 3846.00               IF  COVCOD OF WRK-FCONCOV-REC = '60/660'                                                               150624 
 3847.00               AND SYF41B OF LULV094A-REC   = '3'                                                                     150530 
 3848.00                   MOVE 'ULINGS' TO MPFILFLD OF MPMDLPNT-REC                                                          150530 
 3849.00               END-IF                                                                                                 150530 
 3850.00            END-IF                                                                                                    150530 
 3851.00            .                                                                                                         150416 
 3852.00         END-FIND-FULFILFLD.                                                                                          150530 
 3853.00            EXIT.                                                                                                     150416 
 3854.00       *------------------------------------------------------------------------------------------------------------- 150417 
 3855.00         PROCESS-FCONFUND SECTION.                                                                                    150624 
 3856.00       *------------------------------------------------------------------------------------------------------------- 150417 
 3857.00            INITIALIZE CONFUNDR        OF FCONFUND-REC                                                                150624 
 3858.00            INITIALIZE WFUNDUNTVAL                                                                                    150427 
 3859.00                                                                                                                      150417 
 3860.00            MOVE RUNDT     OF FCONCOV-REC  TO RUNDT     OF FCONFUND-REC                                               150624 
 3861.00            MOVE COMPCOD   OF FCONCOV-REC  TO COMPCOD   OF FCONFUND-REC                                               150624 
 3862.00            MOVE DSBCHACOD OF FCONCOV-REC  TO DSBCHACOD OF FCONFUND-REC                                               150624 
 3863.00            MOVE BRCHCOD   OF FCONCOV-REC  TO BRCHCOD   OF FCONFUND-REC                                               150624 
 3864.00            MOVE SYSAPPCOD OF FCONCOV-REC  TO SYSAPPCOD OF FCONFUND-REC                                               150624 
 3865.00            MOVE CONNBR    OF FCONCOV-REC  TO CONNBR    OF FCONFUND-REC                                               150624 
 3866.00            MOVE LIFNO     OF FCONCOV-REC  TO LIFNO     OF FCONFUND-REC                                               150624 
 3867.00            MOVE COVNO     OF FCONCOV-REC  TO COVNO     OF FCONFUND-REC                                               150624 
 3868.00            MOVE LOW-VALUES               TO FUNDCOD    OF FCONFUND-REC                                               150624 
 3869.00                                                                                                                      150430 
 3870.00            START FCONFUND KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150624 
 3871.00            READ  FCONFUND NEXT                                                                                       150624 
 3872.00                                                                                                                      150430 
 3873.00            PERFORM  UNTIL FCONFUND-STATUS NOT =  FOUND-REC                                                           150624 
 3874.00              OR RUNDT     OF FCONCOV-REC  NOT =                                                                      150624 
 3875.00                 RUNDT     OF FCONFUND-REC                                                                            150624 
 3876.00              OR COMPCOD   OF FCONCOV-REC  NOT =                                                                      150624 
 3877.00                 COMPCOD   OF FCONFUND-REC                                                                            150624 
 3878.00              OR DSBCHACOD OF FCONCOV-REC  NOT =                                                                      150624 
 3879.00                 DSBCHACOD OF FCONFUND-REC                                                                            150624 
 3880.00              OR BRCHCOD   OF FCONCOV-REC  NOT =                                                                      150624 
 3881.00                 BRCHCOD   OF FCONFUND-REC                                                                            150624 
 3882.00              OR SYSAPPCOD OF FCONCOV-REC  NOT =                                                                      150624 
 3883.00                 SYSAPPCOD OF FCONFUND-REC                                                                            150624 
 3884.00              OR CONNBR    OF FCONCOV-REC  NOT =                                                                      150624 
 3885.00                 CONNBR    OF FCONFUND-REC                                                                            150624 
 3886.00              OR LIFNO     OF FCONCOV-REC  NOT =                                                                      150624 
 3887.00                 LIFNO     OF FCONFUND-REC                                                                            150624 
 3888.00              OR COVNO     OF FCONCOV-REC  NOT =                                                                      150624 
 3889.00                 COVNO     OF FCONFUND-REC                                                                            150624 
 3890.00                                                                                                                      150417 
 3891.00              COMPUTE WFUNDUNTVAL = FUNDUNTVAL OF FCONFUND-REC +                                                      150624 
 3892.00                                    FUNDUNTVAL OF FCONFUND-REC                                                        150624 
 3893.00                                                                                                                      150417 
 3894.00       *      LIFE400                                                                                                 150430 
 3895.00       *      IF SYSAPPCOD OF FCONTRACT-REC    = "01"                                                                 150624 
 3896.00       *         IF COVCOD OF FCONCOV-REC(1:2) = "ML"                                                                 150624 
 3897.00       *            MOVE FUNDUNTNBR OF FCONFUND-REC                                                                   150624 
 3898.00       *              TO MPUNINBR   OF MPMDLPNT-REC                                                                   150520 
 3899.00       *            MOVE FUNDUNTPRC OF FCONFUND-REC                                                                   150624 
 3900.00       *              TO MPUNIPRC   OF MPMDLPNT-REC                                                                   150520 
 3901.00       *         ELSE                                                                                                 150520 
 3902.00       *            MOVE 1                                                                                            150520 
 3903.00       *              TO MPUNINBR   OF MPMDLPNT-REC                                                                   150520 
 3904.00       *            MOVE 1                                                                                            150520 
 3905.00       *              TO MPUNIPRC   OF MPMDLPNT-REC                                                                   150520 
 3906.00       *         END-IF                                                                                               150520 
 3907.00       *      END-IF                                                                                                  150520 
 3908.00                                                                                                                      150417 
 3909.00              READ FCONFUND NEXT                                                                                      150624 
 3910.00                                                                                                                      150417 
 3911.00            END-PERFORM                                                                                               150417 
 3912.00                                                                                                                      150430 
 3913.00       *    IF SYSAPPCOD OF FCONTRACT-REC     = '01'                                                                  150624 
 3914.00       *       IF  STSCOD   OF FCONCOV-REC    = 'IF'                                                                  150624 
 3915.00       *       AND PRDCATCOD OF FCONTRACT-REC = 'U'                                                                   150624 
 3916.00               MOVE WFUNDUNTVAL TO MPFNDAMT OF MPMDLPNT-REC                                                           150520 
 3917.00       *       END-IF                                                                                                 150520 
 3918.00       *    END-IF                                                                                                    150520 
 3919.00            .                                                                                                         150417 
 3920.00         END-PROCESS-FCONFUND.                                                                                        150624 
 3921.00            EXIT.                                                                                                     150417 
 3922.00       *------------------------------------------------------------------------------------------------------------- 150418 
 3923.00         PROCESS-EXCLUDE SECTION.                                                                                     150418 
 3924.00       *------------------------------------------------------------------------------------------------------------- 150418 
 3925.00                                                                                                                      150421 
 3926.00            INITIALIZE  WMPREJRESN                                                                                    150623 
 3927.00            INITIALIZE  MPCOVEXCR OF MPCOVEXC-REC                                                                     150418 
 3928.00            MOVE 0 TO WRK-EXCLUDE                                                                                     150424 
 3929.00                                                                                                                      150418 
 3930.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC TO                                                                      150624 
 3931.00                 SYSAPPCOD OF MPCOVEXC-REC                                                                            150624 
 3932.00            MOVE COVTYPCOD OF MPFILE-REC     TO                                                                       150624 
 3933.00                 COVTYPCOD OF MPCOVEXC-REC                                                                            150624 
 3934.00            MOVE COVCOD    OF WRK-FCONCOV-REC TO                                                                      150624 
 3935.00                 COVCOD    OF MPCOVEXC-REC                                                                            150624 
 3936.00            MOVE LOW-VALUES  TO COVREQCOD OF MPCOVEXC-REC                                                             150624 
 3937.00            MOVE LOW-VALUES  TO COVINVCOD OF MPCOVEXC-REC                                                             150624 
 3938.00            MOVE LOW-VALUES  TO FREQCOD   OF MPCOVEXC-REC                                                             150624 
 3939.00                                                                                                                      150418 
 3940.00            START MPCOVEXC  KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                        150418 
 3941.00            READ  MPCOVEXC NEXT                                                                                       150418 
 3942.00            PERFORM UNTIL MPCOVEXC-STATUS      NOT =  FOUND-REC                                                       150627 
 3943.00              OR SYSAPPCOD OF WRK-FCONCOV-REC  NOT =                                                                  150624 
 3944.00                 SYSAPPCOD OF MPCOVEXC-REC                                                                            150610 
 3945.00              OR COVTYPCOD OF MPFILE-REC       NOT =                                                                  150627 
 3946.00                 COVTYPCOD OF MPCOVEXC-REC                                                                            150610 
 3947.00              OR COVCOD    OF WRK-FCONCOV-REC  NOT =                                                                  150627 
 3948.00                 COVCOD    OF MPCOVEXC-REC                                                                            150610 
 3949.00              OR WRK-EXCLUDE                   NOT = 0                                                                150627 
 3950.00                                                                                                                      150423 
 3951.00                MOVE 1 TO WRK-EXCLUDE                                                                                 150424 
 3952.00                                                                                                                      150424 
 3953.00       *        REQUIRED BASIC COVERAGE FOR EXCLUSION                                                                 150627 
 3954.00       *        --------------------------------------                                                                150627 
 3955.00       *        IF  COVREQCOD OF MPCOVEXC-REC   NOT =                                                                 150627 
 3956.00       *            COVCOD    OF WRK-BASFCOV-REC                                                                      150627 
 3957.00       *        AND COVREQCOD OF MPCOVEXC-REC   NOT = SPACES                                                          150627 
 3958.00       *            MOVE 0 TO WRK-EXCLUDE                                                                             150627 
 3959.00       *        END-IF                                                                                                150627 
 3960.00                                                                                                                      150627 
 3961.00       *        INVALID BASIC COVERAGE FOR EXCLUSION                                                                  150627 
 3962.00       *        ------------------------------------                                                                  150627 
 3963.00       *        IF  COVINVCOD OF MPCOVEXC-REC       =                                                                 150627 
 3964.00       *            COVCOD    OF WRK-BASFCOV-REC                                                                      150627 
 3965.00       *        AND COVINVCOD OF MPCOVEXC-REC   NOT = SPACES                                                          150627 
 3966.00       *            MOVE 0 TO WRK-EXCLUDE                                                                             150627 
 3967.00       *        END-IF                                                                                                150627 
 3968.00                                                                                                                      150424 
 3969.00       *        FREQUENCY                                                                                             150424 
 3970.00       *        ---------                                                                                             150424 
 3971.00                IF  FREQCOD   OF MPCOVEXC-REC NOT =                                                                   150424 
 3972.00                    MPPRMFREQ OF MPMDLPNT-REC                                                                         150424 
 3973.00                AND FREQCOD OF MPCOVEXC-REC   NOT = SPACES                                                            150424 
 3974.00                     MOVE 0 TO WRK-EXCLUDE                                                                            150424 
 3975.00                END-IF                                                                                                150424 
 3976.00                                                                                                                      150423 
 3977.00       *        ADD TO MAIN                                                                                           150424 
 3978.00       *        (     SUMINS                                                                    150424 
 3979.00       *         +  PREM  IF SUMINSAMT<15 ->=15)                                                                 150424 
 3980.00       *        -------------------------------------                                                                 150424 
 3981.00                IF  FADDMAIN OF MPCOVEXC-REC = '1'                                                                    150424 
 3982.00                AND WRK-EXCLUDE              = 1                                                                      150424 
 3983.00                   IF MPSUMINS  OF MPMDLPNT-REC <                                                                     150424 
 3984.00                      MINSUMINS OF MPCOVEXC-REC                                                                       150424 
 3985.00                      COMPUTE MPSUMINS  OF MPMDLPNT-REC =                                                             150424 
 3986.00                              MINSUMINS OF MPCOVEXC-REC                                                               150424 
 3987.00                   END-IF                                                                                             150424 
 3988.00                END-IF                                                                                                150424 
 3989.00                                                                                                                      150418 
 3990.00                IF WRK-EXCLUDE = '1'                                                                                  150424 
 3991.00                   MOVE MPREJRESN OF MPCOVEXC TO WMPREJRESN                                                           150623 
 3992.00                   PERFORM WRITE-EXCLUDE                                                                              150424 
 3993.00                END-IF                                                                                                150424 
 3994.00                                                                                                                      150423 
 3995.00                READ MPCOVEXC NEXT                                                                                    150424 
 3996.00                                                                                                                      150424 
 3997.00            END-PERFORM                                                                                               150418 
 3998.00                                                                                                                      150610 
 3999.00                                                                                                                      150504 
 4000.00       *    GENERAL TRANSFORMATION RULES                                                                              150504 
 4001.00            MOVE 0 TO WRK-MPMONIF                                                                                     150504 
 4002.00                                                                                                                      150504 
 4003.00       *    FOR PIRAEUS                                                                                               150625 
 4004.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '03'                                                                    150625 
 4005.00                                                                                                                      150625 
 4006.00       *       INCEPT DATE >PORTOFOLIO DATE                                                                           150625 
 4007.00               MOVE MPINCPDAY  OF MPMDLPNT-REC TO WRK-INCPDAY                                                         150625 
 4008.00               MOVE MPINCPMON  OF MPMDLPNT-REC TO WRK-INCPMON                                                         150625 
 4009.00               MOVE MPINCPYEAR OF MPMDLPNT-REC TO WRK-INCPYEAR                                                        150625 
 4010.00                                                                                                                      150625 
 4011.00               IF WRK-INCPDATE >  WRK-RUNDT                                                                           150625 
 4012.00                      MOVE 'ERROR:After Valuation Date'                                                               150625 
 4013.00                      TO WMPREJRESN                                                                                   150625 
 4014.00                   PERFORM WRITE-EXCLUDE                                                                              150625 
 4015.00               END-IF                                                                                                 150625 
 4016.00            END-IF                                                                                                    150625 
 4017.00                                                                                                                      150625 
 4018.00       *    FOR NELIS                                                                                                 150504 
 4019.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '02'                                                                    150624 
 4020.00                                                                                                                      150601 
 4021.00       *       INCEPT DATE >PORTOFOLIO DATE                                                                           150504 
 4022.00               MOVE MPINCPDAY  OF MPMDLPNT-REC TO WRK-INCPDAY                                                         150427 
 4023.00               MOVE MPINCPMON  OF MPMDLPNT-REC TO WRK-INCPMON                                                         150427 
 4024.00               MOVE MPINCPYEAR OF MPMDLPNT-REC TO WRK-INCPYEAR                                                        150427 
 4025.00                                                                                                                      150427 
 4026.00               IF WRK-INCPDATE >  WRK-RUNDT                                                                           150427 
 4027.00                      MOVE 'ERROR:After Valuation Date'                                                               150610 
 4028.00                      TO WMPREJRESN                                                                                   150623 
 4029.00                   PERFORM WRITE-EXCLUDE                                                                              150427 
 4030.00               ELSE                                                                                                   150601 
 4031.00       *          INCEPT DATE + COVER TERM + EXT.TERM < PORTOFOLIO DATE                                               150623 
 4032.00                  IF WRK-INCPDATE +                                                                                   150623 
 4033.00                     (MPCOVTRM OF MPMDLPNT-REC * 10000) +                                                             150623 
 4034.00                     (MPEXTTRM OF MPMDLPNT-REC * 10000)                                                               150623 
 4035.00                     <=                                                                                               150601 
 4036.00                     WRK-RUNDT                                                                                        150601 
 4037.00                      MOVE 'INCEPT DATE + MAIN TERM < PORTOFOLIO DATE'                                                150612 
 4038.00                      TO WMPREJRESN                                                                                   150623 
 4039.00                     PERFORM WRITE-EXCLUDE                                                                            150601 
 4040.00                  END-IF                                                                                              150601 
 4041.00               END-IF                                                                                                 150601 
 4042.00                                                                                                                      150504 
 4043.00       *       from informatica                                                                                       150606 
 4044.00       *       COMPUTE WRK-MPMONIF             =                                                                      150430 
 4045.00       *               MPMONIF OF MPMDLPNT-REC / 12                                                                   150430 
 4046.00       *       IF WRK-MPMONIF                  >                                                                      150430 
 4047.00       *          MPCOVTRM OF MPMDLPNT-REC +                                                                          150430 
 4048.00       *          MPEXTTRM OF MPMDLPNT-REC                                                                            150430 
 4049.00       *           PERFORM WRITE-EXCLUDE                                                                              150430 
 4050.00       *       END-IF                                                                                                 150430 
 4051.00                                                                                                                      150504 
 4052.00       *       11051_11052_00175_00192                                                                                150627 
 4053.00               IF  (COVCOD OF WRK-FCONCOV-REC = '11051' OR                                                            150627 
 4054.00                    COVCOD OF WRK-FCONCOV-REC = '11052'   )                                                           150627 
 4055.00               AND COVCOD OF WRK-BASFCOV-REC NOT = '00175'                                                            150627 
 4056.00               AND COVCOD OF WRK-BASFCOV-REC NOT = '00192'                                                            150627 
 4057.00                   MOVE 'Cover Not 11051_11052_00175_00192'                                                           150627 
 4058.00                     TO WMPREJRESN                                                                                    150627 
 4059.00                   PERFORM WRITE-EXCLUDE                                                                              150627 
 4060.00               END-IF                                                                                                 150627 
 4061.00                                                                                                                      150504 
 4062.00                                                                                                                      150627 
 4063.00               IF AUTINCRCOD OF FCONTRACT-REC  ='00'                                                                  150624 
 4064.00                                                                                                                      150504 
 4065.00                  IF COVCOD OF WRK-FCONCOV-REC ='00011'                                                               150624 
 4066.00                  OR COVCOD OF WRK-FCONCOV-REC ='00025'                                                               150624 
 4067.00                  OR COVCOD OF WRK-FCONCOV-REC ='00026'                                                               150624 
 4068.00                  OR COVCOD OF WRK-FCONCOV-REC ='00027'                                                               150624 
 4069.00                  OR COVCOD OF WRK-FCONCOV-REC ='00075'                                                               150624 
 4070.00                  OR COVCOD OF WRK-FCONCOV-REC ='00076'                                                               150624 
 4071.00                  OR COVCOD OF WRK-FCONCOV-REC ='00175'                                                               150624 
 4072.00                  OR COVCOD OF WRK-FCONCOV-REC ='00176'                                                               150624 
 4073.00                     PERFORM WRITE-EXCLUDE                                                                            150504 
 4074.00                  END-IF                                                                                              150504 
 4075.00               END-IF                                                                                                 150504 
 4076.00            END-IF                                                                                                    150427 
 4077.00                                                                                                                      150504 
 4078.00       *    GENERAL TRANSFORMATION RULES                                                                              150504 
 4079.00       *    FOR LIFE400                                                                                               150504 
 4080.00                                                                                                                      150504 
 4081.00            IF SYSAPPCOD OF WRK-FCONCOV-REC      = '01'                                                               150624 
 4082.00                                                                                                                      150504 
 4083.00               COMPUTE WRK-MPMONIF             =                                                                      150430 
 4084.00                       MPMONIF OF MPMDLPNT-REC / 12                                                                   150504 
 4085.00                                                                                                                      150504 
 4086.00               IF COVCOD OF WRK-FCONCOV-REC NOT =  'SPDA'                                                             150624 
 4087.00                  IF  WRK-MPMONIF               >                                                                     150504 
 4088.00                      MPCOVTRM OF MPMDLPNT-REC   +                                                                    150504 
 4089.00                      MPEXTTRM OF MPMDLPNT-REC                                                                        150504 
 4090.00                  OR  MPSTSCOD OF MPMDLPNT-REC = 99                                                                   150606 
 4091.00                      MOVE 'Duration>Term - No SPDA'                                                                  150610 
 4092.00                      TO WMPREJRESN                                                                                   150623 
 4093.00                      PERFORM WRITE-EXCLUDE                                                                           150504 
 4094.00                  END-IF                                                                                              150504 
 4095.00               END-IF                                                                                                 150430 
 4096.00                                                                                                                      150427 
 4097.00               IF COVCOD OF WRK-FCONCOV-REC     =  'SPDA'                                                             150624 
 4098.00                  IF WRK-MPMONIF               >                                                                      150430 
 4099.00                     MPMAINTRM OF MPMDLPNT-REC                                                                        150430 
 4100.00                      MOVE 'Duration>Term'                                                                            150610 
 4101.00                      TO WMPREJRESN                                                                                   150623 
 4102.00                     PERFORM WRITE-EXCLUDE                                                                            150430 
 4103.00                  END-IF                                                                                              150430 
 4104.00               END-IF                                                                                                 150430 
 4105.00                                                                                                                      150427 
 4106.00            END-IF                                                                                                    150430 
 4107.00            .                                                                                                         150418 
 4108.00         END-PROCESS-EXCLUDE.                                                                                         150418 
 4109.00            EXIT.                                                                                                     150418 
 4110.00                                                                                                                      150511 
 4111.00       *------------------------------------------------------------------------------------------------------------- 150511 
 4112.00         PROCESS-MPFILFLD SECTION.                                                                                    150511 
 4113.00       *------------------------------------------------------------------------------------------------------------- 150511 
 4114.00                                                                                                                      150511 
 4115.00            INITIALIZE  MPFILEPARR OF MPFILEPAR-REC                                                                   150511 
 4116.00            MOVE 0 TO WRK-FOUNDFILFLD                                                                                 150511 
 4117.00                                                                                                                      150511 
 4118.00            MOVE SYSAPPCOD  OF WRK-FCONCOV-REC                                                                        150624 
 4119.00              TO SYSAPPCOD  OF MPFILEPAR-REC                                                                          150513 
 4120.00            MOVE COVCOD     OF WRK-FCONCOV-REC                                                                        150624 
 4121.00              TO COVCOD     OF MPFILEPAR-REC                                                                          150513 
 4122.00            MOVE LOW-VALUES                                                                                           150513 
 4123.00              TO INCRNBR    OF MPFILEPAR-REC                                                                          150513 
 4124.00                                                                                                                      150511 
 4125.00            START MPFILEPAR KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                        150511 
 4126.00            READ  MPFILEPAR NEXT                                                                                      150511 
 4127.00            PERFORM UNTIL MPFILEPAR-STATUS    NOT = FOUND-REC                                                         150511 
 4128.00              OR SYSAPPCOD OF WRK-FCONCOV-REC  NOT =                                                                  150624 
 4129.00                 SYSAPPCOD OF MPFILEPAR-REC                                                                           150511 
 4130.00              OR COVCOD    OF WRK-FCONCOV-REC  NOT =                                                                  150624 
 4131.00                 COVCOD    OF MPFILEPAR-REC                                                                           150511 
 4132.00              OR WRK-FOUNDFILFLD              NOT = 0                                                                 150511 
 4133.00                                                                                                                      150511 
 4134.00              MOVE 1 TO WRK-FOUNDFILFLD                                                                               150513 
 4135.00                                                                                                                      150511 
 4136.00       *      SINGLE PREMIUM                                                                                          150513 
 4137.00       *      --------------                                                                                          150513 
 4138.00              IF  FSINGLE OF MPFILEPAR        = '1'                                                                   150513 
 4139.00              AND FREQCOD OF FCONTRACT-REC NOT = '00'                                                                 150624 
 4140.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4141.00              END-IF                                                                                                  150513 
 4142.00                                                                                                                      150511 
 4143.00       *      EXT.INFO CODE                                                                                           150513 
 4144.00       *      -------------                                                                                           150513 
 4145.00              IF  EXTINFCOD OF MPFILEPAR      NOT = SPACES                                                            150513 
 4146.00              AND EXTINFCOD OF WRK-FCONCOV-REC NOT =                                                                  150624 
 4147.00                  EXTINFCOD OF MPFILEPAR                                                                              150513 
 4148.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4149.00              END-IF                                                                                                  150513 
 4150.00                                                                                                                      150511 
 4151.00       *      CAMPCOD                                                                                                 150513 
 4152.00       *      ---------                                                                                               150513 
 4153.00              IF  CAMPCOD OF MPFILEPAR-REC  NOT = SPACES                                                              150513 
 4154.00              AND CAMPCOD OF WRK-FCONCOV-REC NOT =                                                                    150624 
 4155.00                  CAMPCOD OF MPFILEPAR-REC                                                                            150513 
 4156.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4157.00              END-IF                                                                                                  150513 
 4158.00                                                                                                                      150511 
 4159.00       *      MPMAINCOD                                                                                               150513 
 4160.00       *      ---------                                                                                               150513 
 4161.00              IF  MPMAINCOD OF MPFILEPAR-REC NOT = SPACES                                                             150513 
 4162.00              AND MPMAINCOD OF MPFILEPAR-REC NOT =                                                                    150513 
 4163.00                  MPMAINCOD OF MPMDLPNT-REC                                                                           150513 
 4164.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4165.00              END-IF                                                                                                  150513 
 4166.00                                                                                                                      150511 
 4167.00       *      MPINCPYEAR                                                                                              150513 
 4168.00       *      ---------                                                                                               150513 
 4169.00       *      IF  SYSAPPCOD OF WRK-FCONCOV-REC NOT ='03'                                                              150624 
 4170.00       *      OR  (COVCOD OF WRK-FCONCOV-REC NOT = '00/175' AND                                                       150624 
 4171.00       *           COVCOD OF WRK-FCONCOV-REC NOT = '00/183' AND                                                       150624 
 4172.00       *           COVCOD OF WRK-FCONCOV-REC NOT = '00/192'    )                                                      150624 
 4173.00       *         IF  MPINCPYEAR  OF MPFILEPAR-REC NOT = ZEROES                                                        150520 
 4174.00       *         AND MPINCPYEAR  OF MPMDLPNT-REC  NOT =                                                               150520 
 4175.00       *             MPINCPYEAR  OF MPFILEPAR-REC                                                                     150520 
 4176.00       *             MOVE 0 TO WRK-FOUNDFILFLD                                                                        150520 
 4177.00       *         END-IF                                                                                               150520 
 4178.00       *      ELSE                                                                                                    150520 
 4179.00              IF  SYSAPPCOD OF WRK-FCONCOV-REC NOT ='03'                                                              150624 
 4180.00                 IF  MPINCPYEAR  OF MPFILEPAR-REC NOT = ZEROES                                                        150520 
 4181.00                 AND MPINCPYEAR  OF MPMDLPNT-REC     <=                                                               150520 
 4182.00                     MPINCPYEAR  OF MPFILEPAR-REC                                                                     150520 
 4183.00                     MOVE 0 TO WRK-FOUNDFILFLD                                                                        150520 
 4184.00                 END-IF                                                                                               150520 
 4185.00              END-IF                                                                                                  150520 
 4186.00                                                                                                                      150511 
 4187.00       *      MPAAHROOM                                                                                               150513 
 4188.00       *      ---------                                                                                               150513 
 4189.00              IF  MPAAHROOM OF MPFILEPAR-REC NOT = ZEROES                                                             150513 
 4190.00              AND MPAAHROOM OF MPMDLPNT-REC  NOT =                                                                    150513 
 4191.00                  MPAAHROOM OF MPFILEPAR-REC                                                                          150513 
 4192.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4193.00              END-IF                                                                                                  150513 
 4194.00                                                                                                                      150511 
 4195.00       *      MPDEDUCT                                                                                                150513 
 4196.00       *      ---------                                                                                               150513 
 4197.00              IF  MPDEDUCT  OF MPFILEPAR-REC NOT = ZEROES                                                             150513 
 4198.00              AND MPDEDUCT  OF MPMDLPNT-REC  NOT =                                                                    150513 
 4199.00                  MPDEDUCT  OF MPFILEPAR-REC                                                                          150513 
 4200.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4201.00              END-IF                                                                                                  150513 
 4202.00                                                                                                                      150511 
 4203.00       *      MPCOINS                                                                                                 150513 
 4204.00       *      ---------                                                                                               150513 
 4205.00              IF  MPCOINS   OF MPFILEPAR-REC NOT = ZEROES                                                             150513 
 4206.00              AND MPCOINS   OF MPMDLPNT-REC  NOT =                                                                    150513 
 4207.00                  MPCOINS   OF MPFILEPAR-REC                                                                          150513 
 4208.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4209.00              END-IF                                                                                                  150513 
 4210.00                                                                                                                      150511 
 4211.00       *      MPCLNTORG                                                                                               150513 
 4212.00       *      ---------                                                                                               150513 
 4213.00              IF  MPCLNTORG OF MPFILEPAR-REC NOT = ZEROES                                                             150513 
 4214.00              AND MPCLNTORG OF MPMDLPNT-REC  NOT =                                                                    150513 
 4215.00                  MPCLNTORG OF MPFILEPAR-REC                                                                          150513 
 4216.00                  MOVE 0 TO WRK-FOUNDFILFLD                                                                           150513 
 4217.00              END-IF                                                                                                  150513 
 4218.00                                                                                                                      150513 
 4219.00              IF WRK-FOUNDFILFLD = '1'                                                                                150513 
 4220.00                 MOVE MPFILFLD OF MPFILEPAR-REC                                                                       150513 
 4221.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150513 
 4222.00              END-IF                                                                                                  150513 
 4223.00                                                                                                                      150511 
 4224.00              READ MPFILEPAR NEXT                                                                                     150513 
 4225.00                                                                                                                      150511 
 4226.00            END-PERFORM                                                                                               150511 
 4227.00                                                                                                                      150513 
 4228.00            IF WRK-FOUNDFILFLD = '0'                                                                                  150513 
 4229.00               MOVE 'Un_modelled'   TO MPFILFLD OF MPMDLPNT-REC                                                       150513 
 4230.00            END-IF                                                                                                    150513 
 4231.00       *20/5/2015                                                                                                     150520 
 4232.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '03'                                                                    150624 
 4233.00               IF COVCOD OF WRK-FCONCOV-REC = '00/175'                                                                150624 
 4234.00               AND WRK9YEAR                < 2010                                                                     150520 
 4235.00                 MOVE 'IPTERA'                                                                                        150520 
 4236.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4237.00               END-IF                                                                                                 150520 
 4238.00               IF COVCOD OF WRK-FCONCOV-REC = '00/175'                                                                150624 
 4239.00               AND WRK9YEAR                >= 2010                                                                    150520 
 4240.00                 MOVE 'IPTERA2'                                                                                       150520 
 4241.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4242.00               END-IF                                                                                                 150520 
 4243.00               IF COVCOD OF WRK-FCONCOV-REC = '00/183'                                                                150624 
 4244.00               AND WRK9YEAR                < 2010                                                                     150520 
 4245.00                 MOVE 'IPENDA'                                                                                        150520 
 4246.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4247.00               END-IF                                                                                                 150520 
 4248.00               IF COVCOD OF WRK-FCONCOV-REC = '00/183'                                                                150624 
 4249.00               AND WRK9YEAR                >= 2010                                                                    150520 
 4250.00                 MOVE 'IPENDA2'                                                                                       150520 
 4251.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4252.00               END-IF                                                                                                 150520 
 4253.00               IF COVCOD OF WRK-FCONCOV-REC = '00/192'                                                                150624 
 4254.00               AND WRK9YEAR                < 2010                                                                     150520 
 4255.00                 MOVE 'IPPERA'                                                                                        150520 
 4256.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4257.00               END-IF                                                                                                 150520 
 4258.00               IF COVCOD OF WRK-FCONCOV-REC = '00/192'                                                                150624 
 4259.00               AND WRK9YEAR                >= 2010                                                                    150520 
 4260.00                 MOVE 'IPPERA2'                                                                                       150520 
 4261.00                   TO MPFILFLD OF MPMDLPNT-REC                                                                        150520 
 4262.00               END-IF                                                                                                 150520 
 4263.00            END-IF                                                                                                    150520 
 4264.00       *20/5/2015                                                                                                     150520 
 4265.00                                                                                                                      150511 
 4266.00            .                                                                                                         150511 
 4267.00         END-PROCESS-MPFILFLD.                                                                                        150512 
 4268.00            EXIT.                                                                                                     150511 
 4269.00                                                                                                                      150424 
 4270.00       *------------------------------------------------------------------------------------------------------------- 150418 
 4271.00         WRITE-EXCLUDE SECTION.                                                                                       150418 
 4272.00       *------------------------------------------------------------------------------------------------------------- 150418 
 4273.00            MOVE MPMDLPNT-REC TO  MPMDLPNTRJ-REC                                                                      150421 
 4274.00                                                                                                                      150421 
 4275.00            MOVE WMPREJRESN   TO MPREJRESN OF MPMDLPNTRJ-REC                                                          150623 
 4276.00                                                                                                                      150623 
 4277.00            PERFORM WRITE-REJECTED-REC                                                                                190219 
 4278.00       **** WRITE MPMDLPNTRJ-REC                                                                                      190219 
 4279.00                IF  MPMDLPNTRJ-STATUS     NOT = STATUS-OK                                                             150418 
 4280.00                                                                                                                      150418 
 4281.00                 INITIALIZE REPLERRR               OF REPLERR-REC                                                     150422 
 4282.00                 MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                    150624 
 4283.00                   TO SYSAPPCOD OF REPLERR-REC                                                                        150423 
 4284.00                 MOVE "MPMDLPNTRJ"  TO REPLGRP   OF REPLERR-REC                                                       150423 
 4285.00                 MOVE CONNBR OF WRK-FCONCOV-REC TO ENTYKEY OF REPLERR-REC                                             150624 
 4286.00                 MOVE "MPMDL001"      TO PGMNAME  OF REPLERR-REC                                                      150720 
 4287.00                 MOVE " "             TO FILENAME OF REPLERR-REC                                                      150423 
 4288.00                 MOVE MPMDLPNT-STATUS TO ERRDES   OF REPLERR-REC                                                      150423 
 4289.00                 PERFORM GET-TIMESTAMP                                                                                150422 
 4290.00                 MOVE WSAA-TIMESTAMP  TO TIMESTMP OF REPLERR-REC                                                      150423 
 4291.00                 WRITE REPLERR-REC                                                                                    150422 
 4292.00                ELSE                                                                                                  150421 
 4293.00                 MOVE  1 TO WRK-WR-EXCL                                                                               150422 
 4294.00                END-IF                                                                                                150418 
 4295.00            .                                                                                                         150418 
 4296.00         END-WRITE-EXCLUDE.                                                                                           150418 
 4297.00            EXIT.                                                                                                     150418 
 4298.00       *------------------------------------------------------------------------------------------------------------- 180425 
 4299.00         WRITE-EXCLUDE-NB SECTION.                                                                                    180425 
 4300.00       *------------------------------------------------------------------------------------------------------------- 180425 
 4301.00            MOVE MPMDLPNTNP-REC TO MPMDLPNTRJ-REC                                                                     180425 
 4302.00                                                                                                                      180425 
 4303.00            MOVE WMPREJRESN             TO MPREJRESN OF MPMDLPNTRJ-REC                                                180425 
 4304.00                                                                                                                      180425 
 4305.00            PERFORM WRITE-REJECTED-REC                                                                                190220 
 4306.00       **** WRITE MPMDLPNTRJ-REC                                                                                      190219 
 4307.00                IF  MPMDLPNTRJ-STATUS     NOT = STATUS-OK                                                             180425 
 4308.00                                                                                                                      180425 
 4309.00                 INITIALIZE REPLERRR               OF REPLERR-REC                                                     180425 
 4310.00                 MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                    180425 
 4311.00                   TO SYSAPPCOD OF REPLERR-REC                                                                        180425 
 4312.00                 MOVE "MPMDLPNTRJ"      TO REPLGRP   OF REPLERR-REC                                                   180425 
 4313.00                 MOVE CONNBR OF WRK-FCONCOV-REC TO ENTYKEY OF REPLERR-REC                                             180425 
 4314.00                 MOVE "MPMDL001"        TO PGMNAME  OF REPLERR-REC                                                    180425 
 4315.00                 MOVE " "               TO FILENAME OF REPLERR-REC                                                    180425 
 4316.00                 MOVE MPMDLPNTNP-STATUS TO ERRDES   OF REPLERR-REC                                                    180425 
 4317.00                 PERFORM GET-TIMESTAMP                                                                                180425 
 4318.00                 MOVE WSAA-TIMESTAMP    TO TIMESTMP OF REPLERR-REC                                                    180425 
 4319.00                 WRITE REPLERR-REC                                                                                    180425 
 4320.00                ELSE                                                                                                  180425 
 4321.00                 MOVE  1 TO WRK-WR-EXCL                                                                               180425 
 4322.00                END-IF                                                                                                180425 
 4323.00            .                                                                                                         180425 
 4324.00         END-WRITE-EXCLUDE-NB.                                                                                        180425 
 4325.00            EXIT.                                                                                                     180425 
 4326.00       *------------------------------------------------------------------------------------------------------------- 150418 
 4327.00         FIND-MPGROUP   SECTION.                                                                                      150418 
 4328.00       *------------------------------------------------------------------------------------------------------------- 150418 
 4329.00            MOVE  SPACES TO MPPRDGRP OF MPMDLPNT-REC                                                                  150521 
 4330.00                                                                                                                      150521 
 4331.00            INITIALIZE MPGROUPR OF  MPGROUP-REC                                                                       150418 
 4332.00            MOVE  MPFILFLD OF MPMDLPNT-REC TO MPFILFLD OF MPGROUP-REC                                                 150520 
 4333.00            MOVE  LOW-VALUES               TO MPPRDGRP OF MPGROUP-REC                                                 150520 
 4334.00                                                                                                                      150418 
 4335.00            START MPGROUP KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                          150418 
 4336.00            READ  MPGROUP NEXT                                                                                        150418 
 4337.00            IF MPGROUP-STATUS = FOUND-REC                                                                             150418 
 4338.00               MOVE  MPPRDGRP OF MPGROUP-REC TO MPPRDGRP OF MPMDLPNT-REC                                              150520 
 4339.00            ELSE                                                                                                      150515 
 4340.00               MOVE  'UnModelled'            TO MPPRDGRP OF MPMDLPNT-REC                                              150521 
 4341.00            END-IF                                                                                                    150427 
 4342.00                                                                                                                      150521 
 4343.00            IF (MPMAINCOD OF MPMDLPNT-REC NOT = SPACES OR                                                             150630 
 4344.00                MPULCOD   OF MPMDLPNT-REC NOT = SPACES   )                                                            150630 
 4345.00            AND FCOVMAIN  OF MPFILE-REC       = '1'                                                                   150521 
 4346.00               MOVE MPPRDGRP OF MPMDLPNT-REC TO WRK-MPPRDGRPBAS                                                       150521 
 4347.00            END-IF                                                                                                    150521 
 4348.00                                                                                                                      150521 
 4349.00            IF  MPRMAINCOD OF MPMDLPNT-REC NOT = SPACES                                                               150521 
 4350.00            AND MPRIDCOD   OF MPMDLPNT-REC NOT = SPACES                                                               150521 
 4351.00       *    AND MPPRDGRP   OF MPMDLPNT-REC NOT     = 'UnModelled'                                                     180515 
 4352.00            AND COVCOD OF WRK-FCONCOV-REC(1:2) NOT = 'UR'                                                             180515 
 4353.00            AND COVCOD OF WRK-FCONCOV-REC  NOT     = 'ADL1'                                                           180515 
 4354.00            AND COVCOD OF WRK-FCONCOV-REC  NOT     = 'ADP1'                                                           180515 
 4355.00                MOVE  SPACES TO MPPRDGRP OF MPMDLPNT-REC                                                              150521 
 4356.00                STRING WRK-MPPRDGRPBAS DELIMITED BY SPACES                                                            150521 
 4357.00                       '_Riders'       DELIMITED BY SIZE                                                              150521 
 4358.00                  INTO MPPRDGRP OF MPMDLPNT-REC                                                                       150521 
 4359.00            END-IF                                                                                                    150521 
 4360.00                                                                                                                      150601 
 4361.00            IF  MPRMAINCOD OF MPMDLPNT-REC     = SPACES                                                               150630 
 4362.00            AND MPRIDCOD   OF MPMDLPNT-REC NOT = SPACES                                                               150630 
 4363.00       *    AND MPPRDGRP   OF MPMDLPNT-REC NOT = 'UnModelled'                                                         150630 
 4364.00            AND WRK-MPPRDGRPBAS                = 'UL_Regular '                                                        150630 
 4365.00            AND COVCOD OF WRK-FCONCOV-REC(1:2) NOT                                                                    180515 
 4366.00                                               = 'UR'                                                                 180515 
 4367.00            AND COVCOD OF WRK-FCONCOV-REC  NOT = 'ADL1'                                                               171128 
 4368.00            AND COVCOD OF WRK-FCONCOV-REC  NOT = 'ADP1'                                                               171128 
 4369.00                MOVE  SPACES TO MPPRDGRP OF MPMDLPNT-REC                                                              150630 
 4370.00                STRING WRK-MPPRDGRPBAS DELIMITED BY SPACES                                                            150630 
 4371.00                       '_Riders'       DELIMITED BY SIZE                                                              150630 
 4372.00                  INTO MPPRDGRP OF MPMDLPNT-REC                                                                       150630 
 4373.00            END-IF                                                                                                    150630 
 4374.00                                                                                                                      150520 
 4375.00            .                                                                                                         150418 
 4376.00         END-MPGROUP.                                                                                                 150515 
 4377.00            EXIT.                                                                                                     150418 
 4378.00       *------------------------------------------------------------------------------------------------------------- 150420 
 4379.00         FIND-MPWOPR    SECTION.                                                                                      150420 
 4380.00       *------------------------------------------------------------------------------------------------------------- 150420 
 4381.00            INITIALIZE MPWOPRATER OF  MPWOPRATE-REC                                                                   150420 
 4382.00                       WRSKCOMMAGE                                                                                    150423 
 4383.00                                                                                                                      150723 
 4384.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRSKCOMMAGE                                                      150723 
 4385.00                                                                                                                      150421 
 4386.00            IF SEXCOD OF FCONLIF-REC = 'F'                                                                            150624 
 4387.00               COMPUTE  WRSKCOMMAGE  =                                                                                150423 
 4388.00                        WRSKCOMMAGE  - 3                                                                              150423 
 4389.00            ELSE                                                                                                      150421 
 4390.00               MOVE RSKCOMMAGE OF WRK-FCONCOV-REC TO WRSKCOMMAGE                                                      150624 
 4391.00            END-IF                                                                                                    150421 
 4392.00                                                                                                                      150421 
 4393.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                         150624 
 4394.00              TO SYSAPPCOD OF MPWOPRATE-REC                                                                           150423 
 4395.00            MOVE WRSKCOMMAGE              TO MPWOPAGE  OF MPWOPRATE-REC                                               150421 
 4396.00            MOVE MPCOVTRM OF MPMDLPNT-REC TO MPWOPAGE1 OF MPWOPRATE-REC                                               150420 
 4397.00                                                                                                                      150420 
 4398.00            READ MPWOPRATE                                                                                            150423 
 4399.00            IF MPWOPRATE-STATUS = FOUND-REC                                                                           150420 
 4400.00               MOVE MPWOPRAT OF MPWOPRATE-REC TO WRATE                                                                150423 
 4401.00            END-IF                                                                                                    150420 
 4402.00            .                                                                                                         150420 
 4403.00         END-MPWOPR.                                                                                                  150420 
 4404.00            EXIT.                                                                                                     150420 
 4405.00       *------------------------------------------------------------------------------------------------------------- 150421 
 4406.00         WRITE-REPLERR  SECTION.                                                                                      150421 
 4407.00       *------------------------------------------------------------------------------------------------------------- 150421 
 4408.00                INITIALIZE REPLERRR               OF REPLERR-REC                                                      150421 
 4409.00                MOVE SYSAPPCOD OF FCONCOV-REC TO SYSAPPCOD OF REPLERR-REC                                             150624 
 4410.00                MOVE "MPMDLPNT"              TO REPLGRP   OF REPLERR-REC                                              150421 
 4411.00                MOVE CONNBR OF FCONCOV-REC TO ENTYKEY      OF REPLERR-REC                                             150624 
 4412.00                MOVE "MPMDL001"      TO PGMNAME   OF REPLERR-REC                                                      150720 
 4413.00                MOVE " "             TO FILENAME  OF REPLERR-REC                                                      150421 
 4414.00                MOVE MPMDLPNT-STATUS TO ERRDES    OF REPLERR-REC                                                      150421 
 4415.00                PERFORM GET-TIMESTAMP                                                                                 150421 
 4416.00                MOVE WSAA-TIMESTAMP  TO TIMESTMP  OF REPLERR-REC                                                      150421 
 4417.00                WRITE REPLERR-REC                                                                                     150421 
 4418.00            .                                                                                                         150421 
 4419.00         END-WRITE-REPLERR.                                                                                           150421 
 4420.00            EXIT.                                                                                                     150421 
 4421.00                                                                                                                      150504 
 4422.00       *------------------------------------------------------------------------------------------------------------- 150421 
 4423.00         FIND-MAINCOV   SECTION.                                                                                      150421 
 4424.00       *------------------------------------------------------------------------------------------------------------- 150421 
 4425.00            INITIALIZE CONCOVR OF FCONCOV1-REC                                                                        150624 
 4426.00                                                                                                                      150421 
 4427.00            MOVE RUNDT     OF FCONTRACT-REC TO RUNDT     OF FCONCOV1-REC                                              150624 
 4428.00            MOVE COMPCOD   OF FCONTRACT-REC TO COMPCOD   OF FCONCOV1-REC                                              150624 
 4429.00            MOVE DSBCHACOD OF FCONTRACT-REC TO DSBCHACOD OF FCONCOV1-REC                                              150624 
 4430.00            MOVE BRCHCOD   OF FCONTRACT-REC TO BRCHCOD   OF FCONCOV1-REC                                              150624 
 4431.00            MOVE SYSAPPCOD OF FCONTRACT-REC TO SYSAPPCOD OF FCONCOV1-REC                                              150624 
 4432.00            MOVE CONNBR    OF FCONTRACT-REC TO CONNBR    OF FCONCOV1-REC                                              150624 
 4433.00            MOVE LOW-VALUES                TO LIFNO      OF FCONCOV1-REC                                              150914 
 4434.00                                                                                                                      150421 
 4435.00            START FCONCOV1 KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150624 
 4436.00            READ  FCONCOV1 NEXT                                                                                       150624 
 4437.00                                                                                                                      150421 
 4438.00            PERFORM UNTIL FCONCOV1-STATUS   NOT = FOUND-REC                                                           150624 
 4439.00              OR RUNDT     OF FCONTRACT-REC NOT =                                                                     150624 
 4440.00                 RUNDT     OF FCONCOV1-REC                                                                            150624 
 4441.00              OR COMPCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 4442.00                 COMPCOD   OF FCONCOV1-REC                                                                            150624 
 4443.00              OR DSBCHACOD OF FCONTRACT-REC NOT =                                                                     150624 
 4444.00                 DSBCHACOD OF FCONCOV1-REC                                                                            150624 
 4445.00              OR BRCHCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 4446.00                 BRCHCOD   OF FCONCOV1-REC                                                                            150624 
 4447.00              OR SYSAPPCOD OF FCONTRACT-REC NOT =                                                                     150624 
 4448.00                 SYSAPPCOD OF FCONCOV1-REC                                                                            150624 
 4449.00              OR CONNBR    OF FCONTRACT-REC NOT =                                                                     150624 
 4450.00                 CONNBR    OF FCONCOV1-REC                                                                            150624 
 4451.00              OR WRK-FNDBAS                    = 1                                                                    150422 
 4452.00                                                                                                                      150504 
 4453.00              INITIALIZE MPFILER OF MPFILE-REC                                                                        150422 
 4454.00              MOVE SYSAPPCOD OF FCONCOV1-REC TO SYSAPPCOD OF MPFILE-REC                                               150624 
 4455.00              MOVE COVCOD    OF FCONCOV1-REC TO COVCOD    OF MPFILE-REC                                               150624 
 4456.00                                                                                                                      150421 
 4457.00              READ MPFILE                                                                                             150422 
 4458.00              IF MPFILE-STATUS = FOUND-REC                                                                            150422 
 4459.00                 IF FCOVMAIN OF MPFILE-REC = '1'                                                                      150424 
 4460.00                    MOVE FCONCOV1-REC TO WRK-BASFCOV-REC                                                              150624 
 4461.00                    IF MPCOVCOD      OF MPFILE-REC NOT = SPACES                                                       150424 
 4462.00                       MOVE MPCOVCOD OF MPFILE-REC                                                                    150423 
 4463.00                         TO COVCOD   OF WRK-BASFCOV-REC                                                               150624 
 4464.00                    END-IF                                                                                            150423 
 4465.00                    MOVE 1 TO WRK-FNDBAS                                                                              150422 
 4466.00                 END-IF                                                                                               150422 
 4467.00              END-IF                                                                                                  150422 
 4468.00                                                                                                                      150422 
 4469.00              READ FCONCOV1 NEXT                                                                                      150624 
 4470.00                                                                                                                      150421 
 4471.00            END-PERFORM                                                                                               150421 
 4472.00                                                                                                                      150504 
 4473.00       *    IN CASE CANNOT FIND BASIC COVER                                                                           150504 
 4474.00       *    TAKES THE FIRST OF THE FCONTRACT                                                                          150624 
 4475.00            IF WRK-FNDBAS NOT = 1                                                                                     150504 
 4476.00               MOVE RUNDT     OF FCONTRACT-REC TO                                                                     150624 
 4477.00                    RUNDT     OF FCONCOV1-REC                                                                         150624 
 4478.00               MOVE COMPCOD   OF FCONTRACT-REC TO                                                                     150624 
 4479.00                    COMPCOD   OF FCONCOV1-REC                                                                         150624 
 4480.00               MOVE DSBCHACOD OF FCONTRACT-REC TO                                                                     150624 
 4481.00                    DSBCHACOD OF FCONCOV1-REC                                                                         150624 
 4482.00               MOVE BRCHCOD   OF FCONTRACT-REC TO                                                                     150624 
 4483.00                    BRCHCOD   OF FCONCOV1-REC                                                                         150624 
 4484.00               MOVE SYSAPPCOD OF FCONTRACT-REC TO                                                                     150624 
 4485.00                    SYSAPPCOD OF FCONCOV1-REC                                                                         190305 
 4486.00       **********   SYSAPPCOD OF FCONTRACT-REC                                                                        190305 
 4487.00               MOVE CONNBR    OF FCONTRACT-REC TO                                                                     150624 
 4488.00                    CONNBR    OF FCONCOV1-REC                                                                         150624 
 4489.00               MOVE LOW-VALUES   TO LIFNO     OF FCONCOV1-REC                                                         150624 
 4490.00                                                                                                                      150914 
 4491.00               START FCONCOV1 KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                      150624 
 4492.00               READ  FCONCOV1 NEXT                                                                                    150624 
 4493.00                                                                                                                      150504 
 4494.00               IF FCONCOV1-STATUS             = FOUND-REC                                                             150624 
 4495.00               AND RUNDT     OF FCONTRACT-REC = RUNDT     OF FCONCOV1-REC                                             150624 
 4496.00               AND COMPCOD   OF FCONTRACT-REC = COMPCOD   OF FCONCOV1-REC                                             150624 
 4497.00               AND DSBCHACOD OF FCONTRACT-REC = DSBCHACOD OF FCONCOV1-REC                                             150624 
 4498.00               AND BRCHCOD   OF FCONTRACT-REC = BRCHCOD   OF FCONCOV1-REC                                             150624 
 4499.00               AND SYSAPPCOD OF FCONTRACT-REC = SYSAPPCOD OF FCONCOV1-REC                                             150624 
 4500.00               AND CONNBR    OF FCONTRACT-REC = CONNBR    OF FCONCOV1-REC                                             150624 
 4501.00                                                                                                                      150504 
 4502.00                 INITIALIZE MPFILER OF MPFILE-REC                                                                     150504 
 4503.00                 MOVE SYSAPPCOD OF FCONCOV1-REC TO                                                                    150624 
 4504.00                      SYSAPPCOD OF MPFILE-REC                                                                         150624 
 4505.00                 MOVE COVCOD OF FCONCOV1-REC TO COVCOD    OF MPFILE-REC                                               150624 
 4506.00                                                                                                                      150504 
 4507.00                 READ MPFILE                                                                                          150504 
 4508.00                 IF MPFILE-STATUS = FOUND-REC                                                                         150504 
 4509.00                    MOVE FCONCOV1-REC TO WRK-BASFCOV-REC                                                              150624 
 4510.00                    IF MPCOVCOD      OF MPFILE-REC NOT = SPACES                                                       150504 
 4511.00                       MOVE MPCOVCOD OF MPFILE-REC                                                                    150504 
 4512.00                         TO COVCOD   OF WRK-BASFCOV-REC                                                               150624 
 4513.00                    END-IF                                                                                            150504 
 4514.00                    MOVE 1 TO WRK-FNDBAS                                                                              150504 
 4515.00                 END-IF                                                                                               150504 
 4516.00                                                                                                                      150504 
 4517.00            END-IF                                                                                                    150504 
 4518.00                                                                                                                      150504 
 4519.00            .                                                                                                         150421 
 4520.00         END-FIND-MAINCOV.                                                                                            150421 
 4521.00            EXIT.                                                                                                     150421 
 4522.00                                                                                                                      150627 
 4523.00       *------------------------------------------------------------------------------------------------------------- 150627 
 4524.00         FIND-WOPMCPPI  SECTION.                                                                                      150627 
 4525.00       *------------------------------------------------------------------------------------------------------------- 150627 
 4526.00            INITIALIZE CONCOVR OF FCONCOV1-REC                                                                        150627 
 4527.00                                                                                                                      150627 
 4528.00            MOVE RUNDT     OF FCONTRACT-REC TO RUNDT     OF FCONCOV1-REC                                              150627 
 4529.00            MOVE COMPCOD   OF FCONTRACT-REC TO COMPCOD   OF FCONCOV1-REC                                              150627 
 4530.00            MOVE DSBCHACOD OF FCONTRACT-REC TO DSBCHACOD OF FCONCOV1-REC                                              150627 
 4531.00            MOVE BRCHCOD   OF FCONTRACT-REC TO BRCHCOD   OF FCONCOV1-REC                                              150627 
 4532.00            MOVE SYSAPPCOD OF FCONTRACT-REC TO SYSAPPCOD OF FCONCOV1-REC                                              150627 
 4533.00            MOVE CONNBR    OF FCONTRACT-REC TO CONNBR    OF FCONCOV1-REC                                              150627 
 4534.00            MOVE LOW-VALUES                 TO LIFNO     OF FCONCOV1-REC                                              150627 
 4535.00                                                                                                                      150627 
 4536.00            START FCONCOV1 KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150627 
 4537.00            READ  FCONCOV1 NEXT                                                                                       150627 
 4538.00                                                                                                                      150627 
 4539.00            PERFORM UNTIL FCONCOV1-STATUS   NOT = FOUND-REC                                                           150627 
 4540.00              OR RUNDT     OF FCONTRACT-REC NOT =                                                                     150627 
 4541.00                 RUNDT     OF FCONCOV1-REC                                                                            150627 
 4542.00              OR COMPCOD   OF FCONTRACT-REC NOT =                                                                     150627 
 4543.00                 COMPCOD   OF FCONCOV1-REC                                                                            150627 
 4544.00              OR DSBCHACOD OF FCONTRACT-REC NOT =                                                                     150627 
 4545.00                 DSBCHACOD OF FCONCOV1-REC                                                                            150627 
 4546.00              OR BRCHCOD   OF FCONTRACT-REC NOT =                                                                     150627 
 4547.00                 BRCHCOD   OF FCONCOV1-REC                                                                            150627 
 4548.00              OR SYSAPPCOD OF FCONTRACT-REC NOT =                                                                     150627 
 4549.00                 SYSAPPCOD OF FCONCOV1-REC                                                                            150627 
 4550.00              OR CONNBR    OF FCONTRACT-REC NOT =                                                                     150627 
 4551.00                 CONNBR    OF FCONCOV1-REC                                                                            150627 
 4552.00                                                                                                                      150627 
 4553.00              IF  STSCOD OF FCONCOV1-REC     ='IF'                                                                    180514 
 4554.00                  IF COVCOD OF FCONCOV1-REC  = 'WPP6'                                                                 150627 
 4555.00                  OR COVCOD OF FCONCOV1-REC  = 'WPP5'                                                                 150917 
 4556.00                     MOVE 'PH'                                                                                        150627 
 4557.00                       TO MPRIDCOD OF MPMDLPNT-REC                                                                    150627 
 4558.00                  END-IF                                                                                              150627 
 4559.00                  IF COVCOD OF FCONCOV1-REC  = 'WPL6'                                                                 150627 
 4560.00                  OR COVCOD OF FCONCOV1-REC  = 'WPL5'                                                                 150917 
 4561.00                     MOVE 'LA'                                                                                        150627 
 4562.00                       TO MPRIDCOD   OF MPMDLPNT-REC                                                                  150627 
 4563.00                  END-IF                                                                                              150627 
 4564.00                  IF COVCOD OF FCONCOV1-REC    = 'WPP7'                                                               170807 
 4565.00                  OR COVCOD OF FCONCOV1-REC    = 'WPP8'                                                               170807 
 4566.00                     MOVE 'PH_AD'             TO                                                                      170807 
 4567.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       170807 
 4568.00                  END-IF                                                                                              170718 
 4569.00                  IF COVCOD OF FCONCOV1-REC    = 'WPL7'                                                               170807 
 4570.00                  OR COVCOD OF FCONCOV1-REC    = 'WPL8'                                                               170807 
 4571.00                     MOVE 'LA_AD'             TO                                                                      170807 
 4572.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       170807 
 4573.00                  END-IF                                                                                              170718 
 4574.00                  IF COVCOD OF FCONCOV1-REC    = 'ADL1'                                                               170921 
 4575.00                     MOVE 'ADL1'              TO                                                                      170921 
 4576.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       170921 
 4577.00                  END-IF                                                                                              170921 
 4578.00                  IF COVCOD OF FCONCOV1-REC    = 'ADP1'                                                               170921 
 4579.00                     MOVE 'ADP1'              TO                                                                      170921 
 4580.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       170921 
 4581.00                  END-IF                                                                                              170921 
 4582.00                  IF COVCOD OF FCONCOV1-REC    = 'ADL2'                                                               180530 
 4583.00                     MOVE 'ADL2'              TO                                                                      180530 
 4584.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       180530 
 4585.00                  END-IF                                                                                              180530 
 4586.00                  IF COVCOD OF FCONCOV1-REC    = 'ADP2'                                                               180530 
 4587.00                     MOVE 'ADP2'              TO                                                                      180530 
 4588.00                     MPRIDCOD   OF MPMDLPNT-REC                                                                       180530 
 4589.00                  END-IF                                                                                              180530 
 4590.00       ****       IF COVCOD OF FCONCOV1-REC    = 'ADL3'                                                               180802 
 4591.00       ****          MOVE 'ADL3'              TO                                                                      180802 
 4592.00       ****          MPRIDCOD   OF MPMDLPNT-REC                                                                       180802 
 4593.00       ****       END-IF                                                                                              180802 
 4594.00       ****       IF COVCOD OF FCONCOV1-REC    = 'ADP3'                                                               180802 
 4595.00       ****          MOVE 'ADP3'              TO                                                                      180802 
 4596.00       ****          MPRIDCOD   OF MPMDLPNT-REC                                                                       180802 
 4597.00       ****       END-IF                                                                                              180802 
 4598.00              END-IF                                                                                                  180514 
 4599.00                                                                                                                      150627 
 4600.00              READ FCONCOV1 NEXT                                                                                      150627 
 4601.00                                                                                                                      150627 
 4602.00            END-PERFORM                                                                                               150627 
 4603.00                                                                                                                      150627 
 4604.00            .                                                                                                         150627 
 4605.00         END-FIND-WOPMCPPI.                                                                                           150627 
 4606.00            EXIT.                                                                                                     150627 
 4607.00       *------------------------------------------------------------------------------------------------------------- 150426 
 4608.00         FINDNB-WOPMCPPI  SECTION.                                                                                    180601 
 4609.00       *------------------------------------------------------------------------------------------------------------- 180601 
 4610.00            INITIALIZE CONCOVR OF FCONCOV1-REC                                                                        180601 
 4611.00                                                                                                                      180601 
 4612.00            MOVE RUNDT     OF FCONTRACT-REC TO RUNDT     OF FCONCOV1-REC                                              180601 
 4613.00            MOVE COMPCOD   OF FCONTRACT-REC TO COMPCOD   OF FCONCOV1-REC                                              180601 
 4614.00            MOVE DSBCHACOD OF FCONTRACT-REC TO DSBCHACOD OF FCONCOV1-REC                                              180601 
 4615.00            MOVE BRCHCOD   OF FCONTRACT-REC TO BRCHCOD   OF FCONCOV1-REC                                              180601 
 4616.00            MOVE SYSAPPCOD OF FCONTRACT-REC TO SYSAPPCOD OF FCONCOV1-REC                                              180601 
 4617.00            MOVE CONNBR    OF FCONTRACT-REC TO CONNBR    OF FCONCOV1-REC                                              180601 
 4618.00            MOVE LOW-VALUES                 TO LIFNO     OF FCONCOV1-REC                                              180601 
 4619.00                                                                                                                      180601 
 4620.00            START FCONCOV1 KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         180601 
 4621.00            READ  FCONCOV1 NEXT                                                                                       180601 
 4622.00                                                                                                                      180601 
 4623.00            PERFORM UNTIL FCONCOV1-STATUS   NOT = FOUND-REC                                                           180601 
 4624.00              OR RUNDT     OF FCONTRACT-REC NOT =                                                                     180601 
 4625.00                 RUNDT     OF FCONCOV1-REC                                                                            180601 
 4626.00              OR COMPCOD   OF FCONTRACT-REC NOT =                                                                     180601 
 4627.00                 COMPCOD   OF FCONCOV1-REC                                                                            180601 
 4628.00              OR DSBCHACOD OF FCONTRACT-REC NOT =                                                                     180601 
 4629.00                 DSBCHACOD OF FCONCOV1-REC                                                                            180601 
 4630.00              OR BRCHCOD   OF FCONTRACT-REC NOT =                                                                     180601 
 4631.00                 BRCHCOD   OF FCONCOV1-REC                                                                            180601 
 4632.00              OR SYSAPPCOD OF FCONTRACT-REC NOT =                                                                     180601 
 4633.00                 SYSAPPCOD OF FCONCOV1-REC                                                                            180601 
 4634.00              OR CONNBR    OF FCONTRACT-REC NOT =                                                                     180601 
 4635.00                 CONNBR    OF FCONCOV1-REC                                                                            180601 
 4636.00                                                                                                                      180601 
 4637.00              IF  STSCOD OF FCONCOV1-REC NOT ='PU'                                                                    180601 
 4638.00                  IF COVCOD OF FCONCOV1-REC  = 'WPP6'                                                                 180601 
 4639.00                  OR COVCOD OF FCONCOV1-REC  = 'WPP5'                                                                 180601 
 4640.00                     MOVE 'PH'                                                                                        180601 
 4641.00                       TO MPRIDCOD OF MPMDLPNTNP-REC                                                                  180601 
 4642.00                  END-IF                                                                                              180601 
 4643.00                  IF COVCOD OF FCONCOV1-REC  = 'WPL6'                                                                 180601 
 4644.00                  OR COVCOD OF FCONCOV1-REC  = 'WPL5'                                                                 180601 
 4645.00                     MOVE 'LA'                                                                                        180601 
 4646.00                       TO MPRIDCOD   OF MPMDLPNTNP-REC                                                                180601 
 4647.00                  END-IF                                                                                              180601 
 4648.00                  IF COVCOD OF FCONCOV1-REC    = 'WPP7'                                                               180601 
 4649.00                  OR COVCOD OF FCONCOV1-REC    = 'WPP8'                                                               180601 
 4650.00                     MOVE 'PH_AD'             TO                                                                      180601 
 4651.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4652.00                  END-IF                                                                                              180601 
 4653.00                  IF COVCOD OF FCONCOV1-REC    = 'WPL7'                                                               180601 
 4654.00                  OR COVCOD OF FCONCOV1-REC    = 'WPL8'                                                               180601 
 4655.00                     MOVE 'LA_AD'             TO                                                                      180601 
 4656.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4657.00                  END-IF                                                                                              180601 
 4658.00                  IF COVCOD OF FCONCOV1-REC    = 'ADL1'                                                               180601 
 4659.00                     MOVE 'ADL1'              TO                                                                      180601 
 4660.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4661.00                  END-IF                                                                                              180601 
 4662.00                  IF COVCOD OF FCONCOV1-REC    = 'ADP1'                                                               180601 
 4663.00                     MOVE 'ADP1'              TO                                                                      180601 
 4664.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4665.00                  END-IF                                                                                              180601 
 4666.00                  IF COVCOD OF FCONCOV1-REC    = 'ADL2'                                                               180601 
 4667.00                     MOVE 'ADL2'              TO                                                                      180601 
 4668.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4669.00                  END-IF                                                                                              180601 
 4670.00                  IF COVCOD OF FCONCOV1-REC    = 'ADP2'                                                               180601 
 4671.00                     MOVE 'ADP2'              TO                                                                      180601 
 4672.00                     MPRIDCOD   OF MPMDLPNTNP-REC                                                                     180601 
 4673.00                  END-IF                                                                                              180601 
 4674.00              END-IF                                                                                                  180601 
 4675.00                                                                                                                      180601 
 4676.00              READ FCONCOV1 NEXT                                                                                      180601 
 4677.00                                                                                                                      180601 
 4678.00            END-PERFORM                                                                                               180601 
 4679.00                                                                                                                      180601 
 4680.00            .                                                                                                         180601 
 4681.00         END-FINDNB-WOPMCPPI.                                                                                         180601 
 4682.00            EXIT.                                                                                                     180601 
 4683.00       *------------------------------------------------------------------------------------------------------------- 180601 
 4684.00         PREM-PAYBL-YNELIS SECTION.                                                                                   150426 
 4685.00       *------------------------------------------------------------------------------------------------------------- 150426 
 4686.00              IF  COVCOD OF WRK-FCONCOV-REC(1:2) = '11'                                                               150624 
 4687.00              AND (COVCOD OF WRK-FCONCOV-REC(3:3) < '020' OR                                                          150624 
 4688.00                   COVCOD OF WRK-FCONCOV-REC(3:3) = '026' OR                                                          150624 
 4689.00                   COVCOD OF WRK-FCONCOV-REC(3:3) = '027'   )                                                         150624 
 4690.00              AND (COVCOD  OF WRK-FCONCOV-REC(3:3)  NOT = '011' OR                                                    150624 
 4691.00                   CAMPCOD OF WRK-FCONCOV-REC       NOT = 'A1'    )                                                   150624 
 4692.00              AND (COVCOD  OF WRK-FCONCOV-REC(3:3)  NOT = '012' OR                                                    150624 
 4693.00                   CAMPCOD OF WRK-FCONCOV-REC       NOT = 'A1'    )                                                   150624 
 4694.00              AND (RELTCOD   OF FCONLIF-REC = '  ' OR 'WI' OR 'HU')                                                   150624 
 4695.00       *    IF COVCOD OF FCONCOV-REC(1:2) = '11'                                                                      150624 
 4696.00       *    AND ( RELTCOD OF FCONLIF-REC  = '  ' OR                                                                   150624 
 4697.00       *          RELTCOD OF FCONLIF-REC  = 'WI' OR                                                                   150624 
 4698.00       *          RELTCOD OF FCONLIF-REC  = 'HU'   )                                                                  150624 
 4699.00       *          RELTCOD OF FCONLIF-REC  = 'AD'   )                                                                  150624 
 4700.00       *    AND ( COVCOD OF FCONCOV-REC   < '11020' OR                                                                150624 
 4701.00       *         COVCOD OF FCONCOV-REC    = '11026' OR                                                                150624 
 4702.00       *         COVCOD OF FCONCOV-REC    = '11027'   )                                                               150624 
 4703.00                                                                                                                      150426 
 4704.00       *       MPAGEENTR + MPMONIF                                                                                    150510 
 4705.00               COMPUTE WRK-AGEDURATION = MPAGEENTR OF MPMDLPNT-REC +                                                  150510 
 4706.00                                         MPMONIF   OF MPMDLPNT-REC / 12                                               150510 
 4707.00                                                                                                                      150510 
 4708.00       *       AGE + DURATION >= 65                                                                                   150510 
 4709.00               IF WRK-AGEDURATION >= 65                                                                               150510 
 4710.00                  MOVE 0 TO MPEXTTRM OF MPMDLPNT-REC                                                                  150510 
 4711.00               END-IF                                                                                                 150510 
 4712.00                                                                                                                      150426 
 4713.00       *       AGE+DURATION < 65  AND 65-AGEENTRY < 5                                                                 150510 
 4714.00               IF  WRK-AGEDURATION < 65                                                                               150510 
 4715.00               AND 65 - MPAGEENTR OF MPMDLPNT-REC < 5                                                                 150510 
 4716.00                   MOVE 0 TO MPEXTTRM OF MPMDLPNT-REC                                                                 150510 
 4717.00                   COMPUTE MPPRMTRM   OF MPMDLPNT-REC =                                                               150510 
 4718.00                           MPMAINTRM  OF MPMDLPNT-REC +                                                               150510 
 4719.00       ****                MPISSYEAR  OF MPMDLPNT-REC -                                                               161118 
 4720.00                           WRKISSY                    -                                                               161118 
 4721.00                           MPINCPYEAR OF MPMDLPNT-REC                                                                 150510 
 4722.00                   IF 65 - MPAGEENTR OF MPMDLPNT-REC <                                                                150510 
 4723.00                      MPPRMTRM OF MPMDLPNT-REC                                                                        150510 
 4724.00                      COMPUTE MPPRMTRM OF MPMDLPNT-REC =                                                              150510 
 4725.00                              65 - MPAGEENTR OF MPMDLPNT-REC                                                          150510 
 4726.00                   END-IF                                                                                             150510 
 4727.00               END-IF                                                                                                 150510 
 4728.00                                                                                                                      150510 
 4729.00       *       AGE+DURATION < 65  AND 65-AGEENTRY >= 5                                                                150510 
 4730.00               IF  WRK-AGEDURATION < 65                                                                               150510 
 4731.00               AND 65 - MPAGEENTR OF MPMDLPNT-REC >= 5                                                                150510 
 4732.00                   COMPUTE MPEXTTRM   OF MPMDLPNT-REC =                                                               150510 
 4733.00                           MPMAINTRM  OF MPMDLPNT-REC +                                                               150510 
 4734.00       ****                MPISSYEAR  OF MPMDLPNT-REC -                                                               161118 
 4735.00                           WRKISSY                    -                                                               161118 
 4736.00                           MPINCPYEAR OF MPMDLPNT-REC -                                                               150510 
 4737.00                           MPPRMTRM   OF MPMDLPNT-REC                                                                 150510 
 4738.00                   IF MPEXTTRM OF MPMDLPNT-REC < 0                                                                    150510 
 4739.00                      MOVE 0 TO MPEXTTRM OF MPMDLPNT-REC                                                              150510 
 4740.00                   END-IF                                                                                             150510 
 4741.00                                                                                                                      150510 
 4742.00       *           DURATION OF PAYMENTS (AJDRK??)                                                                     150510 
 4743.00                                                                                                                      150510 
 4744.00               END-IF                                                                                                 150510 
 4745.00                                                                                                                      150426 
 4746.00               IF  WRK-AGEDURATION <  65                                                                              150510 
 4747.00               AND (MPRMAINCOD OF MPMDLPNT-REC ='00014' OR                                                            150510 
 4748.00                    MPRMAINCOD OF MPMDLPNT-REC ='00015' OR                                                            150510 
 4749.00                    MPRMAINCOD OF MPMDLPNT-REC ='00024' OR                                                            150510 
 4750.00                    MPRMAINCOD OF MPMDLPNT-REC ='00034' OR                                                            150510 
 4751.00                    MPRMAINCOD OF MPMDLPNT-REC ='00035' OR                                                            150510 
 4752.00                    MPRMAINCOD OF MPMDLPNT-REC ='00084' OR                                                            150510 
 4753.00                    MPRMAINCOD OF MPMDLPNT-REC ='00085' OR                                                            150510 
 4754.00                    MPRMAINCOD OF MPMDLPNT-REC ='00184' OR                                                            150510 
 4755.00                    MPRMAINCOD OF MPMDLPNT-REC ='00185'   )                                                           150510 
 4756.00               AND 65 - MPAGEENTR OF MPMDLPNT-REC >= 5                                                                150510 
 4757.00                                                                                                                      150426 
 4758.00                   COMPUTE MPPRMTRM OF MPMDLPNT-REC =                                                                 150510 
 4759.00                           65 - MPAGEENTR OF MPMDLPNT-REC                                                             150510 
 4760.00                                                                                                                      150510 
 4761.00                   IF RELTCOD OF FCONLIF-REC = '  '                                                                   150624 
 4762.00                      COMPUTE WRK-2AGEDURATION = 120 - 65                                                             150508 
 4763.00                      MOVE WRK-2AGEDURATION TO                                                                        150510 
 4764.00                           MPEXTTRM   OF MPMDLPNT-REC                                                                 150510 
 4765.00                   END-IF                                                                                             150510 
 4766.00                                                                                                                      150426 
 4767.00                   IF RELTCOD OF FCONLIF-REC = 'WI' OR 'HU'                                                           150624 
 4768.00                      COMPUTE  MPEXTTRM   OF MPMDLPNT-REC  =                                                          150426 
 4769.00                               MPCOVTRM OF MPMDLPNT-REC    -                                                          150426 
 4770.00                               MPPRMTRM OF MPMDLPNT-REC                                                               150426 
 4771.00                   END-IF                                                                                             150510 
 4772.00                                                                                                                      150426 
 4773.00                   IF RELTCOD OF FCONLIF-REC = 'AD' OR 'SO' OR 'DA'                                                   150624 
 4774.00                      MOVE 0 TO    MPEXTTRM   OF MPMDLPNT-REC                                                         150510 
 4775.00                   END-IF                                                                                             150510 
 4776.00                                                                                                                      150426 
 4777.00                   IF CAMPCOD OF FCONCOV-REC = 'A1'                                                                   150624 
 4778.00                   OR CAMPCOD OF FCONCOV-REC = 'A2'                                                                   150624 
 4779.00                   OR CAMPCOD OF FCONCOV-REC = 'A3'                                                                   150624 
 4780.00                      MOVE 0 TO    MPEXTTRM   OF MPMDLPNT-REC                                                         150510 
 4781.00                   END-IF                                                                                             150510 
 4782.00               END-IF                                                                                                 150510 
 4783.00                                                                                                                      150426 
 4784.00            ELSE                                                                                                      150426 
 4785.00               MOVE 0 TO MPEXTTRM OF MPMDLPNT-REC                                                                     150510 
 4786.00            END-IF                                                                                                    150426 
 4787.00            .                                                                                                         150426 
 4788.00         END-PREM-PAYBL-YNELIS.                                                                                       150426 
 4789.00            EXIT.                                                                                                     150426 
 4790.00       *------------------------------------------------------------------------------------------------------------- 150428 
 4791.00         PROCESS-NEWBUSINESS SECTION.                                                                                 150428 
 4792.00       *------------------------------------------------------------------------------------------------------------- 150428 
 4793.00       *NEW BUSINESS    RECS                                                                  150428 
 4794.00       * ISSFRSTDT OF FCONTRACT = RSKCOMMDT =CURRENT YEAR-QUARTER                                                     150624 
 4795.00                                                                                                                      150428 
 4796.00       *Change 27/12/2017                                                                                             171227 
 4797.00       *It must checks first ZAPE file so new business file agrees with ZAPE.                                         171227 
 4798.00            PERFORM CHECK-ZAPE                                                                                        171227 
 4799.00                                                                                                                      171227 
 4800.00       *A T                                                                                                     150428 
 4801.00            MOVE 01       TO WRK-CURRAPOD                                                                             150428 
 4802.00            MOVE 01       TO WRK-CURRAPOM                                                                             150428 
 4803.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             150428 
 4804.00                                                                                                                      150428 
 4805.00            MOVE 31       TO WRK-CURREOSD                                                                             150428 
 4806.00            MOVE 03       TO WRK-CURREOSM                                                                             150428 
 4807.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             150428 
 4808.00                                                                                                                      150428 
 4809.00            IF  RUNDT OF WRK-FCONCOV-REC         >= WRK-CURRENTAPO                                                    160118 
 4810.00            AND RUNDT OF WRK-FCONCOV-REC         <= WRK-CURRENTEOS                                                    160118 
 4811.00                                                                                                                      160118 
 4812.00            IF  ISSFRSTDT OF FCONTRACT-REC       >= WRK-CURRENTAPO                                                    150624 
 4813.00            AND ISSFRSTDT OF FCONTRACT-REC       <= WRK-CURRENTEOS                                                    150624 
 4814.00            OR (RSKCOMMDT OF WRK-FCONCOV-REC     >= WRK-CURRENTAPO                                                    150624 
 4815.00                AND RSKCOMMDT OF WRK-FCONCOV-REC <= WRK-CURRENTEOS)                                                   150624 
 4816.00            OR  WRK-FOUND-ZAPE = '00'                                                                                 171227 
 4817.00                PERFORM WRITE-NEWBUSINESS                                                                             170915 
 4818.00            ELSE                                                                                                      171019 
 4819.00       *    change for topup with date > from rskcommdt of fconcov                                                    171019 
 4820.00                IF COVTYPCOD OF WRK-FCONCOV-REC   = 'P'                                                               171019 
 4821.00                AND COVCOD   OF WRK-FCONCOV-REC(1:2)                                                                  171020 
 4822.00                                                  = 'TU'                                                              171020 
 4823.00                   PERFORM WRITE-NEW-TOPUPS                                                                           171019 
 4824.00                END-IF                                                                                                171019 
 4825.00            END-IF                                                                                                    150428 
 4826.00            END-IF                                                                                                    160118 
 4827.00                                                                                                                      150428 
 4828.00       *B T                                                                                                     150428 
 4829.00                                                                                                                      160118 
 4830.00            MOVE 01       TO WRK-CURRAPOD                                                                             150428 
 4831.00            MOVE 04       TO WRK-CURRAPOM                                                                             150428 
 4832.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             150428 
 4833.00                                                                                                                      150428 
 4834.00            MOVE 30       TO WRK-CURREOSD                                                                             150428 
 4835.00            MOVE 06       TO WRK-CURREOSM                                                                             150428 
 4836.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             150428 
 4837.00                                                                                                                      150428 
 4838.00            IF  RUNDT OF WRK-FCONCOV-REC         >= WRK-CURRENTAPO                                                    160118 
 4839.00            AND RUNDT OF WRK-FCONCOV-REC         <= WRK-CURRENTEOS                                                    160118 
 4840.00                                                                                                                      160118 
 4841.00            IF  ISSFRSTDT OF FCONTRACT-REC       >= WRK-CURRENTAPO                                                    150624 
 4842.00            AND ISSFRSTDT OF FCONTRACT-REC       <= WRK-CURRENTEOS                                                    150624 
 4843.00            OR (RSKCOMMDT OF WRK-FCONCOV-REC     >= WRK-CURRENTAPO                                                    150624 
 4844.00                AND RSKCOMMDT OF WRK-FCONCOV-REC <= WRK-CURRENTEOS)                                                   150624 
 4845.00            OR  WRK-FOUND-ZAPE = '00'                                                                                 171227 
 4846.00                PERFORM WRITE-NEWBUSINESS                                                                             150516 
 4847.00            ELSE                                                                                                      171020 
 4848.00       *    change for topup with date > from rskcommdt of fconcov                                                    171019 
 4849.00                IF COVTYPCOD OF WRK-FCONCOV-REC   = 'P'                                                               171019 
 4850.00                   PERFORM WRITE-NEW-TOPUPS                                                                           171019 
 4851.00                END-IF                                                                                                171019 
 4852.00            END-IF                                                                                                    150428 
 4853.00            END-IF                                                                                                    160118 
 4854.00                                                                                                                      150516 
 4855.00       *     T                                                                                                 150516 
 4856.00            MOVE 01       TO WRK-CURRAPOD                                                                             150428 
 4857.00            MOVE 07       TO WRK-CURRAPOM                                                                             150428 
 4858.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             150428 
 4859.00                                                                                                                      150428 
 4860.00            MOVE 30       TO WRK-CURREOSD                                                                             150428 
 4861.00            MOVE 09       TO WRK-CURREOSM                                                                             150428 
 4862.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             150428 
 4863.00                                                                                                                      150428 
 4864.00            IF  RUNDT OF WRK-FCONCOV-REC         >= WRK-CURRENTAPO                                                    160118 
 4865.00            AND RUNDT OF WRK-FCONCOV-REC         <= WRK-CURRENTEOS                                                    160118 
 4866.00                                                                                                                      160118 
 4867.00            IF  ISSFRSTDT OF FCONTRACT-REC       >= WRK-CURRENTAPO                                                    150624 
 4868.00            AND ISSFRSTDT OF FCONTRACT-REC       <= WRK-CURRENTEOS                                                    150624 
 4869.00            OR (RSKCOMMDT OF WRK-FCONCOV-REC     >= WRK-CURRENTAPO                                                    150624 
 4870.00                AND RSKCOMMDT OF WRK-FCONCOV-REC <= WRK-CURRENTEOS)                                                   150624 
 4871.00            OR  WRK-FOUND-ZAPE = '00'                                                                                 171227 
 4872.00                   PERFORM WRITE-NEWBUSINESS                                                                          150428 
 4873.00            ELSE                                                                                                      171020 
 4874.00       *    change for topup with date > from rskcommdt of fconcov                                                    171019 
 4875.00                IF COVTYPCOD OF WRK-FCONCOV-REC   = 'P'                                                               171019 
 4876.00                   PERFORM WRITE-NEW-TOPUPS                                                                           171019 
 4877.00                END-IF                                                                                                171019 
 4878.00            END-IF                                                                                                    150428 
 4879.00            END-IF                                                                                                    160118 
 4880.00                                                                                                                      150516 
 4881.00       *     T                                                                                                 150516 
 4882.00            MOVE 01       TO WRK-CURRAPOD                                                                             150428 
 4883.00            MOVE 10       TO WRK-CURRAPOM                                                                             150428 
 4884.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             150428 
 4885.00                                                                                                                      150428 
 4886.00            MOVE 31       TO WRK-CURREOSD                                                                             150428 
 4887.00            MOVE 12       TO WRK-CURREOSM                                                                             150428 
 4888.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             150428 
 4889.00                                                                                                                      150428 
 4890.00            IF  RUNDT OF WRK-FCONCOV-REC         >= WRK-CURRENTAPO                                                    160118 
 4891.00            AND RUNDT OF WRK-FCONCOV-REC         <= WRK-CURRENTEOS                                                    160118 
 4892.00                                                                                                                      160118 
 4893.00            IF  ISSFRSTDT OF FCONTRACT-REC       >= WRK-CURRENTAPO                                                    150624 
 4894.00            AND ISSFRSTDT OF FCONTRACT-REC       <= WRK-CURRENTEOS                                                    150624 
 4895.00            OR (RSKCOMMDT OF WRK-FCONCOV-REC     >= WRK-CURRENTAPO                                                    150624 
 4896.00                AND RSKCOMMDT OF WRK-FCONCOV-REC <= WRK-CURRENTEOS)                                                   150624 
 4897.00            OR  WRK-FOUND-ZAPE = '00'                                                                                 180323 
 4898.00            OR  MPSPCOD OF MPMDLPNT-REC = 3                                                                           180323 
 4899.00                   PERFORM WRITE-NEWBUSINESS                                                                          150428 
 4900.00            ELSE                                                                                                      171020 
 4901.00       *    change for topup with date > from rskcommdt of fconcov                                                    171019 
 4902.00                IF COVTYPCOD OF WRK-FCONCOV-REC   = 'P'                                                               171019 
 4903.00                   PERFORM WRITE-NEW-TOPUPS                                                                           171019 
 4904.00                END-IF                                                                                                171019 
 4905.00            END-IF                                                                                                    150428 
 4906.00            END-IF                                                                                                    160118 
 4907.00            .                                                                                                         150428 
 4908.00         END-PROCESS-NEWBUSINESS.                                                                                     150428 
 4909.00            EXIT.                                                                                                     150428 
 4910.00       *------------------------------------------------------------------------------------------------------------- 150428 
 4911.00         WRITE-NEWBUSINESS SECTION.                                                                                   150428 
 4912.00       *------------------------------------------------------------------------------------------------------------- 150428 
 4913.00       *    WRITE-NEWBUSINESS                                                                                         150516 
 4914.00       *    NELIS KAI LIFE400 IDIA                                                                                    150516 
 4915.00                                                                                                                      150909 
 4916.00       **** INITIALIZE MPMDLPNTR  OF MPMDLPNTNP-REC                                                                   180126 
 4917.00       **** INITIALIZE MDLNNONAPR OF MDLNNONAPE-REC                                                                   180126 
 4918.00                                                                                                                      171009 
 4919.00                                                                                                                      180601 
 4920.00       *                                                                                                              181205 
 4921.00       *    MCG4 has same rules as MCG2.                                                                              190328 
 4922.00       *                                                                                                              181205 
 4923.00            IF SYSAPPCOD OF FCONTRACT-REC        = '01'                                                               181205 
 4924.00            AND ( COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG1'                                                            181205 
 4925.00            OR    COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG2')                                                           190402 
 4926.00       **?? OR    COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG4')                                                           190402 
 4927.00       **** OR    COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG3')                                                           190328 
 4928.00                MOVE 0                   TO MPAUTINCPC OF MPMDLPNTNP-REC                                              181205 
 4929.00            END-IF                                                                                                    181205 
 4930.00                                                                                                                      181205 
 4931.00       ****    IF SYSAPPCOD OF FCONTRACT-REC         = '01'                                                           181205 
 4932.00       ****    AND ( COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG1'                                                         181205 
 4933.00       ****    OR    COVCOD  OF WRK-FCONCOV-REC(1:4) = 'MCG2')                                                        181205 
 4934.00       ****        MOVE 0   TO MPAUTINCPC OF MPMDLPNTNP-REC                                                           181205 
 4935.00       ****    END-IF                                                                                                 181205 
 4936.00                                                                                                                      180530 
 4937.00       **** MOVE MPMDLPNT-REC TO MPMDLPNTNP-REC                                                                       180126 
 4938.00       **** MOVE MPMDLPNT-REC TO MDLNNONAPE-REC                                                                       180126 
 4939.00       **** Only for main coverages the totals are zeroes in New Business                                             171023 
 4940.00            IF FCOVMAIN  OF MPFILE-REC              = '1'                                                             171030 
 4941.00            AND MPULCOD OF MPMDLPNTNP-REC(1:3)  NOT = 'TUM'                                                           171023 
 4942.00            AND MPULCOD OF MPMDLPNTNP-REC(1:3)  NOT = 'TULB'                                                          180313 
 4943.00               MOVE ZEROES TO MPTOPUPY1  OF MPMDLPNTNP-REC                                                            171023 
 4944.00               MOVE ZEROES TO MPTOPUPY2  OF MPMDLPNTNP-REC                                                            171023 
 4945.00               MOVE ZEROES TO MPTOPUPY3  OF MPMDLPNTNP-REC                                                            171023 
 4946.00               MOVE ZEROES TO MPTOPUPY4  OF MPMDLPNTNP-REC                                                            171023 
 4947.00               MOVE ZEROES TO MPTOPUPY5  OF MPMDLPNTNP-REC                                                            171023 
 4948.00               MOVE ZEROES TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                            171023 
 4949.00               MOVE ZEROES TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                            171023 
 4950.00            END-IF                                                                                                    171023 
 4951.00                                                                                                                      171030 
 4952.00       **** Without TULA for MCP2                                                                                     171030 
 4953.00       **** Without TULB for MCG1                                                                                     171030 
 4954.00            IF  MPULCOD OF MPMDLPNTNP-REC(1:4)      = 'TUM2'                                                          171030 
 4955.00            OR  MPULCOD OF MPMDLPNTNP-REC(1:4)      = 'TUM3'                                                          171030 
 4956.00                INITIALIZE WRK-MPTOPUPTOT                                                                             171030 
 4957.00                COMPUTE    WRK-MPTOPUPTOT           =                                                                 171030 
 4958.00                                   WRK-MPTOPUPY1  +                                                                   171030 
 4959.00                                   WRK-MPTOPUPY2  +                                                                   171030 
 4960.00                                   WRK-MPTOPUPY3  +                                                                   171030 
 4961.00                                   WRK-MPTOPUPY4  +                                                                   171030 
 4962.00                                   WRK-MPTOPUPY5  +                                                                   171030 
 4963.00                                   WRK-MPTOPUP6PLUS                                                                   171030 
 4964.00                MOVE WRK-MPTOPUPTOT TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                   171030 
 4965.00            END-IF                                                                                                    171030 
 4966.00                                                                                                                      171023 
 4967.00            MOVE ZEROES TO MPDIVAMT   OF MPMDLPNTNP-REC                                                               180129 
 4968.00            MOVE ZEROES TO MPPROTAMT  OF MPMDLPNTNP-REC                                                               170929 
 4969.00            MOVE ZEROES TO MPBNDFLR   OF MPMDLPNTNP-REC                                                               170929 
 4970.00                                                                                                                      150526 
 4971.00            COMPUTE  MPSPCOD   OF MPMDLPNTNP-REC =                                                                    180314 
 4972.00                     MPINCPMON OF MPMDLPNTNP-REC + 50                                                                 180320 
 4973.00                                                                                                                      150527 
 4974.00       **** Changed in 18/10/2017                                                                                     171018 
 4975.00       **** MOVE ZEROES       TO MPMONIF  OF MPMDLPNTNP-REC                                                           171018 
 4976.00            MOVE 1            TO MPMONIF  OF MPMDLPNTNP-REC                                                           171018 
 4977.00            MOVE MPINCPMON OF MPMDLPNTNP-REC                                                                          150917 
 4978.00              TO MPSALMON  OF MPMDLPNTNP-REC                                                                          150526 
 4979.00            MOVE ZEROES       TO MPFNDAMT OF MPMDLPNTNP-REC                                                           150516 
 4980.00       *    MOVE 1            TO MPUNINBR OF MPMDLPNTNP-REC                                                           150601 
 4981.00       *    MOVE 1            TO MPUNIPRC OF MPMDLPNTNP-REC                                                           150601 
 4982.00       *   13/3/2018 it was asked                                                                                     180313 
 4983.00            IF COVCOD   OF WRK-FCONCOV-REC(1:2)  NOT = 'ML'                                                           180313 
 4984.00               MOVE 1         TO MPUNIPRC OF MPMDLPNTNP-REC                                                           180313 
 4985.00            END-IF                                                                                                    180313 
 4986.00                                                                                                                      180313 
 4987.00            IF COVCOD  OF WRK-FCONCOV-REC(1:3)                                                                        180507 
 4988.00                                         = 'TU0'                                                                      180507 
 4989.00               MOVE 1                   TO MPPRMFREQ OF MPMDLPNTNP-REC                                                170901 
 4990.00            END-IF                                                                                                    170901 
 4991.00                                                                                                                      190205 
 4992.00       * mark if it is a wop activated.                                                                               190205 
 4993.00            PERFORM CHECK-WOP-ACTIVATION                                                                              190205 
 4994.00            MOVE WOP-STATUS             TO WOPACT OF MPMDLPNTNP-REC                                                   190205 
 4995.00                                                                                                                      190205 
 4996.00       *------------------------------------------------                                                              190205 
 4997.00       *    LIFE400                                                                                                   150516 
 4998.00       *------------------------------------------------                                                              190205 
 4999.00            IF SYSAPPCOD OF WRK-FCONCOV-REC     = '01'                                                                150624 
 5000.00                                                                                                                      150430 
 5001.00              IF COVCOD  OF WRK-FCONCOV-REC(1:2) = 'MC'                                                               150915 
 5002.00              OR COVCOD  OF WRK-FCONCOV-REC(1:2) = 'UR'                                                               180515 
 5003.00       *A  UM...  C...                                                                                    150915 
 5004.00       *A  U0...  UR...                                                                                    170901 
 5005.00                 MOVE WRK-COVERNP                                                                                     150915 
 5006.00                                TO MPULCOD  OF MPMDLPNTNP-REC                                                         150918 
 5007.00                 MOVE WRK-NPMPNOTINV                                                                                  150918 
 5008.00                                TO MPNOTINV OF MPMDLPNTNP-REC                                                         150918 
 5009.00                                                                                                                      180416 
 5010.00                 IF WRK-NPMPNOTINV               = 0                                                                  180416 
 5011.00                 AND (MPULCOD  OF MPMDLPNTNP-REC = 'MCP1'                                                             180416 
 5012.00                 OR   MPULCOD  OF MPMDLPNTNP-REC = 'MCP3')                                                            180416 
 5013.00                    COMPUTE MPNOTINV OF MPMDLPNTNP-REC                                                                180416 
 5014.00                                                 =                                                                    180416 
 5015.00                            (MPANNPRM OF MPMDLPNTNP-REC                                                               180424 
 5016.00                                                 -                                                                    180424 
 5017.00                            WRK-INIANETPRM )                                                                          180424 
 5018.00                                                 *                                                                    180416 
 5019.00                                                 0.2                                                                  180416 
 5020.00                 END-IF                                                                                               180416 
 5021.00                                                                                                                      180416 
 5022.00                 IF WRK-NPMPNOTINV               = 0                                                                  180416 
 5023.00                 AND (MPULCOD  OF MPMDLPNTNP-REC = 'MCP2'                                                             180416 
 5024.00                   OR MPULCOD  OF MPMDLPNTNP-REC = 'MCP4')                                                            180416 
 5025.00                    COMPUTE MPNOTINV OF MPMDLPNTNP-REC                                                                180416 
 5026.00                                                 =                                                                    180416 
 5027.00                            (MPANNPRM OF MPMDLPNTNP-REC                                                               180424 
 5028.00                                                 -                                                                    180424 
 5029.00                            WRK-INIANETPRM )                                                                          180424 
 5030.00                                                 *                                                                    180416 
 5031.00                                                 0.5                                                                  180416 
 5032.00                 END-IF                                                                                               180416 
 5033.00                 MOVE WRK-NPMPIMPMLP                                                                                  150918 
 5034.00                                TO MPIMPMLP OF MPMDLPNTNP-REC                                                         150918 
 5035.00              END-IF                                                                                                  150915 
 5036.00                                                                                                                      171020 
 5037.00              IF COVCOD  OF WRK-FCONCOV-REC(1:2) = 'TU'                                                               171023 
 5038.00                 MOVE WRK-NPMPIMPMLP                                                                                  171020 
 5039.00                                TO MPIMPMLP OF MPMDLPNTNP-REC                                                         171020 
 5040.00              END-IF                                                                                                  171020 
 5041.00                                                                                                                      171020 
 5042.00              IF COVCOD  OF WRK-FCONCOV-REC(1:2) = 'UR'                                                               180515 
 5043.00              OR COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TU0'                                                              180507 
 5044.00                 MOVE ZEROES                                                                                          170913 
 5045.00                                TO MPNOTINV OF MPMDLPNTNP-REC                                                         170913 
 5046.00                 MOVE ZEROES                                                                                          170921 
 5047.00                                TO MPIMPMLP OF MPMDLPNTNP-REC                                                         170921 
 5048.00              END-IF                                                                                                  170913 
 5049.00                                                                                                                      161108 
 5050.00       *  TUM      FCONCOVSLC                                                             150915 
 5051.00       *23/8/2017 same logic for TU05,TU06,TU07,TU08,TU09  with TUM                                                   180507 
 5052.00       ****   IF COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TUM'                                                              170901 
 5053.00              IF COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TUM'                                                              170808 
 5054.00              OR COVCOD  OF WRK-FCONCOV-REC(1:3) = 'TU0'                                                              180507 
 5055.00              AND WRK-FNDSLICES ='1'                                                                                  150915 
 5056.00                 PERFORM PROCESS-NPFORTUM                                                                             150915 
 5057.00              ELSE                                                                                                    150916 
 5058.00                                                                                                                      150915 
 5059.00                IF MPULCOD OF MPMDLPNTNP-REC(1:2)                                                                     180314 
 5060.00                                                 = 'ML'                                                               180314 
 5061.00                   PERFORM READ-FCONFUNDIS                                                                            150915 
 5062.00                END-IF                                                                                                150915 
 5063.00       *23/10/2017 for TUL.. to be written seperately                                                                 171024 
 5064.00                IF MPULCOD OF MPMDLPNTNP-REC(1:2)                                                                     180314 
 5065.00                                                  = 'MC'                                                              180314 
 5066.00                   MOVE WRK-MPTOPUPTUL                                                                                171222 
 5067.00                             TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                          171024 
 5068.00                   MOVE ZEROES TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                        171222 
 5069.00                   MOVE ZEROES TO MPTOPUPY1  OF MPMDLPNTNP-REC                                                        171222 
 5070.00                   MOVE ZEROES TO MPTOPUPY2  OF MPMDLPNTNP-REC                                                        171222 
 5071.00                   MOVE ZEROES TO MPTOPUPY3  OF MPMDLPNTNP-REC                                                        171222 
 5072.00                   MOVE ZEROES TO MPTOPUPY4  OF MPMDLPNTNP-REC                                                        171222 
 5073.00                   MOVE ZEROES TO MPTOPUPY5  OF MPMDLPNTNP-REC                                                        171222 
 5074.00                END-IF                                                                                                171222 
 5075.00       *23/10/2017                                                                                                    171024 
 5076.00       *MPPRMFREQ                                                                                                     171024 
 5077.00                IF  MPULCOD OF MPMDLPNTNP-REC    = 'TUM2'                                                             171222 
 5078.00                    MOVE '99'  TO MPPRMFREQ OF MPMDLPNTNP-REC                                                         171222 
 5079.00                END-IF                                                                                                171222 
 5080.00                                                                                                                      150430 
 5081.00       ***** 22/12/2017                                                                                               171222 
 5082.00       ***** the below condition does n't exist anymore as                                                            171222 
 5083.00       ***** has been written for orange cross(HRP1,ORP1,ORP2).                                                       171222 
 5084.00       ***** The pgm checks only what exists in ZAPE.                                                                 171222 
 5085.00       ***** 22/12/2017                                                                                               171222 
 5086.00       ***         IF INICOMMDT OF WRK-FCONCOV-REC  =  0                                                              171222 
 5087.00       ***         AND  (CLNTORGCOD OF WRK-FCONCOV-REC    = '01'                                                      171222 
 5088.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '02'                                                      171222 
 5089.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '05'                                                      171222 
 5090.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '06'                                                      171222 
 5091.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '07'                                                      171222 
 5092.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '08'                                                      171222 
 5093.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '09'                                                      171222 
 5094.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '10'                                                      171222 
 5095.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '11'                                                      171222 
 5096.00       ***           OR  CLNTORGCOD OF WRK-FCONCOV-REC    = '12')                                                     171222 
 5097.00                                                                                                                      150915 
 5098.00       ****27/12/17     PERFORM CHECK-ZAPE                                                                            171227 
 5099.00                        PERFORM FINDNB-WOPMCPPI                                                                       180601 
 5100.00                                                                                                                      170928 
 5101.00                        IF WRK-FOUND-ZAPE    = '00'                                                                   171009 
 5102.00                           PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                         171024 
 5103.00                           PERFORM WRITE-NEWBUS-REC                                                                   190219 
 5104.00       ****                WRITE MPMDLPNTNP-REC                                                                       190219 
 5105.00                        END-IF                                                                                        171003 
 5106.00                        IF WRK-FOUND-NON-APE = '00'                                                                   180319 
 5107.00                           PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                         171024 
 5108.00                           PERFORM WRITE-NON-APE                                                                      180319 
 5109.00                        END-IF                                                                                        171229 
 5110.00       *23/10/2017 for separate record for TULA.                                                                      171023 
 5111.00                        IF COVCOD  OF WRK-FCONCOV-REC(1:4) = 'TULA'                                                   171030 
 5112.00                        AND WRKEFFZ-YEAR                   = WRK-RUNY                                                 180103 
 5113.00                        AND WRKEFFZ-MONTH                  = WRK-RUNM                                                 180103 
 5114.00                        AND ZNEWOLD OF ZAPE-REC            = 'Y'                                                      180103 
 5115.00                           MOVE 'MCP2' TO MPFILFLD OF MPMDLPNTNP-REC                                                  171030 
 5116.00                           PERFORM WRITE-NEWBUS-REC                                                                   190219 
 5117.00       ****                WRITE MPMDLPNTNP-REC                                                                       190219 
 5118.00                        END-IF                                                                                        171023 
 5119.00                        IF COVCOD  OF WRK-FCONCOV-REC(1:4) = 'TULB'                                                   171030 
 5120.00                        AND WRKEFFZ-YEAR                   = WRK-RUNY                                                 180103 
 5121.00                        AND WRKEFFZ-MONTH                  = WRK-RUNM                                                 180103 
 5122.00                        AND ZNEWOLD OF ZAPE-REC            = 'Y'                                                      180103 
 5123.00       ****29/12/2017      MOVE 'MCG1' TO MPFILFLD OF MPMDLPNTNP-REC                                                  171229 
 5124.00                           MOVE 'Un_modelled'                                                                         171229 
 5125.00                                       TO MPFILFLD OF MPMDLPNTNP-REC                                                  171229 
 5126.00                           PERFORM WRITE-NEWBUS-REC                                                                   190219 
 5127.00       ****                WRITE MPMDLPNTNP-REC                                                                       190219 
 5128.00                        END-IF                                                                                        171030 
 5129.00       ****        END-IF                                                                                             171222 
 5130.00              END-IF                                                                                                  171023 
 5131.00            END-IF                                                                                                    150916 
 5132.00                                                                                                                      150516 
 5133.00       *------------------------------------------------                                                              190205 
 5134.00       *    NELIS                                                                                                     180323 
 5135.00       *------------------------------------------------                                                              190205 
 5136.00            IF SYSAPPCOD OF WRK-FCONCOV-REC =  '02'                                                                   150624 
 5137.00                                                                                                                      170928 
 5138.00                  IF WRK-FOUND-ZAPE = '00'                                                                            171003 
 5139.00                     PERFORM WRITE-NEWBUS-REC                                                                         190219 
 5140.00       ****          WRITE MPMDLPNTNP-REC                                                                             190219 
 5141.00                  END-IF                                                                                              171003 
 5142.00                  IF WRK-FOUND-NON-APE = '00'                                                                         180322 
 5143.00                                                                                                                      171219 
 5144.00                     IF  MPINCPYEAR OF MPMDLPNTNP-REC  = WRK-RUNY                                                     180319 
 5145.00                         PERFORM CHECK-NEW-BUSINESS                                                                   180425 
 5146.00                     END-IF                                                                                           180425 
 5147.00                  ELSE                                                                                                180322 
 5148.00                     IF  MPINCPYEAR OF MPMDLPNTNP-REC  = WRK-RUNY                                                     180417 
 5149.00                         PERFORM CHECK-HISTORY-FILES                                                                  180326 
 5150.00                         IF WRK-FOUND-NEW-MODEL = '00'                                                                180323 
 5151.00                            PERFORM CHECK-NEW-BUSINESS                                                                180425 
 5152.00                         END-IF                                                                                       180323 
 5153.00                     END-IF                                                                                           180417 
 5154.00                  END-IF                                                                                              180319 
 5155.00            END-IF                                                                                                    180315 
 5156.00                                                                                                                      150522 
 5157.00       *------------------------------------------------                                                              190205 
 5158.00       *                                                                                                      150522 
 5159.00       *------------------------------------------------                                                              190205 
 5160.00            IF SYSAPPCOD OF WRK-FCONCOV-REC = '03'                                                                    150624 
 5161.00       *  TRANSORMATIONS KAI CHECK A   INCEPT MONTH                                                 150527 
 5162.00       * ONLY FOR HOSTPITAL RIDER AND WOP RIDER PIREAUS                                                               150527 
 5163.00       * WE USE FOR MPINCMON NOT THE MPINCPMON=RSKCOMMDT BUT                                                          150527 
 5164.00       * THE ISSFRDT OF FCONTRACT ( WRKFIRSTIS)                                                                       150624 
 5165.00               IF MPRIDCOD OF MPMDLPNT-REC    = 'WPL_I11'                                                             150527 
 5166.00               OR MPRIDCOD OF MPMDLPNT-REC    = 'WPL_I12'                                                             150527 
 5167.00                  MOVE WRKFIRY                                                                                        150527 
 5168.00                  TO   MPINCPYEAR OF MPMDLPNTNP-REC                                                                   150527 
 5169.00                  MOVE WRKFIRM                                                                                        150527 
 5170.00                  TO   MPINCPMON OF MPMDLPNTNP-REC                                                                    150527 
 5171.00                  MOVE WRKFIRD                                                                                        150527 
 5172.00                  TO   MPINCPDAY OF MPMDLPNTNP-REC                                                                    150527 
 5173.00               END-IF                                                                                                 150527 
 5174.00                                                                                                                      171003 
 5175.00               PERFORM CHECK-FAPEP                                                                                    171003 
 5176.00                                                                                                                      170928 
 5177.00               IF WRK-FOUND-FAPEP  = '00'                                                                             171009 
 5178.00                  PERFORM WRITE-NEWBUS-REC                                                                            190219 
 5179.00       ****       WRITE MPMDLPNTNP-REC                                                                                190219 
 5180.00               END-IF                                                                                                 171003 
 5181.00                                                                                                                      171009 
 5182.00               IF WRK-FOUND-NFAPEP = '00'                                                                             171009 
 5183.00                  PERFORM WRITE-NON-APE                                                                               180319 
 5184.00               END-IF                                                                                                 171009 
 5185.00            END-IF                                                                                                    150522 
 5186.00            .                                                                                                         150428 
 5187.00         END-WRITE-NEWBUSINESS.                                                                                       150428 
 5188.00            EXIT.                                                                                                     150428 
 5189.00       *------------------------------------------------------------------------------------------------------------- 150616 
 5190.00         FIND-ANNPREMMCPPI SECTION.                                                                                   150616 
 5191.00       *------------------------------------------------------------------------------------------------------------- 150616 
 5192.00            INITIALIZE MPANNPRM  OF MPMDLPNT-REC                                                                      150624 
 5193.00            INITIALIZE WRK-INIANETPRM                                                                                 180424 
 5194.00            INITIALIZE CONCOVR   OF FCONCOV1-REC                                                                      150624 
 5195.00                                                                                                                      150616 
 5196.00            MOVE RUNDT     OF FCONTRACT-REC TO RUNDT     OF FCONCOV1-REC                                              150624 
 5197.00            MOVE COMPCOD   OF FCONTRACT-REC TO COMPCOD   OF FCONCOV1-REC                                              150624 
 5198.00            MOVE DSBCHACOD OF FCONTRACT-REC TO DSBCHACOD OF FCONCOV1-REC                                              150624 
 5199.00            MOVE BRCHCOD   OF FCONTRACT-REC TO BRCHCOD   OF FCONCOV1-REC                                              150624 
 5200.00            MOVE SYSAPPCOD OF FCONTRACT-REC TO SYSAPPCOD OF FCONCOV1-REC                                              150624 
 5201.00            MOVE CONNBR    OF FCONTRACT-REC TO CONNBR    OF FCONCOV1-REC                                              150624 
 5202.00            MOVE LOW-VALUES                TO LIFNO      OF FCONCOV1-REC                                              150914 
 5203.00                                                                                                                      150616 
 5204.00            START FCONCOV1 KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                         150624 
 5205.00            READ  FCONCOV1 NEXT                                                                                       150624 
 5206.00                                                                                                                      150616 
 5207.00            PERFORM UNTIL FCONCOV1-STATUS   NOT = FOUND-REC                                                           150624 
 5208.00              OR RUNDT     OF FCONTRACT-REC NOT =                                                                     150624 
 5209.00                 RUNDT     OF FCONCOV1-REC                                                                            150624 
 5210.00              OR COMPCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 5211.00                 COMPCOD   OF FCONCOV1-REC                                                                            150624 
 5212.00              OR DSBCHACOD OF FCONTRACT-REC NOT =                                                                     150624 
 5213.00                 DSBCHACOD OF FCONCOV1-REC                                                                            150624 
 5214.00              OR BRCHCOD   OF FCONTRACT-REC NOT =                                                                     150624 
 5215.00                 BRCHCOD   OF FCONCOV1-REC                                                                            150624 
 5216.00              OR SYSAPPCOD OF FCONTRACT-REC NOT =                                                                     150624 
 5217.00                 SYSAPPCOD OF FCONCOV1-REC                                                                            150624 
 5218.00              OR CONNBR    OF FCONTRACT-REC NOT =                                                                     150624 
 5219.00                 CONNBR    OF FCONCOV1-REC                                                                            150624 
 5220.00                                                                                                                      150620 
 5221.00              IF COVCOD OF FCONCOV1-REC(1:2)= 'MC'                                                                    150624 
 5222.00              OR COVCOD OF FCONCOV1-REC(1:1)= 'W'                                                                     150624 
 5223.00                                                                                                                      150616 
 5224.00                 COMPUTE MPANNPRM  OF MPMDLPNT-REC      =                                                             150620 
 5225.00                         MPANNPRM   OF MPMDLPNT-REC      +                                                            160114 
 5226.00                         INIANETPRM OF FCONCOV1-REC                                                                   160114 
 5227.00              END-IF                                                                                                  150616 
 5228.00              IF COVCOD OF FCONCOV1-REC(1:1)= 'W'                                                                     180424 
 5229.00                 MOVE INIANETPRM OF FCONCOV1-REC                                                                      180424 
 5230.00                      TO WRK-INIANETPRM                                                                               180424 
 5231.00              END-IF                                                                                                  180424 
 5232.00                                                                                                                      150616 
 5233.00              READ FCONCOV1 NEXT                                                                                      150624 
 5234.00                                                                                                                      150616 
 5235.00            END-PERFORM                                                                                               150616 
 5236.00                                                                                                                      150616 
 5237.00            .                                                                                                         150616 
 5238.00         END-FIND-ANNPREMMCPPI.                                                                                       150616 
 5239.00            EXIT.                                                                                                     150616 
 5240.00       *------------------------------------------------------------------------------------------------------------- 150626 
 5241.00         FIND-FCONMICRO SECTION.                                                                                      150626 
 5242.00       *------------------------------------------------------------------------------------------------------------- 150626 
 5243.00            INITIALIZE WRK-NINVAMT                                                                                    150911 
 5244.00            INITIALIZE WRK-NPMPIMPMLP                                                                                 170921 
 5245.00                                                                                                                      150911 
 5246.00            INITIALIZE CONMICROR OF FCONMICRO-REC                                                                     150911 
 5247.00              MOVE RUNDT   OF WRK-FCONCOV-REC TO                                                                      150911 
 5248.00              RUNDT   OF FCONMICRO-REC                                                                                150911 
 5249.00              MOVE COMPCOD OF WRK-FCONCOV-REC TO                                                                      150911 
 5250.00              COMPCOD OF FCONMICRO-REC                                                                                150911 
 5251.00              MOVE DSBCHACOD  OF WRK-FCONCOV-REC TO                                                                   150626 
 5252.00              DSBCHACOD OF FCONMICRO-REC                                                                              150911 
 5253.00              MOVE BRCHCOD  OF WRK-FCONCOV-REC TO                                                                     150626 
 5254.00              BRCHCOD OF FCONMICRO-REC                                                                                150626 
 5255.00              MOVE SYSAPPCOD OF WRK-FCONCOV-REC TO                                                                    150626 
 5256.00              SYSAPPCOD OF FCONMICRO-REC                                                                              150626 
 5257.00              MOVE CONNBR    OF WRK-FCONCOV-REC TO                                                                    150626 
 5258.00              CONNBR    OF FCONMICRO-REC                                                                              150626 
 5259.00                                                                                                                      150626 
 5260.00              READ FCONMICRO                                                                                          150626 
 5261.00              IF FCONMICRO-STATUS = FOUND-REC                                                                         150626 
 5262.00                 MOVE PROTAMT    OF FCONMICRO-REC   TO                                                                150626 
 5263.00                      MPPROTAMT  OF MPMDLPNT-REC                                                                      150626 
 5264.00                 MOVE IMPMLPPC   OF  FCONMICRO-REC TO                                                                 150626 
 5265.00                      MPIMPMLP   OF MPMDLPNT-REC                                                                      150626 
 5266.00       * FOR NEW BUSINESS  MC                                                                                         150918 
 5267.00                 MOVE TRGMLPPC   OF  FCONMICRO-REC TO                                                                 150918 
 5268.00                     WRK-NPMPIMPMLP                                                                                   150918 
 5269.00                 MOVE BNDFLRAMT  OF  FCONMICRO-REC TO                                                                 150626 
 5270.00                      MPBNDFLR   OF MPMDLPNT-REC                                                                      150626 
 5271.00                 MOVE NINVAMT    OF  FCONMICRO-REC TO                                                                 150626 
 5272.00                      MPNOTINV   OF MPMDLPNT-REC                                                                      150626 
 5273.00                 MOVE NINVAMT    OF  FCONMICRO-REC TO                                                                 150911 
 5274.00                      WRK-NINVAMT                                                                                     150911 
 5275.00       *?        MOVE ZAVINDX    OF  FCONMICRO-REC TO                                                                 150626 
 5276.00       *?             MPAVIDXDTA OF MPMDLPNT-REC                                                                      150626 
 5277.00              END-IF                                                                                                  150626 
 5278.00            .                                                                                                         150626 
 5279.00         END-FIND-FCONMICRO.                                                                                          150626 
 5280.00            EXIT.                                                                                                     150909 
 5281.00       *------------------------------------------------------------------------------------------------------------- 150909 
 5282.00         PROCESS-TOPUP    SECTION.                                                                                    150911 
 5283.00       *------------------------------------------------------------------------------------------------------------- 150909 
 5284.00                                                                                                                      150911 
 5285.00             PERFORM  CHECK-EXSLICES                                                                                  150911 
 5286.00       *        FCONCOVSLC                                                                                 150911 
 5287.00             IF  WRK-FNDSLICES = '1'                                                                                  150911 
 5288.00                PERFORM UPDATE-MCTOTAL                                                                                150911 
 5289.00             END-IF                                                                                                   150911 
 5290.00            .                                                                                                         150909 
 5291.00         END-PROCESS-TOPUP.                                                                                           150911 
 5292.00            EXIT.                                                                                                     150909 
 5293.00       *------------------------------------------------------------------------------------------------------------- 150910 
 5294.00         CHECK-EXSLICES    SECTION.                                                                                   150910 
 5295.00       *------------------------------------------------------------------------------------------------------------- 150910 
 5296.00       *E     FCONCOVSLC                                        150911 
 5297.00       *LOOP  FCONCOVSLC      UM    C..                                        150911 
 5298.00            INITIALIZE CONCOVSLCR OF FCONCOVSLC-REC                                                                   150911 
 5299.00            INITIALIZE WSAA-COVER                                                                                     150911 
 5300.00            MOVE ZEROES TO WRK-MPTOPUPTOT                                                                             150911 
 5301.00            MOVE ZEROES TO WRK-MPTOPUPTUL                                                                             170505 
 5302.00            MOVE ZEROES TO WRK-MPTOPUPY1                                                                              150911 
 5303.00            MOVE ZEROES TO WRK-MPTOPUPY2                                                                              150911 
 5304.00            MOVE ZEROES TO WRK-MPTOPUPY3                                                                              150911 
 5305.00            MOVE ZEROES TO WRK-MPTOPUPY4                                                                              150911 
 5306.00            MOVE ZEROES TO WRK-MPTOPUPY5                                                                              150911 
 5307.00            MOVE ZEROES TO WRK-MPNOTINV                                                                               150911 
 5308.00            MOVE ZEROES TO WSAA-IND                                                                                   150915 
 5309.00            MOVE ZEROES TO WSAA-TOP-IND                                                                               171019 
 5310.00            INITIALIZE  WSAA-CONCOVSLC-RECS                                                                           171002 
 5311.00            INITIALIZE  WSAA-FCONCOVSLC-TOPUPS-RECS                                                                   171019 
 5312.00            MOVE ZEROES TO WRK-MPTOPUPTOTGR                                                                           170901 
 5313.00            MOVE ZEROES TO WRK-MPTOPUPY1GR                                                                            170901 
 5314.00            MOVE ZEROES TO WRK-MPTOPUPY2GR                                                                            170901 
 5315.00            MOVE ZEROES TO WRK-MPTOPUPY3GR                                                                            170901 
 5316.00            MOVE ZEROES TO WRK-MPTOPUPY4GR                                                                            170901 
 5317.00            MOVE ZEROES TO WRK-MPTOPUPY5GR                                                                            170901 
 5318.00            MOVE ZEROES TO WRK-COVNO                                                                                  170901 
 5319.00            INITIALIZE  WRK-FNDTUM                                                                                    171019 
 5320.00            INITIALIZE  WRK-NEW-TOPUP                                                                                 171019 
 5321.00                                                                                                                      150910 
 5322.00            MOVE RUNDT      OF WRK-FCONCOV-REC                                                                        150911 
 5323.00                        TO RUNDT   OF FCONCOVSLC-REC                                                                  150911 
 5324.00            MOVE COMPCOD    OF WRK-FCONCOV-REC                                                                        150911 
 5325.00                        TO COMPCOD   OF FCONCOVSLC-REC                                                                150911 
 5326.00            MOVE DSBCHACOD  OF WRK-FCONCOV-REC                                                                        150911 
 5327.00                        TO DSBCHACOD OF FCONCOVSLC-REC                                                                150911 
 5328.00            MOVE BRCHCOD    OF WRK-FCONCOV-REC                                                                        150911 
 5329.00                        TO BRCHCOD   OF FCONCOVSLC-REC                                                                150911 
 5330.00            MOVE SYSAPPCOD  OF WRK-FCONCOV-REC                                                                        150911 
 5331.00                        TO SYSAPPCOD OF FCONCOVSLC-REC                                                                150911 
 5332.00            MOVE CONNBR     OF WRK-FCONCOV-REC                                                                        150911 
 5333.00                        TO CONNBR    OF FCONCOVSLC-REC                                                                150911 
 5334.00            MOVE LOW-VALUES TO LIFNO      OF FCONCOVSLC-REC                                                           150911 
 5335.00            MOVE LOW-VALUES TO COVNO      OF FCONCOVSLC-REC                                                           150911 
 5336.00            MOVE LOW-VALUES TO RSKCOMMDT  OF FCONCOVSLC-REC                                                           150911 
 5337.00                                                                                                                      150910 
 5338.00              START FCONCOVSLC KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                     150911 
 5339.00              READ  FCONCOVSLC NEXT                                                                                   150911 
 5340.00                                                                                                                      150911 
 5341.00              PERFORM UNTIL FCONCOVSLC-STATUS NOT    = STATUS-OK                                                      150911 
 5342.00                OR RUNDT     OF WRK-FCONCOV-REC NOT  =                                                                150911 
 5343.00                RUNDT     OF FCONCOVSLC-REC                                                                           150911 
 5344.00                OR COMPCOD   OF WRK-FCONCOV-REC NOT  =                                                                150911 
 5345.00                COMPCOD   OF FCONCOVSLC-REC                                                                           150911 
 5346.00                OR DSBCHACOD OF WRK-FCONCOV-REC NOT =                                                                 150911 
 5347.00                DSBCHACOD OF FCONCOVSLC-REC                                                                           150911 
 5348.00                OR BRCHCOD   OF WRK-FCONCOV-REC NOT  =                                                                150911 
 5349.00                BRCHCOD   OF FCONCOVSLC-REC                                                                           150911 
 5350.00                OR SYSAPPCOD OF WRK-FCONCOV-REC NOT  =                                                                150911 
 5351.00                SYSAPPCOD OF FCONCOVSLC-REC                                                                           150911 
 5352.00                OR CONNBR    OF WRK-FCONCOV-REC NOT  =                                                                150911 
 5353.00                CONNBR    OF FCONCOVSLC-REC                                                                           150911 
 5354.00                                                                                                                      171019 
 5355.00       *  ROYALTY BONUS   TULB  TopUp Total                                                   171019 
 5356.00       *  ROYALTY BONUS   TULA  TopUp Total   25/4/2017                                       171019 
 5357.00                                                                                                                      171019 
 5358.00                IF COVCOD OF FCONCOVSLC-REC(1:3)  = 'TUL'                                                             171019 
 5359.00                   COMPUTE  WRK-MPTOPUPTUL                                                                            171019 
 5360.00                                    = SGLNETPRM OF FCONCOVSLC-REC                                                     171019 
 5361.00                END-IF                                                                                                171019 
 5362.00                                                                                                                      171018 
 5363.00       *23/8/2017 same logic for TU05,TU06,TU07,TU08,TU09                                                             180507 
 5364.00       *but for TU06,TU08,TU09 foreign top up , for TU05,TU07 greek top up different                                  180507 
 5365.00       *column MPTOPUPTOT_GR                                                                                          170901 
 5366.00                                                                                                                      150911 
 5367.00                IF COVCOD OF FCONCOVSLC-REC(1:3)  = 'TUM'                                                             170808 
 5368.00                OR COVCOD OF FCONCOVSLC-REC(1:3)  = 'TU0'                                                             180507 
 5369.00                                                                                                                      150911 
 5370.00                   MOVE '1' TO WRK-FNDSLICES                                                                          150911 
 5371.00       *     C* ANTI  CP1 ,MPC2,3,4   MPULCOD= TUM1,TUM2,3,4                                        180308 
 5372.00       *    TO    UM EN                                                             150911 
 5373.00       *        FCONCOVSLC  MONO                                                                 150911 
 5374.00                                                                                                                      150914 
 5375.00                   PERFORM SAVETOPUP-NEWB                                                                             150914 
 5376.00                                                                                                                      180514 
 5377.00                   IF  COVCOD OF FCONCOVSLC-REC(1:4) NOT                                                              170901 
 5378.00                                         = 'TU05'                                                                     170901 
 5379.00                   AND COVCOD OF FCONCOVSLC-REC(1:4) NOT                                                              170901 
 5380.00                                         = 'TU06'                                                                     170901 
 5381.00                   AND COVCOD OF FCONCOVSLC-REC(1:4) NOT                                                              180514 
 5382.00                                         = 'TU07'                                                                     180514 
 5383.00                   AND COVCOD OF FCONCOVSLC-REC(1:4) NOT                                                              180514 
 5384.00                                         = 'TU08'                                                                     180514 
 5385.00                   AND COVCOD OF FCONCOVSLC-REC(1:4) NOT                                                              180514 
 5386.00                                         = 'TU09'                                                                     180514 
 5387.00                       MOVE COVCOD OF WRK-FCONCOV-REC                                                                 180514 
 5388.00                                        TO WSAA-BREAK-COVER                                                           180514 
 5389.00                       MOVE 'TUM'       TO WSAA-BREAK-COV3                                                            180514 
 5390.00                       MOVE WSAA-BREAK-COVER                                                                          180514 
 5391.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    180514 
 5392.00                       IF  COVCOD OF FCONCOVSLC-REC(1:4)                                                              180514 
 5393.00                                         = 'TU07'                                                                     180507 
 5394.00                       AND COVCOD OF FCONCOVSLC-REC(1:4)                                                              180514 
 5395.00                                         = 'TU08'                                                                     180507 
 5396.00                       AND COVCOD OF FCONCOVSLC-REC(1:4)                                                              180514 
 5397.00                                         = 'TU09'                                                                     180507 
 5398.00                       MOVE COVCOD OF WRK-FCONCOV-REC                                                                 170824 
 5399.00                                        TO WSAA-BREAK-COVER                                                           170824 
 5400.00                       MOVE 'TU0'       TO WSAA-BREAK-COV3                                                            180507 
 5401.00                       MOVE WSAA-BREAK-COVER                                                                          170824 
 5402.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    170824 
 5403.00                       END-IF                                                                                         180514 
 5404.00       *06/02/2018    TUM4  MPULCOD                                                                180507 
 5405.00                       IF  COVCOD OF WRK-FCONCOV-REC                                                                  180507 
 5406.00                                         = 'MCP3'                                                                     180507 
 5407.00                           MOVE 'TUM1'                                                                                180507 
 5408.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    180507 
 5409.00                       END-IF                                                                                         180507 
 5410.00                       IF  COVCOD OF WRK-FCONCOV-REC                                                                  180507 
 5411.00                                         = 'MCP4'                                                                     180507 
 5412.00                           MOVE 'TUM2'                                                                                180507 
 5413.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    180507 
 5414.00                       END-IF                                                                                         180507 
 5415.00       *24/02/2017 ZHTH  MCG1 NA EMFANIZEI TUM3                                                               170308 
 5416.00                       IF  COVCOD OF WRK-FCONCOV-REC                                                                  170824 
 5417.00                                         = 'MCG1'                                                                     170824 
 5418.00                           MOVE 3       TO WSAA-BREAK-COV4                                                            170824 
 5419.00                           MOVE WSAA-BREAK-COVER                                                                      170824 
 5420.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    170824 
 5421.00                       END-IF                                                                                         170824 
 5422.00                                                                                                                      150911 
 5423.00                   ELSE                                                                                               170901 
 5424.00                       IF   WRK-COVNO    =  ZEROES                                                                    170901 
 5425.00                            MOVE COVCOD OF FCONCOVSLC-REC                                                             170901 
 5426.00                                        TO MPULCOD OF MPMDLPNT-REC                                                    170901 
 5427.00                            MOVE COVNO  OF FCONCOVSLC-REC                                                             170901 
 5428.00                                        TO WRK-COVNO                                                                  170901 
 5429.00                       END-IF                                                                                         170901 
 5430.00                   END-IF                                                                                             170901 
 5431.00                                                                                                                      170913 
 5432.00                END-IF                                                                                                170824 
 5433.00                                                                                                                      161125 
 5434.00                IF  COVCOD OF FCONCOVSLC-REC(1:4)                                                                     171018 
 5435.00                                         = 'TU05'                                                                     171018 
 5436.00                OR  COVCOD OF FCONCOVSLC-REC(1:4)                                                                     180507 
 5437.00                                         = 'TU07'                                                                     180507 
 5438.00                OR  COVCOD OF FCONCOVSLC-REC(1:4)                                                                     180530 
 5439.00                                         = 'TU08'                                                                     180530 
 5440.00                    PERFORM CALCULATE-TOPUP-PY-GR                                                                     171018 
 5441.00                    MOVE '1' TO WRK-FNDTUM                                                                            171019 
 5442.00                END-IF                                                                                                171018 
 5443.00                                                                                                                      171019 
 5444.00                IF COVCOD OF FCONCOVSLC-REC(1:3)  = 'TUM'                                                             171019 
 5445.00                OR COVCOD OF FCONCOVSLC-REC(1:3)  = 'TU0'                                                             180507 
 5446.00                   PERFORM CALCULATE-TOPUP-PY                                                                         171019 
 5447.00                   MOVE '1' TO WRK-FNDTUM                                                                             171019 
 5448.00                END-IF                                                                                                171019 
 5449.00                                                                                                                      171019 
 5450.00                IF WRK-FNDTUM            = SPACES                                                                     171019 
 5451.00                   COMPUTE  WRK-MPTOPUPTOT        =                                                                   171019 
 5452.00                                                  +                                                                   171019 
 5453.00                                   WRK-MPTOPUPTUL                                                                     171019 
 5454.00                END-IF                                                                                                171019 
 5455.00                                                                                                                      150911 
 5456.00              READ FCONCOVSLC  NEXT                                                                                   150911 
 5457.00                                                                                                                      150911 
 5458.00              END-PERFORM                                                                                             150911 
 5459.00            .                                                                                                         150910 
 5460.00         END-CHECK-EXSLICES.                                                                                          150910 
 5461.00            EXIT.                                                                                                     150910 
 5462.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5463.00         SAVETOPUP-NEWB     SECTION.                                                                                  150911 
 5464.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5465.00       *           NEW BUSINESS                                       150911 
 5466.00            ADD 1 TO WSAA-IND                                                                                         150915 
 5467.00                                                                                                                      150915 
 5468.00            MOVE RUNDT      OF FCONCOVSLC-REC TO WSAA-RUNDT(WSAA-IND)                                                 150911 
 5469.00            MOVE COMPCOD    OF FCONCOVSLC-REC TO WSAA-COMPCOD(WSAA-IND)                                               150911 
 5470.00            MOVE DSBCHACOD  OF FCONCOVSLC-REC TO WSAA-DSBCHACOD(WSAA-IND)                                             150911 
 5471.00            MOVE BRCHCOD    OF FCONCOVSLC-REC TO WSAA-BRCHCOD(WSAA-IND)                                               150911 
 5472.00            MOVE SYSAPPCOD  OF FCONCOVSLC-REC TO WSAA-SYSAPPCOD(WSAA-IND)                                             150911 
 5473.00            MOVE CONNBR     OF FCONCOVSLC-REC TO WSAA-CONNBR(WSAA-IND)                                                150911 
 5474.00            MOVE LIFNO      OF FCONCOVSLC-REC TO WSAA-LIFNO(WSAA-IND)                                                 150911 
 5475.00            MOVE COVNO      OF FCONCOVSLC-REC TO WSAA-COVNO(WSAA-IND)                                                 150911 
 5476.00            MOVE COVCOD     OF FCONCOVSLC-REC TO WSAA-COVCOD(WSAA-IND)                                                150911 
 5477.00            MOVE STSCOD     OF FCONCOVSLC-REC TO WSAA-STSCOD(WSAA-IND)                                                150911 
 5478.00            MOVE STSDT      OF FCONCOVSLC-REC TO WSAA-STSDT(WSAA-IND)                                                 150911 
 5479.00            MOVE RSKCOMMDT  OF FCONCOVSLC-REC TO WSAA-RSKCOMMDT(WSAA-IND)                                             150911 
 5480.00                                                                                                                      171019 
 5481.00            MOVE '0' TO WRK-CHECKSLC-DATE                                                                             171023 
 5482.00            PERFORM CHECK-DATE-TERM                                                                                   171023 
 5483.00            IF  WRK-CHECKSLC-DATE          = '1'                                                                      171023 
 5484.00            AND COVCOD   OF FCONCOVSLC-REC(1:2)                                                                       171020 
 5485.00                                           = 'TU'                                                                     171020 
 5486.00               MOVE '1' TO WRK-NEW-TOPUP                                                                              171019 
 5487.00               PERFORM SAVE-TOPUP-GREATER-DATE                                                                        171019 
 5488.00            END-IF                                                                                                    171019 
 5489.00                                                                                                                      171019 
 5490.00            MOVE RSKCESSDT  OF FCONCOVSLC-REC TO WSAA-RSKCESSDT(WSAA-IND)                                             150911 
 5491.00            MOVE PRMCESSDT  OF FCONCOVSLC-REC TO WSAA-PRMCESSDT(WSAA-IND)                                             150911 
 5492.00            MOVE BENCESSDT  OF FCONCOVSLC-REC TO WSAA-BENCESSDT(WSAA-IND)                                             150911 
 5493.00            MOVE PRCAGE     OF FCONCOVSLC-REC TO WSAA-PRCAGE(WSAA-IND)                                                150911 
 5494.00            MOVE RSKCOMMAGE OF FCONCOVSLC-REC TO                                                                      150911 
 5495.00                                               WSAA-RSKCOMMAGE(WSAA-IND)                                              150911 
 5496.00            MOVE RSKCESSAGE OF FCONCOVSLC-REC TO                                                                      150911 
 5497.00                                               WSAA-RSKCESSAGE(WSAA-IND)                                              150911 
 5498.00            MOVE RSKCESSTRM OF FCONCOVSLC-REC TO                                                                      150911 
 5499.00                                               WSAA-RSKCESSTRM(WSAA-IND)                                              150911 
 5500.00            MOVE COVYEARNO  OF FCONCOVSLC-REC TO WSAA-COVYEARNO(WSAA-IND)                                             150911 
 5501.00            MOVE CONCESSAGE OF FCONCOVSLC-REC TO                                                                      150911 
 5502.00                                               WSAA-CONCESSAGE(WSAA-IND)                                              150911 
 5503.00            MOVE SUMINSAMT  OF FCONCOVSLC-REC TO                                                                      150911 
 5504.00                                               WSAA-SUMINSAMT(WSAA-IND)                                               150911 
 5505.00            MOVE ANNNETPRM  OF FCONCOVSLC-REC TO                                                                      150911 
 5506.00                                               WSAA-ANNNETPRM(WSAA-IND)                                               150911 
 5507.00            MOVE INIANETPRM OF FCONCOVSLC-REC TO                                                                      160115 
 5508.00                                               WSAA-INIANETPRM(WSAA-IND)                                              160115 
 5509.00            MOVE SGLNETPRM  OF FCONCOVSLC-REC TO                                                                      150911 
 5510.00                                               WSAA-SGLNETPRM(WSAA-IND)                                               150911 
 5511.00            MOVE ISTNETPRM  OF FCONCOVSLC-REC TO                                                                      150911 
 5512.00                                               WSAA-ISTNETPRM(WSAA-IND)                                               150911 
 5513.00            MOVE ININETPRM  OF FCONCOVSLC-REC TO                                                                      160115 
 5514.00                                               WSAA-ININETPRM(WSAA-IND)                                               160115 
 5515.00            MOVE ISTGRSPRM  OF FCONCOVSLC-REC TO                                                                      150911 
 5516.00                                               WSAA-ISTGRSPRM(WSAA-IND)                                               150911 
 5517.00                                                                                                                      150911 
 5518.00            MOVE CLNTORGCOD OF FCONCOVSLC-REC TO                                                                      150911 
 5519.00                                              WSAA-CLNTORGCOD(WSAA-IND)                                               150911 
 5520.00            MOVE CAMPCOD    OF FCONCOVSLC-REC TO WSAA-CAMPCOD(WSAA-IND)                                               150911 
 5521.00            MOVE DIVAMT     OF FCONCOVSLC-REC TO WSAA-DIVAMT(WSAA-IND)                                                150911 
 5522.00            MOVE LOANOUTAMT OF FCONCOVSLC-REC TO                                                                      150911 
 5523.00                                              WSAA-LOANOUTAMT(WSAA-IND)                                               150911 
 5524.00            MOVE NINVAMT    OF FCONCOVSLC-REC TO                                                                      150914 
 5525.00                                              WSAA-NINVAMT(WSAA-IND)                                                  150914 
 5526.00            MOVE CLNTCODL4 OF FCONLIF-REC(1:8) TO                                                                     171004 
 5527.00                                              WSAA-CLNTCODL4(WSAA-IND)                                                171003 
 5528.00            IF SYSAPPCOD OF FCONLIF-REC     = '02'                                                                    171004 
 5529.00            MOVE CLNTCOD OF FCONLIF-REC(1:8)   TO                                                                     171005 
 5530.00                                              WSAA-CLNTCODL4(WSAA-IND)                                                171004 
 5531.00            END-IF                                                                                                    171004 
 5532.00            .                                                                                                         150911 
 5533.00         END-SAVETOPUP-NEWB.                                                                                          150911 
 5534.00            EXIT.                                                                                                     150911 
 5535.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5536.00         CALCULATE-TOPUP-PY  SECTION.                                                                                 150914 
 5537.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5538.00       *   C    UM                                                                      150911 
 5539.00            IF COVYEARNO OF FCONCOVSLC-REC = 01                                                                       180320 
 5540.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5541.00                   COMPUTE  WRK-MPTOPUPY1   =                                                                         170929 
 5542.00                                  WRK-MPTOPUPY1             +                                                         170929 
 5543.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5544.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5545.00               ELSE                                                                                                   170929 
 5546.00                   COMPUTE  WRK-MPTOPUPY1   =                                                                         170929 
 5547.00                                   WRK-MPTOPUPY1             +                                                        150911 
 5548.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5549.00               END-IF                                                                                                 170929 
 5550.00            END-IF                                                                                                    150911 
 5551.00                                                                                                                      150911 
 5552.00            IF COVYEARNO OF FCONCOVSLC-REC = 2                                                                        150916 
 5553.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5554.00                   COMPUTE  WRK-MPTOPUPY2   =                                                                         170929 
 5555.00                                  WRK-MPTOPUPY2             +                                                         170929 
 5556.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5557.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5558.00               ELSE                                                                                                   170929 
 5559.00                   COMPUTE  WRK-MPTOPUPY2   =                                                                         170929 
 5560.00                                   WRK-MPTOPUPY2             +                                                        150911 
 5561.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5562.00               END-IF                                                                                                 170929 
 5563.00            END-IF                                                                                                    150911 
 5564.00                                                                                                                      150911 
 5565.00            IF COVYEARNO OF FCONCOVSLC-REC = 3                                                                        150916 
 5566.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5567.00                   COMPUTE  WRK-MPTOPUPY3   =                                                                         170929 
 5568.00                                  WRK-MPTOPUPY3             +                                                         170929 
 5569.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5570.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5571.00               ELSE                                                                                                   170929 
 5572.00                   COMPUTE  WRK-MPTOPUPY3   =                                                                         170929 
 5573.00                                   WRK-MPTOPUPY3             +                                                        150911 
 5574.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5575.00               END-IF                                                                                                 170929 
 5576.00            END-IF                                                                                                    150911 
 5577.00                                                                                                                      150911 
 5578.00            IF COVYEARNO OF FCONCOVSLC-REC = 4                                                                        150916 
 5579.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5580.00                   COMPUTE  WRK-MPTOPUPY4   =                                                                         170929 
 5581.00                                  WRK-MPTOPUPY4             +                                                         170929 
 5582.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5583.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5584.00               ELSE                                                                                                   170929 
 5585.00                   COMPUTE  WRK-MPTOPUPY4   =                                                                         170929 
 5586.00                                   WRK-MPTOPUPY4             +                                                        150911 
 5587.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5588.00               END-IF                                                                                                 170929 
 5589.00            END-IF                                                                                                    150911 
 5590.00                                                                                                                      150911 
 5591.00            IF COVYEARNO OF FCONCOVSLC-REC = 5                                                                        150916 
 5592.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5593.00                   COMPUTE  WRK-MPTOPUPY5   =                                                                         170929 
 5594.00                                  WRK-MPTOPUPY5             +                                                         170929 
 5595.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5596.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5597.00               ELSE                                                                                                   170929 
 5598.00                    COMPUTE  WRK-MPTOPUPY5   =                                                                        170929 
 5599.00                                   WRK-MPTOPUPY5             +                                                        150911 
 5600.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5601.00               END-IF                                                                                                 170929 
 5602.00            END-IF                                                                                                    150911 
 5603.00                                                                                                                      150911 
 5604.00            IF COVYEARNO OF FCONCOVSLC-REC > 5                                                                        150916 
 5605.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) = 'TU0'                                                              180507 
 5606.00                   COMPUTE  WRK-MPTOPUP6PLUS =                                                                        170929 
 5607.00                                  WRK-MPTOPUP6PLUS         +                                                          170929 
 5608.00                                  SGLNETPRM OF FCONCOVSLC-REC -                                                       170929 
 5609.00                                  NINVAMT   OF FCONCOVSLC-REC                                                         170929 
 5610.00               ELSE                                                                                                   170929 
 5611.00                   COMPUTE  WRK-MPTOPUP6PLUS =                                                                        170929 
 5612.00                                   WRK-MPTOPUP6PLUS         +                                                         150914 
 5613.00                                   SGLNETPRM OF FCONCOVSLC-REC                                                        150911 
 5614.00               END-IF                                                                                                 170929 
 5615.00            END-IF                                                                                                    150911 
 5616.00                                                                                                                      150911 
 5617.00            COMPUTE  WRK-MPTOPUPY1  =                                                                                 150914 
 5618.00                                   WRK-MPTOPUPY1             +                                                        150914 
 5619.00                                   MPTOPUPY1 OF MPMDLPNT-REC                                                          150914 
 5620.00            COMPUTE  WRK-MPTOPUPY2  =                                                                                 150914 
 5621.00                                   WRK-MPTOPUPY2             +                                                        150914 
 5622.00                                   MPTOPUPY2 OF MPMDLPNT-REC                                                          150914 
 5623.00            COMPUTE  WRK-MPTOPUPY3  =                                                                                 150911 
 5624.00                                   WRK-MPTOPUPY3             +                                                        150911 
 5625.00                                   MPTOPUPY3 OF MPMDLPNT-REC                                                          150911 
 5626.00            COMPUTE  WRK-MPTOPUPY4  =                                                                                 150911 
 5627.00                                   WRK-MPTOPUPY4             +                                                        150911 
 5628.00                                   MPTOPUPY4 OF MPMDLPNT-REC                                                          150911 
 5629.00            COMPUTE  WRK-MPTOPUPY5  =                                                                                 150911 
 5630.00                                   WRK-MPTOPUPY5             +                                                        150911 
 5631.00                                   MPTOPUPY5 OF MPMDLPNT-REC                                                          150911 
 5632.00                                                                                                                      150911 
 5633.00            COMPUTE  WRK-MPTOPUPTOT =                                                                                 150911 
 5634.00                                   WRK-MPTOPUPTUL +                                                                   170505 
 5635.00                                   WRK-MPTOPUPY1  +                                                                   170502 
 5636.00                                   WRK-MPTOPUPY2  +                                                                   150911 
 5637.00                                   WRK-MPTOPUPY3  +                                                                   150911 
 5638.00                                   WRK-MPTOPUPY4  +                                                                   150911 
 5639.00                                   WRK-MPTOPUPY5  +                                                                   150911 
 5640.00                                   WRK-MPTOPUP6PLUS                                                                   150911 
 5641.00                                                                                                                      150911 
 5642.00               IF  COVCOD OF FCONCOVSLC-REC(1:3) NOT = 'TU0'                                                          180507 
 5643.00                                                                                                                      171106 
 5644.00                 COMPUTE WRK-MPNOTINV                =                                                                171106 
 5645.00                            WRK-MPNOTINV             +                                                                171106 
 5646.00                            NINVAMT   OF FCONCOVSLC-REC                                                               171106 
 5647.00               END-IF                                                                                                 171106 
 5648.00                                                                                                                      150911 
 5649.00            .                                                                                                         150911 
 5650.00         END-CALCULATE-TOPUP-PY.                                                                                      150911 
 5651.00            EXIT.                                                                                                     150911 
 5652.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5653.00         CALCULATE-TOPUP-PY-GR  SECTION.                                                                              170901 
 5654.00       *------------------------------------------------------------------------------------------------------------- 170901 
 5655.00       *   C    UM                                                                      170901 
 5656.00            IF COVYEARNO OF FCONCOVSLC-REC = 01                                                                       180320 
 5657.00            COMPUTE  WRK-MPTOPUPY1GR =                                                                                170901 
 5658.00                                   WRK-MPTOPUPY1GR           +                                                        170901 
 5659.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5660.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5661.00            END-IF                                                                                                    170901 
 5662.00                                                                                                                      170901 
 5663.00            IF COVYEARNO OF FCONCOVSLC-REC = 2                                                                        170901 
 5664.00            COMPUTE  WRK-MPTOPUPY2GR =                                                                                170901 
 5665.00                                   WRK-MPTOPUPY2GR           +                                                        170901 
 5666.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5667.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5668.00            END-IF                                                                                                    170901 
 5669.00                                                                                                                      170901 
 5670.00            IF COVYEARNO OF FCONCOVSLC-REC = 3                                                                        170901 
 5671.00            COMPUTE  WRK-MPTOPUPY3GR =                                                                                170901 
 5672.00                                   WRK-MPTOPUPY3GR           +                                                        170901 
 5673.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5674.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5675.00            END-IF                                                                                                    170901 
 5676.00                                                                                                                      170901 
 5677.00            IF COVYEARNO OF FCONCOVSLC-REC = 4                                                                        170901 
 5678.00            COMPUTE  WRK-MPTOPUPY4GR =                                                                                170901 
 5679.00                                   WRK-MPTOPUPY4GR           +                                                        170901 
 5680.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5681.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5682.00            END-IF                                                                                                    170901 
 5683.00                                                                                                                      170901 
 5684.00            IF COVYEARNO OF FCONCOVSLC-REC = 5                                                                        170901 
 5685.00            COMPUTE  WRK-MPTOPUPY5GR =                                                                                170901 
 5686.00                                   WRK-MPTOPUPY5GR           +                                                        170901 
 5687.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5688.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5689.00            END-IF                                                                                                    170901 
 5690.00                                                                                                                      170901 
 5691.00            IF COVYEARNO OF FCONCOVSLC-REC > 5                                                                        170901 
 5692.00            COMPUTE  WRK-MPTOPUP6PLUSGR                                                                               170901 
 5693.00                                    =                                                                                 170901 
 5694.00                                   WRK-MPTOPUP6PLUSGR       +                                                         170901 
 5695.00                                   SGLNETPRM OF FCONCOVSLC-REC -                                                      170921 
 5696.00                                   NINVAMT   OF FCONCOVSLC-REC                                                        170921 
 5697.00            END-IF                                                                                                    170901 
 5698.00                                                                                                                      170901 
 5699.00            COMPUTE  WRK-MPTOPUPY1GR  =                                                                               170901 
 5700.00                                   WRK-MPTOPUPY1GR          +                                                         170901 
 5701.00                                   MPTOPUPY1 OF MPMDLPNT-REC                                                          170901 
 5702.00            COMPUTE  WRK-MPTOPUPY2GR  =                                                                               170901 
 5703.00                                   WRK-MPTOPUPY2GR          +                                                         170901 
 5704.00                                   MPTOPUPY2 OF MPMDLPNT-REC                                                          170901 
 5705.00            COMPUTE  WRK-MPTOPUPY3GR  =                                                                               170901 
 5706.00                                   WRK-MPTOPUPY3GR          +                                                         170901 
 5707.00                                   MPTOPUPY3 OF MPMDLPNT-REC                                                          170901 
 5708.00            COMPUTE  WRK-MPTOPUPY4GR  =                                                                               170901 
 5709.00                                   WRK-MPTOPUPY4GR          +                                                         170901 
 5710.00                                   MPTOPUPY4 OF MPMDLPNT-REC                                                          170901 
 5711.00            COMPUTE  WRK-MPTOPUPY5GR  =                                                                               170901 
 5712.00                                   WRK-MPTOPUPY5GR          +                                                         170901 
 5713.00                                   MPTOPUPY5 OF MPMDLPNT-REC                                                          170901 
 5714.00                                                                                                                      170901 
 5715.00            COMPUTE  WRK-MPTOPUPTOTGR                                                                                 170901 
 5716.00                                    =                                                                                 170901 
 5717.00                                   WRK-MPTOPUPY1GR  +                                                                 170901 
 5718.00                                   WRK-MPTOPUPY2GR  +                                                                 170901 
 5719.00                                   WRK-MPTOPUPY3GR  +                                                                 170901 
 5720.00                                   WRK-MPTOPUPY4GR  +                                                                 170901 
 5721.00                                   WRK-MPTOPUPY5GR  +                                                                 170901 
 5722.00                                   WRK-MPTOPUP6PLUSGR                                                                 170901 
 5723.00                                                                                                                      170901 
 5724.00            .                                                                                                         170901 
 5725.00         END-CALCULATE-TOPUP-PY-GR.                                                                                   170901 
 5726.00            EXIT.                                                                                                     170901 
 5727.00       *------------------------------------------------------------------------------------------------------------- 170901 
 5728.00         PROCESS-NPFORTUM SECTION.                                                                                    150911 
 5729.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5730.00       *      TUM1,TUM2,3,4 TOTE       AK                            180308 
 5731.00       *    FCONCOVSLC AI                                                                                  180308 
 5732.00       *       WSAA-TOPUP, MPMDLPNTNP.                                                           150911 
 5733.00       *    MONO AN EINAI TOP-UP 1 XRONOY  NEW PRODUCTION.                                                 150911 
 5734.00       *    WRK-FNDSLICES=1 EXEI    FCONCOVSLC                                                         150911 
 5735.00       ***  Change 4/01/2018 coyearno of fconcovslc must be 1.                                                        180104 
 5736.00       ***  IF COVYEARNO OF WRK-FCONCOV-REC = 1                                                                       180104 
 5737.00            IF                WRK-FNDSLICES = 1                                                                       180104 
 5738.00               PERFORM WRITE-TOPUP                                                                                    150911 
 5739.00            END-IF                                                                                                    150911 
 5740.00            .                                                                                                         150911 
 5741.00         END-PROCESS-NPFORTUM.                                                                                        150911 
 5742.00            EXIT.                                                                                                     150911 
 5743.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5744.00         WRITE-TOPUP   SECTION.                                                                                       150911 
 5745.00       *------------------------------------------------------------------------------------------------------------- 150911 
 5746.00       *        FCONCOVSLC KI ENHM  PMDLPNTNP                      150911 
 5747.00       * ME *                                                                               150915 
 5748.00                                                                                                                      180320 
 5749.00            INITIALIZE WRK-MPTOPUPTOTNP                                                                               180320 
 5750.00                                                                                                                      150911 
 5751.00            MOVE '99' TO WRK-FOUND-ZAPE                                                                               171003 
 5752.00                                                                                                                      171003 
 5753.00            PERFORM VARYING WSAA-IND  FROM 1 BY 1                                                                     150911 
 5754.00               UNTIL WSAA-IND              > 99                                                                       150911 
 5755.00               OR  WSAA-CONNBR(WSAA-IND)                                                                              150911 
 5756.00                                          = SPACES                                                                    150911 
 5757.00                                                                                                                      150911 
 5758.00       * change 29/12/2017 if rskcommdt in the same month with the rundate                                            171229 
 5759.00       * change 26/3/2018                                                                                             180326 
 5760.00       ***  IF  WSAA-RSKCOMMDT(WSAA-IND)                                                                              180326 
 5761.00       ***                                >= WRK-CURRENTAPO                                                           180326 
 5762.00       ***  AND WSAA-RSKCOMMDT(WSAA-IND)                                                                              180326 
 5763.00       ***                                <= WRK-CURRENTEOS                                                           180326 
 5764.00       ***RSKCOMMDT must be in the month that we run                                                                  180327 
 5765.00            IF  WRKEFFZ-YEAR               = WRK-RUNY                                                                 180326 
 5766.00            AND WRKEFFZ-MONTH              = WRK-RUNM                                                                 171229 
 5767.00            AND WSAA-RSKCOMMDT(WSAA-IND)                                                                              180327 
 5768.00                                          >= WRK-FIRSTRUNDATE                                                         180327 
 5769.00            AND WSAA-RSKCOMMDT(WSAA-IND)                                                                              180327 
 5770.00                                          <= WRK-RUNDT                                                                180327 
 5771.00            AND WSAA-COVYEARNO(WSAA-IND)                                                                              180104 
 5772.00                                           = 1                                                                        180104 
 5773.00       *    MPISSYEAR                                                                                                 150911 
 5774.00                 MOVE WSAA-RSKCOMMDT(WSAA-IND)                                                                        171229 
 5775.00                                   TO WRK-DATE9                                                                       171229 
 5776.00                 MOVE WRK9DAY      TO MPINCPDAY  OF MPMDLPNTNP-REC                                                    150911 
 5777.00                 MOVE WRK9MONTH    TO MPINCPMON  OF MPMDLPNTNP-REC                                                    150911 
 5778.00                 MOVE WRK9YEAR     TO MPINCPYEAR OF MPMDLPNTNP-REC                                                    150911 
 5779.00                 MOVE WSAA-RSKCOMMAGE(WSAA-IND)                                                                       150914 
 5780.00                                   TO MPAGEENTR  OF MPMDLPNTNP-REC                                                    171229 
 5781.00                 COMPUTE  MPSPCOD  OF MPMDLPNTNP-REC =                                                                171229 
 5782.00                      MPINCPMON OF MPMDLPNTNP-REC + 50                                                                171229 
 5783.00       *MPSEXCOD                                                                                                      150911 
 5784.00       *MPCOVTRM                                                                                                      150911 
 5785.00       *MPMAINTRM                                                                                                     150911 
 5786.00       *MPPRMTRM                                                                                                      150911 
 5787.00       *MPEXTTRM                                                                                                      150911 
 5788.00       *MPPAIDUPY                                                                                                     150911 
 5789.00       *MPSTSDAY                                                                                                      150911 
 5790.00       *MPSTSMON                                                                                                      150911 
 5791.00       *MPSTSYEAR                                                                                                     150911 
 5792.00                 MOVE WSAA-SUMINSAMT(WSAA-IND)                                                                        150911 
 5793.00                                   TO MPSUMINS OF MPMDLPNTNP-REC                                                      171229 
 5794.00       *MPANNPRM                                                                                                      150911 
 5795.00                 MOVE WSAA-SGLNETPRM(WSAA-IND)                                                                        150911 
 5796.00                                   TO MPSGLPRM OF MPMDLPNTNP-REC                                                      171229 
 5797.00                 MOVE 1            TO MPPOLNO  OF MPMDLPNTNP-REC                                                      150911 
 5798.00                 MOVE MPINCPMON OF MPMDLPNTNP-REC                                                                     150917 
 5799.00                                   TO MPSALMON OF MPMDLPNTNP-REC                                                      171229 
 5800.00       ****      MOVE WSAA-DIVAMT(WSAA-IND)                                                                           180129 
 5801.00       ****                        TO MPDIVAMT OF MPMDLPNTNP-REC                                                      180129 
 5802.00       ****      29.1.2018                                                                                            180129 
 5803.00                 MOVE ZEROES       TO MPDIVAMT OF MPMDLPNTNP-REC                                                      180129 
 5804.00                 MOVE WSAA-CONNBR(WSAA-IND)                                                                           150911 
 5805.00                                   TO WRK-M1FPOLNUM                                                                   171229 
 5806.00                 MOVE WRK-M1FPOLNUM                                                                                   171229 
 5807.00                                   TO WRK-MPFPOLNUM                                                                   171229 
 5808.00                 MOVE WRK-MPFPOLNUM                                                                                   150914 
 5809.00                                   TO MPFPOLNUM OF MPMDLPNTNP-REC                                                     171229 
 5810.00                 MOVE WSAA-LOANOUTAMT(WSAA-IND)                                                                       150911 
 5811.00                                   TO MPLOANAMT OF MPMDLPNTNP-REC                                                     171229 
 5812.00                 MOVE WSAA-COVCOD(WSAA-IND)                                                                           150911 
 5813.00                                   TO MPULCOD   OF MPMDLPNTNP-REC                                                     171229 
 5814.00       *MPCLNTCOD                                                                                                     150911 
 5815.00                 INITIALIZE MPSTATUSR OF  MPSTATUS-REC                                                                171229 
 5816.00                                                                                                                      150916 
 5817.00                 MOVE WSAA-STSCOD(WSAA-IND) TO STSCOD OF MPSTATUS-REC                                                 171229 
 5818.00                 READ MPSTATUS                                                                                        171229 
 5819.00                 IF MPSTATUS-STATUS = FOUND-REC                                                                       171229 
 5820.00                    MOVE MPSTSCOD OF MPSTATUS-REC                                                                     171229 
 5821.00                                   TO MPSTSCOD OF MPMDLPNTNP-REC                                                      171229 
 5822.00                 END-IF                                                                                               171229 
 5823.00                                                                                                                      150916 
 5824.00       *MPFILFLD                                                                                                      150911 
 5825.00       *MPPRDGRP                                                                                                      171020 
 5826.00                 IF COVCOD  OF WRK-FCONCOV-REC(1:4) = 'TUM2'                                                          171229 
 5827.00                    MOVE 1         TO MPAUTINCPC OF MPMDLPNTNP-REC                                                    171229 
 5828.00                 END-IF                                                                                               180308 
 5829.00                 IF  COVCOD  OF WRK-FCONCOV-REC(1:2)     = 'TU'                                                       180308 
 5830.00                 AND COVCOD  OF WRK-FCONCOV-REC(1:3) NOT = 'TU0'                                                      180507 
 5831.00                     MOVE 'MCPPI_TA'                                                                                  180308 
 5832.00                                   TO MPPRDGRP   OF MPMDLPNTNP-REC                                                    171229 
 5833.00                 END-IF                                                                                               180308 
 5834.00                 IF  COVCOD  OF WRK-FCONCOV-REC(1:4)     = 'TU05'                                                     180531 
 5835.00                 OR  COVCOD  OF WRK-FCONCOV-REC(1:4)     = 'TU06'                                                     180531 
 5836.00                     MOVE 'UL_Regular'                                                                                180313 
 5837.00                                   TO MPPRDGRP   OF MPMDLPNTNP-REC                                                    180313 
 5838.00                     MOVE 0                                                                                           180313 
 5839.00                                   TO MPIMPMLP   OF MPMDLPNTNP-REC                                                    180313 
 5840.00                 END-IF                                                                                               180313 
 5841.00                                                                                                                      180531 
 5842.00                 IF  COVCOD  OF WRK-FCONCOV-REC(1:4)     = 'TU07'                                                     180531 
 5843.00                 OR  COVCOD  OF WRK-FCONCOV-REC(1:4)     = 'TU08'                                                     180531 
 5844.00                 OR  COVCOD  OF WRK-FCONCOV-REC(1:4)     = 'TU09'                                                     180531 
 5845.00                     MOVE 'UL_Regular_BA'                                                                             180531 
 5846.00                                   TO MPPRDGRP   OF MPMDLPNTNP-REC                                                    180531 
 5847.00                     MOVE 0                                                                                           180531 
 5848.00                                   TO MPIMPMLP   OF MPMDLPNTNP-REC                                                    180531 
 5849.00                 END-IF                                                                                               180531 
 5850.00       *MPAAHCOD                                                                                                      150911 
 5851.00       *MPAAHROOM                                                                                                     150911 
 5852.00       *MPDEDUCT                                                                                                      150911 
 5853.00       *MPCOINS                                                                                                       150911 
 5854.00       *MPUNINBR                                                                                                      150911 
 5855.00       *MPUNIPRC                                                                                                      150911 
 5856.00       *MPPAYMETH                                                                                                     150911 
 5857.00       *MPWOPAGE                                                                                                      150911 
 5858.00       *MPWOPSEX                                                                                                      150911 
 5859.00                 MOVE WSAA-RSKCOMMAGE(WSAA-IND)                                                                       150911 
 5860.00                                   TO MPAGERDF  OF MPMDLPNTNP-REC                                                     171229 
 5861.00                 MOVE "TA_0000"    TO MPDSBCHA   OF MPMDLPNT-REC                                                      171229 
 5862.00                                                                                                                      190220 
 5863.00       *    it is refactored into NEW BUSINESS writing routine WRITE-NEWBUS-REC.                                      190220 
 5864.00       ****      COMPUTE WRRN = WRRN + 1                                                                              190220 
 5865.00       ****      MOVE WRRN         TO MPCMPIDF  OF MPMDLPNTNP-REC                                                     190220 
 5866.00                                                                                                                      190220 
 5867.00                 MOVE WSAA-CLNTORGCOD(WSAA-IND)                                                                       150911 
 5868.00                                   TO MPCLNTORG OF MPMDLPNTNP-REC                                                     171229 
 5869.00       *MPCOMMFLG                                                                                                     150911 
 5870.00       *MPIMPMLP                                                                                                      150911 
 5871.00                 MOVE WRK-NPMPIMPMLP                                                                                  171023 
 5872.00                                   TO MPIMPMLP OF MPMDLPNTNP-REC                                                      171229 
 5873.00       *MPBNDFLR                                                                                                      150911 
 5874.00       *MPNOTINV                                                                                                      150911 
 5875.00                 MOVE  WSAA-NINVAMT(WSAA-IND)                                                                         170718 
 5876.00                                   TO MPNOTINV   OF MPMDLPNTNP-REC                                                    171229 
 5877.00       *MPPROTAMT                                                                                                     170908 
 5878.00                 IF  COVCOD OF WRK-FCONCOV-REC(1:2)                                                                   180515 
 5879.00                                         =  'UR'                                                                      180515 
 5880.00                 OR  COVCOD OF WRK-FCONCOV-REC(1:3)                                                                   180507 
 5881.00                                         =  'TU0'                                                                     180507 
 5882.00                     MOVE ZEROES   TO MPPROTAMT OF MPMDLPNTNP-REC                                                     171229 
 5883.00                     MOVE ZEROES   TO MPNOTINV  OF MPMDLPNTNP-REC                                                     171229 
 5884.00                 END-IF                                                                                               170908 
 5885.00                 MOVE 1         TO MPAVIDXDTA OF MPMDLPNTNP-REC                                                       150911 
 5886.00       *    1                                                               150911 
 5887.00                 MOVE WSAA-SGLNETPRM(WSAA-IND)                                                                        171023 
 5888.00                                TO MPTOPUPY1  OF MPMDLPNTNP-REC                                                       171023 
 5889.00       ****      MOVE WSAA-SGLNETPRM(WSAA-IND)                                                                        180320 
 5890.00       ****                     TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                       180320 
 5891.00                 IF WSAA-COVYEARNO(WSAA-IND)     = 1                                                                  180320 
 5892.00                    IF  WSAA-COVCOD(WSAA-IND)(1:3)                                                                    180507 
 5893.00                                                 = 'TU0'                                                              180507 
 5894.00                        COMPUTE  MPTOPUPY1 OF MPMDLPNTNP-REC                                                          171229 
 5895.00                                                 =                                                                    171229 
 5896.00                                  WSAA-SGLNETPRM(WSAA-IND)                                                            171023 
 5897.00                                               -                                                                      171023 
 5898.00                                  WSAA-NINVAMT(WSAA-IND)                                                              171023 
 5899.00                    END-IF                                                                                            171229 
 5900.00                 END-IF                                                                                               171229 
 5901.00                                                                                                                      171023 
 5902.00                 IF WSAA-COVCOD(WSAA-IND) = 'TU06'                                                                    180320 
 5903.00                 OR WSAA-COVCOD(WSAA-IND) = 'TU09'                                                                    180601 
 5904.00                    MOVE MPTOPUPY1 OF MPMDLPNTNP-REC                                                                  171229 
 5905.00                                TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                       171229 
 5906.00                    MOVE ZEROES TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                       171229 
 5907.00                 END-IF                                                                                               171229 
 5908.00                                                                                                                      171023 
 5909.00                 IF WSAA-COVCOD(WSAA-IND) = 'TU05'                                                                    171229 
 5910.00                 OR WSAA-COVCOD(WSAA-IND) = 'TU07'                                                                    180507 
 5911.00                 OR WSAA-COVCOD(WSAA-IND) = 'TU08'                                                                    180601 
 5912.00                    MOVE MPTOPUPY1 OF MPMDLPNTNP-REC                                                                  171229 
 5913.00                                TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                       171229 
 5914.00                    MOVE ZEROES TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                       171229 
 5915.00                 END-IF                                                                                               171229 
 5916.00                                                                                                                      150911 
 5917.00            COMPUTE  MPTOPUPTOT OF MPMDLPNTNP-REC =                                                                   180320 
 5918.00                                   MPTOPUPY1  OF MPMDLPNTNP-REC  +                                                    180320 
 5919.00                                   MPTOPUPY2  OF MPMDLPNTNP-REC  +                                                    180320 
 5920.00                                   MPTOPUPY3  OF MPMDLPNTNP-REC  +                                                    180320 
 5921.00                                   MPTOPUPY4  OF MPMDLPNTNP-REC  +                                                    180320 
 5922.00                                   MPTOPUPY5  OF MPMDLPNTNP-REC                                                       180320 
 5923.00                                                                                                                      180320 
 5924.00       *****     From 01/01/2018 new coverages MCP2,MCP4                                                              180308 
 5925.00       *****     IF WSAA-COVCOD(WSAA-IND) = 'TUM1'                                                                    180308 
 5926.00       *****        MOVE 'MCP1'                                                                                       180308 
 5927.00       *****                    TO MPFILFLD OF MPMDLPNTNP-REC                                                         180308 
 5928.00       *****    29.01.2018 if it has rskcommdt <=20171231 then it's                                                   180308 
 5929.00       *****    MCP1 or MCP2                                                                                          180308 
 5930.00       *****    else it's MCP3 for TUM1  and MCP4 for TUM2                                                            180308 
 5931.00                 IF   WSAA-COVCOD(WSAA-IND)     = 'TUM1'                                                              180308 
 5932.00       *****     AND  WSAA-RSKCOMMDT(WSAA-IND) <= 20171231                                                            180326 
 5933.00       *****     change 26/3/2018 must check issue first date of contract                                             180326 
 5934.00                 AND  ISSFRSTDT OF FCONTRACT-REC                                                                      180326 
 5935.00                                               <= 20171231                                                            180326 
 5936.00                      MOVE 'MCP1'                                                                                     180308 
 5937.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         180308 
 5938.00                 ELSE                                                                                                 180308 
 5939.00                      MOVE 'MCP3'                                                                                     180308 
 5940.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         180308 
 5941.00                 END-IF                                                                                               180308 
 5942.00                                                                                                                      150917 
 5943.00       *****     IF   WSAA-COVCOD(WSAA-IND) = 'TUM2'                                                                  180308 
 5944.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TUM2'                                                                  180308 
 5945.00       *****     AND  WSAA-RSKCOMMDT(WSAA-IND) <= 20171231                                                            180326 
 5946.00       *****     change 26/3/2018 must check issue first date of contract                                             180326 
 5947.00                 AND  ISSFRSTDT OF FCONTRACT-REC                                                                      180326 
 5948.00                                               <= 20171231                                                            180326 
 5949.00                      MOVE 'MCP2'                                                                                     180308 
 5950.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171229 
 5951.00                 ELSE                                                                                                 180308 
 5952.00                      MOVE 'MCP4'                                                                                     180308 
 5953.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         180308 
 5954.00                 END-IF                                                                                               180326 
 5955.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TUM2'                                                                  180308 
 5956.00                      MOVE '99'      TO MPPRMFREQ OF MPMDLPNTNP-REC                                                   180308 
 5957.00                 END-IF                                                                                               180308 
 5958.00                                                                                                                      161108 
 5959.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TUM3'                                                                  161108 
 5960.00                      MOVE 'MCG1'                                                                                     161121 
 5961.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         161121 
 5962.00                 END-IF                                                                                               161108 
 5963.00                                                                                                                      150917 
 5964.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TUM4'                                                                  170209 
 5965.00                      MOVE 'MCG2'                                                                                     170209 
 5966.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         170209 
 5967.00                 END-IF                                                                                               170209 
 5968.00                                                                                                                      170921 
 5969.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TU05'                                                                  170921 
 5970.00                 OR   WSAA-COVCOD(WSAA-IND) = 'TU06'                                                                  170921 
 5971.00                      MOVE 'ULTIMA'                                                                                   170929 
 5972.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         170921 
 5973.00                 END-IF                                                                                               170921 
 5974.00                                                                                                                      180507 
 5975.00                 IF   WSAA-COVCOD(WSAA-IND) = 'TU07'                                                                  180507 
 5976.00                 OR   WSAA-COVCOD(WSAA-IND) = 'TU08'                                                                  180507 
 5977.00                 OR   WSAA-COVCOD(WSAA-IND) = 'TU09'                                                                  180507 
 5978.00                      MOVE 'UR02'                                                                                     180507 
 5979.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         180507 
 5980.00                 END-IF                                                                                               180507 
 5981.00                                                                                                                      170209 
 5982.00                 IF   WSAA-CLNTORGCOD(WSAA-IND)   = '01'                                                              150911 
 5983.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '02'                                                              150911 
 5984.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '05'                                                              150911 
 5985.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '06'                                                              150911 
 5986.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '07'                                                              150911 
 5987.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '08'                                                              150911 
 5988.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '09'                                                              150911 
 5989.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '10'                                                              160115 
 5990.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '11'                                                              161108 
 5991.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '12'                                                              161108 
 5992.00                   OR WSAA-CLNTORGCOD(WSAA-IND)   = '14'                                                              161108 
 5993.00                                                                                                                      150911 
 5994.00                      PERFORM CHECK-ZAPE-SLC                                                                          180308 
 5995.00                                                                                                                      171003 
 5996.00                      IF WRK-FOUND-ZAPE-SLC      = '00'                                                               180308 
 5997.00                         PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                           180308 
 5998.00                         PERFORM WRITE-NEWBUS-REC                                                                     190219 
 5999.00       ****              WRITE MPMDLPNTNP-REC                                                                         190219 
 6000.00                      END-IF                                                                                          180308 
 6001.00                      IF WRK-FOUND-ZAPE-SLC-NAPE = '00'                                                               180308 
 6002.00                         PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                           180308 
 6003.00                         PERFORM WRITE-NON-APE                                                                        180319 
 6004.00                      END-IF                                                                                          180308 
 6005.00                                                                                                                      150911 
 6006.00                 END-IF                                                                                               150911 
 6007.00            END-IF                                                                                                    171228 
 6008.00                                                                                                                      171228 
 6009.00            END-PERFORM                                                                                               150911 
 6010.00       *                                                                               150915 
 6011.00            INITIALIZE  WSAA-CONCOVSLC-RECS                                                                           150915 
 6012.00                                                                                                                      150915 
 6013.00            .                                                                                                         150911 
 6014.00         END-WRITE-TOPUP.                                                                                             150911 
 6015.00            EXIT.                                                                                                     150911 
 6016.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6017.00         UPDATE-MCTOTAL SECTION.                                                                                      150911 
 6018.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6019.00            INITIALIZE WRK-FINALMPNOTINV                                                                              150911 
 6020.00                                                                                                                      150911 
 6021.00       *       TOP UP1-5 +  TOTAL                                                       150911 
 6022.00       *    C*KA     UM*       MC*-->TUM                    150911 
 6023.00                                                                                                                      150911 
 6024.00       *                                                                                             150911 
 6025.00            MOVE  WRK-MPTOPUPY1 TO MPTOPUPY1 OF MPMDLPNT-REC                                                          150911 
 6026.00            MOVE  WRK-MPTOPUPY2 TO MPTOPUPY2 OF MPMDLPNT-REC                                                          150911 
 6027.00            MOVE  WRK-MPTOPUPY3 TO MPTOPUPY3 OF MPMDLPNT-REC                                                          150911 
 6028.00            MOVE  WRK-MPTOPUPY4 TO MPTOPUPY4 OF MPMDLPNT-REC                                                          150911 
 6029.00            MOVE  WRK-MPTOPUPY5 TO MPTOPUPY5 OF MPMDLPNT-REC                                                          150911 
 6030.00            MOVE WRK-MPTOPUPTOT TO MPTOPUPTOT OF MPMDLPNT-REC                                                         150911 
 6031.00            MOVE WRK-MPTOPUPTOTGR TO MPTOPUPTGR OF MPMDLPNT-REC                                                       170901 
 6032.00                                                                                                                      150911 
 6033.00       *NIGA FOR TOPUP (   FCONCOVSLC(WRK-MPNOTINV)  +  OTI EXEI TO FCONMICRO=WRK-NINVAMT)                   150911 
 6034.00            COMPUTE WRK-FINALMPNOTINV   =                                                                             150911 
 6035.00                      MPNOTINV OF MPMDLPNT-REC + WRK-MPNOTINV                                                         150911 
 6036.00            MOVE WRK-FINALMPNOTINV TO MPNOTINV OF MPMDLPNT-REC                                                        150911 
 6037.00            .                                                                                                         150911 
 6038.00         END-UPDATE-MCTOTAL.                                                                                          150911 
 6039.00            EXIT.                                                                                                     150911 
 6040.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6041.00         CHECK-MCWOPAGESEX  SECTION.                                                                                  150917 
 6042.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6043.00            MOVE RUNDT     OF WRK-FCONCOV-REC TO RUNDT   OF FCONCOVM-REC                                              150914 
 6044.00            MOVE COMPCOD   OF WRK-FCONCOV-REC TO COMPCOD OF FCONCOVM-REC                                              150914 
 6045.00            MOVE DSBCHACOD OF WRK-FCONCOV-REC TO                                                                      150911 
 6046.00                                              DSBCHACOD OF FCONCOVM-REC                                               150914 
 6047.00            MOVE BRCHCOD   OF WRK-FCONCOV-REC TO BRCHCOD OF FCONCOVM-REC                                              150914 
 6048.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC TO                                                                      150911 
 6049.00                                              SYSAPPCOD OF FCONCOVM-REC                                               150914 
 6050.00            MOVE CONNBR    OF WRK-FCONCOV-REC TO                                                                      150911 
 6051.00                                              CONNBR   OF FCONCOVM-REC                                                150914 
 6052.00            MOVE ZEROES     TO LIFNO     OF FCONCOVM-REC                                                              150914 
 6053.00            MOVE ZEROES     TO COVNO     OF FCONCOVM-REC                                                              150914 
 6054.00            MOVE ZEROES     TO RSKCOMMDT OF FCONCOVM-REC                                                              150914 
 6055.00                                                                                                                      150911 
 6056.00              START FCONCOVM KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                       150914 
 6057.00              READ  FCONCOVM NEXT                                                                                     150914 
 6058.00                                                                                                                      150911 
 6059.00              PERFORM UNTIL FCONCOVM-STATUS NOT      = STATUS-OK                                                      150914 
 6060.00                OR RUNDT     OF WRK-FCONCOV-REC NOT  =                                                                150911 
 6061.00                   RUNDT     OF FCONCOVM-REC                                                                          150914 
 6062.00                OR COMPCOD   OF WRK-FCONCOV-REC NOT  =                                                                150914 
 6063.00                   COMPCOD   OF FCONCOVM-REC                                                                          150914 
 6064.00                OR DSBCHACOD OF WRK-FCONCOV-REC NOT  =                                                                150914 
 6065.00                   DSBCHACOD OF FCONCOVM-REC                                                                          150914 
 6066.00                OR BRCHCOD   OF WRK-FCONCOV-REC NOT  =                                                                150911 
 6067.00                   BRCHCOD   OF FCONCOVM-REC                                                                          150914 
 6068.00                OR SYSAPPCOD OF WRK-FCONCOV-REC NOT  =                                                                150911 
 6069.00                   SYSAPPCOD OF FCONCOVM-REC                                                                          150914 
 6070.00                OR CONNBR    OF WRK-FCONCOV-REC NOT  =                                                                150911 
 6071.00                   CONNBR    OF FCONCOVM-REC                                                                          150914 
 6072.00                                                                                                                      150911 
 6073.00                   IF COVCOD OF FCONCOVM-REC  = 'WPP5'                                                                150917 
 6074.00                   OR COVCOD OF FCONCOVM-REC  = 'WPP6'                                                                150917 
 6075.00                   OR COVCOD OF FCONCOVM-REC  = 'WPP7'                                                                170718 
 6076.00                   OR COVCOD OF FCONCOVM-REC  = 'WPP8'                                                                170720 
 6077.00                   OR COVCOD OF FCONCOVM-REC  = 'ADP1'                                                                170929 
 6078.00                   OR COVCOD OF FCONCOVM-REC  = 'ADP2'                                                                180530 
 6079.00                   OR COVCOD OF FCONCOVM-REC  = 'ADP3'                                                                180306 
 6080.00                      PERFORM FIND-SEXMCWOP                                                                           150917 
 6081.00                   END-IF                                                                                             150911 
 6082.00                                                                                                                      150911 
 6083.00              READ FCONCOVM    NEXT                                                                                   150914 
 6084.00                                                                                                                      150911 
 6085.00              END-PERFORM                                                                                             150911 
 6086.00            .                                                                                                         150911 
 6087.00         END-CHECK-MCWOPAGESEX.                                                                                       150917 
 6088.00            EXIT.                                                                                                     150911 
 6089.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6090.00         FIND-SEXMCWOP   SECTION.                                                                                     150917 
 6091.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6092.00            INITIALIZE CONLIFR  OF FCONLIFM-REC                                                                       150918 
 6093.00                                                                                                                      150911 
 6094.00            MOVE RUNDT     OF FCONCOVM-REC TO RUNDT     OF FCONLIFM-REC                                               150918 
 6095.00            MOVE COMPCOD   OF FCONCOVM-REC TO COMPCOD   OF FCONLIFM-REC                                               150918 
 6096.00            MOVE DSBCHACOD OF FCONCOVM-REC TO DSBCHACOD OF FCONLIFM-REC                                               150918 
 6097.00            MOVE BRCHCOD   OF FCONCOVM-REC TO BRCHCOD   OF FCONLIFM-REC                                               150918 
 6098.00            MOVE SYSAPPCOD OF FCONCOVM-REC TO SYSAPPCOD OF FCONLIFM-REC                                               150918 
 6099.00            MOVE CONNBR    OF FCONCOVM-REC TO CONNBR    OF FCONLIFM-REC                                               150918 
 6100.00            MOVE LIFNO     OF FCONCOVM-REC TO LIFNO     OF FCONLIFM-REC                                               150918 
 6101.00                                                                                                                      150911 
 6102.00            READ  FCONLIFM                                                                                            150918 
 6103.00                                                                                                                      150911 
 6104.00            IF    FCONLIFM-STATUS = FOUND-REC                                                                         150918 
 6105.00                                                                                                                      150911 
 6106.00                    INITIALIZE MPSEXR  OF  MPSEX-REC                                                                  150911 
 6107.00                    MOVE SEXCOD OF FCONLIFM-REC                                                                       150918 
 6108.00                         TO SEXCOD OF MPSEX-REC                                                                       150911 
 6109.00                                                                                                                      150911 
 6110.00                    READ MPSEX                                                                                        150911 
 6111.00                    IF MPSEX-STATUS = FOUND-REC                                                                       150911 
 6112.00                    MOVE MPSEXCOD OF MPSEX-REC                                                                        150911 
 6113.00                         TO MPWOPSEX OF MPMDLPNT-REC                                                                  150911 
 6114.00                    ELSE                                                                                              150911 
 6115.00       *       UNKNOWN - ERROR                                                                                        150911 
 6116.00                    MOVE 0 TO MPWOPSEX OF MPMDLPNT-REC                                                                150911 
 6117.00                    END-IF                                                                                            150911 
 6118.00                                                                                                                      150911 
 6119.00                    MOVE RSKCOMMAGE OF FCONLIFM-REC                                                                   150918 
 6120.00                         TO MPWOPAGE OF MPMDLPNT-REC                                                                  150911 
 6121.00            END-IF                                                                                                    150911 
 6122.00            .                                                                                                         150911 
 6123.00         END-FIND-SEXMCWOP.                                                                                           150917 
 6124.00            EXIT.                                                                                                     150911 
 6125.00       *------------------------------------------------------------------------------------------------------------- 150911 
 6126.00         NEWCALCTRM   SECTION.                                                                                        161121 
 6127.00       *------------------------------------------------------------------------------------------------------------- 161121 
 6128.00                                                                                                                      161121 
 6129.00       *      AN HEALTH (11)   < 11020  11026-11027                                                       161121 
 6130.00       *        11011-12                                                                            161121 
 6131.00       *        DEPENDANT                                                                                       161121 
 6132.00              IF  (COVCOD OF WRK-FCONCOV-REC(1:2) =                                                                   161206 
 6133.00                                                    '11'                                                              161206 
 6134.00              AND (COVCOD OF WRK-FCONCOV-REC(3:3) < '020'                                                             161206 
 6135.00              OR   COVCOD OF WRK-FCONCOV-REC(3:3) = '026'                                                             161206 
 6136.00              OR   COVCOD OF WRK-FCONCOV-REC(3:3) = '027' ))                                                          161206 
 6137.00              AND (RELTCOD   OF FCONLIF-REC       = '  '                                                              161206 
 6138.00              OR   RELTCOD   OF FCONLIF-REC       = 'WI'                                                              161206 
 6139.00              OR   RELTCOD   OF FCONLIF-REC       = 'HU' )                                                            161206 
 6140.00                                                                                                                      161121 
 6141.00                INITIALIZE  WRK-CURRAGE                                                                               161121 
 6142.00                INITIALIZE  WRK-MPPRMTRM                                                                              161121 
 6143.00                INITIALIZE  WRK-MPPRMTRM1                                                                             161206 
 6144.00                INITIALIZE  WRK-1AGEDURATION                                                                          161121 
 6145.00                INITIALIZE  WRK-2AGEDURATION                                                                          161121 
 6146.00                INITIALIZE  WRK-3AGEDURATION                                                                          161121 
 6147.00                INITIALIZE  WRK-4AGEDURATION                                                                          161121 
 6148.00                                                                                                                      161121 
 6149.00       *                                                                                    161121 
 6150.00                COMPUTE WRK-CURRAGE               =                                                                   161121 
 6151.00                      MPAGEENTR OF MPMDLPNT-REC   +                                                                   161121 
 6152.00                     ( MPMONIF  OF MPMDLPNT-REC  / 12 )                                                               161206 
 6153.00                                                                                                                      161121 
 6154.00       *                                                                                     161121 
 6155.00                                                                                                                      161121 
 6156.00                COMPUTE WRK-MPPRMTRM1             =                                                                   161206 
 6157.00                       MPINCPYEAR OF MPMDLPNT-REC -                                                                   161121 
 6158.00       ****            MPISSYEAR  OF MPMDLPNT-REC - 1                                                                 161206 
 6159.00                       WRKISSY                                                                                        161206 
 6160.00                                                  - 1                                                                 161209 
 6161.00                                                                                                                      161206 
 6162.00                                                                                                                      161206 
 6163.00                COMPUTE WRK-MPPRMTRM              =                                                                   161206 
 6164.00                       MPMAINTRM OF MPMDLPNT-REC  -                                                                   161209 
 6165.00                       WRK-MPPRMTRM1                                                                                  161209 
 6166.00                                                                                                                      161206 
 6167.00       *      WHOLE LIFE                                                                                              161121 
 6168.00                   IF  WRK-CURRAGE     <  65                                                                          161121 
 6169.00                   AND (WRK-MPMAINCOD                                                                                 161121 
 6170.00                                                  = '00014'  OR                                                       161121 
 6171.00                        WRK-MPMAINCOD                                                                                 161121 
 6172.00                                                  = '00034'  OR                                                       161121 
 6173.00                        WRK-MPMAINCOD                                                                                 161121 
 6174.00                                                  ='00035'   OR                                                       161121 
 6175.00                        WRK-MPMAINCOD                                                                                 161121 
 6176.00                                                  ='00084'   OR                                                       161121 
 6177.00                        WRK-MPMAINCOD                                                                                 161121 
 6178.00                                                  ='00085'   OR                                                       161121 
 6179.00                        WRK-MPMAINCOD                                                                                 161121 
 6180.00                                                  ='00184'   OR                                                       161121 
 6181.00                        WRK-MPMAINCOD                                                                                 161121 
 6182.00                                                  ='00185'   )                                                        161121 
 6183.00                                                                                                                      161121 
 6184.00                        COMPUTE MPCOVTRM OF MPMDLPNT-REC                                                              161121 
 6185.00                                                  =                                                                   161121 
 6186.00                           65 - MPAGEENTR OF MPMDLPNT-REC                                                             161121 
 6187.00                                                                                                                      161121 
 6188.00       * MPEXTTRM                                                                             161121 
 6189.00                        COMPUTE WRK-1AGEDURATION  =                                                                   161121 
 6190.00                          MPAGEENTR OF MPMDLPNT-REC                                                                   161121 
 6191.00                                                  +                                                                   161121 
 6192.00                          WRK-MPPRMTRM            -                                                                   161121 
 6193.00                          65                                                                                          161121 
 6194.00                                                                                                                      161121 
 6195.00                        COMPUTE WRK-3AGEDURATION  =                                                                   161121 
 6196.00                          106 - 65                                                                                    161121 
 6197.00                                                                                                                      161121 
 6198.00                        IF WRK-1AGEDURATION       <                                                                   161121 
 6199.00                           WRK-3AGEDURATION                                                                           161121 
 6200.00                                                                                                                      161121 
 6201.00                           COMPUTE MPEXTTRM  OF                                                                       161121 
 6202.00                           MPMDLPNT-REC           =                                                                   161121 
 6203.00                           WRK-1AGEDURATION                                                                           161121 
 6204.00                        ELSE                                                                                          161121 
 6205.00                                                                                                                      161121 
 6206.00                           COMPUTE MPEXTTRM  OF                                                                       161121 
 6207.00                           MPMDLPNT-REC           =                                                                   161121 
 6208.00                           WRK-3AGEDURATION                                                                           161121 
 6209.00                        END-IF                                                                                        161121 
 6210.00                   END-IF                                                                                             161121 
 6211.00                                                                                                                      161121 
 6212.00                   IF  WRK-CURRAGE               >= 65                                                                161121 
 6213.00                   AND (WRK-MPMAINCOD                                                                                 161121 
 6214.00                                                  = '00014'  OR                                                       161121 
 6215.00                        WRK-MPMAINCOD                                                                                 161121 
 6216.00                                                  = '00034'  OR                                                       161121 
 6217.00                        WRK-MPMAINCOD                                                                                 161121 
 6218.00                                                  ='00035'   OR                                                       161121 
 6219.00                        WRK-MPMAINCOD                                                                                 161121 
 6220.00                                                  ='00084'   OR                                                       161121 
 6221.00                        WRK-MPMAINCOD                                                                                 161121 
 6222.00                                                  ='00085'   OR                                                       161121 
 6223.00                        WRK-MPMAINCOD                                                                                 161121 
 6224.00                                                  ='00184'   OR                                                       161121 
 6225.00                        WRK-MPMAINCOD                                                                                 161121 
 6226.00                                                  ='00185'   )                                                        161121 
 6227.00                                                                                                                      161121 
 6228.00                        COMPUTE WRK-3AGEDURATION =                                                                    161121 
 6229.00                          106 - MPAGEENTR OF MPMDLPNT-REC                                                             161121 
 6230.00                                                                                                                      161121 
 6231.00                        IF WRK-3AGEDURATION      <                                                                    161121 
 6232.00                           WRK-MPPRMTRM                                                                               161121 
 6233.00                                                                                                                      161121 
 6234.00                           COMPUTE MPCOVTRM  OF                                                                       161121 
 6235.00                           MPMDLPNT-REC          =                                                                    161121 
 6236.00                           WRK-3AGEDURATION                                                                           161121 
 6237.00                                                                                                                      161121 
 6238.00                        ELSE                                                                                          161121 
 6239.00                                                                                                                      161121 
 6240.00                           COMPUTE MPCOVTRM  OF                                                                       161121 
 6241.00                           MPMDLPNT-REC          =                                                                    161121 
 6242.00                           WRK-MPPRMTRM                                                                               161121 
 6243.00                                                                                                                      161121 
 6244.00                        END-IF                                                                                        161121 
 6245.00                                                                                                                      161121 
 6246.00                           COMPUTE MPEXTTRM  OF                                                                       161121 
 6247.00                           MPMDLPNT-REC          = 0                                                                  161121 
 6248.00                   END-IF                                                                                             161121 
 6249.00       *   NOT  WHOLE LIFE                                                                                            161121 
 6250.00                   IF  (WRK-MPMAINCOD                                                                                 161121 
 6251.00                                             NOT  = '00014'  AND                                                      161121 
 6252.00                        WRK-MPMAINCOD                                                                                 161121 
 6253.00                                             NOT  = '00034'  AND                                                      161121 
 6254.00                        WRK-MPMAINCOD                                                                                 161121 
 6255.00                                             NOT  ='00035'   AND                                                      161121 
 6256.00                        WRK-MPMAINCOD                                                                                 161121 
 6257.00                                             NOT  ='00084'   AND                                                      161121 
 6258.00                        WRK-MPMAINCOD                                                                                 161121 
 6259.00                                             NOT  ='00085'   AND                                                      161121 
 6260.00                        WRK-MPMAINCOD                                                                                 161121 
 6261.00                                             NOT  ='00184'   AND                                                      161121 
 6262.00                        WRK-MPMAINCOD                                                                                 161121 
 6263.00                                             NOT  ='00185'   )                                                        161121 
 6264.00                                                                                                                      161121 
 6265.00                        COMPUTE WRK-4AGEDURATION  =                                                                   161121 
 6266.00                        MPAGEENTR OF MPMDLPNT-REC +                                                                   161121 
 6267.00                        WRK-MPPRMTRM                                                                                  161121 
 6268.00                                                                                                                      161121 
 6269.00                        IF  WRK-CURRAGE           <  65                                                               161121 
 6270.00                            IF  WRK-4AGEDURATION  < 65                                                                161121 
 6271.00                                COMPUTE MPEXTTRM  OF MPMDLPNT-REC                                                     161121 
 6272.00                                                  = 0                                                                 161121 
 6273.00                            ELSE                                                                                      161121 
 6274.00                                COMPUTE MPCOVTRM  OF MPMDLPNT-REC                                                     161121 
 6275.00                                                  =                                                                   161121 
 6276.00                                65 - MPAGEENTR OF MPMDLPNT-REC                                                        161121 
 6277.00                                                                                                                      161121 
 6278.00                                COMPUTE MPEXTTRM  OF MPMDLPNT-REC                                                     161121 
 6279.00                                                  =                                                                   161121 
 6280.00                                MPAGEENTR OF MPMDLPNT-REC                                                             161121 
 6281.00                                                  +                                                                   161121 
 6282.00                                WRK-MPPRMTRM      -                                                                   161121 
 6283.00                                65                                                                                    161121 
 6284.00                            END-IF                                                                                    161121 
 6285.00                                                                                                                      161121 
 6286.00                        ELSE                                                                                          161121 
 6287.00                            COMPUTE MPCOVTRM OF MPMDLPNT-REC                                                          161121 
 6288.00                                                  =                                                                   161121 
 6289.00                            WRK-MPPRMTRM                                                                              161121 
 6290.00                            COMPUTE MPEXTTRM  OF MPMDLPNT-REC                                                         161121 
 6291.00                                                  = 0                                                                 161121 
 6292.00                        END-IF                                                                                        161121 
 6293.00                   END-IF                                                                                             161121 
 6294.00                   COMPUTE MPPRMTRM OF MPMDLPNT-REC                                                                   161121 
 6295.00                                                  =                                                                   161121 
 6296.00                   MPCOVTRM OF MPMDLPNT-REC                                                                           161121 
 6297.00              END-IF                                                                                                  161121 
 6298.00                                                                                                                      161121 
 6299.00            .                                                                                                         161121 
 6300.00         END-NEWCALCTRM.                                                                                              161121 
 6301.00            EXIT.                                                                                                     161121 
 6302.00       *------------------------------------------------------------------------------------------------------------- 170209 
 6303.00         CHECK-MPANTASF SECTION.                                                                                      170209 
 6304.00       *------------------------------------------------------------------------------------------------------------- 170209 
 6305.00            INITIALIZE MPANTASFR OF MPANTASF-REC                                                                      170209 
 6306.00            MOVE ZEROES                 TO WRK-FNDANTASF                                                              170209 
 6307.00                                                                                                                      170209 
 6308.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                         170209 
 6309.00                                        TO SYSAPPCOD OF MPANTASF-REC                                                  170209 
 6310.00            MOVE COVCOD    OF WRK-FCONCOV-REC                                                                         170209 
 6311.00                                        TO COVCOD    OF MPANTASF-REC                                                  170209 
 6312.00                                                                                                                      170209 
 6313.00            START MPANTASF KEY IS       >= EXTERNALLY-DESCRIBED-KEY                                                   170209 
 6314.00            READ  MPANTASF NEXT                                                                                       170209 
 6315.00                                                                                                                      170209 
 6316.00            PERFORM UNTIL MPANTASF-STATUS                                                                             170209 
 6317.00                                     NOT = FOUND-REC                                                                  170209 
 6318.00              OR SYSAPPCOD OF WRK-FCONCOV-REC                                                                         170209 
 6319.00                                     NOT =                                                                            170209 
 6320.00                 SYSAPPCOD OF MPANTASF-REC                                                                            170209 
 6321.00              OR COVCOD    OF WRK-FCONCOV-REC                                                                         170209 
 6322.00                                     NOT =                                                                            170209 
 6323.00                 COVCOD    OF MPANTASF-REC                                                                            170209 
 6324.00              OR WRK-FNDANTASF           = 1                                                                          170209 
 6325.00                                                                                                                      170209 
 6326.00                 MOVE 0                 TO MPSALMON OF MPMDLPNT-REC                                                   170209 
 6327.00       *  ORANGE CROSS     CLIENT ORIGIN 1-5                                                      170224 
 6328.00       *    MPSALMON = 0                                                                                 170224 
 6329.00                 IF SYSAPPCOD OF WRK-FCONCOV-REC                                                                      170306 
 6330.00                                         = '01'                                                                       170306 
 6331.00                 AND (COVCOD OF WRK-FCONCOV-REC                                                                       170306 
 6332.00                                         = 'HRP1'                                                                     170306 
 6333.00                    OR COVCOD OF WRK-FCONCOV-REC                                                                      170306 
 6334.00                                         = 'HRP2'                                                                     170717 
 6335.00                    OR COVCOD OF WRK-FCONCOV-REC                                                                      180507 
 6336.00                                         = 'HRP3'                                                                     180507 
 6337.00                    OR COVCOD OF WRK-FCONCOV-REC                                                                      170717 
 6338.00                                         = 'ORP1'                                                                     170306 
 6339.00                    OR COVCOD OF WRK-FCONCOV-REC                                                                      170306 
 6340.00                                         = 'ORP2' )                                                                   170306 
 6341.00                       IF (CLNTORGCOD OF WRK-FCONCOV-REC                                                              170306 
 6342.00                                         = '01'                                                                       170306 
 6343.00                       OR  CLNTORGCOD OF WRK-FCONCOV-REC                                                              170306 
 6344.00                                         = '02'                                                                       170306 
 6345.00                       OR  CLNTORGCOD OF WRK-FCONCOV-REC                                                              170306 
 6346.00                                         = '03'                                                                       170306 
 6347.00                       OR  CLNTORGCOD OF WRK-FCONCOV-REC                                                              170306 
 6348.00                                         = '04'                                                                       170306 
 6349.00                       OR  CLNTORGCOD OF WRK-FCONCOV-REC                                                              170306 
 6350.00                                         = '05')                                                                      170306 
 6351.00                           MOVE 0       TO MPSALMON OF MPMDLPNT-REC                                                   170306 
 6352.00                       ELSE                                                                                           170306 
 6353.00                           MOVE 1       TO MPSALMON OF MPMDLPNT-REC                                                   170306 
 6354.00                       END-IF                                                                                         170306 
 6355.00                 ELSE                                                                                                 170306 
 6356.00                       MOVE 0           TO MPSALMON OF MPMDLPNT-REC                                                   170306 
 6357.00                 END-IF                                                                                               170306 
 6358.00                 IF SYSAPPCOD OF WRK-FCONCOV-REC                                                                      170306 
 6359.00                                         = '02'                                                                       170306 
 6360.00                 OR SYSAPPCOD OF WRK-FCONCOV-REC                                                                      170306 
 6361.00                                         = '03'                                                                       170306 
 6362.00                    MOVE 0              TO MPSALMON OF MPMDLPNT-REC                                                   170306 
 6363.00                 END-IF                                                                                               170306 
 6364.00                                                                                                                      170224 
 6365.00                 MOVE 1                 TO WRK-FNDANTASF                                                              170224 
 6366.00            READ MPANTASF  NEXT                                                                                       170209 
 6367.00                                                                                                                      170209 
 6368.00            END-PERFORM                                                                                               170209 
 6369.00                                                                                                                      170209 
 6370.00            .                                                                                                         170209 
 6371.00            END-CHECK-MPANTASF.                                                                                       170209 
 6372.00            EXIT.                                                                                                     170209 
 6373.00       *------------------------------------------------------------------------------------------------------------- 170920 
 6374.00         CHECK-ZAPE SECTION.                                                                                          170920 
 6375.00       *------------------------------------------------------------------------------------------------------------- 170920 
 6376.00            INITIALIZE MPMDLPNTR  OF MPMDLPNTNP-REC                                                                   180125 
 6377.00            INITIALIZE MDLNNONAPR OF MDLNNONAPE-REC                                                                   180125 
 6378.00                                                                                                                      180125 
 6379.00            MOVE MPMDLPNT-REC TO MPMDLPNTNP-REC                                                                       180125 
 6380.00            MOVE MPMDLPNT-REC TO MDLNNONAPE-REC                                                                       180125 
 6381.00                                                                                                                      180125 
 6382.00            INITIALIZE ZAPEREC OF ZAPE-REC                                                                            170920 
 6383.00            INITIALIZE WRK-EFFD-ZAPE                                                                                  170921 
 6384.00            INITIALIZE WSAA-LIFENUM                                                                                   171004 
 6385.00            MOVE '99' TO WRK-FOUND-ZAPE                                                                               171003 
 6386.00            MOVE '99' TO WRK-FOUND-NON-APE                                                                            171009 
 6387.00                                                                                                                      170920 
 6388.00            MOVE RUNDATE    TO CRTDATE OF ZAPE-REC                                                                    170920 
 6389.00            MOVE COMPCOD   OF FCONCOV-REC TO CHDRCOY  OF ZAPE-REC                                                     170920 
 6390.00            MOVE CONNBR    OF FCONCOV-REC TO CHDRNUM  OF ZAPE-REC                                                     170920 
 6391.00       ***  IF   SYSAPPCOD OF FCONCOV-REC = '02'                                                                      171017 
 6392.00       ***       MOVE CLNTCOD OF FCONLIF-REC(1:8)  TO WSAA-LIFENUM                                                    171017 
 6393.00       ***  ELSE                                                                                                      171017 
 6394.00       ***      MOVE CLNTCODL4 OF FCONLIF-REC(1:8) TO WSAA-LIFENUM                                                    171017 
 6395.00       ***  END-IF                                                                                                    171017 
 6396.00            MOVE MPCLNTCOD OF MPMDLPNT-REC                                                                            171017 
 6397.00                                          TO WSAA-LIFENUM                                                             171017 
 6398.00            MOVE WSAA-LIFENUM             TO LIFENUM  OF ZAPE-REC                                                     171004 
 6399.00       *                                                                                                              181227 
 6400.00       *    use initial cover for ZAPE, not the replacing.                                                            181227 
 6401.00            MOVE WSAA-COV-ZAPE           TO JCOVCODE OF ZAPE-REC                                                      181227 
 6402.00       **** MOVE COVCOD    OF FCONCOV-REC TO JCOVCODE OF ZAPE-REC                                                     181227 
 6403.00            MOVE LOW-VALUES               TO EFFDATE  OF ZAPE-REC                                                     171017 
 6404.00                                                                                                                      170920 
 6405.00            START ZAPE KEY IS           >= EXTERNALLY-DESCRIBED-KEY                                                   170920 
 6406.00            READ  ZAPE NEXT                                                                                           170920 
 6407.00                                                                                                                      170920 
 6408.00            PERFORM    UNTIL  ZAPE-STATUS NOT = FOUND-REC                                                             170920 
 6409.00              OR CRTDATE  OF ZAPE-REC NOT =                                                                           170920 
 6410.00              RUNDATE                                                                                                 170920 
 6411.00              OR CHDRCOY  OF ZAPE-REC NOT =                                                                           170920 
 6412.00              COMPCOD     OF FCONCOV-REC                                                                              170920 
 6413.00              OR CHDRNUM  OF ZAPE-REC NOT =                                                                           170920 
 6414.00              CONNBR      OF FCONCOV-REC                                                                              170920 
 6415.00              OR LIFENUM  OF ZAPE-REC NOT =                                                                           171017 
 6416.00              WSAA-LIFENUM                                                                                            171017 
 6417.00              OR JCOVCODE OF ZAPE-REC                                                                                 171017 
 6418.00                                     NOT =                                                                            171017 
 6419.00              WSAA-COV-ZAPE                                                                                           181227 
 6420.00       ****   COVCOD      OF FCONCOV-REC                                                                              181227 
 6421.00                                                                                                                      170920 
 6422.00              MOVE EFFDATE OF ZAPE-REC TO WRK-EFFD-ZAPE                                                               170921 
 6423.00                                                                                                                      170921 
 6424.00              IF  WRKEFFZ-YEAR           = WRK-RUNY                                                                   170921 
 6425.00              AND WRKEFFZ-MONTH          = WRK-RUNM                                                                   170921 
 6426.00                                                                                                                      170921 
 6427.00       ****   THIS FLAG WITH 'Y' SHOWS THAT CONCERNS APE                                                              170920 
 6428.00                  IF ZNEWOLD OF ZAPE-REC = 'Y'                                                                        170921 
 6429.00                     MOVE '00' TO WRK-FOUND-ZAPE                                                                      171003 
 6430.00                     PERFORM CHECK-AMOUNTS                                                                            170921 
 6431.00                  END-IF                                                                                              170921 
 6432.00                  IF ZNEWOLD OF ZAPE-REC = 'N'                                                                        171009 
 6433.00                     MOVE '00' TO WRK-FOUND-NON-APE                                                                   171009 
 6434.00                     PERFORM CHECK-AMOUNTS                                                                            171009 
 6435.00                  END-IF                                                                                              171009 
 6436.00              END-IF                                                                                                  170921 
 6437.00            READ ZAPE      NEXT                                                                                       170920 
 6438.00                                                                                                                      170920 
 6439.00            END-PERFORM                                                                                               170920 
 6440.00                                                                                                                      170920 
 6441.00            .                                                                                                         170920 
 6442.00            END-CHECK-ZAPE.                                                                                           170920 
 6443.00            EXIT.                                                                                                     170920 
 6444.00       *------------------------------------------------------------------------------------------------------------- 171003 
 6445.00         CHECK-ZAPE-SLC SECTION.                                                                                      171003 
 6446.00       *------------------------------------------------------------------------------------------------------------- 171003 
 6447.00            INITIALIZE ZAPEREC OF ZAPE-REC                                                                            171003 
 6448.00            INITIALIZE WRK-EFFD-ZAPE                                                                                  171003 
 6449.00            MOVE '99' TO WRK-FOUND-ZAPE-SLC                                                                           171004 
 6450.00            MOVE '99' TO WRK-FOUND-ZAPE-SLC-NAPE                                                                      171009 
 6451.00                                                                                                                      171003 
 6452.00            MOVE RUNDATE                   TO CRTDATE OF ZAPE-REC                                                     171003 
 6453.00            MOVE COMPCOD OF FCONCOV-REC    TO CHDRCOY  OF ZAPE-REC                                                    171003 
 6454.00            MOVE WSAA-CONNBR(WSAA-IND)     TO CHDRNUM  OF ZAPE-REC                                                    171003 
 6455.00            MOVE WSAA-CLNTCODL4(WSAA-IND)  TO LIFENUM  OF ZAPE-REC                                                    171003 
 6456.00            MOVE WSAA-COVCOD(WSAA-IND)     TO JCOVCODE OF ZAPE-REC                                                    171003 
 6457.00                                                                                                                      171003 
 6458.00            START ZAPE KEY IS           >= EXTERNALLY-DESCRIBED-KEY                                                   171003 
 6459.00            READ  ZAPE NEXT                                                                                           171003 
 6460.00                                                                                                                      171003 
 6461.00            PERFORM    UNTIL  ZAPE-STATUS NOT = FOUND-REC                                                             171003 
 6462.00              OR CRTDATE  OF ZAPE-REC NOT =                                                                           171009 
 6463.00              RUNDATE                                                                                                 171003 
 6464.00              OR CHDRCOY  OF ZAPE-REC NOT =                                                                           171003 
 6465.00              COMPCOD     OF FCONCOV-REC                                                                              171003 
 6466.00              OR CHDRNUM  OF ZAPE-REC NOT =                                                                           171003 
 6467.00              WSAA-CONNBR(WSAA-IND)                                                                                   171003 
 6468.00              OR LIFENUM  OF ZAPE-REC NOT =                                                                           171003 
 6469.00              WSAA-CLNTCODL4(WSAA-IND)                                                                                171006 
 6470.00              OR JCOVCODE OF ZAPE-REC                                                                                 171003 
 6471.00                                     NOT =                                                                            171003 
 6472.00              WSAA-COVCOD(WSAA-IND)                                                                                   171003 
 6473.00                                                                                                                      171003 
 6474.00              MOVE EFFDATE OF ZAPE-REC TO WRK-EFFD-ZAPE                                                               171003 
 6475.00                                                                                                                      171003 
 6476.00              IF  WRKEFFZ-YEAR           = WRK-RUNY                                                                   171003 
 6477.00              AND WRKEFFZ-MONTH          = WRK-RUNM                                                                   171003 
 6478.00                                                                                                                      171003 
 6479.00       ****   THIS FLAG WITH 'Y' SHOWS THAT CONCERNS APE                                                              171003 
 6480.00                  IF ZNEWOLD OF ZAPE-REC = 'Y'                                                                        171003 
 6481.00                     MOVE '00' TO WRK-FOUND-ZAPE-SLC                                                                  171004 
 6482.00                     PERFORM CHECK-AMOUNTS                                                                            171003 
 6483.00                  END-IF                                                                                              171003 
 6484.00                  IF ZNEWOLD OF ZAPE-REC = 'N'                                                                        171009 
 6485.00                     MOVE '00' TO WRK-FOUND-ZAPE-SLC-NAPE                                                             171009 
 6486.00                     PERFORM CHECK-AMOUNTS                                                                            171009 
 6487.00                  END-IF                                                                                              171009 
 6488.00              END-IF                                                                                                  171003 
 6489.00            READ ZAPE      NEXT                                                                                       171003 
 6490.00                                                                                                                      171003 
 6491.00            END-PERFORM                                                                                               171003 
 6492.00                                                                                                                      171003 
 6493.00            .                                                                                                         171003 
 6494.00            END-CHECK-ZAPE-SLC.                                                                                       171003 
 6495.00            EXIT.                                                                                                     171003 
 6496.00       *------------------------------------------------------------------------------------------------------------- 170920 
 6497.00         CHECK-AMOUNTS SECTION.                                                                                       170920 
 6498.00                                                                                                                      181205 
 6499.00       **** the annual premium is changed only for                                                                    181205 
 6500.00       **** the products that have annual premium                                                                     181205 
 6501.00       *    (MCG4 has same rules as MCG2)                                                                             190328 
 6502.00            IF  MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG1'                                                                181205 
 6503.00            AND MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG2'                                                                181205 
 6504.00       **?? AND MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG4'                                                                190402 
 6505.00       **** AND MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG3'                                                                190328 
 6506.00            AND MPULCOD OF MPMDLPNTNP-REC(1:2) NOT                                                                    181205 
 6507.00                                               = 'TU'                                                                 181205 
 6508.00               MOVE ZANNPRM OF ZAPE-REC TO MPANNPRM OF MPMDLPNTNP-REC                                                 181205 
 6509.00            END-IF                                                                                                    181205 
 6510.00                                                                                                                      170920 
 6511.00       ****   IF MPANNPRM OF MPMDLPNTNP-REC NOT = ZEROES                                                              180126 
 6512.00       ****   the annual premium is changed only for                                                                  180202 
 6513.00       ****   the products that have annual premium                                                                   180202 
 6514.00       ****   IF  MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG1'                                                              181205 
 6515.00       ****   AND MPULCOD OF MPMDLPNTNP-REC NOT = 'MCG2'                                                              181205 
 6516.00       ****   AND MPULCOD OF MPMDLPNTNP-REC(1:2) NOT                                                                  181205 
 6517.00       ****                                      = 'TU'                                                               181205 
 6518.00       ****      MOVE ZANNPRM OF ZAPE-REC TO MPANNPRM OF MPMDLPNTNP-REC                                               181205 
 6519.00       ****   END-IF                                                                                                  181205 
 6520.00       ****   END-IF                                                                                                  180126 
 6521.00                                                                                                                      171018 
 6522.00       * EINAI H   ZAPE (  BIF  MPSGLRPM * 10)                                      171229 
 6523.00       *29 12/2017 *10 must be computed                                                                               180126 
 6524.00              IF MPSGLPRM OF MPMDLPNTNP-REC NOT = ZEROES                                                              180126 
 6525.00                 COMPUTE MPSGLPRM OF MPMDLPNTNP-REC                                                                   171229 
 6526.00                                                = ZANNPRM OF ZAPE-REC                                                 171229 
 6527.00                                                * 10                                                                  171229 
 6528.00              END-IF                                                                                                  180126 
 6529.00                                                                                                                      171030 
 6530.00       ****   ZAPE      W...                                     171030 
 6531.00              IF JCOVCODE  OF ZAPE-REC(1:2)= 'MC'                                                                     171030 
 6532.00                 PERFORM LOOP-MZAPE                                                                                   171030 
 6533.00              END-IF                                                                                                  171030 
 6534.00                                                                                                                      171030 
 6535.00       **** Client origin 11 and campaign then    /                                             171030 
 6536.00              IF  MPCLNTORG OF MPMDLPNTNP-REC                                                                         171030 
 6537.00                                           = '11'                                                                     171030 
 6538.00              AND CAMPCOD OF FCONCOV-REC  NOT                                                                         171030 
 6539.00                                           = SPACES                                                                   171030 
 6540.00              AND MPANNPRM OF MPMDLPNTNP-REC NOT =                                                                    171030 
 6541.00                  ZINTPREM OF ZAPE-REC                                                                                171030 
 6542.00                                                                                                                      171030 
 6543.00                  MOVE ZINTPREM OF ZAPE-REC TO MPANNPRM OF MPMDLPNTNP-REC                                             171030 
 6544.00                                                                                                                      171030 
 6545.00              END-IF                                                                                                  171030 
 6546.00                                                                                                                      171030 
 6547.00       *       18/10/2017                                                   171030 
 6548.00       *       0.01                                                             171030 
 6549.00       *           'HRP1'                                                               171030 
 6550.00              IF MPANNPRM  OF MPMDLPNTNP-REC                                                                          180201 
 6551.00                                         = 0                                                                          171030 
 6552.00              AND (MPRIDCOD OF MPMDLPNTNP-REC                                                                         180201 
 6553.00                                         = 'HRP1'                                                                     171030 
 6554.00              OR MPRIDCOD OF MPMDLPNTNP-REC                                                                           180201 
 6555.00                                         = 'HRP2' )                                                                   171030 
 6556.00                     MOVE 0.01          TO MPANNPRM  OF MPMDLPNTNP-REC                                                171030 
 6557.00              END-IF                                                                                                  180201 
 6558.00                                                                                                                      180201 
 6559.00       *       01/02/2018   /                                                 180201 
 6560.00       *             effective from ZAPE                                           180201 
 6561.00       *    =TRANSACTION DATE                                                                                         180201 
 6562.00              MOVE RSKCOMMDT OF WRK-FCONCOV-REC TO WRK-DATE9                                                          180201 
 6563.00                                                                                                                      180201 
 6564.00              IF  WRK-DATE9  <   WRK-RUNDT                                                                            180201 
 6565.00                  MOVE EFFDATE OF ZAPE-REC TO WRK-EFFD-ZAPE                                                           180201 
 6566.00                  MOVE WRKEFFZ-DAY    TO MPINCPDAY  OF MPMDLPNTNP-REC                                                 180201 
 6567.00                  MOVE WRKEFFZ-MONTH  TO MPINCPMON  OF MPMDLPNTNP-REC                                                 180201 
 6568.00                  MOVE WRKEFFZ-YEAR   TO MPINCPYEAR OF MPMDLPNTNP-REC                                                 180201 
 6569.00              END-IF                                                                                                  180201 
 6570.00                  COMPUTE  MPSPCOD  OF MPMDLPNTNP-REC =                                                               180313 
 6571.00                           MPINCPMON OF MPMDLPNTNP-REC + 50                                                           180313 
 6572.00       * Change 30/08/2018 it was decided for new business the client origin                                          180830 
 6573.00       * to be taken from ZAPE file.                                                                                  180830 
 6574.00            IF   ZCLTORIG OF ZAPE-REC(2:1)  = ' '                                                                     180919 
 6575.00                 MOVE ZCLTORIG OF ZAPE-REC(1:1)                                                                       180919 
 6576.00                                          TO MPCLNTORG  OF MPMDLPNTNP-REC                                             180919 
 6577.00            ELSE                                                                                                      180919 
 6578.00                 MOVE ZCLTORIG OF ZAPE-REC                                                                            180919 
 6579.00                                          TO MPCLNTORG  OF MPMDLPNTNP-REC                                             180919 
 6580.00            END-IF                                                                                                    180919 
 6581.00       *      MOVE ZCLTORIG OF ZAPE-REC TO MPCLNTORG  OF MPMDLPNTNP-REC                                               180919 
 6582.00            .                                                                                                         170920 
 6583.00            END-CHECK-AMOUNTS.                                                                                        170920 
 6584.00            EXIT.                                                                                                     170920 
 6585.00       *------------------------------------------------------------------------------------------------------------- 170920 
 6586.00         CHECK-FAPEP SECTION.                                                                                         170928 
 6587.00       *------------------------------------------------------------------------------------------------------------- 170928 
 6588.00            INITIALIZE FAPEPR OF FAPEP-REC                                                                            170929 
 6589.00            INITIALIZE WRK-EFFD-FAPE                                                                                  170928 
 6590.00            INITIALIZE WRK-CONNBR                                                                                     170929 
 6591.00            INITIALIZE WRK-FCHDRNUM                                                                                   170929 
 6592.00            INITIALIZE WRK-CLNTCOD                                                                                    170929 
 6593.00            INITIALIZE WRK-FLIFENUM                                                                                   170929 
 6594.00            INITIALIZE WRK-FJCOVCODE                                                                                  180125 
 6595.00            INITIALIZE WRK4-FJCOVCODE                                                                                 180126 
 6596.00            INITIALIZE WRK5-FJCOVCODE                                                                                 180126 
 6597.00            INITIALIZE WRK-FREQCOD                                                                                    171002 
 6598.00            MOVE '99' TO WRK-FOUND-FAPEP                                                                              171003 
 6599.00            MOVE '99' TO WRK-FOUND-NFAPEP                                                                             171009 
 6600.00                                                                                                                      170928 
 6601.00            MOVE '00'                     TO WRK-COMPCOD                                                              170929 
 6602.00            MOVE CONNBR    OF WRK-FCONCOV-REC TO WRK-CONNBR                                                           180126 
 6603.00            MOVE WRK-FCHDRNUM             TO FCHDRNUM OF FAPEP-REC                                                    170929 
 6604.00            MOVE CLNTCOD   OF FCONLIF-REC TO WRK-CLNTCOD                                                              170929 
 6605.00            MOVE WRK-FLIFENUM TO FLIFENUM OF FAPEP-REC                                                                170929 
 6606.00                                                                                                                      180126 
 6607.00            MOVE COVCOD    OF WRK-FCONCOV-REC                                                                         180126 
 6608.00                                          TO WRK-FJCOVCODE                                                            180126 
 6609.00            MOVE WRK-FJCOVCODE(1:2)                                                                                   180126 
 6610.00                                          TO WRK1-FJCOVCODE                                                           180126 
 6611.00            MOVE '/'                      TO WRK2-FJCOVCODE                                                           180126 
 6612.00            IF   COVCOD OF FCONCOV-REC(3:1)  = '/'                                                                    180126 
 6613.00                 MOVE COVCOD OF FCONCOV-REC(4:3)                                                                      180126 
 6614.00                                          TO WRK3-FJCOVCODE                                                           180126 
 6615.00            ELSE                                                                                                      180126 
 6616.00                 MOVE COVCOD OF FCONCOV-REC(3:3)                                                                      180126 
 6617.00                                          TO WRK3-FJCOVCODE                                                           180126 
 6618.00            END-IF                                                                                                    180126 
 6619.00                                                                                                                      180126 
 6620.00            MOVE WRK4-FJCOVCODE                                                                                       180126 
 6621.00                                          TO WRK5-FJCOVCODE                                                           180126 
 6622.00                                                                                                                      180126 
 6623.00            MOVE WRK5-FJCOVCODE                                                                                       180126 
 6624.00                                          TO FJCOVCODE OF FAPEP-REC                                                   180125 
 6625.00                                                                                                                      170928 
 6626.00                                                                                                                      180126 
 6627.00            START FAPEP KEY IS          >= EXTERNALLY-DESCRIBED-KEY                                                   170928 
 6628.00            READ  FAPEP NEXT                                                                                          170928 
 6629.00                                                                                                                      170928 
 6630.00            PERFORM UNTIL FAPEP-STATUS NOT = FOUND-REC                                                                170928 
 6631.00              OR FCHDRCOY OF FAPEP-REC NOT =                                                                          170928 
 6632.00              WRK-FCHDRCOY                                                                                            170929 
 6633.00              OR FCHDRNUM OF FAPEP-REC NOT =                                                                          170928 
 6634.00              WRK-FCHDRNUM                                                                                            170929 
 6635.00              OR FLIFENUM OF FAPEP-REC NOT =                                                                          170928 
 6636.00              WRK-FLIFENUM                                                                                            170929 
 6637.00              OR FJCOVCODE OF FAPEP-REC                                                                               170928 
 6638.00                                     NOT   =                                                                          170928 
 6639.00              WRK5-FJCOVCODE                                                                                          180126 
 6640.00                                                                                                                      170928 
 6641.00              MOVE FEFFDATE OF FAPEP-REC TO WRK-EFFD-FAPE                                                             170928 
 6642.00                                                                                                                      170928 
 6643.00              IF  WRKEFFP-YEAR                = WRK-RUNY                                                              171009 
 6644.00              AND WRKEFFP-MONTH               = WRK-RUNM                                                              171009 
 6645.00                                                                                                                      170928 
 6646.00                  IF FJCOVCODE OF FAPEP-REC   = '00/179'                                                              171009 
 6647.00                  OR FJCOVCODE OF FAPEP-REC   = '05/Y00'                                                              171009 
 6648.00                  OR FJCOVCODE OF FAPEP-REC   = '05/Y01'                                                              171009 
 6649.00                  OR FJCOVCODE OF FAPEP-REC   = '05/Y02'                                                              171009 
 6650.00                  OR FJCOVCODE OF FAPEP-REC   = '02/I20'                                                              171009 
 6651.00                                                                                                                      171009 
 6652.00                     MOVE '00' TO WRK-FOUND-FAPEP                                                                     171009 
 6653.00                  ELSE                                                                                                171009 
 6654.00                     MOVE '00' TO WRK-FOUND-NFAPEP                                                                    171009 
 6655.00                  END-IF                                                                                              171009 
 6656.00                                                                                                                      171009 
 6657.00                  IF  MPANNPRM OF MPMDLPNTNP-REC                                                                      171009 
 6658.00                                          NOT =                                                                       171009 
 6659.00                      FORIGPREM OF FAPEP-REC                                                                          180306 
 6660.00                      MOVE FORIGPREM OF FAPEP-REC                                                                     180306 
 6661.00                                        TO                                                                            170928 
 6662.00                      MPANNPRM OF MPMDLPNTNP-REC                                                                      180306 
 6663.00                  END-IF                                                                                              171009 
 6664.00       * IN CASE OF REC WITH INSRPREM<>0 DID NT PASS AS IN FAPEP IS ALWAYS ANNUAL PREM                                171009 
 6665.00                  IF  MPANNPRM OF MPMDLPNTNP-REC                                                                      180306 
 6666.00                                         = ZEROES                                                                     171002 
 6667.00                      IF  ISTNETPRM OF WRK-FCONCOV-REC                                                                180306 
 6668.00                                     NOT = ZEROES                                                                     171002 
 6669.00                             MOVE FREQCOD OF FCONTRACT-REC                                                            171009 
 6670.00                                      TO WRK-FREQCOD                                                                  171002 
 6671.00                             COMPUTE  MPANNPRM OF MPMDLPNTNP-REC                                                      171009 
 6672.00                                         = ISTNETPRM OF WRK-FCONCOV-REC                                               171002 
 6673.00                                         * WRK-WFREQCOD                                                               171002 
 6674.00                      END-IF                                                                                          180306 
 6675.00                  END-IF                                                                                              180306 
 6676.00       *23/10/2017 was asked to be updated                                                                            171023 
 6677.00       ****          IF MPDEDUCT OF MPMDLPNTNP-REC = 0                                                                180126 
 6678.00       ****change 26/01/2018 for 00/179 it had amount 0.22 from fconcov                                               180126 
 6679.00                  MOVE FEKPAMT OF FAPEP-REC                                                                           180306 
 6680.00                       TO MPDEDUCT OF MPMDLPNTNP-REC                                                                  180306 
 6681.00       ****          END-IF                                                                                           180126 
 6682.00                                                                                                                      180129 
 6683.00       *29/01/2018 it brought 0 from fanal01,02 and they had problems                                                 180129 
 6684.00       *2/2/2018  sumins what FAPEP has                                                                               180202 
 6685.00       ****          IF MPSUMINS OF MPMDLPNTNP-REC = 0                                                                180202 
 6686.00                  MOVE FASFKEF OF FAPEP-REC                                                                           180306 
 6687.00                       TO MPSUMINS OF MPMDLPNTNP-REC                                                                  180306 
 6688.00       ****          END-IF                                                                                           180202 
 6689.00       *01/02/2018 it was asked to take the                                                                           180202 
 6690.00       * Client origin from APE Pireaus                                                                               180202 
 6691.00       * if the duration = 0 take the duration from APE Pireaus                                                       180202 
 6692.00                  MOVE FCLTORIG      OF FAPEP-REC                                                                     180202 
 6693.00                       TO MPCLNTORG  OF MPMDLPNTNP-REC                                                                180202 
 6694.00                  IF MPRIDCOD OF MPMDLPNTNP-REC(1:2) NOT = '05'                                                       180314 
 6695.00                     MOVE FDIAKAL OF FAPEP-REC                                                                        180314 
 6696.00                       TO MPCOVTRM  OF MPMDLPNTNP-REC                                                                 180313 
 6697.00                     MOVE FDIAKAL OF FAPEP-REC                                                                        180314 
 6698.00                       TO MPPRMTRM  OF MPMDLPNTNP-REC                                                                 180313 
 6699.00                  END-IF                                                                                              180314 
 6700.00              END-IF                                                                                                  170928 
 6701.00                                                                                                                      170928 
 6702.00            READ FAPEP     NEXT                                                                                       170928 
 6703.00                                                                                                                      170928 
 6704.00            END-PERFORM                                                                                               170928 
 6705.00                                                                                                                      170928 
 6706.00            .                                                                                                         171018 
 6707.00            END-CHECK-FAPEP.                                                                                          170928 
 6708.00            EXIT.                                                                                                     170928 
 6709.00       *------------------------------------------------------------------------------------------------------------- 171004 
 6710.00         LOOP-MZAPE SECTION.                                                                                          171018 
 6711.00       *------------------------------------------------------------------------------------------------------------- 171018 
 6712.00            INITIALIZE ZAPEREC OF MZAPE-REC                                                                           171018 
 6713.00            INITIALIZE WRK-ZANNPRM                                                                                    171018 
 6714.00            INITIALIZE WRK-EFFD-MZAPE                                                                                 171018 
 6715.00                                                                                                                      171018 
 6716.00            MOVE CRTDATE OF ZAPE-REC      TO CRTDATE  OF MZAPE-REC                                                    171018 
 6717.00            MOVE CHDRCOY OF ZAPE-REC      TO CHDRCOY  OF MZAPE-REC                                                    171018 
 6718.00            MOVE CHDRNUM OF ZAPE-REC      TO CHDRNUM  OF MZAPE-REC                                                    171018 
 6719.00            MOVE LOW-VALUES               TO LIFENUM  OF MZAPE-REC                                                    171018 
 6720.00            MOVE LOW-VALUES               TO JCOVCODE OF MZAPE-REC                                                    171018 
 6721.00            MOVE LOW-VALUES               TO EFFDATE  OF MZAPE-REC                                                    171018 
 6722.00                                                                                                                      171018 
 6723.00            START MZAPE KEY IS          >= EXTERNALLY-DESCRIBED-KEY                                                   171018 
 6724.00            READ  MZAPE NEXT                                                                                          171018 
 6725.00                                                                                                                      171018 
 6726.00            PERFORM    UNTIL  MZAPE-STATUS NOT = FOUND-REC                                                            171018 
 6727.00              OR CRTDATE  OF MZAPE-REC NOT =                                                                          171018 
 6728.00              CRTDATE     OF ZAPE-REC                                                                                 171018 
 6729.00              OR CHDRCOY  OF MZAPE-REC NOT =                                                                          171018 
 6730.00              CHDRCOY     OF MZAPE-REC                                                                                171018 
 6731.00              OR CHDRNUM  OF MZAPE-REC NOT =                                                                          171018 
 6732.00              CHDRNUM     OF ZAPE-REC                                                                                 171018 
 6733.00                                                                                                                      171018 
 6734.00              MOVE EFFDATE OF MZAPE-REC TO WRK-EFFD-MZAPE                                                             171018 
 6735.00                                                                                                                      171018 
 6736.00              IF  WRKMEFFZ-YEAR          = WRK-RUNY                                                                   171018 
 6737.00              AND WRKMEFFZ-MONTH         = WRK-RUNM                                                                   171018 
 6738.00              AND ZNEWOLD OF MZAPE-REC   = 'Y'                                                                        171018 
 6739.00                                                                                                                      171018 
 6740.00                  IF JCOVCODE  OF ZAPE-REC(1:2)= 'MC'                                                                 171018 
 6741.00                  OR JCOVCODE  OF ZAPE-REC(1:1)= 'W'                                                                  171018 
 6742.00                     COMPUTE WRK-ZANNPRM =                                                                            171018 
 6743.00                                         + WRK-ZANNPRM                                                                171018 
 6744.00                                         + ZANNPRM OF MZAPE-REC                                                       171018 
 6745.00                  END-IF                                                                                              171018 
 6746.00              END-IF                                                                                                  171018 
 6747.00                                                                                                                      171018 
 6748.00            READ MZAPE     NEXT                                                                                       171018 
 6749.00                                                                                                                      171018 
 6750.00            END-PERFORM                                                                                               171018 
 6751.00                                                                                                                      171018 
 6752.00       *    (MCG4 has same rules as MCG2)                                                                             190328 
 6753.00            IF  MPANNPRM OF MPMDLPNTNP-REC NOT = WRK-ZANNPRM                                                          181205 
 6754.00            AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG1'                                                               181205 
 6755.00            AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG2'                                                               181205 
 6756.00       **?? AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG4'                                                               190402 
 6757.00       **** AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG3'                                                               190328 
 6758.00            AND MPULCOD OF MPMDLPNTNP-REC(1:2) NOT                                                                    181205 
 6759.00                                               = 'TU'                                                                 181205 
 6760.00                COMPUTE MPANNPRM OF MPMDLPNTNP-REC                                                                    181205 
 6761.00                                         = WRK-ZANNPRM                                                                181205 
 6762.00                END-COMPUTE                                                                                           181205 
 6763.00            END-IF                                                                                                    181205 
 6764.00                                                                                                                      181205 
 6765.00       **** IF  MPANNPRM OF MPMDLPNTNP-REC NOT = ZEROES                                                               180126 
 6766.00       **** AND MPANNPRM OF MPMDLPNTNP-REC NOT                                                                        180126 
 6767.00       **** IF  MPANNPRM OF MPMDLPNTNP-REC NOT                                                                        181205 
 6768.00       ****                                    = WRK-ZANNPRM                                                          181205 
 6769.00       **** AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG1'                                                               181205 
 6770.00       **** AND MPULCOD OF MPMDLPNTNP-REC NOT  = 'MCG2'                                                               181205 
 6771.00       **** AND MPULCOD OF MPMDLPNTNP-REC(1:2) NOT                                                                    181205 
 6772.00       ****                                    = 'TU'                                                                 181205 
 6773.00       ****     COMPUTE MPANNPRM OF MPMDLPNTNP-REC                                                                    181205 
 6774.00       ****                              =                                                                            181205 
 6775.00       ****               WRK-ZANNPRM                                                                                 181205 
 6776.00       **** END-IF                                                                                                    181205 
 6777.00                                                                                                                      171030 
 6778.00       *29/12/2017 *10 must be computed                                                                               171229 
 6779.00            IF  MPSGLPRM OF MPMDLPNTNP-REC NOT = ZEROES                                                               180126 
 6780.00            AND MPSGLPRM OF MPMDLPNTNP-REC NOT                                                                        180126 
 6781.00                                         = WRK-ZANNPRM                                                                171030 
 6782.00                COMPUTE MPSGLPRM OF MPMDLPNTNP-REC                                                                    171030 
 6783.00                                         =                                                                            171030 
 6784.00                          WRK-ZANNPRM    * 10                                                                         171229 
 6785.00            END-IF                                                                                                    171030 
 6786.00                                                                                                                      171030 
 6787.00            .                                                                                                         171018 
 6788.00            END-LOOP-MZAPE.                                                                                           171018 
 6789.00            EXIT.                                                                                                     171018 
 6790.00       *------------------------------------------------------------------------------------------------------------- 171019 
 6791.00         WRITE-NEW-TOPUPS SECTION.                                                                                    171019 
 6792.00       *------------------------------------------------------------------------------------------------------------- 171019 
 6793.00            IF WRK-NEW-TOPUP = 1                                                                                      171019 
 6794.00               INITIALIZE MPMDLPNTR  OF MPMDLPNTNP-REC                                                                171020 
 6795.00               MOVE MPMDLPNT-REC TO MPMDLPNTNP-REC                                                                    171020 
 6796.00       *        FCONCOVSLC KI ENHM  PMDLPNTNP                      171019 
 6797.00                                                                                                                      171019 
 6798.00               MOVE '99' TO WRK-FOUND-ZAPE                                                                            171019 
 6799.00                                                                                                                      171019 
 6800.00            PERFORM VARYING WSAA-TOP-IND  FROM 1 BY 1                                                                 171019 
 6801.00               UNTIL WSAA-IND              > 99                                                                       171019 
 6802.00               OR  WSAA-NCONNBR(WSAA-TOP-IND)                                                                         180104 
 6803.00                                          = SPACES                                                                    171019 
 6804.00                                                                                                                      171019 
 6805.00            IF  WSAA-NRSKCOMMDT(WSAA-TOP-IND)                                                                         180104 
 6806.00                                          >= WRK-CURRENTAPO                                                           171020 
 6807.00            AND WSAA-NRSKCOMMDT(WSAA-TOP-IND)                                                                         180104 
 6808.00                                          <= WRK-CURRENTEOS                                                           171020 
 6809.00       *    MPISSYEAR                                                                                                 171019 
 6810.00                 MOVE WSAA-NRSKCOMMDT(WSAA-TOP-IND) TO WRK-DATE9                                                      180104 
 6811.00                 MOVE WRK9DAY      TO MPINCPDAY  OF MPMDLPNTNP-REC                                                    171019 
 6812.00                 MOVE WRK9MONTH    TO MPINCPMON  OF MPMDLPNTNP-REC                                                    171019 
 6813.00                 MOVE WRK9YEAR     TO MPINCPYEAR OF MPMDLPNTNP-REC                                                    171019 
 6814.00                 MOVE WSAA-NRSKCOMMAGE(WSAA-TOP-IND)                                                                  180104 
 6815.00                                TO MPAGEENTR  OF MPMDLPNTNP-REC                                                       171019 
 6816.00            COMPUTE  MPSPCOD   OF MPMDLPNTNP-REC =                                                                    171019 
 6817.00                     MPINCPMON OF MPMDLPNTNP-REC + 50                                                                 171019 
 6818.00                 MOVE WSAA-NSUMINSAMT(WSAA-TOP-IND)                                                                   180104 
 6819.00                                TO MPSUMINS OF MPMDLPNTNP-REC                                                         171019 
 6820.00       *MPANNPRM                                                                                                      171019 
 6821.00                 MOVE WSAA-NSGLNETPRM(WSAA-TOP-IND)                                                                   180104 
 6822.00                                TO MPSGLPRM OF MPMDLPNTNP-REC                                                         171019 
 6823.00                 MOVE 1            TO MPPOLNO  OF MPMDLPNTNP-REC                                                      171019 
 6824.00                 MOVE MPINCPMON OF MPMDLPNTNP-REC                                                                     171019 
 6825.00                                TO MPSALMON OF MPMDLPNTNP-REC                                                         171019 
 6826.00       ****      MOVE WSAA-NDIVAMT(WSAA-TOP-IND)                                                                      180129 
 6827.00       ****                     TO MPDIVAMT OF MPMDLPNTNP-REC                                                         180129 
 6828.00       ****      29.01.2018                                                                                           180129 
 6829.00                 MOVE ZEROES    TO MPDIVAMT OF MPMDLPNTNP-REC                                                         180129 
 6830.00                 MOVE WSAA-NCONNBR(WSAA-TOP-IND)                                                                      180104 
 6831.00                                TO WRK-M1FPOLNUM                                                                      171019 
 6832.00                 MOVE WRK-M1FPOLNUM TO WRK-MPFPOLNUM                                                                  171019 
 6833.00                 MOVE WRK-MPFPOLNUM                                                                                   171019 
 6834.00                                TO MPFPOLNUM OF MPMDLPNTNP-REC                                                        171019 
 6835.00                 MOVE WSAA-NLOANOUTAMT(WSAA-TOP-IND)                                                                  180104 
 6836.00                                TO MPLOANAMT OF MPMDLPNTNP-REC                                                        171019 
 6837.00                 MOVE WSAA-NCOVCOD(WSAA-TOP-IND)                                                                      180104 
 6838.00                                TO MPULCOD   OF MPMDLPNTNP-REC                                                        171019 
 6839.00       *MPCLNTCOD                                                                                                     171019 
 6840.00                 INITIALIZE MPSTATUSR OF  MPSTATUS-REC                                                                171020 
 6841.00                                                                                                                      171019 
 6842.00                 MOVE WSAA-NSTSCOD(WSAA-TOP-IND)                                                                      180104 
 6843.00                                TO STSCOD OF MPSTATUS-REC                                                             180104 
 6844.00                 READ MPSTATUS                                                                                        171020 
 6845.00                 IF MPSTATUS-STATUS = FOUND-REC                                                                       171020 
 6846.00                    MOVE MPSTSCOD OF MPSTATUS-REC TO                                                                  171020 
 6847.00                                MPSTSCOD OF MPMDLPNTNP-REC                                                            171019 
 6848.00                 END-IF                                                                                               171020 
 6849.00                                                                                                                      171019 
 6850.00                 MOVE WSAA-NRSKCOMMAGE(WSAA-TOP-IND)                                                                  180104 
 6851.00                                TO MPAGERDF  OF MPMDLPNTNP-REC                                                        171019 
 6852.00                 MOVE "TA_0000"  TO MPDSBCHA OF MPMDLPNTNP-REC                                                        171024 
 6853.00                                                                                                                      190220 
 6854.00       *    it is refactored into NEW BUSINESS writing routine WRITE-NEWBUS-REC.                                      190220 
 6855.00       ****      COMPUTE WRRN = WRRN + 1                                                                              190220 
 6856.00       ****      MOVE WRRN         TO MPCMPIDF  OF MPMDLPNTNP-REC                                                     190220 
 6857.00                                                                                                                      190220 
 6858.00                 MOVE WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6859.00                                TO MPCLNTORG OF MPMDLPNTNP-REC                                                        171019 
 6860.00                 MOVE  WSAA-NNINVAMT(WSAA-TOP-IND)                                                                    180104 
 6861.00                                TO MPNOTINV   OF MPMDLPNTNP-REC                                                       171019 
 6862.00                                                                                                                      171020 
 6863.00                 IF  COVCOD OF WRK-FCONCOV-REC(1:2)                                                                   180515 
 6864.00                                         =  'UR'                                                                      180515 
 6865.00                 OR  COVCOD OF WRK-FCONCOV-REC(1:3)                                                                   180507 
 6866.00                                         =  'TU0'                                                                     180507 
 6867.00                     MOVE ZEROES        TO MPPROTAMT OF MPMDLPNTNP-REC                                                171019 
 6868.00                     MOVE ZEROES        TO MPNOTINV  OF MPMDLPNTNP-REC                                                171019 
 6869.00                 END-IF                                                                                               171019 
 6870.00                                                                                                                      171020 
 6871.00                 MOVE 1         TO MPAVIDXDTA OF MPMDLPNTNP-REC                                                       171019 
 6872.00       *    1                                                               171019 
 6873.00            IF COVYEARNO OF FCONCOVSLC-REC     = 1                                                                    171023 
 6874.00               IF  WSAA-NCOVCOD(WSAA-TOP-IND)(1:3)                                                                    180507 
 6875.00                                               = 'TU0'                                                                180507 
 6876.00                   COMPUTE  MPTOPUPY1 OF MPMDLPNTNP-REC                                                               171023 
 6877.00                                               =                                                                      171023 
 6878.00                                  WSAA-NSGLNETPRM(WSAA-TOP-IND)                                                       180104 
 6879.00                                               -                                                                      171023 
 6880.00                                  WSAA-NNINVAMT(WSAA-TOP-IND)                                                         180104 
 6881.00               END-IF                                                                                                 171023 
 6882.00            END-IF                                                                                                    171023 
 6883.00                                                                                                                      171023 
 6884.00            IF   WSAA-NCOVCOD(WSAA-TOP-IND)    = 'TU06'                                                               180104 
 6885.00            OR   WSAA-NCOVCOD(WSAA-TOP-IND)    = 'TU08'                                                               180507 
 6886.00            OR   WSAA-NCOVCOD(WSAA-TOP-IND)    = 'TU09'                                                               180507 
 6887.00                 MOVE MPTOPUPY1  OF MPMDLPNTNP-REC                                                                    171023 
 6888.00                      TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                                 171023 
 6889.00                 MOVE ZEROES                                                                                          171023 
 6890.00                      TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                                 171023 
 6891.00            END-IF                                                                                                    171023 
 6892.00                                                                                                                      171023 
 6893.00            IF   WSAA-NCOVCOD(WSAA-TOP-IND)    = 'TU05'                                                               180104 
 6894.00            OR   WSAA-NCOVCOD(WSAA-TOP-IND)    = 'TU07'                                                               180507 
 6895.00                 MOVE MPTOPUPY1  OF MPMDLPNTNP-REC                                                                    171023 
 6896.00                      TO MPTOPUPTGR OF MPMDLPNTNP-REC                                                                 171023 
 6897.00                 MOVE ZEROES                                                                                          171023 
 6898.00                      TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                                 171023 
 6899.00            END-IF                                                                                                    171023 
 6900.00                                                                                                                      171019 
 6901.00       ****      MOVE  ZEROES   TO MPTOPUPY1  OF MPMDLPNTNP-REC                                                       171023 
 6902.00                 MOVE  ZEROES   TO MPTOPUPY2  OF MPMDLPNTNP-REC                                                       171019 
 6903.00                 MOVE  ZEROES   TO MPTOPUPY3  OF MPMDLPNTNP-REC                                                       171019 
 6904.00                 MOVE  ZEROES   TO MPTOPUPY4  OF MPMDLPNTNP-REC                                                       171019 
 6905.00                 MOVE  ZEROES   TO MPTOPUPY5  OF MPMDLPNTNP-REC                                                       171019 
 6906.00       ****      MOVE  ZEROES   TO MPTOPUPTOT OF MPMDLPNTNP-REC                                                       171023 
 6907.00                                                                                                                      171019 
 6908.00                 IF   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TUM1'                                                             180104 
 6909.00                      MOVE 'MCP1'                                                                                     171019 
 6910.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171019 
 6911.00                 END-IF                                                                                               171019 
 6912.00                                                                                                                      171019 
 6913.00                 IF   WSAA-NCOVCOD(WSAA-IND)     = 'TUM2'                                                             180104 
 6914.00                      MOVE 'MCP2'                                                                                     171019 
 6915.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171019 
 6916.00                 END-IF                                                                                               171019 
 6917.00                                                                                                                      171019 
 6918.00                 IF   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TUM3'                                                             180104 
 6919.00                      MOVE 'MCG1'                                                                                     171019 
 6920.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171019 
 6921.00                 END-IF                                                                                               171019 
 6922.00                                                                                                                      171019 
 6923.00                 IF   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TUM4'                                                             180104 
 6924.00                      MOVE 'MCG2'                                                                                     171019 
 6925.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171019 
 6926.00                 END-IF                                                                                               171019 
 6927.00                                                                                                                      171019 
 6928.00                 IF   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TU05'                                                             180104 
 6929.00                 OR   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TU06'                                                             180104 
 6930.00                      MOVE 'ULTIMA'                                                                                   171019 
 6931.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         171019 
 6932.00                 END-IF                                                                                               171019 
 6933.00                                                                                                                      180507 
 6934.00                 IF   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TU07'                                                             180507 
 6935.00                 OR   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TU08'                                                             180507 
 6936.00                 OR   WSAA-NCOVCOD(WSAA-TOP-IND) = 'TU09'                                                             180507 
 6937.00                      MOVE 'UR02'                                                                                     180507 
 6938.00                                TO MPFILFLD OF MPMDLPNTNP-REC                                                         180507 
 6939.00                 END-IF                                                                                               180507 
 6940.00                                                                                                                      171019 
 6941.00                 IF   WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6942.00                                                 = '01'                                                               180104 
 6943.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6944.00                                                 = '02'                                                               180104 
 6945.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6946.00                                                 = '05'                                                               180104 
 6947.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6948.00                                                 = '06'                                                               180104 
 6949.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6950.00                                                 = '07'                                                               180104 
 6951.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6952.00                                                 = '08'                                                               180104 
 6953.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6954.00                                                 = '09'                                                               180104 
 6955.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6956.00                                                 = '10'                                                               180104 
 6957.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6958.00                                                 = '11'                                                               180104 
 6959.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6960.00                                                 = '12'                                                               180104 
 6961.00                   OR WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                                  180104 
 6962.00                                                 = '14'                                                               180104 
 6963.00                                                                                                                      171019 
 6964.00                   PERFORM CHECK-ZAPE-SLC                                                                             171020 
 6965.00                                                                                                                      171019 
 6966.00                   IF WRK-FOUND-ZAPE-SLC         = '00'                                                               180104 
 6967.00                      PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                              171024 
 6968.00                      PERFORM WRITE-NEWBUS-REC                                                                        190219 
 6969.00       ****           WRITE MPMDLPNTNP-REC                                                                            190219 
 6970.00                   END-IF                                                                                             171020 
 6971.00                   IF WRK-FOUND-ZAPE-SLC-NAPE    = '00'                                                               180104 
 6972.00                      PERFORM CHANGE-CLIENTORIGIN-FORNEW                                                              171024 
 6973.00                      PERFORM WRITE-NON-APE                                                                           180319 
 6974.00                   END-IF                                                                                             171020 
 6975.00                                                                                                                      171019 
 6976.00                 END-IF                                                                                               171019 
 6977.00            END-IF                                                                                                    171020 
 6978.00                                                                                                                      171019 
 6979.00            END-PERFORM                                                                                               171019 
 6980.00       *                                                                               171019 
 6981.00            INITIALIZE  WSAA-FCONCOVSLC-TOPUPS-RECS                                                                   171019 
 6982.00            END-IF                                                                                                    171019 
 6983.00            .                                                                                                         171019 
 6984.00            END-WRITE-NEW-TOPUPS.                                                                                     171019 
 6985.00            EXIT.                                                                                                     171019 
 6986.00       *------------------------------------------------------------------------------------------------------------- 171019 
 6987.00         SAVE-TOPUP-GREATER-DATE SECTION.                                                                             171019 
 6988.00       *------------------------------------------------------------------------------------------------------------- 171019 
 6989.00            ADD 1 TO WSAA-TOP-IND                                                                                     171023 
 6990.00                                                                                                                      171023 
 6991.00            MOVE RUNDT      OF FCONCOVSLC-REC                                                                         171019 
 6992.00                            TO WSAA-NRUNDT(WSAA-TOP-IND)                                                              171019 
 6993.00            MOVE COMPCOD    OF FCONCOVSLC-REC                                                                         171019 
 6994.00                            TO WSAA-NCOMPCOD(WSAA-TOP-IND)                                                            171019 
 6995.00            MOVE DSBCHACOD  OF FCONCOVSLC-REC                                                                         171019 
 6996.00                            TO WSAA-NDSBCHACOD(WSAA-TOP-IND)                                                          171019 
 6997.00            MOVE BRCHCOD    OF FCONCOVSLC-REC                                                                         171019 
 6998.00                            TO WSAA-NBRCHCOD(WSAA-TOP-IND)                                                            171019 
 6999.00            MOVE SYSAPPCOD  OF FCONCOVSLC-REC                                                                         171019 
 7000.00                            TO WSAA-NSYSAPPCOD(WSAA-TOP-IND)                                                          171019 
 7001.00            MOVE CONNBR     OF FCONCOVSLC-REC                                                                         171019 
 7002.00                            TO WSAA-NCONNBR(WSAA-TOP-IND)                                                             171019 
 7003.00            MOVE LIFNO      OF FCONCOVSLC-REC                                                                         171019 
 7004.00                            TO WSAA-NLIFNO(WSAA-TOP-IND)                                                              171019 
 7005.00            MOVE COVNO      OF FCONCOVSLC-REC                                                                         171019 
 7006.00                            TO WSAA-NCOVNO(WSAA-TOP-IND)                                                              171019 
 7007.00            MOVE COVCOD     OF FCONCOVSLC-REC                                                                         171019 
 7008.00                            TO WSAA-NCOVCOD(WSAA-TOP-IND)                                                             171019 
 7009.00            MOVE STSCOD     OF FCONCOVSLC-REC                                                                         171019 
 7010.00                            TO WSAA-NSTSCOD(WSAA-TOP-IND)                                                             171019 
 7011.00            MOVE STSDT      OF FCONCOVSLC-REC                                                                         171019 
 7012.00                            TO WSAA-NSTSDT(WSAA-TOP-IND)                                                              171019 
 7013.00            MOVE STSDT      OF FCONCOVSLC-REC                                                                         171019 
 7014.00                            TO WSAA-NSTSDT(WSAA-TOP-IND)                                                              171019 
 7015.00            MOVE RSKCOMMDT  OF FCONCOVSLC-REC                                                                         171019 
 7016.00                            TO WSAA-NRSKCOMMDT(WSAA-TOP-IND)                                                          171019 
 7017.00            MOVE RSKCESSDT  OF FCONCOVSLC-REC                                                                         171019 
 7018.00                            TO WSAA-NRSKCESSDT(WSAA-TOP-IND)                                                          171019 
 7019.00            MOVE PRMCESSDT  OF FCONCOVSLC-REC                                                                         171019 
 7020.00                            TO WSAA-NPRMCESSDT(WSAA-TOP-IND)                                                          171019 
 7021.00            MOVE BENCESSDT  OF FCONCOVSLC-REC                                                                         171019 
 7022.00                            TO WSAA-NBENCESSDT(WSAA-TOP-IND)                                                          171019 
 7023.00            MOVE PRCAGE     OF FCONCOVSLC-REC                                                                         171019 
 7024.00                            TO WSAA-NPRCAGE(WSAA-TOP-IND)                                                             171019 
 7025.00            MOVE RSKCOMMAGE OF FCONCOVSLC-REC                                                                         171019 
 7026.00                            TO WSAA-NRSKCOMMAGE(WSAA-TOP-IND)                                                         171019 
 7027.00            MOVE RSKCESSAGE OF FCONCOVSLC-REC                                                                         171019 
 7028.00                            TO WSAA-NRSKCESSAGE(WSAA-TOP-IND)                                                         171019 
 7029.00            MOVE RSKCESSTRM OF FCONCOVSLC-REC                                                                         171019 
 7030.00                            TO WSAA-NRSKCESSTRM(WSAA-TOP-IND)                                                         171019 
 7031.00            MOVE COVYEARNO  OF FCONCOVSLC-REC                                                                         171019 
 7032.00                            TO WSAA-NCOVYEARNO(WSAA-TOP-IND)                                                          171019 
 7033.00            MOVE CONCESSAGE OF FCONCOVSLC-REC                                                                         171019 
 7034.00                            TO WSAA-NCONCESSAGE(WSAA-TOP-IND)                                                         171019 
 7035.00            MOVE SUMINSAMT  OF FCONCOVSLC-REC                                                                         171019 
 7036.00                            TO WSAA-NSUMINSAMT(WSAA-TOP-IND)                                                          171019 
 7037.00            MOVE ANNNETPRM  OF FCONCOVSLC-REC                                                                         171019 
 7038.00                            TO WSAA-NANNNETPRM(WSAA-TOP-IND)                                                          171019 
 7039.00            MOVE INIANETPRM OF FCONCOVSLC-REC                                                                         171019 
 7040.00                            TO WSAA-NINIANETPRM(WSAA-TOP-IND)                                                         171019 
 7041.00            MOVE SGLNETPRM  OF FCONCOVSLC-REC                                                                         171019 
 7042.00                            TO WSAA-NSGLNETPRM(WSAA-TOP-IND)                                                          171019 
 7043.00            MOVE ISTNETPRM  OF FCONCOVSLC-REC                                                                         171019 
 7044.00                            TO WSAA-NISTNETPRM(WSAA-TOP-IND)                                                          171019 
 7045.00            MOVE ININETPRM  OF FCONCOVSLC-REC                                                                         171019 
 7046.00                            TO WSAA-NININETPRM(WSAA-TOP-IND)                                                          171019 
 7047.00            MOVE ISTGRSPRM  OF FCONCOVSLC-REC                                                                         171019 
 7048.00                            TO WSAA-NISTGRSPRM(WSAA-TOP-IND)                                                          171019 
 7049.00                                                                                                                      171019 
 7050.00            MOVE CLNTORGCOD OF FCONCOVSLC-REC                                                                         171019 
 7051.00                            TO WSAA-NCLNTORGCOD(WSAA-TOP-IND)                                                         171019 
 7052.00            MOVE CAMPCOD    OF FCONCOVSLC-REC                                                                         171019 
 7053.00                            TO WSAA-NCAMPCOD(WSAA-TOP-IND)                                                            171019 
 7054.00            MOVE DIVAMT     OF FCONCOVSLC-REC                                                                         171019 
 7055.00                            TO WSAA-NDIVAMT(WSAA-TOP-IND)                                                             171019 
 7056.00            MOVE LOANOUTAMT OF FCONCOVSLC-REC                                                                         171019 
 7057.00                            TO WSAA-NLOANOUTAMT(WSAA-TOP-IND)                                                         171019 
 7058.00            MOVE NINVAMT    OF FCONCOVSLC-REC                                                                         171019 
 7059.00                            TO WSAA-NNINVAMT(WSAA-TOP-IND)                                                            171019 
 7060.00            MOVE CLNTCODL4 OF FCONLIF-REC(1:8)                                                                        171019 
 7061.00                           TO WSAA-NCLNTCODL4(WSAA-TOP-IND)                                                           171019 
 7062.00            .                                                                                                         171019 
 7063.00            END-SAVE-TOPUP-GREATER-DATE.                                                                              171019 
 7064.00            EXIT.                                                                                                     171019 
 7065.00       *------------------------------------------------------------------------------------------------------------- 171019 
 7066.00         CHANGE-CLIENTORIGIN-FORNEW SECTION.                                                                          171019 
 7067.00       *------------------------------------------------------------------------------------------------------------- 171019 
 7068.00                                                                                                                      180313 
 7069.00               IF   MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7070.00               AND  (MPULCOD  OF MPMDLPNTNP-REC = 'TUM1'                                                              180313 
 7071.00               OR    MPULCOD  OF MPMDLPNTNP-REC = 'TUM2')                                                             180313 
 7072.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               180313 
 7073.00                                                    = 15                                                              180313 
 7074.00               END-IF                                                                                                 180313 
 7075.00                                                                                                                      180313 
 7076.00               IF   MPCLNTORG OF MPMDLPNTNP-REC = 2                                                                   180313 
 7077.00               AND  (MPULCOD  OF MPMDLPNTNP-REC = 'TUM1'                                                              180313 
 7078.00               OR    MPULCOD  OF MPMDLPNTNP-REC = 'TUM2')                                                             180313 
 7079.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               180313 
 7080.00                                                    = 24                                                              180313 
 7081.00               END-IF                                                                                                 180313 
 7082.00                                                                                                                      180313 
 7083.00               EVALUATE TRUE                                                                                          171020 
 7084.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7085.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7086.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7087.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7088.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7089.00               AND  MPRIDCOD OF MPMDLPNTNP-REC(1:1) = ' '                                                             171024 
 7090.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7091.00                                                    = 10                                                              171024 
 7092.00                                                                                                                      171020 
 7093.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7094.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7095.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7096.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7097.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7098.00               AND  MPRIDCOD OF MPMDLPNTNP-REC = 'LA'                                                                 171020 
 7099.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7100.00                                                    = 11                                                              171024 
 7101.00                                                                                                                      171020 
 7102.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7103.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7104.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7105.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7106.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7107.00               AND  MPRIDCOD OF MPMDLPNTNP-REC = 'LA_AD'                                                              171020 
 7108.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7109.00                                                    = 12                                                              171024 
 7110.00                                                                                                                      171020 
 7111.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7112.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7113.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7114.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7115.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7116.00               AND  MPRIDCOD OF MPMDLPNTNP-REC = 'PH'                                                                 171020 
 7117.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7118.00                                                    = 13                                                              171024 
 7119.00                                                                                                                      171020 
 7120.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 1                                                                   180313 
 7121.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7122.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7123.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7124.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7125.00               AND  MPRIDCOD OF MPMDLPNTNP-REC = 'PH_AD'                                                              171020 
 7126.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7127.00                                                    = 14                                                              171024 
 7128.00                                                                                                                      171020 
 7129.00               END-EVALUATE                                                                                           180313 
 7130.00                                                                                                                      180313 
 7131.00               EVALUATE TRUE                                                                                          171020 
 7132.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 2                                                                   180313 
 7133.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7134.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7135.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7136.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7137.00               AND  MPRIDCOD OF MPMDLPNTNP-REC(1:1) = ' '                                                             171024 
 7138.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7139.00                                                    = 20                                                              171024 
 7140.00                                                                                                                      171020 
 7141.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 2                                                                   180313 
 7142.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7143.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7144.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7145.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7146.00               AND (MPRIDCOD OF MPMDLPNTNP-REC = 'LA'                                                                 171030 
 7147.00               OR   MPRIDCOD OF MPMDLPNTNP-REC = 'LA_AD')                                                             171030 
 7148.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7149.00                                                    = 22                                                              171024 
 7150.00                                                                                                                      171020 
 7151.00               WHEN MPCLNTORG OF MPMDLPNTNP-REC = 2                                                                   180313 
 7152.00               AND (MPFILFLD OF MPMDLPNTNP-REC = 'MCP1'                                                               171020 
 7153.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP2'                                                               180326 
 7154.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP3'                                                               180326 
 7155.00               OR   MPFILFLD OF MPMDLPNTNP-REC = 'MCP4')                                                              180326 
 7156.00               AND (MPRIDCOD OF MPMDLPNTNP-REC = 'PH'                                                                 171030 
 7157.00               OR   MPRIDCOD OF MPMDLPNTNP-REC = 'PH_AD')                                                             171030 
 7158.00                    COMPUTE MPCLNTORG OF MPMDLPNTNP-REC                                                               171024 
 7159.00                                                    = 23                                                              171024 
 7160.00               END-EVALUATE                                                                                           180313 
 7161.00                                                                                                                      171020 
 7162.00               .                                                                                                      171020 
 7163.00            END-CHANGE-CLIENTORIGIN-FORNEW.                                                                           171020 
 7164.00            EXIT.                                                                                                     171020 
 7165.00       *------------------------------------------------------------------------------------------------------------- 171030 
 7166.00         CHECK-DATE-TERM SECTION.                                                                                     171023 
 7167.00       *------------------------------------------------------------------------------------------------------------- 171023 
 7168.00       *A T                                                                                                     171023 
 7169.00            MOVE 01       TO WRK-CURRAPOD                                                                             171023 
 7170.00            MOVE 01       TO WRK-CURRAPOM                                                                             171023 
 7171.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             171023 
 7172.00                                                                                                                      171023 
 7173.00            MOVE 31       TO WRK-CURREOSD                                                                             171023 
 7174.00            MOVE 03       TO WRK-CURREOSM                                                                             171023 
 7175.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             171023 
 7176.00                                                                                                                      171023 
 7177.00            IF  RUNDT OF FCONCOVSLC-REC      >= WRK-CURRENTAPO                                                        171023 
 7178.00            AND RUNDT OF FCONCOVSLC-REC      <= WRK-CURRENTEOS                                                        171023 
 7179.00                                                                                                                      171023 
 7180.00                IF (RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7181.00                                             >= WRK-CURRENTAPO                                                        171023 
 7182.00                AND RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7183.00                                             <= WRK-CURRENTEOS)                                                       171023 
 7184.00                    MOVE '1' TO WRK-CHECKSLC-DATE                                                                     171023 
 7185.00                END-IF                                                                                                171023 
 7186.00            END-IF                                                                                                    171023 
 7187.00       *B T                                                                                                     171023 
 7188.00                                                                                                                      171023 
 7189.00            MOVE 01       TO WRK-CURRAPOD                                                                             171023 
 7190.00            MOVE 04       TO WRK-CURRAPOM                                                                             171023 
 7191.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             171023 
 7192.00                                                                                                                      171023 
 7193.00            MOVE 30       TO WRK-CURREOSD                                                                             171023 
 7194.00            MOVE 06       TO WRK-CURREOSM                                                                             171023 
 7195.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             171023 
 7196.00                                                                                                                      171023 
 7197.00            IF  RUNDT OF FCONCOVSLC-REC      >= WRK-CURRENTAPO                                                        171023 
 7198.00            AND RUNDT OF FCONCOVSLC-REC      <= WRK-CURRENTEOS                                                        171023 
 7199.00                                                                                                                      171023 
 7200.00                IF (RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7201.00                                             >= WRK-CURRENTAPO                                                        171023 
 7202.00                AND RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7203.00                                             <= WRK-CURRENTEOS)                                                       171023 
 7204.00                    MOVE '1' TO WRK-CHECKSLC-DATE                                                                     171023 
 7205.00                END-IF                                                                                                171023 
 7206.00            END-IF                                                                                                    171023 
 7207.00       *     T                                                                                                 171023 
 7208.00            MOVE 01       TO WRK-CURRAPOD                                                                             171023 
 7209.00            MOVE 07       TO WRK-CURRAPOM                                                                             171023 
 7210.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             171023 
 7211.00                                                                                                                      171023 
 7212.00            MOVE 30       TO WRK-CURREOSD                                                                             171023 
 7213.00            MOVE 09       TO WRK-CURREOSM                                                                             171023 
 7214.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             171023 
 7215.00                                                                                                                      171023 
 7216.00            IF  RUNDT OF FCONCOVSLC-REC      >= WRK-CURRENTAPO                                                        171023 
 7217.00            AND RUNDT OF FCONCOVSLC-REC      <= WRK-CURRENTEOS                                                        171023 
 7218.00                                                                                                                      171023 
 7219.00                IF (RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7220.00                                             >= WRK-CURRENTAPO                                                        171023 
 7221.00                AND RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7222.00                                             <= WRK-CURRENTEOS)                                                       171023 
 7223.00                    MOVE '1' TO WRK-CHECKSLC-DATE                                                                     171023 
 7224.00                END-IF                                                                                                171023 
 7225.00            END-IF                                                                                                    171023 
 7226.00       *     T                                                                                                 171023 
 7227.00            MOVE 01       TO WRK-CURRAPOD                                                                             171023 
 7228.00            MOVE 10       TO WRK-CURRAPOM                                                                             171023 
 7229.00            MOVE WRK-RUNY TO WRK-CURRAPOY                                                                             171023 
 7230.00                                                                                                                      171023 
 7231.00            MOVE 31       TO WRK-CURREOSD                                                                             171023 
 7232.00            MOVE 12       TO WRK-CURREOSM                                                                             171023 
 7233.00            MOVE WRK-RUNY TO WRK-CURREOSY                                                                             171023 
 7234.00                                                                                                                      171023 
 7235.00            IF  RUNDT OF FCONCOVSLC-REC      >= WRK-CURRENTAPO                                                        171023 
 7236.00            AND RUNDT OF FCONCOVSLC-REC      <= WRK-CURRENTEOS                                                        171023 
 7237.00                                                                                                                      171023 
 7238.00                IF (RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7239.00                                             >= WRK-CURRENTAPO                                                        171023 
 7240.00                AND RSKCOMMDT OF FCONCOVSLC-REC                                                                       171023 
 7241.00                                             <= WRK-CURRENTEOS)                                                       171023 
 7242.00                    MOVE '1' TO WRK-CHECKSLC-DATE                                                                     171023 
 7243.00                END-IF                                                                                                171023 
 7244.00            END-IF                                                                                                    171023 
 7245.00               .                                                                                                      171023 
 7246.00            END-CHECK-DATE-TERM.                                                                                      171023 
 7247.00            EXIT.                                                                                                     171023 
 7248.00       *------------------------------------------------------------------------------------------------------------- 171030 
 7249.00         CHECK-HISTORY-FILES SECTION.                                                                                 180319 
 7250.00       *------------------------------------------------------------------------------------------------------------- 171030 
 7251.00            MOVE '00'                   TO WRK-FOUND-NEW-MODEL                                                        180319 
 7252.00            MOVE '0'                    TO WRK-PROCESS                                                                180423 
 7253.00            MOVE MPFPOLNUM OF MPMDLPNTNP-REC                                                                          180319 
 7254.00                                        TO MPFPOLNUM OF LHMPMDLPNT-REC                                                180420 
 7255.00            MOVE SYSAPPCOD OF WRK-FCONCOV-REC                                                                         180420 
 7256.00                                        TO SYSAPPCOD OF LHMPMDLPNT-REC                                                180424 
 7257.00            MOVE WRK-RUNDT-FROM         TO RUNDT     OF LHMPMDLPNT-REC                                                180424 
 7258.00                                                                                                                      180319 
 7259.00            START LHMPMDLPNT  KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                      180420 
 7260.00            READ  LHMPMDLPNT  NEXT                                                                                    180420 
 7261.00                                                                                                                      180319 
 7262.00            PERFORM UNTIL LHMPMDLPNT-STATUS NOT  = FOUND-REC                                                          180420 
 7263.00            OR  MPFPOLNUM OF MPMDLPNTNP-REC NOT  =                                                                    180423 
 7264.00                MPFPOLNUM OF LHMPMDLPNT-REC                                                                           180423 
 7265.00            OR  SYSAPPCOD OF WRK-FCONCOV-REC NOT =                                                                    180420 
 7266.00                SYSAPPCOD OF LHMPMDLPNT-REC                                                                           180420 
 7267.00            OR  WRK-FOUND-NEW-MODEL      = '01'                                                                       180420 
 7268.00                                                                                                                      180418 
 7269.00                MOVE '1'                TO WRK-PROCESS                                                                180423 
 7270.00                                                                                                                      181120 
 7271.00                IF  LHMPMDLPNT-STATUS    =  FOUND-REC                                                                 180420 
 7272.00                AND MPSPCOD OF LHMPMDLPNT-REC                                                                         180420 
 7273.00                                         = 3                                                                          180420 
 7274.00                    MOVE '01'           TO WRK-FOUND-NEW-MODEL                                                        180420 
 7275.00                END-IF                                                                                                180420 
 7276.00               READ LHMPMDLPNT NEXT                                                                                   180420 
 7277.00                                                                                                                      180423 
 7278.00            END-PERFORM                                                                                               180319 
 7279.00       * AN                                            180423 
 7280.00       *  NON-APE NEW BUSINESS.                                                                                    180423 
 7281.00            IF WRK-PROCESS NOT  = '1'                                                                                 180423 
 7282.00               MOVE '01'           TO WRK-FOUND-NEW-MODEL                                                             180423 
 7283.00            END-IF                                                                                                    180423 
 7284.00               .                                                                                                      171030 
 7285.00            END-CHECK-HISTORY-FILES.                                                                                  180319 
 7286.00            EXIT.                                                                                                     171030 
 7287.00       *------------------------------------------------------------------------------------------------------------- 180319 
 7288.00         WRITE-NON-APE SECTION.                                                                                       180319 
 7289.00       *------------------------------------------------------------------------------------------------------------- 180319 
 7290.00            MOVE MPMDLPNTNP-REC TO MDLNNONAPE-REC                                                                     180319 
 7291.00            READ MDLNNONAPE                                                                                           180319 
 7292.00            IF MDLNNONAPE-STATUS  NOT = FOUND-REC                                                                     180319 
 7293.00               PERFORM WRITE-NONAPE-REC                                                                               190219 
 7294.00       ****    WRITE MDLNNONAPE-REC                                                                                   190219 
 7295.00            END-IF                                                                                                    180319 
 7296.00               .                                                                                                      180319 
 7297.00            END-WRITE-NON-APE.                                                                                        180319 
 7298.00            EXIT.                                                                                                     180319 
 7299.00       *------------------------------------------------------------------------------------------------------------- 180425 
 7300.00         CHECK-NEW-BUSINESS SECTION.                                                                                  180425 
 7301.00       *------------------------------------------------------------------------------------------------------------- 180425 
 7302.00       * INCEPT DATE >PORTOFOLIO DATE                                                                                 180425 
 7303.00            MOVE MPINCPDAY  OF MPMDLPNTNP-REC    TO WRK-INCPDAY                                                       180425 
 7304.00            MOVE MPINCPMON  OF MPMDLPNTNP-REC    TO WRK-INCPMON                                                       180425 
 7305.00            MOVE MPINCPYEAR OF MPMDLPNTNP-REC    TO WRK-INCPYEAR                                                      180425 
 7306.00                                                                                                                      180425 
 7307.00            IF WRK-INCPDATE >  WRK-RUNDT                                                                              180425 
 7308.00               MOVE 'ERROR:After Valuation Date' TO WMPREJRESN                                                        180425 
 7309.00               PERFORM WRITE-EXCLUDE-NB                                                                               180425 
 7310.00            ELSE                                                                                                      180425 
 7311.00               PERFORM WRITE-NON-APE                                                                                  180425 
 7312.00            END-IF                                                                                                    180425 
 7313.00               .                                                                                                      180425 
 7314.00            END-CHECK-NEW-BUSINESS.                                                                                   180425 
 7315.00            EXIT.                                                                                                     180425 
 7316.00       *------------------------------------------------------------------------------------------------------------- 180425 
 7317.00         GET-LOADINGS SECTION.                                                                                        181120 
 7318.00       *------------------------------------------------------------------------------------------------------------- 181120 
 7319.00       * get loadings and discounts related only to occupation, medical and BMI.                                      181120 
 7320.00       *                                                                                                              181120 
 7321.00            MOVE WSCC-1                  TO WSAA-TOTAL-LOADINGS                                                       190214 
 7322.00                                                                                                                      190214 
 7323.00            INITIALIZE CONSPCTRMR OF FCONSPCTRM-REC                                                                   181120 
 7324.00                                                                                                                      181120 
 7325.00            MOVE RUNDT     OF FCONCOV-REC   TO RUNDT    OF FCONSPCTRM-REC                                             181120 
 7326.00            MOVE COMPCOD   OF FCONCOV-REC   TO COMPCOD  OF FCONSPCTRM-REC                                             181120 
 7327.00            MOVE DSBCHACOD OF FCONCOV-REC   TO DSBCHACOD                                                              181120 
 7328.00                                                        OF FCONSPCTRM-REC                                             181120 
 7329.00            MOVE BRCHCOD   OF FCONCOV-REC   TO BRCHCOD  OF FCONSPCTRM-REC                                             181120 
 7330.00            MOVE SYSAPPCOD OF FCONCOV-REC   TO SYSAPPCOD                                                              181120 
 7331.00                                                        OF FCONSPCTRM-REC                                             181120 
 7332.00            MOVE CONNBR    OF FCONCOV-REC   TO CONNBR   OF FCONSPCTRM-REC                                             181120 
 7333.00            MOVE LIFNO     OF FCONCOV-REC   TO LIFNO    OF FCONSPCTRM-REC                                             181120 
 7334.00            MOVE COVNO     OF FCONCOV-REC   TO COVNO    OF FCONSPCTRM-REC                                             181120 
 7335.00                                                                                                                      181120 
 7336.00            START FCONSPCTRM KEY IS >= EXTERNALLY-DESCRIBED-KEY                                                       181120 
 7337.00            READ  FCONSPCTRM NEXT                                                                                     181120 
 7338.00                                                                                                                      181120 
 7339.00            PERFORM    UNTIL  FCONSPCTRM-STATUS                                                                       181120 
 7340.00                                          NOT = FOUND-REC                                                             181120 
 7341.00              OR RUNDT     OF FCONCOV-REC NOT = RUNDT                                                                 181120 
 7342.00                                                       OF FCONSPCTRM-REC                                              181120 
 7343.00              OR COMPCOD   OF FCONCOV-REC NOT = COMPCOD                                                               181120 
 7344.00                                                       OF FCONSPCTRM-REC                                              181120 
 7345.00              OR DSBCHACOD OF FCONCOV-REC NOT = DSBCHACOD                                                             181120 
 7346.00                                                       OF FCONSPCTRM-REC                                              181120 
 7347.00              OR BRCHCOD   OF FCONCOV-REC NOT = BRCHCOD                                                               181120 
 7348.00                                                       OF FCONSPCTRM-REC                                              181120 
 7349.00              OR SYSAPPCOD OF FCONCOV-REC NOT = SYSAPPCOD                                                             181120 
 7350.00                                                       OF FCONSPCTRM-REC                                              181120 
 7351.00              OR CONNBR    OF FCONCOV-REC NOT = CONNBR                                                                181120 
 7352.00                                                       OF FCONSPCTRM-REC                                              181120 
 7353.00              OR LIFNO     OF FCONCOV-REC NOT = LIFNO                                                                 181120 
 7354.00                                                       OF FCONSPCTRM-REC                                              181120 
 7355.00              OR COVNO     OF FCONCOV-REC NOT = COVNO                                                                 181120 
 7356.00                                                       OF FCONSPCTRM-REC                                              181120 
 7357.00                                                                                                                      181120 
 7358.00              PERFORM PROCESS-LOADING                                                                                 181120 
 7359.00                                                                                                                      181120 
 7360.00              READ FCONSPCTRM NEXT                                                                                    181120 
 7361.00                                                                                                                      181120 
 7362.00            END-PERFORM                                                                                               181120 
 7363.00                                                                                                                      181120 
 7364.00               .                                                                                                      181120 
 7365.00         END-GET-LOADINGS.                                                                                            181120 
 7366.00            EXIT.                                                                                                     181120 
 7367.00       *------------------------------------------------------------------------------------------------------------- 181120 
 7368.00         PROCESS-LOADING SECTION.                                                                                     181120 
 7369.00       *------------------------------------------------------------------------------------------------------------- 181120 
 7370.00       * check if loading is in target group:                                                                         181120 
 7371.00       *    yes: add/substract from total.                                                                            181120 
 7372.00       *    no:  ignore                                                                                               181120 
 7373.00       *                                                                                                              181120 
 7374.00            INITIALIZE FLOADR OF FLOAD-REC                                                                            181120 
 7375.00            MOVE SPCTRMCOD OF FCONSPCTRM-REC                                                                          181120 
 7376.00                                         TO SPCTRMCOD OF FLOAD-REC                                                    181120 
 7377.00            READ FLOAD                                                                                                181120 
 7378.00       *                                                                                                              181120 
 7379.00       * if found means the loading is taken into account.                                                            181120 
 7380.00       *                                                                                                              181120 
 7381.00            IF FLOAD-STATUS              = FOUND-REC                                                                  181120 
 7382.00              MOVE WSCC-1               TO WSAA-CURR-LOADING                                                          190214 
 7383.00                                                                                                                      190214 
 7384.00              EVALUATE TRUE                                                                                           181120 
 7385.00       *                                                                                                              181120 
 7386.00       * when percentage is filled:                                                                                   181120 
 7387.00       *   actual percentage = 1 + ( (FLOAD %) - 100 ) / 100                                                          190214 
 7388.00       *                                                                                                              181120 
 7389.00              WHEN SPCTRMPC OF FCONSPCTRM-REC                                                                         181120 
 7390.00                                         > ZERO                                                                       181120 
 7391.00                  COMPUTE WSAA-CURR-LOADING ROUNDED                                                                   190214 
 7392.00                                         = WSCC-1                                                                     190214 
 7393.00                                         + ((SPCTRMPC OF FCONSPCTRM-REC                                               190214 
 7394.00                                         -   WSCC-100)                                                                181120 
 7395.00                                         / WSCC-100)                                                                  181120 
 7396.00                  END-COMPUTE                                                                                         181120 
 7397.00       *                                                                                                              181120 
 7398.00       * when rate is filled:                                                                                         181120 
 7399.00       *   actual percentage = 1 + ( (FLOAD &/&&) / 1000 / 1000                                                       190214 
 7400.00       *   example: 7000.00 / 1000000 = 0.007                                                                         181120 
 7401.00       *                                                                                                              181120 
 7402.00              WHEN SPCTRMRAT OF FCONSPCTRM-REC                                                                        181120 
 7403.00                                         > ZERO                                                                       181120 
 7404.00                  COMPUTE WSAA-CURR-LOADING ROUNDED                                                                   190214 
 7405.00                                         = WSCC-1                                                                     190214 
 7406.00                                         * (SPCTRMRAT OF FCONSPCTRM-REC)                                              190213 
 7407.00                                         / WSCC-MILLION                                                               181120 
 7408.00                  END-COMPUTE                                                                                         181120 
 7409.00                                                                                                                      181120 
 7410.00            END-EVALUATE                                                                                              181120 
 7411.00                                                                                                                      190214 
 7412.00            COMPUTE WSAA-TOTAL-LOADINGS  = WSAA-TOTAL-LOADINGS                                                        190214 
 7413.00                                         * WSAA-CURR-LOADING                                                          190214 
 7414.00            END-COMPUTE                                                                                               190214 
 7415.00               .                                                                                                      181120 
 7416.00         END-PROCESS-LOADING.                                                                                         181120 
 7417.00            EXIT.                                                                                                     181120 
 7418.00       *------------------------------------------------------------------------------------------------------------- 181205 
 7419.00         CHK-COV-FOR-LOADINGS SECTION.                                                                                181205 
 7420.00       *------------------------------------------------------------------------------------------------------------- 181205 
 7421.00       * check if cover is in target group for loadings.                                                              181205 
 7422.00                                                                                                                      181205 
 7423.00            IF  WSAA-CALC-LOADING        = WSCC-1                                                                     181217 
 7424.00                SET READ-LOADINGS        TO TRUE                                                                      181211 
 7425.00            ELSE                                                                                                      181211 
 7426.00                SET NOT-READ-LOADINGS    TO TRUE                                                                      181211 
 7427.00            END-IF                                                                                                    181211 
 7428.00               .                                                                                                      181205 
 7429.00         END-CHK-COV-FOR-LOADINGS.                                                                                    181211 
 7430.00            EXIT.                                                                                                     181205 
 7431.00       *------------------------------------------------------------------------------------------------------------- 181211 
 7432.00         CALC-ISSUE-DATE SECTION.                                                                                     181212 
 7433.00       *------------------------------------------------------------------------------------------------------------- 181211 
 7434.00       * calculate actual cover issue date.                                                                           181212 
 7435.00                                                                                                                      181211 
 7436.00            MOVE WSCC-N                  TO GET-OLD-ISSUE                                                             181212 
 7437.00            INITIALIZE FCOVREPLR       OF FCOVREPL-REC                                                                181212 
 7438.00       *                                                                                                              181212 
 7439.00       *    check with current cover code.                                                                            181212 
 7440.00       *                                                                                                              181212 
 7441.00            MOVE COVCOD OF WRK-FCONCOV-REC                                                                            181212 
 7442.00                                         TO NEWCOV OF FCOVREPL-REC                                                    181212 
 7443.00            READ  FCOVREPL                                                                                            181217 
 7444.00       *                                                                                                              181212 
 7445.00       *    if found replacement cover, get issue date of it.                                                         181212 
 7446.00       *                                                                                                              181212 
 7447.00            IF FCOVREPL-STATUS = FOUND-REC                                                                            181212 
 7448.00                PERFORM GET-OLD-COVER                                                                                 181212 
 7449.00            END-IF                                                                                                    181212 
 7450.00               .                                                                                                      181211 
 7451.00         END-CALC-ISSUE-DATE.                                                                                         181212 
 7452.00            EXIT.                                                                                                     181211 
 7453.00       *------------------------------------------------------------------------------------------------------------- 181212 
 7454.00         GET-OLD-COVER SECTION.                                                                                       181212 
 7455.00       *------------------------------------------------------------------------------------------------------------- 181212 
 7456.00       * get old cover info.                                                                                          181212 
 7457.00                                                                                                                      181212 
 7458.00            MOVE WSCC-N                  TO GET-OLD-ISSUE                                                             181217 
 7459.00            INITIALIZE CONCOVR         OF LFCONCOV-REC                                                                181212 
 7460.00                                                                                                                      181212 
 7461.00            MOVE RUNDT     OF FCONLIF-REC TO RUNDT     OF LFCONCOV-REC                                                181212 
 7462.00            MOVE COMPCOD   OF FCONLIF-REC TO COMPCOD   OF LFCONCOV-REC                                                181212 
 7463.00            MOVE DSBCHACOD OF FCONLIF-REC TO DSBCHACOD OF LFCONCOV-REC                                                181212 
 7464.00            MOVE BRCHCOD   OF FCONLIF-REC TO BRCHCOD   OF LFCONCOV-REC                                                181212 
 7465.00            MOVE SYSAPPCOD OF FCONLIF-REC TO SYSAPPCOD OF LFCONCOV-REC                                                181212 
 7466.00            MOVE CONNBR    OF FCONLIF-REC TO CONNBR    OF LFCONCOV-REC                                                181212 
 7467.00            MOVE LIFNO     OF FCONLIF-REC TO LIFNO     OF LFCONCOV-REC                                                181212 
 7468.00            MOVE OLDCOV OF FCOVREPL-REC   TO COVCOD    OF LFCONCOV-REC                                                181217 
 7469.00                                                                                                                      181212 
 7470.00            READ LFCONCOV                                                                                             181212 
 7471.00                                                                                                                      181212 
 7472.00       * issue date, age at entry.                                                                                    181212 
 7473.00            IF LFCONCOV-STATUS = FOUND-REC                                                                            181212 
 7474.00                MOVE WSCC-Y              TO GET-OLD-ISSUE                                                             181212 
 7475.00            END-IF                                                                                                    181212 
 7476.00                                                                                                                      181212 
 7477.00               .                                                                                                      181212 
 7478.00         END-GET-OLD-COVER.                                                                                           181212 
 7479.00            EXIT.                                                                                                     181212 
 7480.00       *------------------------------------------------------------------------------------------------------------- 190205 
 7481.00         CHECK-WOP-ACTIVATION SECTION.                                                                                190205 
 7482.00       *------------------------------------------------------------------------------------------------------------- 190205 
 7483.00       * check if it is a wop activated: true when owner = CCS code of NN.                                            190205 
 7484.00                                                                                                                      190205 
 7485.00            MOVE WSCC-0                 TO WOP-STATUS                                                                 190205 
 7486.00            IF CONOWNCOD OF FCONTRACT-REC                                                                             190205 
 7487.00                                         = WSCC-NN-CLIENT                                                             190205 
 7488.00                MOVE WSCC-1             TO WOP-STATUS                                                                 190205 
 7489.00            END-IF                                                                                                    190205 
 7490.00               .                                                                                                      190205 
 7491.00         END-CHECK-WOP-ACTIVATION.                                                                                    190205 
 7492.00            EXIT.                                                                                                     190205 
 7493.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7494.00         WRITE-BIF-REC SECTION.                                                                                       190220 
 7495.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7496.00            COMPUTE WRRN = WRRN + 1                                                                                   190220 
 7497.00            MOVE WRRN TO MPCMPIDF OF MPMDLPNT-REC                                                                     190220 
 7498.00                                                                                                                      190220 
 7499.00            WRITE MPMDLPNT-REC                                                                                        190220 
 7500.00            .                                                                                                         190220 
 7501.00         END-WRITE-BIF-REC.                                                                                           190220 
 7502.00            EXIT.                                                                                                     190220 
 7503.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7504.00         WRITE-NEWBUS-REC SECTION.                                                                                    190220 
 7505.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7506.00            COMPUTE WRRN = WRRN + 1                                                                                   190220 
 7507.00            MOVE WRRN TO MPCMPIDF OF MPMDLPNTNP-REC                                                                   190220 
 7508.00                                                                                                                      190220 
 7509.00            WRITE MPMDLPNTNP-REC                                                                                      190220 
 7510.00            .                                                                                                         190220 
 7511.00         END-WRITE-NEWBUS-REC.                                                                                        190220 
 7512.00            EXIT.                                                                                                     190220 
 7513.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7514.00         WRITE-NONAPE-REC SECTION.                                                                                    190220 
 7515.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7516.00            COMPUTE WRRN = WRRN + 1                                                                                   190220 
 7517.00            MOVE WRRN TO MPCMPIDF OF MDLNNONAPE-REC                                                                   190220 
 7518.00                                                                                                                      190220 
 7519.00            WRITE MDLNNONAPE-REC                                                                                      190220 
 7520.00            .                                                                                                         190220 
 7521.00         END-WRITE-NONAPE-REC.                                                                                        190220 
 7522.00            EXIT.                                                                                                     190220 
 7523.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7524.00         WRITE-REJECTED-REC SECTION.                                                                                  190220 
 7525.00       *------------------------------------------------------------------------------------------------------------- 190220 
 7526.00            COMPUTE WRRN = WRRN + 1                                                                                   190220 
 7527.00            MOVE WRRN TO MPCMPIDF OF MPMDLPNTRJ-REC                                                                   190220 
 7528.00                                                                                                                      190220 
 7529.00            WRITE MPMDLPNTRJ-REC                                                                                      190220 
 7530.00            .                                                                                                         190220 
 7531.00         END-WRITE-NONAPE-REC.                                                                                        190220 
 7532.00            EXIT.                                                                                                     190220 
